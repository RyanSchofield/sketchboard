var gO=Object.defineProperty;var mO=(t,e,n)=>e in t?gO(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n;var g=(t,e,n)=>mO(t,typeof e!="symbol"?e+"":e,n);function yO(t,e){for(var n=0;n<e.length;n++){const r=e[n];if(typeof r!="string"&&!Array.isArray(r)){for(const s in r)if(s!=="default"&&!(s in t)){const i=Object.getOwnPropertyDescriptor(r,s);i&&Object.defineProperty(t,s,i.get?i:{enumerable:!0,get:()=>r[s]})}}}return Object.freeze(Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}))}(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))r(s);new MutationObserver(s=>{for(const i of s)if(i.type==="childList")for(const o of i.addedNodes)o.tagName==="LINK"&&o.rel==="modulepreload"&&r(o)}).observe(document,{childList:!0,subtree:!0});function n(s){const i={};return s.integrity&&(i.integrity=s.integrity),s.referrerPolicy&&(i.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?i.credentials="include":s.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function r(s){if(s.ep)return;s.ep=!0;const i=n(s);fetch(s.href,i)}})();var Hn=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function ga(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var u9={exports:{}},_g={},d9={exports:{}},Ke={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var hh=Symbol.for("react.element"),vO=Symbol.for("react.portal"),SO=Symbol.for("react.fragment"),xO=Symbol.for("react.strict_mode"),wO=Symbol.for("react.profiler"),bO=Symbol.for("react.provider"),CO=Symbol.for("react.context"),PO=Symbol.for("react.forward_ref"),kO=Symbol.for("react.suspense"),IO=Symbol.for("react.memo"),EO=Symbol.for("react.lazy"),Hb=Symbol.iterator;function TO(t){return t===null||typeof t!="object"?null:(t=Hb&&t[Hb]||t["@@iterator"],typeof t=="function"?t:null)}var h9={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},p9=Object.assign,f9={};function Hc(t,e,n){this.props=t,this.context=e,this.refs=f9,this.updater=n||h9}Hc.prototype.isReactComponent={};Hc.prototype.setState=function(t,e){if(typeof t!="object"&&typeof t!="function"&&t!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,t,e,"setState")};Hc.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")};function g9(){}g9.prototype=Hc.prototype;function HS(t,e,n){this.props=t,this.context=e,this.refs=f9,this.updater=n||h9}var WS=HS.prototype=new g9;WS.constructor=HS;p9(WS,Hc.prototype);WS.isPureReactComponent=!0;var Wb=Array.isArray,m9=Object.prototype.hasOwnProperty,KS={current:null},y9={key:!0,ref:!0,__self:!0,__source:!0};function v9(t,e,n){var r,s={},i=null,o=null;if(e!=null)for(r in e.ref!==void 0&&(o=e.ref),e.key!==void 0&&(i=""+e.key),e)m9.call(e,r)&&!y9.hasOwnProperty(r)&&(s[r]=e[r]);var a=arguments.length-2;if(a===1)s.children=n;else if(1<a){for(var l=Array(a),c=0;c<a;c++)l[c]=arguments[c+2];s.children=l}if(t&&t.defaultProps)for(r in a=t.defaultProps,a)s[r]===void 0&&(s[r]=a[r]);return{$$typeof:hh,type:t,key:i,ref:o,props:s,_owner:KS.current}}function MO(t,e){return{$$typeof:hh,type:t.type,key:e,ref:t.ref,props:t.props,_owner:t._owner}}function GS(t){return typeof t=="object"&&t!==null&&t.$$typeof===hh}function _O(t){var e={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,function(n){return e[n]})}var Kb=/\/+/g;function r1(t,e){return typeof t=="object"&&t!==null&&t.key!=null?_O(""+t.key):e.toString(36)}function fp(t,e,n,r,s){var i=typeof t;(i==="undefined"||i==="boolean")&&(t=null);var o=!1;if(t===null)o=!0;else switch(i){case"string":case"number":o=!0;break;case"object":switch(t.$$typeof){case hh:case vO:o=!0}}if(o)return o=t,s=s(o),t=r===""?"."+r1(o,0):r,Wb(s)?(n="",t!=null&&(n=t.replace(Kb,"$&/")+"/"),fp(s,e,n,"",function(c){return c})):s!=null&&(GS(s)&&(s=MO(s,n+(!s.key||o&&o.key===s.key?"":(""+s.key).replace(Kb,"$&/")+"/")+t)),e.push(s)),1;if(o=0,r=r===""?".":r+":",Wb(t))for(var a=0;a<t.length;a++){i=t[a];var l=r+r1(i,a);o+=fp(i,e,n,l,s)}else if(l=TO(t),typeof l=="function")for(t=l.call(t),a=0;!(i=t.next()).done;)i=i.value,l=r+r1(i,a++),o+=fp(i,e,n,l,s);else if(i==="object")throw e=String(t),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return o}function Jh(t,e,n){if(t==null)return t;var r=[],s=0;return fp(t,r,"","",function(i){return e.call(n,i,s++)}),r}function AO(t){if(t._status===-1){var e=t._result;e=e(),e.then(function(n){(t._status===0||t._status===-1)&&(t._status=1,t._result=n)},function(n){(t._status===0||t._status===-1)&&(t._status=2,t._result=n)}),t._status===-1&&(t._status=0,t._result=e)}if(t._status===1)return t._result.default;throw t._result}var er={current:null},gp={transition:null},DO={ReactCurrentDispatcher:er,ReactCurrentBatchConfig:gp,ReactCurrentOwner:KS};function S9(){throw Error("act(...) is not supported in production builds of React.")}Ke.Children={map:Jh,forEach:function(t,e,n){Jh(t,function(){e.apply(this,arguments)},n)},count:function(t){var e=0;return Jh(t,function(){e++}),e},toArray:function(t){return Jh(t,function(e){return e})||[]},only:function(t){if(!GS(t))throw Error("React.Children.only expected to receive a single React element child.");return t}};Ke.Component=Hc;Ke.Fragment=SO;Ke.Profiler=wO;Ke.PureComponent=HS;Ke.StrictMode=xO;Ke.Suspense=kO;Ke.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=DO;Ke.act=S9;Ke.cloneElement=function(t,e,n){if(t==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+t+".");var r=p9({},t.props),s=t.key,i=t.ref,o=t._owner;if(e!=null){if(e.ref!==void 0&&(i=e.ref,o=KS.current),e.key!==void 0&&(s=""+e.key),t.type&&t.type.defaultProps)var a=t.type.defaultProps;for(l in e)m9.call(e,l)&&!y9.hasOwnProperty(l)&&(r[l]=e[l]===void 0&&a!==void 0?a[l]:e[l])}var l=arguments.length-2;if(l===1)r.children=n;else if(1<l){a=Array(l);for(var c=0;c<l;c++)a[c]=arguments[c+2];r.children=a}return{$$typeof:hh,type:t.type,key:s,ref:i,props:r,_owner:o}};Ke.createContext=function(t){return t={$$typeof:CO,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},t.Provider={$$typeof:bO,_context:t},t.Consumer=t};Ke.createElement=v9;Ke.createFactory=function(t){var e=v9.bind(null,t);return e.type=t,e};Ke.createRef=function(){return{current:null}};Ke.forwardRef=function(t){return{$$typeof:PO,render:t}};Ke.isValidElement=GS;Ke.lazy=function(t){return{$$typeof:EO,_payload:{_status:-1,_result:t},_init:AO}};Ke.memo=function(t,e){return{$$typeof:IO,type:t,compare:e===void 0?null:e}};Ke.startTransition=function(t){var e=gp.transition;gp.transition={};try{t()}finally{gp.transition=e}};Ke.unstable_act=S9;Ke.useCallback=function(t,e){return er.current.useCallback(t,e)};Ke.useContext=function(t){return er.current.useContext(t)};Ke.useDebugValue=function(){};Ke.useDeferredValue=function(t){return er.current.useDeferredValue(t)};Ke.useEffect=function(t,e){return er.current.useEffect(t,e)};Ke.useId=function(){return er.current.useId()};Ke.useImperativeHandle=function(t,e,n){return er.current.useImperativeHandle(t,e,n)};Ke.useInsertionEffect=function(t,e){return er.current.useInsertionEffect(t,e)};Ke.useLayoutEffect=function(t,e){return er.current.useLayoutEffect(t,e)};Ke.useMemo=function(t,e){return er.current.useMemo(t,e)};Ke.useReducer=function(t,e,n){return er.current.useReducer(t,e,n)};Ke.useRef=function(t){return er.current.useRef(t)};Ke.useState=function(t){return er.current.useState(t)};Ke.useSyncExternalStore=function(t,e,n){return er.current.useSyncExternalStore(t,e,n)};Ke.useTransition=function(){return er.current.useTransition()};Ke.version="18.3.1";d9.exports=Ke;var C=d9.exports;const Ne=ga(C),jO=yO({__proto__:null,default:Ne},[C]);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var RO=C,OO=Symbol.for("react.element"),LO=Symbol.for("react.fragment"),NO=Object.prototype.hasOwnProperty,zO=RO.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,FO={key:!0,ref:!0,__self:!0,__source:!0};function x9(t,e,n){var r,s={},i=null,o=null;n!==void 0&&(i=""+n),e.key!==void 0&&(i=""+e.key),e.ref!==void 0&&(o=e.ref);for(r in e)NO.call(e,r)&&!FO.hasOwnProperty(r)&&(s[r]=e[r]);if(t&&t.defaultProps)for(r in e=t.defaultProps,e)s[r]===void 0&&(s[r]=e[r]);return{$$typeof:OO,type:t,key:i,ref:o,props:s,_owner:zO.current}}_g.Fragment=LO;_g.jsx=x9;_g.jsxs=x9;u9.exports=_g;var d=u9.exports,Iv={},w9={exports:{}},Yr={},b9={exports:{}},C9={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(t){function e(V,Q){var ne=V.length;V.push(Q);e:for(;0<ne;){var le=ne-1>>>1,de=V[le];if(0<s(de,Q))V[le]=Q,V[ne]=de,ne=le;else break e}}function n(V){return V.length===0?null:V[0]}function r(V){if(V.length===0)return null;var Q=V[0],ne=V.pop();if(ne!==Q){V[0]=ne;e:for(var le=0,de=V.length,_e=de>>>1;le<_e;){var je=2*(le+1)-1,ce=V[je],tt=je+1,Ue=V[tt];if(0>s(ce,ne))tt<de&&0>s(Ue,ce)?(V[le]=Ue,V[tt]=ne,le=tt):(V[le]=ce,V[je]=ne,le=je);else if(tt<de&&0>s(Ue,ne))V[le]=Ue,V[tt]=ne,le=tt;else break e}}return Q}function s(V,Q){var ne=V.sortIndex-Q.sortIndex;return ne!==0?ne:V.id-Q.id}if(typeof performance=="object"&&typeof performance.now=="function"){var i=performance;t.unstable_now=function(){return i.now()}}else{var o=Date,a=o.now();t.unstable_now=function(){return o.now()-a}}var l=[],c=[],u=1,h=null,p=3,f=!1,v=!1,m=!1,x=typeof setTimeout=="function"?setTimeout:null,y=typeof clearTimeout=="function"?clearTimeout:null,S=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function w(V){for(var Q=n(c);Q!==null;){if(Q.callback===null)r(c);else if(Q.startTime<=V)r(c),Q.sortIndex=Q.expirationTime,e(l,Q);else break;Q=n(c)}}function P(V){if(m=!1,w(V),!v)if(n(l)!==null)v=!0,Z(E);else{var Q=n(c);Q!==null&&q(P,Q.startTime-V)}}function E(V,Q){v=!1,m&&(m=!1,y(_),_=-1),f=!0;var ne=p;try{for(w(Q),h=n(l);h!==null&&(!(h.expirationTime>Q)||V&&!$());){var le=h.callback;if(typeof le=="function"){h.callback=null,p=h.priorityLevel;var de=le(h.expirationTime<=Q);Q=t.unstable_now(),typeof de=="function"?h.callback=de:h===n(l)&&r(l),w(Q)}else r(l);h=n(l)}if(h!==null)var _e=!0;else{var je=n(c);je!==null&&q(P,je.startTime-Q),_e=!1}return _e}finally{h=null,p=ne,f=!1}}var M=!1,I=null,_=-1,D=5,R=-1;function $(){return!(t.unstable_now()-R<D)}function U(){if(I!==null){var V=t.unstable_now();R=V;var Q=!0;try{Q=I(!0,V)}finally{Q?O():(M=!1,I=null)}}else M=!1}var O;if(typeof S=="function")O=function(){S(U)};else if(typeof MessageChannel<"u"){var N=new MessageChannel,H=N.port2;N.port1.onmessage=U,O=function(){H.postMessage(null)}}else O=function(){x(U,0)};function Z(V){I=V,M||(M=!0,O())}function q(V,Q){_=x(function(){V(t.unstable_now())},Q)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(V){V.callback=null},t.unstable_continueExecution=function(){v||f||(v=!0,Z(E))},t.unstable_forceFrameRate=function(V){0>V||125<V?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):D=0<V?Math.floor(1e3/V):5},t.unstable_getCurrentPriorityLevel=function(){return p},t.unstable_getFirstCallbackNode=function(){return n(l)},t.unstable_next=function(V){switch(p){case 1:case 2:case 3:var Q=3;break;default:Q=p}var ne=p;p=Q;try{return V()}finally{p=ne}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(V,Q){switch(V){case 1:case 2:case 3:case 4:case 5:break;default:V=3}var ne=p;p=V;try{return Q()}finally{p=ne}},t.unstable_scheduleCallback=function(V,Q,ne){var le=t.unstable_now();switch(typeof ne=="object"&&ne!==null?(ne=ne.delay,ne=typeof ne=="number"&&0<ne?le+ne:le):ne=le,V){case 1:var de=-1;break;case 2:de=250;break;case 5:de=1073741823;break;case 4:de=1e4;break;default:de=5e3}return de=ne+de,V={id:u++,callback:Q,priorityLevel:V,startTime:ne,expirationTime:de,sortIndex:-1},ne>le?(V.sortIndex=ne,e(c,V),n(l)===null&&V===n(c)&&(m?(y(_),_=-1):m=!0,q(P,ne-le))):(V.sortIndex=de,e(l,V),v||f||(v=!0,Z(E))),V},t.unstable_shouldYield=$,t.unstable_wrapCallback=function(V){var Q=p;return function(){var ne=p;p=Q;try{return V.apply(this,arguments)}finally{p=ne}}}})(C9);b9.exports=C9;var $O=b9.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var BO=C,Gr=$O;function oe(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,n=1;n<arguments.length;n++)e+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var P9=new Set,Id={};function vl(t,e){Pc(t,e),Pc(t+"Capture",e)}function Pc(t,e){for(Id[t]=e,t=0;t<e.length;t++)P9.add(e[t])}var eo=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Ev=Object.prototype.hasOwnProperty,UO=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,Gb={},Vb={};function HO(t){return Ev.call(Vb,t)?!0:Ev.call(Gb,t)?!1:UO.test(t)?Vb[t]=!0:(Gb[t]=!0,!1)}function WO(t,e,n,r){if(n!==null&&n.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return r?!1:n!==null?!n.acceptsBooleans:(t=t.toLowerCase().slice(0,5),t!=="data-"&&t!=="aria-");default:return!1}}function KO(t,e,n,r){if(e===null||typeof e>"u"||WO(t,e,n,r))return!0;if(r)return!1;if(n!==null)switch(n.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function tr(t,e,n,r,s,i,o){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=r,this.attributeNamespace=s,this.mustUseProperty=n,this.propertyName=t,this.type=e,this.sanitizeURL=i,this.removeEmptyString=o}var Tn={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(t){Tn[t]=new tr(t,0,!1,t,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(t){var e=t[0];Tn[e]=new tr(e,1,!1,t[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(t){Tn[t]=new tr(t,2,!1,t.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(t){Tn[t]=new tr(t,2,!1,t,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(t){Tn[t]=new tr(t,3,!1,t.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(t){Tn[t]=new tr(t,3,!0,t,null,!1,!1)});["capture","download"].forEach(function(t){Tn[t]=new tr(t,4,!1,t,null,!1,!1)});["cols","rows","size","span"].forEach(function(t){Tn[t]=new tr(t,6,!1,t,null,!1,!1)});["rowSpan","start"].forEach(function(t){Tn[t]=new tr(t,5,!1,t.toLowerCase(),null,!1,!1)});var VS=/[\-:]([a-z])/g;function qS(t){return t[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(t){var e=t.replace(VS,qS);Tn[e]=new tr(e,1,!1,t,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(t){var e=t.replace(VS,qS);Tn[e]=new tr(e,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(t){var e=t.replace(VS,qS);Tn[e]=new tr(e,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(t){Tn[t]=new tr(t,1,!1,t.toLowerCase(),null,!1,!1)});Tn.xlinkHref=new tr("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(t){Tn[t]=new tr(t,1,!1,t.toLowerCase(),null,!0,!0)});function YS(t,e,n,r){var s=Tn.hasOwnProperty(e)?Tn[e]:null;(s!==null?s.type!==0:r||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(KO(e,n,s,r)&&(n=null),r||s===null?HO(e)&&(n===null?t.removeAttribute(e):t.setAttribute(e,""+n)):s.mustUseProperty?t[s.propertyName]=n===null?s.type===3?!1:"":n:(e=s.attributeName,r=s.attributeNamespace,n===null?t.removeAttribute(e):(s=s.type,n=s===3||s===4&&n===!0?"":""+n,r?t.setAttributeNS(r,e,n):t.setAttribute(e,n))))}var ho=BO.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,e0=Symbol.for("react.element"),Wl=Symbol.for("react.portal"),Kl=Symbol.for("react.fragment"),XS=Symbol.for("react.strict_mode"),Tv=Symbol.for("react.profiler"),k9=Symbol.for("react.provider"),I9=Symbol.for("react.context"),ZS=Symbol.for("react.forward_ref"),Mv=Symbol.for("react.suspense"),_v=Symbol.for("react.suspense_list"),QS=Symbol.for("react.memo"),Do=Symbol.for("react.lazy"),E9=Symbol.for("react.offscreen"),qb=Symbol.iterator;function du(t){return t===null||typeof t!="object"?null:(t=qb&&t[qb]||t["@@iterator"],typeof t=="function"?t:null)}var $t=Object.assign,s1;function Nu(t){if(s1===void 0)try{throw Error()}catch(n){var e=n.stack.trim().match(/\n( *(at )?)/);s1=e&&e[1]||""}return`
`+s1+t}var i1=!1;function o1(t,e){if(!t||i1)return"";i1=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(c){var r=c}Reflect.construct(t,[],e)}else{try{e.call()}catch(c){r=c}t.call(e.prototype)}else{try{throw Error()}catch(c){r=c}t()}}catch(c){if(c&&r&&typeof c.stack=="string"){for(var s=c.stack.split(`
`),i=r.stack.split(`
`),o=s.length-1,a=i.length-1;1<=o&&0<=a&&s[o]!==i[a];)a--;for(;1<=o&&0<=a;o--,a--)if(s[o]!==i[a]){if(o!==1||a!==1)do if(o--,a--,0>a||s[o]!==i[a]){var l=`
`+s[o].replace(" at new "," at ");return t.displayName&&l.includes("<anonymous>")&&(l=l.replace("<anonymous>",t.displayName)),l}while(1<=o&&0<=a);break}}}finally{i1=!1,Error.prepareStackTrace=n}return(t=t?t.displayName||t.name:"")?Nu(t):""}function GO(t){switch(t.tag){case 5:return Nu(t.type);case 16:return Nu("Lazy");case 13:return Nu("Suspense");case 19:return Nu("SuspenseList");case 0:case 2:case 15:return t=o1(t.type,!1),t;case 11:return t=o1(t.type.render,!1),t;case 1:return t=o1(t.type,!0),t;default:return""}}function Av(t){if(t==null)return null;if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case Kl:return"Fragment";case Wl:return"Portal";case Tv:return"Profiler";case XS:return"StrictMode";case Mv:return"Suspense";case _v:return"SuspenseList"}if(typeof t=="object")switch(t.$$typeof){case I9:return(t.displayName||"Context")+".Consumer";case k9:return(t._context.displayName||"Context")+".Provider";case ZS:var e=t.render;return t=t.displayName,t||(t=e.displayName||e.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case QS:return e=t.displayName||null,e!==null?e:Av(t.type)||"Memo";case Do:e=t._payload,t=t._init;try{return Av(t(e))}catch{}}return null}function VO(t){var e=t.type;switch(t.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return t=e.render,t=t.displayName||t.name||"",e.displayName||(t!==""?"ForwardRef("+t+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Av(e);case 8:return e===XS?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function na(t){switch(typeof t){case"boolean":case"number":case"string":case"undefined":return t;case"object":return t;default:return""}}function T9(t){var e=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function qO(t){var e=T9(t)?"checked":"value",n=Object.getOwnPropertyDescriptor(t.constructor.prototype,e),r=""+t[e];if(!t.hasOwnProperty(e)&&typeof n<"u"&&typeof n.get=="function"&&typeof n.set=="function"){var s=n.get,i=n.set;return Object.defineProperty(t,e,{configurable:!0,get:function(){return s.call(this)},set:function(o){r=""+o,i.call(this,o)}}),Object.defineProperty(t,e,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(o){r=""+o},stopTracking:function(){t._valueTracker=null,delete t[e]}}}}function t0(t){t._valueTracker||(t._valueTracker=qO(t))}function M9(t){if(!t)return!1;var e=t._valueTracker;if(!e)return!0;var n=e.getValue(),r="";return t&&(r=T9(t)?t.checked?"true":"false":t.value),t=r,t!==n?(e.setValue(t),!0):!1}function df(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch{return t.body}}function Dv(t,e){var n=e.checked;return $t({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:n??t._wrapperState.initialChecked})}function Yb(t,e){var n=e.defaultValue==null?"":e.defaultValue,r=e.checked!=null?e.checked:e.defaultChecked;n=na(e.value!=null?e.value:n),t._wrapperState={initialChecked:r,initialValue:n,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function _9(t,e){e=e.checked,e!=null&&YS(t,"checked",e,!1)}function jv(t,e){_9(t,e);var n=na(e.value),r=e.type;if(n!=null)r==="number"?(n===0&&t.value===""||t.value!=n)&&(t.value=""+n):t.value!==""+n&&(t.value=""+n);else if(r==="submit"||r==="reset"){t.removeAttribute("value");return}e.hasOwnProperty("value")?Rv(t,e.type,n):e.hasOwnProperty("defaultValue")&&Rv(t,e.type,na(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(t.defaultChecked=!!e.defaultChecked)}function Xb(t,e,n){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var r=e.type;if(!(r!=="submit"&&r!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+t._wrapperState.initialValue,n||e===t.value||(t.value=e),t.defaultValue=e}n=t.name,n!==""&&(t.name=""),t.defaultChecked=!!t._wrapperState.initialChecked,n!==""&&(t.name=n)}function Rv(t,e,n){(e!=="number"||df(t.ownerDocument)!==t)&&(n==null?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+n&&(t.defaultValue=""+n))}var zu=Array.isArray;function dc(t,e,n,r){if(t=t.options,e){e={};for(var s=0;s<n.length;s++)e["$"+n[s]]=!0;for(n=0;n<t.length;n++)s=e.hasOwnProperty("$"+t[n].value),t[n].selected!==s&&(t[n].selected=s),s&&r&&(t[n].defaultSelected=!0)}else{for(n=""+na(n),e=null,s=0;s<t.length;s++){if(t[s].value===n){t[s].selected=!0,r&&(t[s].defaultSelected=!0);return}e!==null||t[s].disabled||(e=t[s])}e!==null&&(e.selected=!0)}}function Ov(t,e){if(e.dangerouslySetInnerHTML!=null)throw Error(oe(91));return $t({},e,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function Zb(t,e){var n=e.value;if(n==null){if(n=e.children,e=e.defaultValue,n!=null){if(e!=null)throw Error(oe(92));if(zu(n)){if(1<n.length)throw Error(oe(93));n=n[0]}e=n}e==null&&(e=""),n=e}t._wrapperState={initialValue:na(n)}}function A9(t,e){var n=na(e.value),r=na(e.defaultValue);n!=null&&(n=""+n,n!==t.value&&(t.value=n),e.defaultValue==null&&t.defaultValue!==n&&(t.defaultValue=n)),r!=null&&(t.defaultValue=""+r)}function Qb(t){var e=t.textContent;e===t._wrapperState.initialValue&&e!==""&&e!==null&&(t.value=e)}function D9(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Lv(t,e){return t==null||t==="http://www.w3.org/1999/xhtml"?D9(e):t==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":t}var n0,j9=function(t){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,n,r,s){MSApp.execUnsafeLocalFunction(function(){return t(e,n,r,s)})}:t}(function(t,e){if(t.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in t)t.innerHTML=e;else{for(n0=n0||document.createElement("div"),n0.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=n0.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;e.firstChild;)t.appendChild(e.firstChild)}});function Ed(t,e){if(e){var n=t.firstChild;if(n&&n===t.lastChild&&n.nodeType===3){n.nodeValue=e;return}}t.textContent=e}var od={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},YO=["Webkit","ms","Moz","O"];Object.keys(od).forEach(function(t){YO.forEach(function(e){e=e+t.charAt(0).toUpperCase()+t.substring(1),od[e]=od[t]})});function R9(t,e,n){return e==null||typeof e=="boolean"||e===""?"":n||typeof e!="number"||e===0||od.hasOwnProperty(t)&&od[t]?(""+e).trim():e+"px"}function O9(t,e){t=t.style;for(var n in e)if(e.hasOwnProperty(n)){var r=n.indexOf("--")===0,s=R9(n,e[n],r);n==="float"&&(n="cssFloat"),r?t.setProperty(n,s):t[n]=s}}var XO=$t({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Nv(t,e){if(e){if(XO[t]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(oe(137,t));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(oe(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(oe(61))}if(e.style!=null&&typeof e.style!="object")throw Error(oe(62))}}function zv(t,e){if(t.indexOf("-")===-1)return typeof e.is=="string";switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Fv=null;function JS(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var $v=null,hc=null,pc=null;function Jb(t){if(t=gh(t)){if(typeof $v!="function")throw Error(oe(280));var e=t.stateNode;e&&(e=Og(e),$v(t.stateNode,t.type,e))}}function L9(t){hc?pc?pc.push(t):pc=[t]:hc=t}function N9(){if(hc){var t=hc,e=pc;if(pc=hc=null,Jb(t),e)for(t=0;t<e.length;t++)Jb(e[t])}}function z9(t,e){return t(e)}function F9(){}var a1=!1;function $9(t,e,n){if(a1)return t(e,n);a1=!0;try{return z9(t,e,n)}finally{a1=!1,(hc!==null||pc!==null)&&(F9(),N9())}}function Td(t,e){var n=t.stateNode;if(n===null)return null;var r=Og(n);if(r===null)return null;n=r[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(t=t.type,r=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!r;break e;default:t=!1}if(t)return null;if(n&&typeof n!="function")throw Error(oe(231,e,typeof n));return n}var Bv=!1;if(eo)try{var hu={};Object.defineProperty(hu,"passive",{get:function(){Bv=!0}}),window.addEventListener("test",hu,hu),window.removeEventListener("test",hu,hu)}catch{Bv=!1}function ZO(t,e,n,r,s,i,o,a,l){var c=Array.prototype.slice.call(arguments,3);try{e.apply(n,c)}catch(u){this.onError(u)}}var ad=!1,hf=null,pf=!1,Uv=null,QO={onError:function(t){ad=!0,hf=t}};function JO(t,e,n,r,s,i,o,a,l){ad=!1,hf=null,ZO.apply(QO,arguments)}function eL(t,e,n,r,s,i,o,a,l){if(JO.apply(this,arguments),ad){if(ad){var c=hf;ad=!1,hf=null}else throw Error(oe(198));pf||(pf=!0,Uv=c)}}function Sl(t){var e=t,n=t;if(t.alternate)for(;e.return;)e=e.return;else{t=e;do e=t,e.flags&4098&&(n=e.return),t=e.return;while(t)}return e.tag===3?n:null}function B9(t){if(t.tag===13){var e=t.memoizedState;if(e===null&&(t=t.alternate,t!==null&&(e=t.memoizedState)),e!==null)return e.dehydrated}return null}function e3(t){if(Sl(t)!==t)throw Error(oe(188))}function tL(t){var e=t.alternate;if(!e){if(e=Sl(t),e===null)throw Error(oe(188));return e!==t?null:t}for(var n=t,r=e;;){var s=n.return;if(s===null)break;var i=s.alternate;if(i===null){if(r=s.return,r!==null){n=r;continue}break}if(s.child===i.child){for(i=s.child;i;){if(i===n)return e3(s),t;if(i===r)return e3(s),e;i=i.sibling}throw Error(oe(188))}if(n.return!==r.return)n=s,r=i;else{for(var o=!1,a=s.child;a;){if(a===n){o=!0,n=s,r=i;break}if(a===r){o=!0,r=s,n=i;break}a=a.sibling}if(!o){for(a=i.child;a;){if(a===n){o=!0,n=i,r=s;break}if(a===r){o=!0,r=i,n=s;break}a=a.sibling}if(!o)throw Error(oe(189))}}if(n.alternate!==r)throw Error(oe(190))}if(n.tag!==3)throw Error(oe(188));return n.stateNode.current===n?t:e}function U9(t){return t=tL(t),t!==null?H9(t):null}function H9(t){if(t.tag===5||t.tag===6)return t;for(t=t.child;t!==null;){var e=H9(t);if(e!==null)return e;t=t.sibling}return null}var W9=Gr.unstable_scheduleCallback,t3=Gr.unstable_cancelCallback,nL=Gr.unstable_shouldYield,rL=Gr.unstable_requestPaint,Gt=Gr.unstable_now,sL=Gr.unstable_getCurrentPriorityLevel,ex=Gr.unstable_ImmediatePriority,K9=Gr.unstable_UserBlockingPriority,ff=Gr.unstable_NormalPriority,iL=Gr.unstable_LowPriority,G9=Gr.unstable_IdlePriority,Ag=null,hi=null;function oL(t){if(hi&&typeof hi.onCommitFiberRoot=="function")try{hi.onCommitFiberRoot(Ag,t,void 0,(t.current.flags&128)===128)}catch{}}var Ls=Math.clz32?Math.clz32:cL,aL=Math.log,lL=Math.LN2;function cL(t){return t>>>=0,t===0?32:31-(aL(t)/lL|0)|0}var r0=64,s0=4194304;function Fu(t){switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return t&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return t}}function gf(t,e){var n=t.pendingLanes;if(n===0)return 0;var r=0,s=t.suspendedLanes,i=t.pingedLanes,o=n&268435455;if(o!==0){var a=o&~s;a!==0?r=Fu(a):(i&=o,i!==0&&(r=Fu(i)))}else o=n&~s,o!==0?r=Fu(o):i!==0&&(r=Fu(i));if(r===0)return 0;if(e!==0&&e!==r&&!(e&s)&&(s=r&-r,i=e&-e,s>=i||s===16&&(i&4194240)!==0))return e;if(r&4&&(r|=n&16),e=t.entangledLanes,e!==0)for(t=t.entanglements,e&=r;0<e;)n=31-Ls(e),s=1<<n,r|=t[n],e&=~s;return r}function uL(t,e){switch(t){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function dL(t,e){for(var n=t.suspendedLanes,r=t.pingedLanes,s=t.expirationTimes,i=t.pendingLanes;0<i;){var o=31-Ls(i),a=1<<o,l=s[o];l===-1?(!(a&n)||a&r)&&(s[o]=uL(a,e)):l<=e&&(t.expiredLanes|=a),i&=~a}}function Hv(t){return t=t.pendingLanes&-1073741825,t!==0?t:t&1073741824?1073741824:0}function V9(){var t=r0;return r0<<=1,!(r0&4194240)&&(r0=64),t}function l1(t){for(var e=[],n=0;31>n;n++)e.push(t);return e}function ph(t,e,n){t.pendingLanes|=e,e!==536870912&&(t.suspendedLanes=0,t.pingedLanes=0),t=t.eventTimes,e=31-Ls(e),t[e]=n}function hL(t,e){var n=t.pendingLanes&~e;t.pendingLanes=e,t.suspendedLanes=0,t.pingedLanes=0,t.expiredLanes&=e,t.mutableReadLanes&=e,t.entangledLanes&=e,e=t.entanglements;var r=t.eventTimes;for(t=t.expirationTimes;0<n;){var s=31-Ls(n),i=1<<s;e[s]=0,r[s]=-1,t[s]=-1,n&=~i}}function tx(t,e){var n=t.entangledLanes|=e;for(t=t.entanglements;n;){var r=31-Ls(n),s=1<<r;s&e|t[r]&e&&(t[r]|=e),n&=~s}}var at=0;function q9(t){return t&=-t,1<t?4<t?t&268435455?16:536870912:4:1}var Y9,nx,X9,Z9,Q9,Wv=!1,i0=[],Wo=null,Ko=null,Go=null,Md=new Map,_d=new Map,Ro=[],pL="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function n3(t,e){switch(t){case"focusin":case"focusout":Wo=null;break;case"dragenter":case"dragleave":Ko=null;break;case"mouseover":case"mouseout":Go=null;break;case"pointerover":case"pointerout":Md.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":_d.delete(e.pointerId)}}function pu(t,e,n,r,s,i){return t===null||t.nativeEvent!==i?(t={blockedOn:e,domEventName:n,eventSystemFlags:r,nativeEvent:i,targetContainers:[s]},e!==null&&(e=gh(e),e!==null&&nx(e)),t):(t.eventSystemFlags|=r,e=t.targetContainers,s!==null&&e.indexOf(s)===-1&&e.push(s),t)}function fL(t,e,n,r,s){switch(e){case"focusin":return Wo=pu(Wo,t,e,n,r,s),!0;case"dragenter":return Ko=pu(Ko,t,e,n,r,s),!0;case"mouseover":return Go=pu(Go,t,e,n,r,s),!0;case"pointerover":var i=s.pointerId;return Md.set(i,pu(Md.get(i)||null,t,e,n,r,s)),!0;case"gotpointercapture":return i=s.pointerId,_d.set(i,pu(_d.get(i)||null,t,e,n,r,s)),!0}return!1}function J9(t){var e=Ha(t.target);if(e!==null){var n=Sl(e);if(n!==null){if(e=n.tag,e===13){if(e=B9(n),e!==null){t.blockedOn=e,Q9(t.priority,function(){X9(n)});return}}else if(e===3&&n.stateNode.current.memoizedState.isDehydrated){t.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}t.blockedOn=null}function mp(t){if(t.blockedOn!==null)return!1;for(var e=t.targetContainers;0<e.length;){var n=Kv(t.domEventName,t.eventSystemFlags,e[0],t.nativeEvent);if(n===null){n=t.nativeEvent;var r=new n.constructor(n.type,n);Fv=r,n.target.dispatchEvent(r),Fv=null}else return e=gh(n),e!==null&&nx(e),t.blockedOn=n,!1;e.shift()}return!0}function r3(t,e,n){mp(t)&&n.delete(e)}function gL(){Wv=!1,Wo!==null&&mp(Wo)&&(Wo=null),Ko!==null&&mp(Ko)&&(Ko=null),Go!==null&&mp(Go)&&(Go=null),Md.forEach(r3),_d.forEach(r3)}function fu(t,e){t.blockedOn===e&&(t.blockedOn=null,Wv||(Wv=!0,Gr.unstable_scheduleCallback(Gr.unstable_NormalPriority,gL)))}function Ad(t){function e(s){return fu(s,t)}if(0<i0.length){fu(i0[0],t);for(var n=1;n<i0.length;n++){var r=i0[n];r.blockedOn===t&&(r.blockedOn=null)}}for(Wo!==null&&fu(Wo,t),Ko!==null&&fu(Ko,t),Go!==null&&fu(Go,t),Md.forEach(e),_d.forEach(e),n=0;n<Ro.length;n++)r=Ro[n],r.blockedOn===t&&(r.blockedOn=null);for(;0<Ro.length&&(n=Ro[0],n.blockedOn===null);)J9(n),n.blockedOn===null&&Ro.shift()}var fc=ho.ReactCurrentBatchConfig,mf=!0;function mL(t,e,n,r){var s=at,i=fc.transition;fc.transition=null;try{at=1,rx(t,e,n,r)}finally{at=s,fc.transition=i}}function yL(t,e,n,r){var s=at,i=fc.transition;fc.transition=null;try{at=4,rx(t,e,n,r)}finally{at=s,fc.transition=i}}function rx(t,e,n,r){if(mf){var s=Kv(t,e,n,r);if(s===null)v1(t,e,r,yf,n),n3(t,r);else if(fL(s,t,e,n,r))r.stopPropagation();else if(n3(t,r),e&4&&-1<pL.indexOf(t)){for(;s!==null;){var i=gh(s);if(i!==null&&Y9(i),i=Kv(t,e,n,r),i===null&&v1(t,e,r,yf,n),i===s)break;s=i}s!==null&&r.stopPropagation()}else v1(t,e,r,null,n)}}var yf=null;function Kv(t,e,n,r){if(yf=null,t=JS(r),t=Ha(t),t!==null)if(e=Sl(t),e===null)t=null;else if(n=e.tag,n===13){if(t=B9(e),t!==null)return t;t=null}else if(n===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;t=null}else e!==t&&(t=null);return yf=t,null}function eC(t){switch(t){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(sL()){case ex:return 1;case K9:return 4;case ff:case iL:return 16;case G9:return 536870912;default:return 16}default:return 16}}var No=null,sx=null,yp=null;function tC(){if(yp)return yp;var t,e=sx,n=e.length,r,s="value"in No?No.value:No.textContent,i=s.length;for(t=0;t<n&&e[t]===s[t];t++);var o=n-t;for(r=1;r<=o&&e[n-r]===s[i-r];r++);return yp=s.slice(t,1<r?1-r:void 0)}function vp(t){var e=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&e===13&&(t=13)):t=e,t===10&&(t=13),32<=t||t===13?t:0}function o0(){return!0}function s3(){return!1}function Xr(t){function e(n,r,s,i,o){this._reactName=n,this._targetInst=s,this.type=r,this.nativeEvent=i,this.target=o,this.currentTarget=null;for(var a in t)t.hasOwnProperty(a)&&(n=t[a],this[a]=n?n(i):i[a]);return this.isDefaultPrevented=(i.defaultPrevented!=null?i.defaultPrevented:i.returnValue===!1)?o0:s3,this.isPropagationStopped=s3,this}return $t(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=o0)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=o0)},persist:function(){},isPersistent:o0}),e}var Wc={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},ix=Xr(Wc),fh=$t({},Wc,{view:0,detail:0}),vL=Xr(fh),c1,u1,gu,Dg=$t({},fh,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:ox,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==gu&&(gu&&t.type==="mousemove"?(c1=t.screenX-gu.screenX,u1=t.screenY-gu.screenY):u1=c1=0,gu=t),c1)},movementY:function(t){return"movementY"in t?t.movementY:u1}}),i3=Xr(Dg),SL=$t({},Dg,{dataTransfer:0}),xL=Xr(SL),wL=$t({},fh,{relatedTarget:0}),d1=Xr(wL),bL=$t({},Wc,{animationName:0,elapsedTime:0,pseudoElement:0}),CL=Xr(bL),PL=$t({},Wc,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),kL=Xr(PL),IL=$t({},Wc,{data:0}),o3=Xr(IL),EL={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},TL={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},ML={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function _L(t){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(t):(t=ML[t])?!!e[t]:!1}function ox(){return _L}var AL=$t({},fh,{key:function(t){if(t.key){var e=EL[t.key]||t.key;if(e!=="Unidentified")return e}return t.type==="keypress"?(t=vp(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?TL[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:ox,charCode:function(t){return t.type==="keypress"?vp(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?vp(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),DL=Xr(AL),jL=$t({},Dg,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),a3=Xr(jL),RL=$t({},fh,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:ox}),OL=Xr(RL),LL=$t({},Wc,{propertyName:0,elapsedTime:0,pseudoElement:0}),NL=Xr(LL),zL=$t({},Dg,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),FL=Xr(zL),$L=[9,13,27,32],ax=eo&&"CompositionEvent"in window,ld=null;eo&&"documentMode"in document&&(ld=document.documentMode);var BL=eo&&"TextEvent"in window&&!ld,nC=eo&&(!ax||ld&&8<ld&&11>=ld),l3=" ",c3=!1;function rC(t,e){switch(t){case"keyup":return $L.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function sC(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var Gl=!1;function UL(t,e){switch(t){case"compositionend":return sC(e);case"keypress":return e.which!==32?null:(c3=!0,l3);case"textInput":return t=e.data,t===l3&&c3?null:t;default:return null}}function HL(t,e){if(Gl)return t==="compositionend"||!ax&&rC(t,e)?(t=tC(),yp=sx=No=null,Gl=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return nC&&e.locale!=="ko"?null:e.data;default:return null}}var WL={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function u3(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e==="input"?!!WL[t.type]:e==="textarea"}function iC(t,e,n,r){L9(r),e=vf(e,"onChange"),0<e.length&&(n=new ix("onChange","change",null,n,r),t.push({event:n,listeners:e}))}var cd=null,Dd=null;function KL(t){mC(t,0)}function jg(t){var e=Yl(t);if(M9(e))return t}function GL(t,e){if(t==="change")return e}var oC=!1;if(eo){var h1;if(eo){var p1="oninput"in document;if(!p1){var d3=document.createElement("div");d3.setAttribute("oninput","return;"),p1=typeof d3.oninput=="function"}h1=p1}else h1=!1;oC=h1&&(!document.documentMode||9<document.documentMode)}function h3(){cd&&(cd.detachEvent("onpropertychange",aC),Dd=cd=null)}function aC(t){if(t.propertyName==="value"&&jg(Dd)){var e=[];iC(e,Dd,t,JS(t)),$9(KL,e)}}function VL(t,e,n){t==="focusin"?(h3(),cd=e,Dd=n,cd.attachEvent("onpropertychange",aC)):t==="focusout"&&h3()}function qL(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return jg(Dd)}function YL(t,e){if(t==="click")return jg(e)}function XL(t,e){if(t==="input"||t==="change")return jg(e)}function ZL(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var Fs=typeof Object.is=="function"?Object.is:ZL;function jd(t,e){if(Fs(t,e))return!0;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return!1;var n=Object.keys(t),r=Object.keys(e);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var s=n[r];if(!Ev.call(e,s)||!Fs(t[s],e[s]))return!1}return!0}function p3(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function f3(t,e){var n=p3(t);t=0;for(var r;n;){if(n.nodeType===3){if(r=t+n.textContent.length,t<=e&&r>=e)return{node:n,offset:e-t};t=r}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=p3(n)}}function lC(t,e){return t&&e?t===e?!0:t&&t.nodeType===3?!1:e&&e.nodeType===3?lC(t,e.parentNode):"contains"in t?t.contains(e):t.compareDocumentPosition?!!(t.compareDocumentPosition(e)&16):!1:!1}function cC(){for(var t=window,e=df();e instanceof t.HTMLIFrameElement;){try{var n=typeof e.contentWindow.location.href=="string"}catch{n=!1}if(n)t=e.contentWindow;else break;e=df(t.document)}return e}function lx(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e&&(e==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||e==="textarea"||t.contentEditable==="true")}function QL(t){var e=cC(),n=t.focusedElem,r=t.selectionRange;if(e!==n&&n&&n.ownerDocument&&lC(n.ownerDocument.documentElement,n)){if(r!==null&&lx(n)){if(e=r.start,t=r.end,t===void 0&&(t=e),"selectionStart"in n)n.selectionStart=e,n.selectionEnd=Math.min(t,n.value.length);else if(t=(e=n.ownerDocument||document)&&e.defaultView||window,t.getSelection){t=t.getSelection();var s=n.textContent.length,i=Math.min(r.start,s);r=r.end===void 0?i:Math.min(r.end,s),!t.extend&&i>r&&(s=r,r=i,i=s),s=f3(n,i);var o=f3(n,r);s&&o&&(t.rangeCount!==1||t.anchorNode!==s.node||t.anchorOffset!==s.offset||t.focusNode!==o.node||t.focusOffset!==o.offset)&&(e=e.createRange(),e.setStart(s.node,s.offset),t.removeAllRanges(),i>r?(t.addRange(e),t.extend(o.node,o.offset)):(e.setEnd(o.node,o.offset),t.addRange(e)))}}for(e=[],t=n;t=t.parentNode;)t.nodeType===1&&e.push({element:t,left:t.scrollLeft,top:t.scrollTop});for(typeof n.focus=="function"&&n.focus(),n=0;n<e.length;n++)t=e[n],t.element.scrollLeft=t.left,t.element.scrollTop=t.top}}var JL=eo&&"documentMode"in document&&11>=document.documentMode,Vl=null,Gv=null,ud=null,Vv=!1;function g3(t,e,n){var r=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;Vv||Vl==null||Vl!==df(r)||(r=Vl,"selectionStart"in r&&lx(r)?r={start:r.selectionStart,end:r.selectionEnd}:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection(),r={anchorNode:r.anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset}),ud&&jd(ud,r)||(ud=r,r=vf(Gv,"onSelect"),0<r.length&&(e=new ix("onSelect","select",null,e,n),t.push({event:e,listeners:r}),e.target=Vl)))}function a0(t,e){var n={};return n[t.toLowerCase()]=e.toLowerCase(),n["Webkit"+t]="webkit"+e,n["Moz"+t]="moz"+e,n}var ql={animationend:a0("Animation","AnimationEnd"),animationiteration:a0("Animation","AnimationIteration"),animationstart:a0("Animation","AnimationStart"),transitionend:a0("Transition","TransitionEnd")},f1={},uC={};eo&&(uC=document.createElement("div").style,"AnimationEvent"in window||(delete ql.animationend.animation,delete ql.animationiteration.animation,delete ql.animationstart.animation),"TransitionEvent"in window||delete ql.transitionend.transition);function Rg(t){if(f1[t])return f1[t];if(!ql[t])return t;var e=ql[t],n;for(n in e)if(e.hasOwnProperty(n)&&n in uC)return f1[t]=e[n];return t}var dC=Rg("animationend"),hC=Rg("animationiteration"),pC=Rg("animationstart"),fC=Rg("transitionend"),gC=new Map,m3="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function ma(t,e){gC.set(t,e),vl(e,[t])}for(var g1=0;g1<m3.length;g1++){var m1=m3[g1],eN=m1.toLowerCase(),tN=m1[0].toUpperCase()+m1.slice(1);ma(eN,"on"+tN)}ma(dC,"onAnimationEnd");ma(hC,"onAnimationIteration");ma(pC,"onAnimationStart");ma("dblclick","onDoubleClick");ma("focusin","onFocus");ma("focusout","onBlur");ma(fC,"onTransitionEnd");Pc("onMouseEnter",["mouseout","mouseover"]);Pc("onMouseLeave",["mouseout","mouseover"]);Pc("onPointerEnter",["pointerout","pointerover"]);Pc("onPointerLeave",["pointerout","pointerover"]);vl("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));vl("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));vl("onBeforeInput",["compositionend","keypress","textInput","paste"]);vl("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));vl("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));vl("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var $u="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),nN=new Set("cancel close invalid load scroll toggle".split(" ").concat($u));function y3(t,e,n){var r=t.type||"unknown-event";t.currentTarget=n,eL(r,e,void 0,t),t.currentTarget=null}function mC(t,e){e=(e&4)!==0;for(var n=0;n<t.length;n++){var r=t[n],s=r.event;r=r.listeners;e:{var i=void 0;if(e)for(var o=r.length-1;0<=o;o--){var a=r[o],l=a.instance,c=a.currentTarget;if(a=a.listener,l!==i&&s.isPropagationStopped())break e;y3(s,a,c),i=l}else for(o=0;o<r.length;o++){if(a=r[o],l=a.instance,c=a.currentTarget,a=a.listener,l!==i&&s.isPropagationStopped())break e;y3(s,a,c),i=l}}}if(pf)throw t=Uv,pf=!1,Uv=null,t}function Ct(t,e){var n=e[Qv];n===void 0&&(n=e[Qv]=new Set);var r=t+"__bubble";n.has(r)||(yC(e,t,2,!1),n.add(r))}function y1(t,e,n){var r=0;e&&(r|=4),yC(n,t,r,e)}var l0="_reactListening"+Math.random().toString(36).slice(2);function Rd(t){if(!t[l0]){t[l0]=!0,P9.forEach(function(n){n!=="selectionchange"&&(nN.has(n)||y1(n,!1,t),y1(n,!0,t))});var e=t.nodeType===9?t:t.ownerDocument;e===null||e[l0]||(e[l0]=!0,y1("selectionchange",!1,e))}}function yC(t,e,n,r){switch(eC(e)){case 1:var s=mL;break;case 4:s=yL;break;default:s=rx}n=s.bind(null,e,n,t),s=void 0,!Bv||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(s=!0),r?s!==void 0?t.addEventListener(e,n,{capture:!0,passive:s}):t.addEventListener(e,n,!0):s!==void 0?t.addEventListener(e,n,{passive:s}):t.addEventListener(e,n,!1)}function v1(t,e,n,r,s){var i=r;if(!(e&1)&&!(e&2)&&r!==null)e:for(;;){if(r===null)return;var o=r.tag;if(o===3||o===4){var a=r.stateNode.containerInfo;if(a===s||a.nodeType===8&&a.parentNode===s)break;if(o===4)for(o=r.return;o!==null;){var l=o.tag;if((l===3||l===4)&&(l=o.stateNode.containerInfo,l===s||l.nodeType===8&&l.parentNode===s))return;o=o.return}for(;a!==null;){if(o=Ha(a),o===null)return;if(l=o.tag,l===5||l===6){r=i=o;continue e}a=a.parentNode}}r=r.return}$9(function(){var c=i,u=JS(n),h=[];e:{var p=gC.get(t);if(p!==void 0){var f=ix,v=t;switch(t){case"keypress":if(vp(n)===0)break e;case"keydown":case"keyup":f=DL;break;case"focusin":v="focus",f=d1;break;case"focusout":v="blur",f=d1;break;case"beforeblur":case"afterblur":f=d1;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":f=i3;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":f=xL;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":f=OL;break;case dC:case hC:case pC:f=CL;break;case fC:f=NL;break;case"scroll":f=vL;break;case"wheel":f=FL;break;case"copy":case"cut":case"paste":f=kL;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":f=a3}var m=(e&4)!==0,x=!m&&t==="scroll",y=m?p!==null?p+"Capture":null:p;m=[];for(var S=c,w;S!==null;){w=S;var P=w.stateNode;if(w.tag===5&&P!==null&&(w=P,y!==null&&(P=Td(S,y),P!=null&&m.push(Od(S,P,w)))),x)break;S=S.return}0<m.length&&(p=new f(p,v,null,n,u),h.push({event:p,listeners:m}))}}if(!(e&7)){e:{if(p=t==="mouseover"||t==="pointerover",f=t==="mouseout"||t==="pointerout",p&&n!==Fv&&(v=n.relatedTarget||n.fromElement)&&(Ha(v)||v[to]))break e;if((f||p)&&(p=u.window===u?u:(p=u.ownerDocument)?p.defaultView||p.parentWindow:window,f?(v=n.relatedTarget||n.toElement,f=c,v=v?Ha(v):null,v!==null&&(x=Sl(v),v!==x||v.tag!==5&&v.tag!==6)&&(v=null)):(f=null,v=c),f!==v)){if(m=i3,P="onMouseLeave",y="onMouseEnter",S="mouse",(t==="pointerout"||t==="pointerover")&&(m=a3,P="onPointerLeave",y="onPointerEnter",S="pointer"),x=f==null?p:Yl(f),w=v==null?p:Yl(v),p=new m(P,S+"leave",f,n,u),p.target=x,p.relatedTarget=w,P=null,Ha(u)===c&&(m=new m(y,S+"enter",v,n,u),m.target=w,m.relatedTarget=x,P=m),x=P,f&&v)t:{for(m=f,y=v,S=0,w=m;w;w=Tl(w))S++;for(w=0,P=y;P;P=Tl(P))w++;for(;0<S-w;)m=Tl(m),S--;for(;0<w-S;)y=Tl(y),w--;for(;S--;){if(m===y||y!==null&&m===y.alternate)break t;m=Tl(m),y=Tl(y)}m=null}else m=null;f!==null&&v3(h,p,f,m,!1),v!==null&&x!==null&&v3(h,x,v,m,!0)}}e:{if(p=c?Yl(c):window,f=p.nodeName&&p.nodeName.toLowerCase(),f==="select"||f==="input"&&p.type==="file")var E=GL;else if(u3(p))if(oC)E=XL;else{E=qL;var M=VL}else(f=p.nodeName)&&f.toLowerCase()==="input"&&(p.type==="checkbox"||p.type==="radio")&&(E=YL);if(E&&(E=E(t,c))){iC(h,E,n,u);break e}M&&M(t,p,c),t==="focusout"&&(M=p._wrapperState)&&M.controlled&&p.type==="number"&&Rv(p,"number",p.value)}switch(M=c?Yl(c):window,t){case"focusin":(u3(M)||M.contentEditable==="true")&&(Vl=M,Gv=c,ud=null);break;case"focusout":ud=Gv=Vl=null;break;case"mousedown":Vv=!0;break;case"contextmenu":case"mouseup":case"dragend":Vv=!1,g3(h,n,u);break;case"selectionchange":if(JL)break;case"keydown":case"keyup":g3(h,n,u)}var I;if(ax)e:{switch(t){case"compositionstart":var _="onCompositionStart";break e;case"compositionend":_="onCompositionEnd";break e;case"compositionupdate":_="onCompositionUpdate";break e}_=void 0}else Gl?rC(t,n)&&(_="onCompositionEnd"):t==="keydown"&&n.keyCode===229&&(_="onCompositionStart");_&&(nC&&n.locale!=="ko"&&(Gl||_!=="onCompositionStart"?_==="onCompositionEnd"&&Gl&&(I=tC()):(No=u,sx="value"in No?No.value:No.textContent,Gl=!0)),M=vf(c,_),0<M.length&&(_=new o3(_,t,null,n,u),h.push({event:_,listeners:M}),I?_.data=I:(I=sC(n),I!==null&&(_.data=I)))),(I=BL?UL(t,n):HL(t,n))&&(c=vf(c,"onBeforeInput"),0<c.length&&(u=new o3("onBeforeInput","beforeinput",null,n,u),h.push({event:u,listeners:c}),u.data=I))}mC(h,e)})}function Od(t,e,n){return{instance:t,listener:e,currentTarget:n}}function vf(t,e){for(var n=e+"Capture",r=[];t!==null;){var s=t,i=s.stateNode;s.tag===5&&i!==null&&(s=i,i=Td(t,n),i!=null&&r.unshift(Od(t,i,s)),i=Td(t,e),i!=null&&r.push(Od(t,i,s))),t=t.return}return r}function Tl(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5);return t||null}function v3(t,e,n,r,s){for(var i=e._reactName,o=[];n!==null&&n!==r;){var a=n,l=a.alternate,c=a.stateNode;if(l!==null&&l===r)break;a.tag===5&&c!==null&&(a=c,s?(l=Td(n,i),l!=null&&o.unshift(Od(n,l,a))):s||(l=Td(n,i),l!=null&&o.push(Od(n,l,a)))),n=n.return}o.length!==0&&t.push({event:e,listeners:o})}var rN=/\r\n?/g,sN=/\u0000|\uFFFD/g;function S3(t){return(typeof t=="string"?t:""+t).replace(rN,`
`).replace(sN,"")}function c0(t,e,n){if(e=S3(e),S3(t)!==e&&n)throw Error(oe(425))}function Sf(){}var qv=null,Yv=null;function Xv(t,e){return t==="textarea"||t==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var Zv=typeof setTimeout=="function"?setTimeout:void 0,iN=typeof clearTimeout=="function"?clearTimeout:void 0,x3=typeof Promise=="function"?Promise:void 0,oN=typeof queueMicrotask=="function"?queueMicrotask:typeof x3<"u"?function(t){return x3.resolve(null).then(t).catch(aN)}:Zv;function aN(t){setTimeout(function(){throw t})}function S1(t,e){var n=e,r=0;do{var s=n.nextSibling;if(t.removeChild(n),s&&s.nodeType===8)if(n=s.data,n==="/$"){if(r===0){t.removeChild(s),Ad(e);return}r--}else n!=="$"&&n!=="$?"&&n!=="$!"||r++;n=s}while(n);Ad(e)}function Vo(t){for(;t!=null;t=t.nextSibling){var e=t.nodeType;if(e===1||e===3)break;if(e===8){if(e=t.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return t}function w3(t){t=t.previousSibling;for(var e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="$"||n==="$!"||n==="$?"){if(e===0)return t;e--}else n==="/$"&&e++}t=t.previousSibling}return null}var Kc=Math.random().toString(36).slice(2),ri="__reactFiber$"+Kc,Ld="__reactProps$"+Kc,to="__reactContainer$"+Kc,Qv="__reactEvents$"+Kc,lN="__reactListeners$"+Kc,cN="__reactHandles$"+Kc;function Ha(t){var e=t[ri];if(e)return e;for(var n=t.parentNode;n;){if(e=n[to]||n[ri]){if(n=e.alternate,e.child!==null||n!==null&&n.child!==null)for(t=w3(t);t!==null;){if(n=t[ri])return n;t=w3(t)}return e}t=n,n=t.parentNode}return null}function gh(t){return t=t[ri]||t[to],!t||t.tag!==5&&t.tag!==6&&t.tag!==13&&t.tag!==3?null:t}function Yl(t){if(t.tag===5||t.tag===6)return t.stateNode;throw Error(oe(33))}function Og(t){return t[Ld]||null}var Jv=[],Xl=-1;function ya(t){return{current:t}}function It(t){0>Xl||(t.current=Jv[Xl],Jv[Xl]=null,Xl--)}function mt(t,e){Xl++,Jv[Xl]=t.current,t.current=e}var ra={},Wn=ya(ra),Cr=ya(!1),Ja=ra;function kc(t,e){var n=t.type.contextTypes;if(!n)return ra;var r=t.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===e)return r.__reactInternalMemoizedMaskedChildContext;var s={},i;for(i in n)s[i]=e[i];return r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=e,t.__reactInternalMemoizedMaskedChildContext=s),s}function Pr(t){return t=t.childContextTypes,t!=null}function xf(){It(Cr),It(Wn)}function b3(t,e,n){if(Wn.current!==ra)throw Error(oe(168));mt(Wn,e),mt(Cr,n)}function vC(t,e,n){var r=t.stateNode;if(e=e.childContextTypes,typeof r.getChildContext!="function")return n;r=r.getChildContext();for(var s in r)if(!(s in e))throw Error(oe(108,VO(t)||"Unknown",s));return $t({},n,r)}function wf(t){return t=(t=t.stateNode)&&t.__reactInternalMemoizedMergedChildContext||ra,Ja=Wn.current,mt(Wn,t),mt(Cr,Cr.current),!0}function C3(t,e,n){var r=t.stateNode;if(!r)throw Error(oe(169));n?(t=vC(t,e,Ja),r.__reactInternalMemoizedMergedChildContext=t,It(Cr),It(Wn),mt(Wn,t)):It(Cr),mt(Cr,n)}var Fi=null,Lg=!1,x1=!1;function SC(t){Fi===null?Fi=[t]:Fi.push(t)}function uN(t){Lg=!0,SC(t)}function va(){if(!x1&&Fi!==null){x1=!0;var t=0,e=at;try{var n=Fi;for(at=1;t<n.length;t++){var r=n[t];do r=r(!0);while(r!==null)}Fi=null,Lg=!1}catch(s){throw Fi!==null&&(Fi=Fi.slice(t+1)),W9(ex,va),s}finally{at=e,x1=!1}}return null}var Zl=[],Ql=0,bf=null,Cf=0,is=[],os=0,el=null,Hi=1,Wi="";function Fa(t,e){Zl[Ql++]=Cf,Zl[Ql++]=bf,bf=t,Cf=e}function xC(t,e,n){is[os++]=Hi,is[os++]=Wi,is[os++]=el,el=t;var r=Hi;t=Wi;var s=32-Ls(r)-1;r&=~(1<<s),n+=1;var i=32-Ls(e)+s;if(30<i){var o=s-s%5;i=(r&(1<<o)-1).toString(32),r>>=o,s-=o,Hi=1<<32-Ls(e)+s|n<<s|r,Wi=i+t}else Hi=1<<i|n<<s|r,Wi=t}function cx(t){t.return!==null&&(Fa(t,1),xC(t,1,0))}function ux(t){for(;t===bf;)bf=Zl[--Ql],Zl[Ql]=null,Cf=Zl[--Ql],Zl[Ql]=null;for(;t===el;)el=is[--os],is[os]=null,Wi=is[--os],is[os]=null,Hi=is[--os],is[os]=null}var Br=null,$r=null,Mt=!1,As=null;function wC(t,e){var n=cs(5,null,null,0);n.elementType="DELETED",n.stateNode=e,n.return=t,e=t.deletions,e===null?(t.deletions=[n],t.flags|=16):e.push(n)}function P3(t,e){switch(t.tag){case 5:var n=t.type;return e=e.nodeType!==1||n.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(t.stateNode=e,Br=t,$r=Vo(e.firstChild),!0):!1;case 6:return e=t.pendingProps===""||e.nodeType!==3?null:e,e!==null?(t.stateNode=e,Br=t,$r=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(n=el!==null?{id:Hi,overflow:Wi}:null,t.memoizedState={dehydrated:e,treeContext:n,retryLane:1073741824},n=cs(18,null,null,0),n.stateNode=e,n.return=t,t.child=n,Br=t,$r=null,!0):!1;default:return!1}}function e2(t){return(t.mode&1)!==0&&(t.flags&128)===0}function t2(t){if(Mt){var e=$r;if(e){var n=e;if(!P3(t,e)){if(e2(t))throw Error(oe(418));e=Vo(n.nextSibling);var r=Br;e&&P3(t,e)?wC(r,n):(t.flags=t.flags&-4097|2,Mt=!1,Br=t)}}else{if(e2(t))throw Error(oe(418));t.flags=t.flags&-4097|2,Mt=!1,Br=t}}}function k3(t){for(t=t.return;t!==null&&t.tag!==5&&t.tag!==3&&t.tag!==13;)t=t.return;Br=t}function u0(t){if(t!==Br)return!1;if(!Mt)return k3(t),Mt=!0,!1;var e;if((e=t.tag!==3)&&!(e=t.tag!==5)&&(e=t.type,e=e!=="head"&&e!=="body"&&!Xv(t.type,t.memoizedProps)),e&&(e=$r)){if(e2(t))throw bC(),Error(oe(418));for(;e;)wC(t,e),e=Vo(e.nextSibling)}if(k3(t),t.tag===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(oe(317));e:{for(t=t.nextSibling,e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="/$"){if(e===0){$r=Vo(t.nextSibling);break e}e--}else n!=="$"&&n!=="$!"&&n!=="$?"||e++}t=t.nextSibling}$r=null}}else $r=Br?Vo(t.stateNode.nextSibling):null;return!0}function bC(){for(var t=$r;t;)t=Vo(t.nextSibling)}function Ic(){$r=Br=null,Mt=!1}function dx(t){As===null?As=[t]:As.push(t)}var dN=ho.ReactCurrentBatchConfig;function mu(t,e,n){if(t=n.ref,t!==null&&typeof t!="function"&&typeof t!="object"){if(n._owner){if(n=n._owner,n){if(n.tag!==1)throw Error(oe(309));var r=n.stateNode}if(!r)throw Error(oe(147,t));var s=r,i=""+t;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===i?e.ref:(e=function(o){var a=s.refs;o===null?delete a[i]:a[i]=o},e._stringRef=i,e)}if(typeof t!="string")throw Error(oe(284));if(!n._owner)throw Error(oe(290,t))}return t}function d0(t,e){throw t=Object.prototype.toString.call(e),Error(oe(31,t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t))}function I3(t){var e=t._init;return e(t._payload)}function CC(t){function e(y,S){if(t){var w=y.deletions;w===null?(y.deletions=[S],y.flags|=16):w.push(S)}}function n(y,S){if(!t)return null;for(;S!==null;)e(y,S),S=S.sibling;return null}function r(y,S){for(y=new Map;S!==null;)S.key!==null?y.set(S.key,S):y.set(S.index,S),S=S.sibling;return y}function s(y,S){return y=Zo(y,S),y.index=0,y.sibling=null,y}function i(y,S,w){return y.index=w,t?(w=y.alternate,w!==null?(w=w.index,w<S?(y.flags|=2,S):w):(y.flags|=2,S)):(y.flags|=1048576,S)}function o(y){return t&&y.alternate===null&&(y.flags|=2),y}function a(y,S,w,P){return S===null||S.tag!==6?(S=E1(w,y.mode,P),S.return=y,S):(S=s(S,w),S.return=y,S)}function l(y,S,w,P){var E=w.type;return E===Kl?u(y,S,w.props.children,P,w.key):S!==null&&(S.elementType===E||typeof E=="object"&&E!==null&&E.$$typeof===Do&&I3(E)===S.type)?(P=s(S,w.props),P.ref=mu(y,S,w),P.return=y,P):(P=kp(w.type,w.key,w.props,null,y.mode,P),P.ref=mu(y,S,w),P.return=y,P)}function c(y,S,w,P){return S===null||S.tag!==4||S.stateNode.containerInfo!==w.containerInfo||S.stateNode.implementation!==w.implementation?(S=T1(w,y.mode,P),S.return=y,S):(S=s(S,w.children||[]),S.return=y,S)}function u(y,S,w,P,E){return S===null||S.tag!==7?(S=Ya(w,y.mode,P,E),S.return=y,S):(S=s(S,w),S.return=y,S)}function h(y,S,w){if(typeof S=="string"&&S!==""||typeof S=="number")return S=E1(""+S,y.mode,w),S.return=y,S;if(typeof S=="object"&&S!==null){switch(S.$$typeof){case e0:return w=kp(S.type,S.key,S.props,null,y.mode,w),w.ref=mu(y,null,S),w.return=y,w;case Wl:return S=T1(S,y.mode,w),S.return=y,S;case Do:var P=S._init;return h(y,P(S._payload),w)}if(zu(S)||du(S))return S=Ya(S,y.mode,w,null),S.return=y,S;d0(y,S)}return null}function p(y,S,w,P){var E=S!==null?S.key:null;if(typeof w=="string"&&w!==""||typeof w=="number")return E!==null?null:a(y,S,""+w,P);if(typeof w=="object"&&w!==null){switch(w.$$typeof){case e0:return w.key===E?l(y,S,w,P):null;case Wl:return w.key===E?c(y,S,w,P):null;case Do:return E=w._init,p(y,S,E(w._payload),P)}if(zu(w)||du(w))return E!==null?null:u(y,S,w,P,null);d0(y,w)}return null}function f(y,S,w,P,E){if(typeof P=="string"&&P!==""||typeof P=="number")return y=y.get(w)||null,a(S,y,""+P,E);if(typeof P=="object"&&P!==null){switch(P.$$typeof){case e0:return y=y.get(P.key===null?w:P.key)||null,l(S,y,P,E);case Wl:return y=y.get(P.key===null?w:P.key)||null,c(S,y,P,E);case Do:var M=P._init;return f(y,S,w,M(P._payload),E)}if(zu(P)||du(P))return y=y.get(w)||null,u(S,y,P,E,null);d0(S,P)}return null}function v(y,S,w,P){for(var E=null,M=null,I=S,_=S=0,D=null;I!==null&&_<w.length;_++){I.index>_?(D=I,I=null):D=I.sibling;var R=p(y,I,w[_],P);if(R===null){I===null&&(I=D);break}t&&I&&R.alternate===null&&e(y,I),S=i(R,S,_),M===null?E=R:M.sibling=R,M=R,I=D}if(_===w.length)return n(y,I),Mt&&Fa(y,_),E;if(I===null){for(;_<w.length;_++)I=h(y,w[_],P),I!==null&&(S=i(I,S,_),M===null?E=I:M.sibling=I,M=I);return Mt&&Fa(y,_),E}for(I=r(y,I);_<w.length;_++)D=f(I,y,_,w[_],P),D!==null&&(t&&D.alternate!==null&&I.delete(D.key===null?_:D.key),S=i(D,S,_),M===null?E=D:M.sibling=D,M=D);return t&&I.forEach(function($){return e(y,$)}),Mt&&Fa(y,_),E}function m(y,S,w,P){var E=du(w);if(typeof E!="function")throw Error(oe(150));if(w=E.call(w),w==null)throw Error(oe(151));for(var M=E=null,I=S,_=S=0,D=null,R=w.next();I!==null&&!R.done;_++,R=w.next()){I.index>_?(D=I,I=null):D=I.sibling;var $=p(y,I,R.value,P);if($===null){I===null&&(I=D);break}t&&I&&$.alternate===null&&e(y,I),S=i($,S,_),M===null?E=$:M.sibling=$,M=$,I=D}if(R.done)return n(y,I),Mt&&Fa(y,_),E;if(I===null){for(;!R.done;_++,R=w.next())R=h(y,R.value,P),R!==null&&(S=i(R,S,_),M===null?E=R:M.sibling=R,M=R);return Mt&&Fa(y,_),E}for(I=r(y,I);!R.done;_++,R=w.next())R=f(I,y,_,R.value,P),R!==null&&(t&&R.alternate!==null&&I.delete(R.key===null?_:R.key),S=i(R,S,_),M===null?E=R:M.sibling=R,M=R);return t&&I.forEach(function(U){return e(y,U)}),Mt&&Fa(y,_),E}function x(y,S,w,P){if(typeof w=="object"&&w!==null&&w.type===Kl&&w.key===null&&(w=w.props.children),typeof w=="object"&&w!==null){switch(w.$$typeof){case e0:e:{for(var E=w.key,M=S;M!==null;){if(M.key===E){if(E=w.type,E===Kl){if(M.tag===7){n(y,M.sibling),S=s(M,w.props.children),S.return=y,y=S;break e}}else if(M.elementType===E||typeof E=="object"&&E!==null&&E.$$typeof===Do&&I3(E)===M.type){n(y,M.sibling),S=s(M,w.props),S.ref=mu(y,M,w),S.return=y,y=S;break e}n(y,M);break}else e(y,M);M=M.sibling}w.type===Kl?(S=Ya(w.props.children,y.mode,P,w.key),S.return=y,y=S):(P=kp(w.type,w.key,w.props,null,y.mode,P),P.ref=mu(y,S,w),P.return=y,y=P)}return o(y);case Wl:e:{for(M=w.key;S!==null;){if(S.key===M)if(S.tag===4&&S.stateNode.containerInfo===w.containerInfo&&S.stateNode.implementation===w.implementation){n(y,S.sibling),S=s(S,w.children||[]),S.return=y,y=S;break e}else{n(y,S);break}else e(y,S);S=S.sibling}S=T1(w,y.mode,P),S.return=y,y=S}return o(y);case Do:return M=w._init,x(y,S,M(w._payload),P)}if(zu(w))return v(y,S,w,P);if(du(w))return m(y,S,w,P);d0(y,w)}return typeof w=="string"&&w!==""||typeof w=="number"?(w=""+w,S!==null&&S.tag===6?(n(y,S.sibling),S=s(S,w),S.return=y,y=S):(n(y,S),S=E1(w,y.mode,P),S.return=y,y=S),o(y)):n(y,S)}return x}var Ec=CC(!0),PC=CC(!1),Pf=ya(null),kf=null,Jl=null,hx=null;function px(){hx=Jl=kf=null}function fx(t){var e=Pf.current;It(Pf),t._currentValue=e}function n2(t,e,n){for(;t!==null;){var r=t.alternate;if((t.childLanes&e)!==e?(t.childLanes|=e,r!==null&&(r.childLanes|=e)):r!==null&&(r.childLanes&e)!==e&&(r.childLanes|=e),t===n)break;t=t.return}}function gc(t,e){kf=t,hx=Jl=null,t=t.dependencies,t!==null&&t.firstContext!==null&&(t.lanes&e&&(Sr=!0),t.firstContext=null)}function ys(t){var e=t._currentValue;if(hx!==t)if(t={context:t,memoizedValue:e,next:null},Jl===null){if(kf===null)throw Error(oe(308));Jl=t,kf.dependencies={lanes:0,firstContext:t}}else Jl=Jl.next=t;return e}var Wa=null;function gx(t){Wa===null?Wa=[t]:Wa.push(t)}function kC(t,e,n,r){var s=e.interleaved;return s===null?(n.next=n,gx(e)):(n.next=s.next,s.next=n),e.interleaved=n,no(t,r)}function no(t,e){t.lanes|=e;var n=t.alternate;for(n!==null&&(n.lanes|=e),n=t,t=t.return;t!==null;)t.childLanes|=e,n=t.alternate,n!==null&&(n.childLanes|=e),n=t,t=t.return;return n.tag===3?n.stateNode:null}var jo=!1;function mx(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function IC(t,e){t=t.updateQueue,e.updateQueue===t&&(e.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,effects:t.effects})}function Vi(t,e){return{eventTime:t,lane:e,tag:0,payload:null,callback:null,next:null}}function qo(t,e,n){var r=t.updateQueue;if(r===null)return null;if(r=r.shared,Ze&2){var s=r.pending;return s===null?e.next=e:(e.next=s.next,s.next=e),r.pending=e,no(t,n)}return s=r.interleaved,s===null?(e.next=e,gx(r)):(e.next=s.next,s.next=e),r.interleaved=e,no(t,n)}function Sp(t,e,n){if(e=e.updateQueue,e!==null&&(e=e.shared,(n&4194240)!==0)){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,tx(t,n)}}function E3(t,e){var n=t.updateQueue,r=t.alternate;if(r!==null&&(r=r.updateQueue,n===r)){var s=null,i=null;if(n=n.firstBaseUpdate,n!==null){do{var o={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};i===null?s=i=o:i=i.next=o,n=n.next}while(n!==null);i===null?s=i=e:i=i.next=e}else s=i=e;n={baseState:r.baseState,firstBaseUpdate:s,lastBaseUpdate:i,shared:r.shared,effects:r.effects},t.updateQueue=n;return}t=n.lastBaseUpdate,t===null?n.firstBaseUpdate=e:t.next=e,n.lastBaseUpdate=e}function If(t,e,n,r){var s=t.updateQueue;jo=!1;var i=s.firstBaseUpdate,o=s.lastBaseUpdate,a=s.shared.pending;if(a!==null){s.shared.pending=null;var l=a,c=l.next;l.next=null,o===null?i=c:o.next=c,o=l;var u=t.alternate;u!==null&&(u=u.updateQueue,a=u.lastBaseUpdate,a!==o&&(a===null?u.firstBaseUpdate=c:a.next=c,u.lastBaseUpdate=l))}if(i!==null){var h=s.baseState;o=0,u=c=l=null,a=i;do{var p=a.lane,f=a.eventTime;if((r&p)===p){u!==null&&(u=u.next={eventTime:f,lane:0,tag:a.tag,payload:a.payload,callback:a.callback,next:null});e:{var v=t,m=a;switch(p=e,f=n,m.tag){case 1:if(v=m.payload,typeof v=="function"){h=v.call(f,h,p);break e}h=v;break e;case 3:v.flags=v.flags&-65537|128;case 0:if(v=m.payload,p=typeof v=="function"?v.call(f,h,p):v,p==null)break e;h=$t({},h,p);break e;case 2:jo=!0}}a.callback!==null&&a.lane!==0&&(t.flags|=64,p=s.effects,p===null?s.effects=[a]:p.push(a))}else f={eventTime:f,lane:p,tag:a.tag,payload:a.payload,callback:a.callback,next:null},u===null?(c=u=f,l=h):u=u.next=f,o|=p;if(a=a.next,a===null){if(a=s.shared.pending,a===null)break;p=a,a=p.next,p.next=null,s.lastBaseUpdate=p,s.shared.pending=null}}while(!0);if(u===null&&(l=h),s.baseState=l,s.firstBaseUpdate=c,s.lastBaseUpdate=u,e=s.shared.interleaved,e!==null){s=e;do o|=s.lane,s=s.next;while(s!==e)}else i===null&&(s.shared.lanes=0);nl|=o,t.lanes=o,t.memoizedState=h}}function T3(t,e,n){if(t=e.effects,e.effects=null,t!==null)for(e=0;e<t.length;e++){var r=t[e],s=r.callback;if(s!==null){if(r.callback=null,r=n,typeof s!="function")throw Error(oe(191,s));s.call(r)}}}var mh={},pi=ya(mh),Nd=ya(mh),zd=ya(mh);function Ka(t){if(t===mh)throw Error(oe(174));return t}function yx(t,e){switch(mt(zd,e),mt(Nd,t),mt(pi,mh),t=e.nodeType,t){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:Lv(null,"");break;default:t=t===8?e.parentNode:e,e=t.namespaceURI||null,t=t.tagName,e=Lv(e,t)}It(pi),mt(pi,e)}function Tc(){It(pi),It(Nd),It(zd)}function EC(t){Ka(zd.current);var e=Ka(pi.current),n=Lv(e,t.type);e!==n&&(mt(Nd,t),mt(pi,n))}function vx(t){Nd.current===t&&(It(pi),It(Nd))}var Ot=ya(0);function Ef(t){for(var e=t;e!==null;){if(e.tag===13){var n=e.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||n.data==="$?"||n.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var w1=[];function Sx(){for(var t=0;t<w1.length;t++)w1[t]._workInProgressVersionPrimary=null;w1.length=0}var xp=ho.ReactCurrentDispatcher,b1=ho.ReactCurrentBatchConfig,tl=0,Ft=null,nn=null,un=null,Tf=!1,dd=!1,Fd=0,hN=0;function jn(){throw Error(oe(321))}function xx(t,e){if(e===null)return!1;for(var n=0;n<e.length&&n<t.length;n++)if(!Fs(t[n],e[n]))return!1;return!0}function wx(t,e,n,r,s,i){if(tl=i,Ft=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,xp.current=t===null||t.memoizedState===null?mN:yN,t=n(r,s),dd){i=0;do{if(dd=!1,Fd=0,25<=i)throw Error(oe(301));i+=1,un=nn=null,e.updateQueue=null,xp.current=vN,t=n(r,s)}while(dd)}if(xp.current=Mf,e=nn!==null&&nn.next!==null,tl=0,un=nn=Ft=null,Tf=!1,e)throw Error(oe(300));return t}function bx(){var t=Fd!==0;return Fd=0,t}function Js(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return un===null?Ft.memoizedState=un=t:un=un.next=t,un}function vs(){if(nn===null){var t=Ft.alternate;t=t!==null?t.memoizedState:null}else t=nn.next;var e=un===null?Ft.memoizedState:un.next;if(e!==null)un=e,nn=t;else{if(t===null)throw Error(oe(310));nn=t,t={memoizedState:nn.memoizedState,baseState:nn.baseState,baseQueue:nn.baseQueue,queue:nn.queue,next:null},un===null?Ft.memoizedState=un=t:un=un.next=t}return un}function $d(t,e){return typeof e=="function"?e(t):e}function C1(t){var e=vs(),n=e.queue;if(n===null)throw Error(oe(311));n.lastRenderedReducer=t;var r=nn,s=r.baseQueue,i=n.pending;if(i!==null){if(s!==null){var o=s.next;s.next=i.next,i.next=o}r.baseQueue=s=i,n.pending=null}if(s!==null){i=s.next,r=r.baseState;var a=o=null,l=null,c=i;do{var u=c.lane;if((tl&u)===u)l!==null&&(l=l.next={lane:0,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null}),r=c.hasEagerState?c.eagerState:t(r,c.action);else{var h={lane:u,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null};l===null?(a=l=h,o=r):l=l.next=h,Ft.lanes|=u,nl|=u}c=c.next}while(c!==null&&c!==i);l===null?o=r:l.next=a,Fs(r,e.memoizedState)||(Sr=!0),e.memoizedState=r,e.baseState=o,e.baseQueue=l,n.lastRenderedState=r}if(t=n.interleaved,t!==null){s=t;do i=s.lane,Ft.lanes|=i,nl|=i,s=s.next;while(s!==t)}else s===null&&(n.lanes=0);return[e.memoizedState,n.dispatch]}function P1(t){var e=vs(),n=e.queue;if(n===null)throw Error(oe(311));n.lastRenderedReducer=t;var r=n.dispatch,s=n.pending,i=e.memoizedState;if(s!==null){n.pending=null;var o=s=s.next;do i=t(i,o.action),o=o.next;while(o!==s);Fs(i,e.memoizedState)||(Sr=!0),e.memoizedState=i,e.baseQueue===null&&(e.baseState=i),n.lastRenderedState=i}return[i,r]}function TC(){}function MC(t,e){var n=Ft,r=vs(),s=e(),i=!Fs(r.memoizedState,s);if(i&&(r.memoizedState=s,Sr=!0),r=r.queue,Cx(DC.bind(null,n,r,t),[t]),r.getSnapshot!==e||i||un!==null&&un.memoizedState.tag&1){if(n.flags|=2048,Bd(9,AC.bind(null,n,r,s,e),void 0,null),pn===null)throw Error(oe(349));tl&30||_C(n,e,s)}return s}function _C(t,e,n){t.flags|=16384,t={getSnapshot:e,value:n},e=Ft.updateQueue,e===null?(e={lastEffect:null,stores:null},Ft.updateQueue=e,e.stores=[t]):(n=e.stores,n===null?e.stores=[t]:n.push(t))}function AC(t,e,n,r){e.value=n,e.getSnapshot=r,jC(e)&&RC(t)}function DC(t,e,n){return n(function(){jC(e)&&RC(t)})}function jC(t){var e=t.getSnapshot;t=t.value;try{var n=e();return!Fs(t,n)}catch{return!0}}function RC(t){var e=no(t,1);e!==null&&Ns(e,t,1,-1)}function M3(t){var e=Js();return typeof t=="function"&&(t=t()),e.memoizedState=e.baseState=t,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:$d,lastRenderedState:t},e.queue=t,t=t.dispatch=gN.bind(null,Ft,t),[e.memoizedState,t]}function Bd(t,e,n,r){return t={tag:t,create:e,destroy:n,deps:r,next:null},e=Ft.updateQueue,e===null?(e={lastEffect:null,stores:null},Ft.updateQueue=e,e.lastEffect=t.next=t):(n=e.lastEffect,n===null?e.lastEffect=t.next=t:(r=n.next,n.next=t,t.next=r,e.lastEffect=t)),t}function OC(){return vs().memoizedState}function wp(t,e,n,r){var s=Js();Ft.flags|=t,s.memoizedState=Bd(1|e,n,void 0,r===void 0?null:r)}function Ng(t,e,n,r){var s=vs();r=r===void 0?null:r;var i=void 0;if(nn!==null){var o=nn.memoizedState;if(i=o.destroy,r!==null&&xx(r,o.deps)){s.memoizedState=Bd(e,n,i,r);return}}Ft.flags|=t,s.memoizedState=Bd(1|e,n,i,r)}function _3(t,e){return wp(8390656,8,t,e)}function Cx(t,e){return Ng(2048,8,t,e)}function LC(t,e){return Ng(4,2,t,e)}function NC(t,e){return Ng(4,4,t,e)}function zC(t,e){if(typeof e=="function")return t=t(),e(t),function(){e(null)};if(e!=null)return t=t(),e.current=t,function(){e.current=null}}function FC(t,e,n){return n=n!=null?n.concat([t]):null,Ng(4,4,zC.bind(null,e,t),n)}function Px(){}function $C(t,e){var n=vs();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&xx(e,r[1])?r[0]:(n.memoizedState=[t,e],t)}function BC(t,e){var n=vs();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&xx(e,r[1])?r[0]:(t=t(),n.memoizedState=[t,e],t)}function UC(t,e,n){return tl&21?(Fs(n,e)||(n=V9(),Ft.lanes|=n,nl|=n,t.baseState=!0),e):(t.baseState&&(t.baseState=!1,Sr=!0),t.memoizedState=n)}function pN(t,e){var n=at;at=n!==0&&4>n?n:4,t(!0);var r=b1.transition;b1.transition={};try{t(!1),e()}finally{at=n,b1.transition=r}}function HC(){return vs().memoizedState}function fN(t,e,n){var r=Xo(t);if(n={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null},WC(t))KC(e,n);else if(n=kC(t,e,n,r),n!==null){var s=Jn();Ns(n,t,r,s),GC(n,e,r)}}function gN(t,e,n){var r=Xo(t),s={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null};if(WC(t))KC(e,s);else{var i=t.alternate;if(t.lanes===0&&(i===null||i.lanes===0)&&(i=e.lastRenderedReducer,i!==null))try{var o=e.lastRenderedState,a=i(o,n);if(s.hasEagerState=!0,s.eagerState=a,Fs(a,o)){var l=e.interleaved;l===null?(s.next=s,gx(e)):(s.next=l.next,l.next=s),e.interleaved=s;return}}catch{}finally{}n=kC(t,e,s,r),n!==null&&(s=Jn(),Ns(n,t,r,s),GC(n,e,r))}}function WC(t){var e=t.alternate;return t===Ft||e!==null&&e===Ft}function KC(t,e){dd=Tf=!0;var n=t.pending;n===null?e.next=e:(e.next=n.next,n.next=e),t.pending=e}function GC(t,e,n){if(n&4194240){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,tx(t,n)}}var Mf={readContext:ys,useCallback:jn,useContext:jn,useEffect:jn,useImperativeHandle:jn,useInsertionEffect:jn,useLayoutEffect:jn,useMemo:jn,useReducer:jn,useRef:jn,useState:jn,useDebugValue:jn,useDeferredValue:jn,useTransition:jn,useMutableSource:jn,useSyncExternalStore:jn,useId:jn,unstable_isNewReconciler:!1},mN={readContext:ys,useCallback:function(t,e){return Js().memoizedState=[t,e===void 0?null:e],t},useContext:ys,useEffect:_3,useImperativeHandle:function(t,e,n){return n=n!=null?n.concat([t]):null,wp(4194308,4,zC.bind(null,e,t),n)},useLayoutEffect:function(t,e){return wp(4194308,4,t,e)},useInsertionEffect:function(t,e){return wp(4,2,t,e)},useMemo:function(t,e){var n=Js();return e=e===void 0?null:e,t=t(),n.memoizedState=[t,e],t},useReducer:function(t,e,n){var r=Js();return e=n!==void 0?n(e):e,r.memoizedState=r.baseState=e,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:e},r.queue=t,t=t.dispatch=fN.bind(null,Ft,t),[r.memoizedState,t]},useRef:function(t){var e=Js();return t={current:t},e.memoizedState=t},useState:M3,useDebugValue:Px,useDeferredValue:function(t){return Js().memoizedState=t},useTransition:function(){var t=M3(!1),e=t[0];return t=pN.bind(null,t[1]),Js().memoizedState=t,[e,t]},useMutableSource:function(){},useSyncExternalStore:function(t,e,n){var r=Ft,s=Js();if(Mt){if(n===void 0)throw Error(oe(407));n=n()}else{if(n=e(),pn===null)throw Error(oe(349));tl&30||_C(r,e,n)}s.memoizedState=n;var i={value:n,getSnapshot:e};return s.queue=i,_3(DC.bind(null,r,i,t),[t]),r.flags|=2048,Bd(9,AC.bind(null,r,i,n,e),void 0,null),n},useId:function(){var t=Js(),e=pn.identifierPrefix;if(Mt){var n=Wi,r=Hi;n=(r&~(1<<32-Ls(r)-1)).toString(32)+n,e=":"+e+"R"+n,n=Fd++,0<n&&(e+="H"+n.toString(32)),e+=":"}else n=hN++,e=":"+e+"r"+n.toString(32)+":";return t.memoizedState=e},unstable_isNewReconciler:!1},yN={readContext:ys,useCallback:$C,useContext:ys,useEffect:Cx,useImperativeHandle:FC,useInsertionEffect:LC,useLayoutEffect:NC,useMemo:BC,useReducer:C1,useRef:OC,useState:function(){return C1($d)},useDebugValue:Px,useDeferredValue:function(t){var e=vs();return UC(e,nn.memoizedState,t)},useTransition:function(){var t=C1($d)[0],e=vs().memoizedState;return[t,e]},useMutableSource:TC,useSyncExternalStore:MC,useId:HC,unstable_isNewReconciler:!1},vN={readContext:ys,useCallback:$C,useContext:ys,useEffect:Cx,useImperativeHandle:FC,useInsertionEffect:LC,useLayoutEffect:NC,useMemo:BC,useReducer:P1,useRef:OC,useState:function(){return P1($d)},useDebugValue:Px,useDeferredValue:function(t){var e=vs();return nn===null?e.memoizedState=t:UC(e,nn.memoizedState,t)},useTransition:function(){var t=P1($d)[0],e=vs().memoizedState;return[t,e]},useMutableSource:TC,useSyncExternalStore:MC,useId:HC,unstable_isNewReconciler:!1};function Es(t,e){if(t&&t.defaultProps){e=$t({},e),t=t.defaultProps;for(var n in t)e[n]===void 0&&(e[n]=t[n]);return e}return e}function r2(t,e,n,r){e=t.memoizedState,n=n(r,e),n=n==null?e:$t({},e,n),t.memoizedState=n,t.lanes===0&&(t.updateQueue.baseState=n)}var zg={isMounted:function(t){return(t=t._reactInternals)?Sl(t)===t:!1},enqueueSetState:function(t,e,n){t=t._reactInternals;var r=Jn(),s=Xo(t),i=Vi(r,s);i.payload=e,n!=null&&(i.callback=n),e=qo(t,i,s),e!==null&&(Ns(e,t,s,r),Sp(e,t,s))},enqueueReplaceState:function(t,e,n){t=t._reactInternals;var r=Jn(),s=Xo(t),i=Vi(r,s);i.tag=1,i.payload=e,n!=null&&(i.callback=n),e=qo(t,i,s),e!==null&&(Ns(e,t,s,r),Sp(e,t,s))},enqueueForceUpdate:function(t,e){t=t._reactInternals;var n=Jn(),r=Xo(t),s=Vi(n,r);s.tag=2,e!=null&&(s.callback=e),e=qo(t,s,r),e!==null&&(Ns(e,t,r,n),Sp(e,t,r))}};function A3(t,e,n,r,s,i,o){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(r,i,o):e.prototype&&e.prototype.isPureReactComponent?!jd(n,r)||!jd(s,i):!0}function VC(t,e,n){var r=!1,s=ra,i=e.contextType;return typeof i=="object"&&i!==null?i=ys(i):(s=Pr(e)?Ja:Wn.current,r=e.contextTypes,i=(r=r!=null)?kc(t,s):ra),e=new e(n,i),t.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=zg,t.stateNode=e,e._reactInternals=t,r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=s,t.__reactInternalMemoizedMaskedChildContext=i),e}function D3(t,e,n,r){t=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(n,r),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(n,r),e.state!==t&&zg.enqueueReplaceState(e,e.state,null)}function s2(t,e,n,r){var s=t.stateNode;s.props=n,s.state=t.memoizedState,s.refs={},mx(t);var i=e.contextType;typeof i=="object"&&i!==null?s.context=ys(i):(i=Pr(e)?Ja:Wn.current,s.context=kc(t,i)),s.state=t.memoizedState,i=e.getDerivedStateFromProps,typeof i=="function"&&(r2(t,e,i,n),s.state=t.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof s.getSnapshotBeforeUpdate=="function"||typeof s.UNSAFE_componentWillMount!="function"&&typeof s.componentWillMount!="function"||(e=s.state,typeof s.componentWillMount=="function"&&s.componentWillMount(),typeof s.UNSAFE_componentWillMount=="function"&&s.UNSAFE_componentWillMount(),e!==s.state&&zg.enqueueReplaceState(s,s.state,null),If(t,n,s,r),s.state=t.memoizedState),typeof s.componentDidMount=="function"&&(t.flags|=4194308)}function Mc(t,e){try{var n="",r=e;do n+=GO(r),r=r.return;while(r);var s=n}catch(i){s=`
Error generating stack: `+i.message+`
`+i.stack}return{value:t,source:e,stack:s,digest:null}}function k1(t,e,n){return{value:t,source:null,stack:n??null,digest:e??null}}function i2(t,e){try{console.error(e.value)}catch(n){setTimeout(function(){throw n})}}var SN=typeof WeakMap=="function"?WeakMap:Map;function qC(t,e,n){n=Vi(-1,n),n.tag=3,n.payload={element:null};var r=e.value;return n.callback=function(){Af||(Af=!0,g2=r),i2(t,e)},n}function YC(t,e,n){n=Vi(-1,n),n.tag=3;var r=t.type.getDerivedStateFromError;if(typeof r=="function"){var s=e.value;n.payload=function(){return r(s)},n.callback=function(){i2(t,e)}}var i=t.stateNode;return i!==null&&typeof i.componentDidCatch=="function"&&(n.callback=function(){i2(t,e),typeof r!="function"&&(Yo===null?Yo=new Set([this]):Yo.add(this));var o=e.stack;this.componentDidCatch(e.value,{componentStack:o!==null?o:""})}),n}function j3(t,e,n){var r=t.pingCache;if(r===null){r=t.pingCache=new SN;var s=new Set;r.set(e,s)}else s=r.get(e),s===void 0&&(s=new Set,r.set(e,s));s.has(n)||(s.add(n),t=jN.bind(null,t,e,n),e.then(t,t))}function R3(t){do{var e;if((e=t.tag===13)&&(e=t.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return t;t=t.return}while(t!==null);return null}function O3(t,e,n,r,s){return t.mode&1?(t.flags|=65536,t.lanes=s,t):(t===e?t.flags|=65536:(t.flags|=128,n.flags|=131072,n.flags&=-52805,n.tag===1&&(n.alternate===null?n.tag=17:(e=Vi(-1,1),e.tag=2,qo(n,e,1))),n.lanes|=1),t)}var xN=ho.ReactCurrentOwner,Sr=!1;function Zn(t,e,n,r){e.child=t===null?PC(e,null,n,r):Ec(e,t.child,n,r)}function L3(t,e,n,r,s){n=n.render;var i=e.ref;return gc(e,s),r=wx(t,e,n,r,i,s),n=bx(),t!==null&&!Sr?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~s,ro(t,e,s)):(Mt&&n&&cx(e),e.flags|=1,Zn(t,e,r,s),e.child)}function N3(t,e,n,r,s){if(t===null){var i=n.type;return typeof i=="function"&&!Dx(i)&&i.defaultProps===void 0&&n.compare===null&&n.defaultProps===void 0?(e.tag=15,e.type=i,XC(t,e,i,r,s)):(t=kp(n.type,null,r,e,e.mode,s),t.ref=e.ref,t.return=e,e.child=t)}if(i=t.child,!(t.lanes&s)){var o=i.memoizedProps;if(n=n.compare,n=n!==null?n:jd,n(o,r)&&t.ref===e.ref)return ro(t,e,s)}return e.flags|=1,t=Zo(i,r),t.ref=e.ref,t.return=e,e.child=t}function XC(t,e,n,r,s){if(t!==null){var i=t.memoizedProps;if(jd(i,r)&&t.ref===e.ref)if(Sr=!1,e.pendingProps=r=i,(t.lanes&s)!==0)t.flags&131072&&(Sr=!0);else return e.lanes=t.lanes,ro(t,e,s)}return o2(t,e,n,r,s)}function ZC(t,e,n){var r=e.pendingProps,s=r.children,i=t!==null?t.memoizedState:null;if(r.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},mt(tc,Or),Or|=n;else{if(!(n&1073741824))return t=i!==null?i.baseLanes|n:n,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:t,cachePool:null,transitions:null},e.updateQueue=null,mt(tc,Or),Or|=t,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=i!==null?i.baseLanes:n,mt(tc,Or),Or|=r}else i!==null?(r=i.baseLanes|n,e.memoizedState=null):r=n,mt(tc,Or),Or|=r;return Zn(t,e,s,n),e.child}function QC(t,e){var n=e.ref;(t===null&&n!==null||t!==null&&t.ref!==n)&&(e.flags|=512,e.flags|=2097152)}function o2(t,e,n,r,s){var i=Pr(n)?Ja:Wn.current;return i=kc(e,i),gc(e,s),n=wx(t,e,n,r,i,s),r=bx(),t!==null&&!Sr?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~s,ro(t,e,s)):(Mt&&r&&cx(e),e.flags|=1,Zn(t,e,n,s),e.child)}function z3(t,e,n,r,s){if(Pr(n)){var i=!0;wf(e)}else i=!1;if(gc(e,s),e.stateNode===null)bp(t,e),VC(e,n,r),s2(e,n,r,s),r=!0;else if(t===null){var o=e.stateNode,a=e.memoizedProps;o.props=a;var l=o.context,c=n.contextType;typeof c=="object"&&c!==null?c=ys(c):(c=Pr(n)?Ja:Wn.current,c=kc(e,c));var u=n.getDerivedStateFromProps,h=typeof u=="function"||typeof o.getSnapshotBeforeUpdate=="function";h||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(a!==r||l!==c)&&D3(e,o,r,c),jo=!1;var p=e.memoizedState;o.state=p,If(e,r,o,s),l=e.memoizedState,a!==r||p!==l||Cr.current||jo?(typeof u=="function"&&(r2(e,n,u,r),l=e.memoizedState),(a=jo||A3(e,n,a,r,p,l,c))?(h||typeof o.UNSAFE_componentWillMount!="function"&&typeof o.componentWillMount!="function"||(typeof o.componentWillMount=="function"&&o.componentWillMount(),typeof o.UNSAFE_componentWillMount=="function"&&o.UNSAFE_componentWillMount()),typeof o.componentDidMount=="function"&&(e.flags|=4194308)):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=r,e.memoizedState=l),o.props=r,o.state=l,o.context=c,r=a):(typeof o.componentDidMount=="function"&&(e.flags|=4194308),r=!1)}else{o=e.stateNode,IC(t,e),a=e.memoizedProps,c=e.type===e.elementType?a:Es(e.type,a),o.props=c,h=e.pendingProps,p=o.context,l=n.contextType,typeof l=="object"&&l!==null?l=ys(l):(l=Pr(n)?Ja:Wn.current,l=kc(e,l));var f=n.getDerivedStateFromProps;(u=typeof f=="function"||typeof o.getSnapshotBeforeUpdate=="function")||typeof o.UNSAFE_componentWillReceiveProps!="function"&&typeof o.componentWillReceiveProps!="function"||(a!==h||p!==l)&&D3(e,o,r,l),jo=!1,p=e.memoizedState,o.state=p,If(e,r,o,s);var v=e.memoizedState;a!==h||p!==v||Cr.current||jo?(typeof f=="function"&&(r2(e,n,f,r),v=e.memoizedState),(c=jo||A3(e,n,c,r,p,v,l)||!1)?(u||typeof o.UNSAFE_componentWillUpdate!="function"&&typeof o.componentWillUpdate!="function"||(typeof o.componentWillUpdate=="function"&&o.componentWillUpdate(r,v,l),typeof o.UNSAFE_componentWillUpdate=="function"&&o.UNSAFE_componentWillUpdate(r,v,l)),typeof o.componentDidUpdate=="function"&&(e.flags|=4),typeof o.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof o.componentDidUpdate!="function"||a===t.memoizedProps&&p===t.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||a===t.memoizedProps&&p===t.memoizedState||(e.flags|=1024),e.memoizedProps=r,e.memoizedState=v),o.props=r,o.state=v,o.context=l,r=c):(typeof o.componentDidUpdate!="function"||a===t.memoizedProps&&p===t.memoizedState||(e.flags|=4),typeof o.getSnapshotBeforeUpdate!="function"||a===t.memoizedProps&&p===t.memoizedState||(e.flags|=1024),r=!1)}return a2(t,e,n,r,i,s)}function a2(t,e,n,r,s,i){QC(t,e);var o=(e.flags&128)!==0;if(!r&&!o)return s&&C3(e,n,!1),ro(t,e,i);r=e.stateNode,xN.current=e;var a=o&&typeof n.getDerivedStateFromError!="function"?null:r.render();return e.flags|=1,t!==null&&o?(e.child=Ec(e,t.child,null,i),e.child=Ec(e,null,a,i)):Zn(t,e,a,i),e.memoizedState=r.state,s&&C3(e,n,!0),e.child}function JC(t){var e=t.stateNode;e.pendingContext?b3(t,e.pendingContext,e.pendingContext!==e.context):e.context&&b3(t,e.context,!1),yx(t,e.containerInfo)}function F3(t,e,n,r,s){return Ic(),dx(s),e.flags|=256,Zn(t,e,n,r),e.child}var l2={dehydrated:null,treeContext:null,retryLane:0};function c2(t){return{baseLanes:t,cachePool:null,transitions:null}}function eP(t,e,n){var r=e.pendingProps,s=Ot.current,i=!1,o=(e.flags&128)!==0,a;if((a=o)||(a=t!==null&&t.memoizedState===null?!1:(s&2)!==0),a?(i=!0,e.flags&=-129):(t===null||t.memoizedState!==null)&&(s|=1),mt(Ot,s&1),t===null)return t2(e),t=e.memoizedState,t!==null&&(t=t.dehydrated,t!==null)?(e.mode&1?t.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(o=r.children,t=r.fallback,i?(r=e.mode,i=e.child,o={mode:"hidden",children:o},!(r&1)&&i!==null?(i.childLanes=0,i.pendingProps=o):i=Bg(o,r,0,null),t=Ya(t,r,n,null),i.return=e,t.return=e,i.sibling=t,e.child=i,e.child.memoizedState=c2(n),e.memoizedState=l2,t):kx(e,o));if(s=t.memoizedState,s!==null&&(a=s.dehydrated,a!==null))return wN(t,e,o,r,a,s,n);if(i){i=r.fallback,o=e.mode,s=t.child,a=s.sibling;var l={mode:"hidden",children:r.children};return!(o&1)&&e.child!==s?(r=e.child,r.childLanes=0,r.pendingProps=l,e.deletions=null):(r=Zo(s,l),r.subtreeFlags=s.subtreeFlags&14680064),a!==null?i=Zo(a,i):(i=Ya(i,o,n,null),i.flags|=2),i.return=e,r.return=e,r.sibling=i,e.child=r,r=i,i=e.child,o=t.child.memoizedState,o=o===null?c2(n):{baseLanes:o.baseLanes|n,cachePool:null,transitions:o.transitions},i.memoizedState=o,i.childLanes=t.childLanes&~n,e.memoizedState=l2,r}return i=t.child,t=i.sibling,r=Zo(i,{mode:"visible",children:r.children}),!(e.mode&1)&&(r.lanes=n),r.return=e,r.sibling=null,t!==null&&(n=e.deletions,n===null?(e.deletions=[t],e.flags|=16):n.push(t)),e.child=r,e.memoizedState=null,r}function kx(t,e){return e=Bg({mode:"visible",children:e},t.mode,0,null),e.return=t,t.child=e}function h0(t,e,n,r){return r!==null&&dx(r),Ec(e,t.child,null,n),t=kx(e,e.pendingProps.children),t.flags|=2,e.memoizedState=null,t}function wN(t,e,n,r,s,i,o){if(n)return e.flags&256?(e.flags&=-257,r=k1(Error(oe(422))),h0(t,e,o,r)):e.memoizedState!==null?(e.child=t.child,e.flags|=128,null):(i=r.fallback,s=e.mode,r=Bg({mode:"visible",children:r.children},s,0,null),i=Ya(i,s,o,null),i.flags|=2,r.return=e,i.return=e,r.sibling=i,e.child=r,e.mode&1&&Ec(e,t.child,null,o),e.child.memoizedState=c2(o),e.memoizedState=l2,i);if(!(e.mode&1))return h0(t,e,o,null);if(s.data==="$!"){if(r=s.nextSibling&&s.nextSibling.dataset,r)var a=r.dgst;return r=a,i=Error(oe(419)),r=k1(i,r,void 0),h0(t,e,o,r)}if(a=(o&t.childLanes)!==0,Sr||a){if(r=pn,r!==null){switch(o&-o){case 4:s=2;break;case 16:s=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:s=32;break;case 536870912:s=268435456;break;default:s=0}s=s&(r.suspendedLanes|o)?0:s,s!==0&&s!==i.retryLane&&(i.retryLane=s,no(t,s),Ns(r,t,s,-1))}return Ax(),r=k1(Error(oe(421))),h0(t,e,o,r)}return s.data==="$?"?(e.flags|=128,e.child=t.child,e=RN.bind(null,t),s._reactRetry=e,null):(t=i.treeContext,$r=Vo(s.nextSibling),Br=e,Mt=!0,As=null,t!==null&&(is[os++]=Hi,is[os++]=Wi,is[os++]=el,Hi=t.id,Wi=t.overflow,el=e),e=kx(e,r.children),e.flags|=4096,e)}function $3(t,e,n){t.lanes|=e;var r=t.alternate;r!==null&&(r.lanes|=e),n2(t.return,e,n)}function I1(t,e,n,r,s){var i=t.memoizedState;i===null?t.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:s}:(i.isBackwards=e,i.rendering=null,i.renderingStartTime=0,i.last=r,i.tail=n,i.tailMode=s)}function tP(t,e,n){var r=e.pendingProps,s=r.revealOrder,i=r.tail;if(Zn(t,e,r.children,n),r=Ot.current,r&2)r=r&1|2,e.flags|=128;else{if(t!==null&&t.flags&128)e:for(t=e.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&$3(t,n,e);else if(t.tag===19)$3(t,n,e);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;t.sibling===null;){if(t.return===null||t.return===e)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}r&=1}if(mt(Ot,r),!(e.mode&1))e.memoizedState=null;else switch(s){case"forwards":for(n=e.child,s=null;n!==null;)t=n.alternate,t!==null&&Ef(t)===null&&(s=n),n=n.sibling;n=s,n===null?(s=e.child,e.child=null):(s=n.sibling,n.sibling=null),I1(e,!1,s,n,i);break;case"backwards":for(n=null,s=e.child,e.child=null;s!==null;){if(t=s.alternate,t!==null&&Ef(t)===null){e.child=s;break}t=s.sibling,s.sibling=n,n=s,s=t}I1(e,!0,n,null,i);break;case"together":I1(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function bp(t,e){!(e.mode&1)&&t!==null&&(t.alternate=null,e.alternate=null,e.flags|=2)}function ro(t,e,n){if(t!==null&&(e.dependencies=t.dependencies),nl|=e.lanes,!(n&e.childLanes))return null;if(t!==null&&e.child!==t.child)throw Error(oe(153));if(e.child!==null){for(t=e.child,n=Zo(t,t.pendingProps),e.child=n,n.return=e;t.sibling!==null;)t=t.sibling,n=n.sibling=Zo(t,t.pendingProps),n.return=e;n.sibling=null}return e.child}function bN(t,e,n){switch(e.tag){case 3:JC(e),Ic();break;case 5:EC(e);break;case 1:Pr(e.type)&&wf(e);break;case 4:yx(e,e.stateNode.containerInfo);break;case 10:var r=e.type._context,s=e.memoizedProps.value;mt(Pf,r._currentValue),r._currentValue=s;break;case 13:if(r=e.memoizedState,r!==null)return r.dehydrated!==null?(mt(Ot,Ot.current&1),e.flags|=128,null):n&e.child.childLanes?eP(t,e,n):(mt(Ot,Ot.current&1),t=ro(t,e,n),t!==null?t.sibling:null);mt(Ot,Ot.current&1);break;case 19:if(r=(n&e.childLanes)!==0,t.flags&128){if(r)return tP(t,e,n);e.flags|=128}if(s=e.memoizedState,s!==null&&(s.rendering=null,s.tail=null,s.lastEffect=null),mt(Ot,Ot.current),r)break;return null;case 22:case 23:return e.lanes=0,ZC(t,e,n)}return ro(t,e,n)}var nP,u2,rP,sP;nP=function(t,e){for(var n=e.child;n!==null;){if(n.tag===5||n.tag===6)t.appendChild(n.stateNode);else if(n.tag!==4&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===e)break;for(;n.sibling===null;){if(n.return===null||n.return===e)return;n=n.return}n.sibling.return=n.return,n=n.sibling}};u2=function(){};rP=function(t,e,n,r){var s=t.memoizedProps;if(s!==r){t=e.stateNode,Ka(pi.current);var i=null;switch(n){case"input":s=Dv(t,s),r=Dv(t,r),i=[];break;case"select":s=$t({},s,{value:void 0}),r=$t({},r,{value:void 0}),i=[];break;case"textarea":s=Ov(t,s),r=Ov(t,r),i=[];break;default:typeof s.onClick!="function"&&typeof r.onClick=="function"&&(t.onclick=Sf)}Nv(n,r);var o;n=null;for(c in s)if(!r.hasOwnProperty(c)&&s.hasOwnProperty(c)&&s[c]!=null)if(c==="style"){var a=s[c];for(o in a)a.hasOwnProperty(o)&&(n||(n={}),n[o]="")}else c!=="dangerouslySetInnerHTML"&&c!=="children"&&c!=="suppressContentEditableWarning"&&c!=="suppressHydrationWarning"&&c!=="autoFocus"&&(Id.hasOwnProperty(c)?i||(i=[]):(i=i||[]).push(c,null));for(c in r){var l=r[c];if(a=s!=null?s[c]:void 0,r.hasOwnProperty(c)&&l!==a&&(l!=null||a!=null))if(c==="style")if(a){for(o in a)!a.hasOwnProperty(o)||l&&l.hasOwnProperty(o)||(n||(n={}),n[o]="");for(o in l)l.hasOwnProperty(o)&&a[o]!==l[o]&&(n||(n={}),n[o]=l[o])}else n||(i||(i=[]),i.push(c,n)),n=l;else c==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,a=a?a.__html:void 0,l!=null&&a!==l&&(i=i||[]).push(c,l)):c==="children"?typeof l!="string"&&typeof l!="number"||(i=i||[]).push(c,""+l):c!=="suppressContentEditableWarning"&&c!=="suppressHydrationWarning"&&(Id.hasOwnProperty(c)?(l!=null&&c==="onScroll"&&Ct("scroll",t),i||a===l||(i=[])):(i=i||[]).push(c,l))}n&&(i=i||[]).push("style",n);var c=i;(e.updateQueue=c)&&(e.flags|=4)}};sP=function(t,e,n,r){n!==r&&(e.flags|=4)};function yu(t,e){if(!Mt)switch(t.tailMode){case"hidden":e=t.tail;for(var n=null;e!==null;)e.alternate!==null&&(n=e),e=e.sibling;n===null?t.tail=null:n.sibling=null;break;case"collapsed":n=t.tail;for(var r=null;n!==null;)n.alternate!==null&&(r=n),n=n.sibling;r===null?e||t.tail===null?t.tail=null:t.tail.sibling=null:r.sibling=null}}function Rn(t){var e=t.alternate!==null&&t.alternate.child===t.child,n=0,r=0;if(e)for(var s=t.child;s!==null;)n|=s.lanes|s.childLanes,r|=s.subtreeFlags&14680064,r|=s.flags&14680064,s.return=t,s=s.sibling;else for(s=t.child;s!==null;)n|=s.lanes|s.childLanes,r|=s.subtreeFlags,r|=s.flags,s.return=t,s=s.sibling;return t.subtreeFlags|=r,t.childLanes=n,e}function CN(t,e,n){var r=e.pendingProps;switch(ux(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Rn(e),null;case 1:return Pr(e.type)&&xf(),Rn(e),null;case 3:return r=e.stateNode,Tc(),It(Cr),It(Wn),Sx(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),(t===null||t.child===null)&&(u0(e)?e.flags|=4:t===null||t.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,As!==null&&(v2(As),As=null))),u2(t,e),Rn(e),null;case 5:vx(e);var s=Ka(zd.current);if(n=e.type,t!==null&&e.stateNode!=null)rP(t,e,n,r,s),t.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!r){if(e.stateNode===null)throw Error(oe(166));return Rn(e),null}if(t=Ka(pi.current),u0(e)){r=e.stateNode,n=e.type;var i=e.memoizedProps;switch(r[ri]=e,r[Ld]=i,t=(e.mode&1)!==0,n){case"dialog":Ct("cancel",r),Ct("close",r);break;case"iframe":case"object":case"embed":Ct("load",r);break;case"video":case"audio":for(s=0;s<$u.length;s++)Ct($u[s],r);break;case"source":Ct("error",r);break;case"img":case"image":case"link":Ct("error",r),Ct("load",r);break;case"details":Ct("toggle",r);break;case"input":Yb(r,i),Ct("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!i.multiple},Ct("invalid",r);break;case"textarea":Zb(r,i),Ct("invalid",r)}Nv(n,i),s=null;for(var o in i)if(i.hasOwnProperty(o)){var a=i[o];o==="children"?typeof a=="string"?r.textContent!==a&&(i.suppressHydrationWarning!==!0&&c0(r.textContent,a,t),s=["children",a]):typeof a=="number"&&r.textContent!==""+a&&(i.suppressHydrationWarning!==!0&&c0(r.textContent,a,t),s=["children",""+a]):Id.hasOwnProperty(o)&&a!=null&&o==="onScroll"&&Ct("scroll",r)}switch(n){case"input":t0(r),Xb(r,i,!0);break;case"textarea":t0(r),Qb(r);break;case"select":case"option":break;default:typeof i.onClick=="function"&&(r.onclick=Sf)}r=s,e.updateQueue=r,r!==null&&(e.flags|=4)}else{o=s.nodeType===9?s:s.ownerDocument,t==="http://www.w3.org/1999/xhtml"&&(t=D9(n)),t==="http://www.w3.org/1999/xhtml"?n==="script"?(t=o.createElement("div"),t.innerHTML="<script><\/script>",t=t.removeChild(t.firstChild)):typeof r.is=="string"?t=o.createElement(n,{is:r.is}):(t=o.createElement(n),n==="select"&&(o=t,r.multiple?o.multiple=!0:r.size&&(o.size=r.size))):t=o.createElementNS(t,n),t[ri]=e,t[Ld]=r,nP(t,e,!1,!1),e.stateNode=t;e:{switch(o=zv(n,r),n){case"dialog":Ct("cancel",t),Ct("close",t),s=r;break;case"iframe":case"object":case"embed":Ct("load",t),s=r;break;case"video":case"audio":for(s=0;s<$u.length;s++)Ct($u[s],t);s=r;break;case"source":Ct("error",t),s=r;break;case"img":case"image":case"link":Ct("error",t),Ct("load",t),s=r;break;case"details":Ct("toggle",t),s=r;break;case"input":Yb(t,r),s=Dv(t,r),Ct("invalid",t);break;case"option":s=r;break;case"select":t._wrapperState={wasMultiple:!!r.multiple},s=$t({},r,{value:void 0}),Ct("invalid",t);break;case"textarea":Zb(t,r),s=Ov(t,r),Ct("invalid",t);break;default:s=r}Nv(n,s),a=s;for(i in a)if(a.hasOwnProperty(i)){var l=a[i];i==="style"?O9(t,l):i==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,l!=null&&j9(t,l)):i==="children"?typeof l=="string"?(n!=="textarea"||l!=="")&&Ed(t,l):typeof l=="number"&&Ed(t,""+l):i!=="suppressContentEditableWarning"&&i!=="suppressHydrationWarning"&&i!=="autoFocus"&&(Id.hasOwnProperty(i)?l!=null&&i==="onScroll"&&Ct("scroll",t):l!=null&&YS(t,i,l,o))}switch(n){case"input":t0(t),Xb(t,r,!1);break;case"textarea":t0(t),Qb(t);break;case"option":r.value!=null&&t.setAttribute("value",""+na(r.value));break;case"select":t.multiple=!!r.multiple,i=r.value,i!=null?dc(t,!!r.multiple,i,!1):r.defaultValue!=null&&dc(t,!!r.multiple,r.defaultValue,!0);break;default:typeof s.onClick=="function"&&(t.onclick=Sf)}switch(n){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return Rn(e),null;case 6:if(t&&e.stateNode!=null)sP(t,e,t.memoizedProps,r);else{if(typeof r!="string"&&e.stateNode===null)throw Error(oe(166));if(n=Ka(zd.current),Ka(pi.current),u0(e)){if(r=e.stateNode,n=e.memoizedProps,r[ri]=e,(i=r.nodeValue!==n)&&(t=Br,t!==null))switch(t.tag){case 3:c0(r.nodeValue,n,(t.mode&1)!==0);break;case 5:t.memoizedProps.suppressHydrationWarning!==!0&&c0(r.nodeValue,n,(t.mode&1)!==0)}i&&(e.flags|=4)}else r=(n.nodeType===9?n:n.ownerDocument).createTextNode(r),r[ri]=e,e.stateNode=r}return Rn(e),null;case 13:if(It(Ot),r=e.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if(Mt&&$r!==null&&e.mode&1&&!(e.flags&128))bC(),Ic(),e.flags|=98560,i=!1;else if(i=u0(e),r!==null&&r.dehydrated!==null){if(t===null){if(!i)throw Error(oe(318));if(i=e.memoizedState,i=i!==null?i.dehydrated:null,!i)throw Error(oe(317));i[ri]=e}else Ic(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;Rn(e),i=!1}else As!==null&&(v2(As),As=null),i=!0;if(!i)return e.flags&65536?e:null}return e.flags&128?(e.lanes=n,e):(r=r!==null,r!==(t!==null&&t.memoizedState!==null)&&r&&(e.child.flags|=8192,e.mode&1&&(t===null||Ot.current&1?rn===0&&(rn=3):Ax())),e.updateQueue!==null&&(e.flags|=4),Rn(e),null);case 4:return Tc(),u2(t,e),t===null&&Rd(e.stateNode.containerInfo),Rn(e),null;case 10:return fx(e.type._context),Rn(e),null;case 17:return Pr(e.type)&&xf(),Rn(e),null;case 19:if(It(Ot),i=e.memoizedState,i===null)return Rn(e),null;if(r=(e.flags&128)!==0,o=i.rendering,o===null)if(r)yu(i,!1);else{if(rn!==0||t!==null&&t.flags&128)for(t=e.child;t!==null;){if(o=Ef(t),o!==null){for(e.flags|=128,yu(i,!1),r=o.updateQueue,r!==null&&(e.updateQueue=r,e.flags|=4),e.subtreeFlags=0,r=n,n=e.child;n!==null;)i=n,t=r,i.flags&=14680066,o=i.alternate,o===null?(i.childLanes=0,i.lanes=t,i.child=null,i.subtreeFlags=0,i.memoizedProps=null,i.memoizedState=null,i.updateQueue=null,i.dependencies=null,i.stateNode=null):(i.childLanes=o.childLanes,i.lanes=o.lanes,i.child=o.child,i.subtreeFlags=0,i.deletions=null,i.memoizedProps=o.memoizedProps,i.memoizedState=o.memoizedState,i.updateQueue=o.updateQueue,i.type=o.type,t=o.dependencies,i.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),n=n.sibling;return mt(Ot,Ot.current&1|2),e.child}t=t.sibling}i.tail!==null&&Gt()>_c&&(e.flags|=128,r=!0,yu(i,!1),e.lanes=4194304)}else{if(!r)if(t=Ef(o),t!==null){if(e.flags|=128,r=!0,n=t.updateQueue,n!==null&&(e.updateQueue=n,e.flags|=4),yu(i,!0),i.tail===null&&i.tailMode==="hidden"&&!o.alternate&&!Mt)return Rn(e),null}else 2*Gt()-i.renderingStartTime>_c&&n!==1073741824&&(e.flags|=128,r=!0,yu(i,!1),e.lanes=4194304);i.isBackwards?(o.sibling=e.child,e.child=o):(n=i.last,n!==null?n.sibling=o:e.child=o,i.last=o)}return i.tail!==null?(e=i.tail,i.rendering=e,i.tail=e.sibling,i.renderingStartTime=Gt(),e.sibling=null,n=Ot.current,mt(Ot,r?n&1|2:n&1),e):(Rn(e),null);case 22:case 23:return _x(),r=e.memoizedState!==null,t!==null&&t.memoizedState!==null!==r&&(e.flags|=8192),r&&e.mode&1?Or&1073741824&&(Rn(e),e.subtreeFlags&6&&(e.flags|=8192)):Rn(e),null;case 24:return null;case 25:return null}throw Error(oe(156,e.tag))}function PN(t,e){switch(ux(e),e.tag){case 1:return Pr(e.type)&&xf(),t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 3:return Tc(),It(Cr),It(Wn),Sx(),t=e.flags,t&65536&&!(t&128)?(e.flags=t&-65537|128,e):null;case 5:return vx(e),null;case 13:if(It(Ot),t=e.memoizedState,t!==null&&t.dehydrated!==null){if(e.alternate===null)throw Error(oe(340));Ic()}return t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 19:return It(Ot),null;case 4:return Tc(),null;case 10:return fx(e.type._context),null;case 22:case 23:return _x(),null;case 24:return null;default:return null}}var p0=!1,$n=!1,kN=typeof WeakSet=="function"?WeakSet:Set,me=null;function ec(t,e){var n=t.ref;if(n!==null)if(typeof n=="function")try{n(null)}catch(r){Ht(t,e,r)}else n.current=null}function d2(t,e,n){try{n()}catch(r){Ht(t,e,r)}}var B3=!1;function IN(t,e){if(qv=mf,t=cC(),lx(t)){if("selectionStart"in t)var n={start:t.selectionStart,end:t.selectionEnd};else e:{n=(n=t.ownerDocument)&&n.defaultView||window;var r=n.getSelection&&n.getSelection();if(r&&r.rangeCount!==0){n=r.anchorNode;var s=r.anchorOffset,i=r.focusNode;r=r.focusOffset;try{n.nodeType,i.nodeType}catch{n=null;break e}var o=0,a=-1,l=-1,c=0,u=0,h=t,p=null;t:for(;;){for(var f;h!==n||s!==0&&h.nodeType!==3||(a=o+s),h!==i||r!==0&&h.nodeType!==3||(l=o+r),h.nodeType===3&&(o+=h.nodeValue.length),(f=h.firstChild)!==null;)p=h,h=f;for(;;){if(h===t)break t;if(p===n&&++c===s&&(a=o),p===i&&++u===r&&(l=o),(f=h.nextSibling)!==null)break;h=p,p=h.parentNode}h=f}n=a===-1||l===-1?null:{start:a,end:l}}else n=null}n=n||{start:0,end:0}}else n=null;for(Yv={focusedElem:t,selectionRange:n},mf=!1,me=e;me!==null;)if(e=me,t=e.child,(e.subtreeFlags&1028)!==0&&t!==null)t.return=e,me=t;else for(;me!==null;){e=me;try{var v=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(v!==null){var m=v.memoizedProps,x=v.memoizedState,y=e.stateNode,S=y.getSnapshotBeforeUpdate(e.elementType===e.type?m:Es(e.type,m),x);y.__reactInternalSnapshotBeforeUpdate=S}break;case 3:var w=e.stateNode.containerInfo;w.nodeType===1?w.textContent="":w.nodeType===9&&w.documentElement&&w.removeChild(w.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(oe(163))}}catch(P){Ht(e,e.return,P)}if(t=e.sibling,t!==null){t.return=e.return,me=t;break}me=e.return}return v=B3,B3=!1,v}function hd(t,e,n){var r=e.updateQueue;if(r=r!==null?r.lastEffect:null,r!==null){var s=r=r.next;do{if((s.tag&t)===t){var i=s.destroy;s.destroy=void 0,i!==void 0&&d2(e,n,i)}s=s.next}while(s!==r)}}function Fg(t,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var n=e=e.next;do{if((n.tag&t)===t){var r=n.create;n.destroy=r()}n=n.next}while(n!==e)}}function h2(t){var e=t.ref;if(e!==null){var n=t.stateNode;switch(t.tag){case 5:t=n;break;default:t=n}typeof e=="function"?e(t):e.current=t}}function iP(t){var e=t.alternate;e!==null&&(t.alternate=null,iP(e)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(e=t.stateNode,e!==null&&(delete e[ri],delete e[Ld],delete e[Qv],delete e[lN],delete e[cN])),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}function oP(t){return t.tag===5||t.tag===3||t.tag===4}function U3(t){e:for(;;){for(;t.sibling===null;){if(t.return===null||oP(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(t.flags&2||t.child===null||t.tag===4)continue e;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function p2(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.nodeType===8?n.parentNode.insertBefore(t,e):n.insertBefore(t,e):(n.nodeType===8?(e=n.parentNode,e.insertBefore(t,n)):(e=n,e.appendChild(t)),n=n._reactRootContainer,n!=null||e.onclick!==null||(e.onclick=Sf));else if(r!==4&&(t=t.child,t!==null))for(p2(t,e,n),t=t.sibling;t!==null;)p2(t,e,n),t=t.sibling}function f2(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.insertBefore(t,e):n.appendChild(t);else if(r!==4&&(t=t.child,t!==null))for(f2(t,e,n),t=t.sibling;t!==null;)f2(t,e,n),t=t.sibling}var vn=null,Ts=!1;function ko(t,e,n){for(n=n.child;n!==null;)aP(t,e,n),n=n.sibling}function aP(t,e,n){if(hi&&typeof hi.onCommitFiberUnmount=="function")try{hi.onCommitFiberUnmount(Ag,n)}catch{}switch(n.tag){case 5:$n||ec(n,e);case 6:var r=vn,s=Ts;vn=null,ko(t,e,n),vn=r,Ts=s,vn!==null&&(Ts?(t=vn,n=n.stateNode,t.nodeType===8?t.parentNode.removeChild(n):t.removeChild(n)):vn.removeChild(n.stateNode));break;case 18:vn!==null&&(Ts?(t=vn,n=n.stateNode,t.nodeType===8?S1(t.parentNode,n):t.nodeType===1&&S1(t,n),Ad(t)):S1(vn,n.stateNode));break;case 4:r=vn,s=Ts,vn=n.stateNode.containerInfo,Ts=!0,ko(t,e,n),vn=r,Ts=s;break;case 0:case 11:case 14:case 15:if(!$n&&(r=n.updateQueue,r!==null&&(r=r.lastEffect,r!==null))){s=r=r.next;do{var i=s,o=i.destroy;i=i.tag,o!==void 0&&(i&2||i&4)&&d2(n,e,o),s=s.next}while(s!==r)}ko(t,e,n);break;case 1:if(!$n&&(ec(n,e),r=n.stateNode,typeof r.componentWillUnmount=="function"))try{r.props=n.memoizedProps,r.state=n.memoizedState,r.componentWillUnmount()}catch(a){Ht(n,e,a)}ko(t,e,n);break;case 21:ko(t,e,n);break;case 22:n.mode&1?($n=(r=$n)||n.memoizedState!==null,ko(t,e,n),$n=r):ko(t,e,n);break;default:ko(t,e,n)}}function H3(t){var e=t.updateQueue;if(e!==null){t.updateQueue=null;var n=t.stateNode;n===null&&(n=t.stateNode=new kN),e.forEach(function(r){var s=ON.bind(null,t,r);n.has(r)||(n.add(r),r.then(s,s))})}}function ks(t,e){var n=e.deletions;if(n!==null)for(var r=0;r<n.length;r++){var s=n[r];try{var i=t,o=e,a=o;e:for(;a!==null;){switch(a.tag){case 5:vn=a.stateNode,Ts=!1;break e;case 3:vn=a.stateNode.containerInfo,Ts=!0;break e;case 4:vn=a.stateNode.containerInfo,Ts=!0;break e}a=a.return}if(vn===null)throw Error(oe(160));aP(i,o,s),vn=null,Ts=!1;var l=s.alternate;l!==null&&(l.return=null),s.return=null}catch(c){Ht(s,e,c)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)lP(e,t),e=e.sibling}function lP(t,e){var n=t.alternate,r=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:if(ks(e,t),Xs(t),r&4){try{hd(3,t,t.return),Fg(3,t)}catch(m){Ht(t,t.return,m)}try{hd(5,t,t.return)}catch(m){Ht(t,t.return,m)}}break;case 1:ks(e,t),Xs(t),r&512&&n!==null&&ec(n,n.return);break;case 5:if(ks(e,t),Xs(t),r&512&&n!==null&&ec(n,n.return),t.flags&32){var s=t.stateNode;try{Ed(s,"")}catch(m){Ht(t,t.return,m)}}if(r&4&&(s=t.stateNode,s!=null)){var i=t.memoizedProps,o=n!==null?n.memoizedProps:i,a=t.type,l=t.updateQueue;if(t.updateQueue=null,l!==null)try{a==="input"&&i.type==="radio"&&i.name!=null&&_9(s,i),zv(a,o);var c=zv(a,i);for(o=0;o<l.length;o+=2){var u=l[o],h=l[o+1];u==="style"?O9(s,h):u==="dangerouslySetInnerHTML"?j9(s,h):u==="children"?Ed(s,h):YS(s,u,h,c)}switch(a){case"input":jv(s,i);break;case"textarea":A9(s,i);break;case"select":var p=s._wrapperState.wasMultiple;s._wrapperState.wasMultiple=!!i.multiple;var f=i.value;f!=null?dc(s,!!i.multiple,f,!1):p!==!!i.multiple&&(i.defaultValue!=null?dc(s,!!i.multiple,i.defaultValue,!0):dc(s,!!i.multiple,i.multiple?[]:"",!1))}s[Ld]=i}catch(m){Ht(t,t.return,m)}}break;case 6:if(ks(e,t),Xs(t),r&4){if(t.stateNode===null)throw Error(oe(162));s=t.stateNode,i=t.memoizedProps;try{s.nodeValue=i}catch(m){Ht(t,t.return,m)}}break;case 3:if(ks(e,t),Xs(t),r&4&&n!==null&&n.memoizedState.isDehydrated)try{Ad(e.containerInfo)}catch(m){Ht(t,t.return,m)}break;case 4:ks(e,t),Xs(t);break;case 13:ks(e,t),Xs(t),s=t.child,s.flags&8192&&(i=s.memoizedState!==null,s.stateNode.isHidden=i,!i||s.alternate!==null&&s.alternate.memoizedState!==null||(Tx=Gt())),r&4&&H3(t);break;case 22:if(u=n!==null&&n.memoizedState!==null,t.mode&1?($n=(c=$n)||u,ks(e,t),$n=c):ks(e,t),Xs(t),r&8192){if(c=t.memoizedState!==null,(t.stateNode.isHidden=c)&&!u&&t.mode&1)for(me=t,u=t.child;u!==null;){for(h=me=u;me!==null;){switch(p=me,f=p.child,p.tag){case 0:case 11:case 14:case 15:hd(4,p,p.return);break;case 1:ec(p,p.return);var v=p.stateNode;if(typeof v.componentWillUnmount=="function"){r=p,n=p.return;try{e=r,v.props=e.memoizedProps,v.state=e.memoizedState,v.componentWillUnmount()}catch(m){Ht(r,n,m)}}break;case 5:ec(p,p.return);break;case 22:if(p.memoizedState!==null){K3(h);continue}}f!==null?(f.return=p,me=f):K3(h)}u=u.sibling}e:for(u=null,h=t;;){if(h.tag===5){if(u===null){u=h;try{s=h.stateNode,c?(i=s.style,typeof i.setProperty=="function"?i.setProperty("display","none","important"):i.display="none"):(a=h.stateNode,l=h.memoizedProps.style,o=l!=null&&l.hasOwnProperty("display")?l.display:null,a.style.display=R9("display",o))}catch(m){Ht(t,t.return,m)}}}else if(h.tag===6){if(u===null)try{h.stateNode.nodeValue=c?"":h.memoizedProps}catch(m){Ht(t,t.return,m)}}else if((h.tag!==22&&h.tag!==23||h.memoizedState===null||h===t)&&h.child!==null){h.child.return=h,h=h.child;continue}if(h===t)break e;for(;h.sibling===null;){if(h.return===null||h.return===t)break e;u===h&&(u=null),h=h.return}u===h&&(u=null),h.sibling.return=h.return,h=h.sibling}}break;case 19:ks(e,t),Xs(t),r&4&&H3(t);break;case 21:break;default:ks(e,t),Xs(t)}}function Xs(t){var e=t.flags;if(e&2){try{e:{for(var n=t.return;n!==null;){if(oP(n)){var r=n;break e}n=n.return}throw Error(oe(160))}switch(r.tag){case 5:var s=r.stateNode;r.flags&32&&(Ed(s,""),r.flags&=-33);var i=U3(t);f2(t,i,s);break;case 3:case 4:var o=r.stateNode.containerInfo,a=U3(t);p2(t,a,o);break;default:throw Error(oe(161))}}catch(l){Ht(t,t.return,l)}t.flags&=-3}e&4096&&(t.flags&=-4097)}function EN(t,e,n){me=t,cP(t)}function cP(t,e,n){for(var r=(t.mode&1)!==0;me!==null;){var s=me,i=s.child;if(s.tag===22&&r){var o=s.memoizedState!==null||p0;if(!o){var a=s.alternate,l=a!==null&&a.memoizedState!==null||$n;a=p0;var c=$n;if(p0=o,($n=l)&&!c)for(me=s;me!==null;)o=me,l=o.child,o.tag===22&&o.memoizedState!==null?G3(s):l!==null?(l.return=o,me=l):G3(s);for(;i!==null;)me=i,cP(i),i=i.sibling;me=s,p0=a,$n=c}W3(t)}else s.subtreeFlags&8772&&i!==null?(i.return=s,me=i):W3(t)}}function W3(t){for(;me!==null;){var e=me;if(e.flags&8772){var n=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:$n||Fg(5,e);break;case 1:var r=e.stateNode;if(e.flags&4&&!$n)if(n===null)r.componentDidMount();else{var s=e.elementType===e.type?n.memoizedProps:Es(e.type,n.memoizedProps);r.componentDidUpdate(s,n.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var i=e.updateQueue;i!==null&&T3(e,i,r);break;case 3:var o=e.updateQueue;if(o!==null){if(n=null,e.child!==null)switch(e.child.tag){case 5:n=e.child.stateNode;break;case 1:n=e.child.stateNode}T3(e,o,n)}break;case 5:var a=e.stateNode;if(n===null&&e.flags&4){n=a;var l=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":l.autoFocus&&n.focus();break;case"img":l.src&&(n.src=l.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var c=e.alternate;if(c!==null){var u=c.memoizedState;if(u!==null){var h=u.dehydrated;h!==null&&Ad(h)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(oe(163))}$n||e.flags&512&&h2(e)}catch(p){Ht(e,e.return,p)}}if(e===t){me=null;break}if(n=e.sibling,n!==null){n.return=e.return,me=n;break}me=e.return}}function K3(t){for(;me!==null;){var e=me;if(e===t){me=null;break}var n=e.sibling;if(n!==null){n.return=e.return,me=n;break}me=e.return}}function G3(t){for(;me!==null;){var e=me;try{switch(e.tag){case 0:case 11:case 15:var n=e.return;try{Fg(4,e)}catch(l){Ht(e,n,l)}break;case 1:var r=e.stateNode;if(typeof r.componentDidMount=="function"){var s=e.return;try{r.componentDidMount()}catch(l){Ht(e,s,l)}}var i=e.return;try{h2(e)}catch(l){Ht(e,i,l)}break;case 5:var o=e.return;try{h2(e)}catch(l){Ht(e,o,l)}}}catch(l){Ht(e,e.return,l)}if(e===t){me=null;break}var a=e.sibling;if(a!==null){a.return=e.return,me=a;break}me=e.return}}var TN=Math.ceil,_f=ho.ReactCurrentDispatcher,Ix=ho.ReactCurrentOwner,ps=ho.ReactCurrentBatchConfig,Ze=0,pn=null,Zt=null,kn=0,Or=0,tc=ya(0),rn=0,Ud=null,nl=0,$g=0,Ex=0,pd=null,gr=null,Tx=0,_c=1/0,Ni=null,Af=!1,g2=null,Yo=null,f0=!1,zo=null,Df=0,fd=0,m2=null,Cp=-1,Pp=0;function Jn(){return Ze&6?Gt():Cp!==-1?Cp:Cp=Gt()}function Xo(t){return t.mode&1?Ze&2&&kn!==0?kn&-kn:dN.transition!==null?(Pp===0&&(Pp=V9()),Pp):(t=at,t!==0||(t=window.event,t=t===void 0?16:eC(t.type)),t):1}function Ns(t,e,n,r){if(50<fd)throw fd=0,m2=null,Error(oe(185));ph(t,n,r),(!(Ze&2)||t!==pn)&&(t===pn&&(!(Ze&2)&&($g|=n),rn===4&&Oo(t,kn)),kr(t,r),n===1&&Ze===0&&!(e.mode&1)&&(_c=Gt()+500,Lg&&va()))}function kr(t,e){var n=t.callbackNode;dL(t,e);var r=gf(t,t===pn?kn:0);if(r===0)n!==null&&t3(n),t.callbackNode=null,t.callbackPriority=0;else if(e=r&-r,t.callbackPriority!==e){if(n!=null&&t3(n),e===1)t.tag===0?uN(V3.bind(null,t)):SC(V3.bind(null,t)),oN(function(){!(Ze&6)&&va()}),n=null;else{switch(q9(r)){case 1:n=ex;break;case 4:n=K9;break;case 16:n=ff;break;case 536870912:n=G9;break;default:n=ff}n=yP(n,uP.bind(null,t))}t.callbackPriority=e,t.callbackNode=n}}function uP(t,e){if(Cp=-1,Pp=0,Ze&6)throw Error(oe(327));var n=t.callbackNode;if(mc()&&t.callbackNode!==n)return null;var r=gf(t,t===pn?kn:0);if(r===0)return null;if(r&30||r&t.expiredLanes||e)e=jf(t,r);else{e=r;var s=Ze;Ze|=2;var i=hP();(pn!==t||kn!==e)&&(Ni=null,_c=Gt()+500,qa(t,e));do try{AN();break}catch(a){dP(t,a)}while(!0);px(),_f.current=i,Ze=s,Zt!==null?e=0:(pn=null,kn=0,e=rn)}if(e!==0){if(e===2&&(s=Hv(t),s!==0&&(r=s,e=y2(t,s))),e===1)throw n=Ud,qa(t,0),Oo(t,r),kr(t,Gt()),n;if(e===6)Oo(t,r);else{if(s=t.current.alternate,!(r&30)&&!MN(s)&&(e=jf(t,r),e===2&&(i=Hv(t),i!==0&&(r=i,e=y2(t,i))),e===1))throw n=Ud,qa(t,0),Oo(t,r),kr(t,Gt()),n;switch(t.finishedWork=s,t.finishedLanes=r,e){case 0:case 1:throw Error(oe(345));case 2:$a(t,gr,Ni);break;case 3:if(Oo(t,r),(r&130023424)===r&&(e=Tx+500-Gt(),10<e)){if(gf(t,0)!==0)break;if(s=t.suspendedLanes,(s&r)!==r){Jn(),t.pingedLanes|=t.suspendedLanes&s;break}t.timeoutHandle=Zv($a.bind(null,t,gr,Ni),e);break}$a(t,gr,Ni);break;case 4:if(Oo(t,r),(r&4194240)===r)break;for(e=t.eventTimes,s=-1;0<r;){var o=31-Ls(r);i=1<<o,o=e[o],o>s&&(s=o),r&=~i}if(r=s,r=Gt()-r,r=(120>r?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*TN(r/1960))-r,10<r){t.timeoutHandle=Zv($a.bind(null,t,gr,Ni),r);break}$a(t,gr,Ni);break;case 5:$a(t,gr,Ni);break;default:throw Error(oe(329))}}}return kr(t,Gt()),t.callbackNode===n?uP.bind(null,t):null}function y2(t,e){var n=pd;return t.current.memoizedState.isDehydrated&&(qa(t,e).flags|=256),t=jf(t,e),t!==2&&(e=gr,gr=n,e!==null&&v2(e)),t}function v2(t){gr===null?gr=t:gr.push.apply(gr,t)}function MN(t){for(var e=t;;){if(e.flags&16384){var n=e.updateQueue;if(n!==null&&(n=n.stores,n!==null))for(var r=0;r<n.length;r++){var s=n[r],i=s.getSnapshot;s=s.value;try{if(!Fs(i(),s))return!1}catch{return!1}}}if(n=e.child,e.subtreeFlags&16384&&n!==null)n.return=e,e=n;else{if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function Oo(t,e){for(e&=~Ex,e&=~$g,t.suspendedLanes|=e,t.pingedLanes&=~e,t=t.expirationTimes;0<e;){var n=31-Ls(e),r=1<<n;t[n]=-1,e&=~r}}function V3(t){if(Ze&6)throw Error(oe(327));mc();var e=gf(t,0);if(!(e&1))return kr(t,Gt()),null;var n=jf(t,e);if(t.tag!==0&&n===2){var r=Hv(t);r!==0&&(e=r,n=y2(t,r))}if(n===1)throw n=Ud,qa(t,0),Oo(t,e),kr(t,Gt()),n;if(n===6)throw Error(oe(345));return t.finishedWork=t.current.alternate,t.finishedLanes=e,$a(t,gr,Ni),kr(t,Gt()),null}function Mx(t,e){var n=Ze;Ze|=1;try{return t(e)}finally{Ze=n,Ze===0&&(_c=Gt()+500,Lg&&va())}}function rl(t){zo!==null&&zo.tag===0&&!(Ze&6)&&mc();var e=Ze;Ze|=1;var n=ps.transition,r=at;try{if(ps.transition=null,at=1,t)return t()}finally{at=r,ps.transition=n,Ze=e,!(Ze&6)&&va()}}function _x(){Or=tc.current,It(tc)}function qa(t,e){t.finishedWork=null,t.finishedLanes=0;var n=t.timeoutHandle;if(n!==-1&&(t.timeoutHandle=-1,iN(n)),Zt!==null)for(n=Zt.return;n!==null;){var r=n;switch(ux(r),r.tag){case 1:r=r.type.childContextTypes,r!=null&&xf();break;case 3:Tc(),It(Cr),It(Wn),Sx();break;case 5:vx(r);break;case 4:Tc();break;case 13:It(Ot);break;case 19:It(Ot);break;case 10:fx(r.type._context);break;case 22:case 23:_x()}n=n.return}if(pn=t,Zt=t=Zo(t.current,null),kn=Or=e,rn=0,Ud=null,Ex=$g=nl=0,gr=pd=null,Wa!==null){for(e=0;e<Wa.length;e++)if(n=Wa[e],r=n.interleaved,r!==null){n.interleaved=null;var s=r.next,i=n.pending;if(i!==null){var o=i.next;i.next=s,r.next=o}n.pending=r}Wa=null}return t}function dP(t,e){do{var n=Zt;try{if(px(),xp.current=Mf,Tf){for(var r=Ft.memoizedState;r!==null;){var s=r.queue;s!==null&&(s.pending=null),r=r.next}Tf=!1}if(tl=0,un=nn=Ft=null,dd=!1,Fd=0,Ix.current=null,n===null||n.return===null){rn=1,Ud=e,Zt=null;break}e:{var i=t,o=n.return,a=n,l=e;if(e=kn,a.flags|=32768,l!==null&&typeof l=="object"&&typeof l.then=="function"){var c=l,u=a,h=u.tag;if(!(u.mode&1)&&(h===0||h===11||h===15)){var p=u.alternate;p?(u.updateQueue=p.updateQueue,u.memoizedState=p.memoizedState,u.lanes=p.lanes):(u.updateQueue=null,u.memoizedState=null)}var f=R3(o);if(f!==null){f.flags&=-257,O3(f,o,a,i,e),f.mode&1&&j3(i,c,e),e=f,l=c;var v=e.updateQueue;if(v===null){var m=new Set;m.add(l),e.updateQueue=m}else v.add(l);break e}else{if(!(e&1)){j3(i,c,e),Ax();break e}l=Error(oe(426))}}else if(Mt&&a.mode&1){var x=R3(o);if(x!==null){!(x.flags&65536)&&(x.flags|=256),O3(x,o,a,i,e),dx(Mc(l,a));break e}}i=l=Mc(l,a),rn!==4&&(rn=2),pd===null?pd=[i]:pd.push(i),i=o;do{switch(i.tag){case 3:i.flags|=65536,e&=-e,i.lanes|=e;var y=qC(i,l,e);E3(i,y);break e;case 1:a=l;var S=i.type,w=i.stateNode;if(!(i.flags&128)&&(typeof S.getDerivedStateFromError=="function"||w!==null&&typeof w.componentDidCatch=="function"&&(Yo===null||!Yo.has(w)))){i.flags|=65536,e&=-e,i.lanes|=e;var P=YC(i,a,e);E3(i,P);break e}}i=i.return}while(i!==null)}fP(n)}catch(E){e=E,Zt===n&&n!==null&&(Zt=n=n.return);continue}break}while(!0)}function hP(){var t=_f.current;return _f.current=Mf,t===null?Mf:t}function Ax(){(rn===0||rn===3||rn===2)&&(rn=4),pn===null||!(nl&268435455)&&!($g&268435455)||Oo(pn,kn)}function jf(t,e){var n=Ze;Ze|=2;var r=hP();(pn!==t||kn!==e)&&(Ni=null,qa(t,e));do try{_N();break}catch(s){dP(t,s)}while(!0);if(px(),Ze=n,_f.current=r,Zt!==null)throw Error(oe(261));return pn=null,kn=0,rn}function _N(){for(;Zt!==null;)pP(Zt)}function AN(){for(;Zt!==null&&!nL();)pP(Zt)}function pP(t){var e=mP(t.alternate,t,Or);t.memoizedProps=t.pendingProps,e===null?fP(t):Zt=e,Ix.current=null}function fP(t){var e=t;do{var n=e.alternate;if(t=e.return,e.flags&32768){if(n=PN(n,e),n!==null){n.flags&=32767,Zt=n;return}if(t!==null)t.flags|=32768,t.subtreeFlags=0,t.deletions=null;else{rn=6,Zt=null;return}}else if(n=CN(n,e,Or),n!==null){Zt=n;return}if(e=e.sibling,e!==null){Zt=e;return}Zt=e=t}while(e!==null);rn===0&&(rn=5)}function $a(t,e,n){var r=at,s=ps.transition;try{ps.transition=null,at=1,DN(t,e,n,r)}finally{ps.transition=s,at=r}return null}function DN(t,e,n,r){do mc();while(zo!==null);if(Ze&6)throw Error(oe(327));n=t.finishedWork;var s=t.finishedLanes;if(n===null)return null;if(t.finishedWork=null,t.finishedLanes=0,n===t.current)throw Error(oe(177));t.callbackNode=null,t.callbackPriority=0;var i=n.lanes|n.childLanes;if(hL(t,i),t===pn&&(Zt=pn=null,kn=0),!(n.subtreeFlags&2064)&&!(n.flags&2064)||f0||(f0=!0,yP(ff,function(){return mc(),null})),i=(n.flags&15990)!==0,n.subtreeFlags&15990||i){i=ps.transition,ps.transition=null;var o=at;at=1;var a=Ze;Ze|=4,Ix.current=null,IN(t,n),lP(n,t),QL(Yv),mf=!!qv,Yv=qv=null,t.current=n,EN(n),rL(),Ze=a,at=o,ps.transition=i}else t.current=n;if(f0&&(f0=!1,zo=t,Df=s),i=t.pendingLanes,i===0&&(Yo=null),oL(n.stateNode),kr(t,Gt()),e!==null)for(r=t.onRecoverableError,n=0;n<e.length;n++)s=e[n],r(s.value,{componentStack:s.stack,digest:s.digest});if(Af)throw Af=!1,t=g2,g2=null,t;return Df&1&&t.tag!==0&&mc(),i=t.pendingLanes,i&1?t===m2?fd++:(fd=0,m2=t):fd=0,va(),null}function mc(){if(zo!==null){var t=q9(Df),e=ps.transition,n=at;try{if(ps.transition=null,at=16>t?16:t,zo===null)var r=!1;else{if(t=zo,zo=null,Df=0,Ze&6)throw Error(oe(331));var s=Ze;for(Ze|=4,me=t.current;me!==null;){var i=me,o=i.child;if(me.flags&16){var a=i.deletions;if(a!==null){for(var l=0;l<a.length;l++){var c=a[l];for(me=c;me!==null;){var u=me;switch(u.tag){case 0:case 11:case 15:hd(8,u,i)}var h=u.child;if(h!==null)h.return=u,me=h;else for(;me!==null;){u=me;var p=u.sibling,f=u.return;if(iP(u),u===c){me=null;break}if(p!==null){p.return=f,me=p;break}me=f}}}var v=i.alternate;if(v!==null){var m=v.child;if(m!==null){v.child=null;do{var x=m.sibling;m.sibling=null,m=x}while(m!==null)}}me=i}}if(i.subtreeFlags&2064&&o!==null)o.return=i,me=o;else e:for(;me!==null;){if(i=me,i.flags&2048)switch(i.tag){case 0:case 11:case 15:hd(9,i,i.return)}var y=i.sibling;if(y!==null){y.return=i.return,me=y;break e}me=i.return}}var S=t.current;for(me=S;me!==null;){o=me;var w=o.child;if(o.subtreeFlags&2064&&w!==null)w.return=o,me=w;else e:for(o=S;me!==null;){if(a=me,a.flags&2048)try{switch(a.tag){case 0:case 11:case 15:Fg(9,a)}}catch(E){Ht(a,a.return,E)}if(a===o){me=null;break e}var P=a.sibling;if(P!==null){P.return=a.return,me=P;break e}me=a.return}}if(Ze=s,va(),hi&&typeof hi.onPostCommitFiberRoot=="function")try{hi.onPostCommitFiberRoot(Ag,t)}catch{}r=!0}return r}finally{at=n,ps.transition=e}}return!1}function q3(t,e,n){e=Mc(n,e),e=qC(t,e,1),t=qo(t,e,1),e=Jn(),t!==null&&(ph(t,1,e),kr(t,e))}function Ht(t,e,n){if(t.tag===3)q3(t,t,n);else for(;e!==null;){if(e.tag===3){q3(e,t,n);break}else if(e.tag===1){var r=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof r.componentDidCatch=="function"&&(Yo===null||!Yo.has(r))){t=Mc(n,t),t=YC(e,t,1),e=qo(e,t,1),t=Jn(),e!==null&&(ph(e,1,t),kr(e,t));break}}e=e.return}}function jN(t,e,n){var r=t.pingCache;r!==null&&r.delete(e),e=Jn(),t.pingedLanes|=t.suspendedLanes&n,pn===t&&(kn&n)===n&&(rn===4||rn===3&&(kn&130023424)===kn&&500>Gt()-Tx?qa(t,0):Ex|=n),kr(t,e)}function gP(t,e){e===0&&(t.mode&1?(e=s0,s0<<=1,!(s0&130023424)&&(s0=4194304)):e=1);var n=Jn();t=no(t,e),t!==null&&(ph(t,e,n),kr(t,n))}function RN(t){var e=t.memoizedState,n=0;e!==null&&(n=e.retryLane),gP(t,n)}function ON(t,e){var n=0;switch(t.tag){case 13:var r=t.stateNode,s=t.memoizedState;s!==null&&(n=s.retryLane);break;case 19:r=t.stateNode;break;default:throw Error(oe(314))}r!==null&&r.delete(e),gP(t,n)}var mP;mP=function(t,e,n){if(t!==null)if(t.memoizedProps!==e.pendingProps||Cr.current)Sr=!0;else{if(!(t.lanes&n)&&!(e.flags&128))return Sr=!1,bN(t,e,n);Sr=!!(t.flags&131072)}else Sr=!1,Mt&&e.flags&1048576&&xC(e,Cf,e.index);switch(e.lanes=0,e.tag){case 2:var r=e.type;bp(t,e),t=e.pendingProps;var s=kc(e,Wn.current);gc(e,n),s=wx(null,e,r,t,s,n);var i=bx();return e.flags|=1,typeof s=="object"&&s!==null&&typeof s.render=="function"&&s.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,Pr(r)?(i=!0,wf(e)):i=!1,e.memoizedState=s.state!==null&&s.state!==void 0?s.state:null,mx(e),s.updater=zg,e.stateNode=s,s._reactInternals=e,s2(e,r,t,n),e=a2(null,e,r,!0,i,n)):(e.tag=0,Mt&&i&&cx(e),Zn(null,e,s,n),e=e.child),e;case 16:r=e.elementType;e:{switch(bp(t,e),t=e.pendingProps,s=r._init,r=s(r._payload),e.type=r,s=e.tag=NN(r),t=Es(r,t),s){case 0:e=o2(null,e,r,t,n);break e;case 1:e=z3(null,e,r,t,n);break e;case 11:e=L3(null,e,r,t,n);break e;case 14:e=N3(null,e,r,Es(r.type,t),n);break e}throw Error(oe(306,r,""))}return e;case 0:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:Es(r,s),o2(t,e,r,s,n);case 1:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:Es(r,s),z3(t,e,r,s,n);case 3:e:{if(JC(e),t===null)throw Error(oe(387));r=e.pendingProps,i=e.memoizedState,s=i.element,IC(t,e),If(e,r,null,n);var o=e.memoizedState;if(r=o.element,i.isDehydrated)if(i={element:r,isDehydrated:!1,cache:o.cache,pendingSuspenseBoundaries:o.pendingSuspenseBoundaries,transitions:o.transitions},e.updateQueue.baseState=i,e.memoizedState=i,e.flags&256){s=Mc(Error(oe(423)),e),e=F3(t,e,r,n,s);break e}else if(r!==s){s=Mc(Error(oe(424)),e),e=F3(t,e,r,n,s);break e}else for($r=Vo(e.stateNode.containerInfo.firstChild),Br=e,Mt=!0,As=null,n=PC(e,null,r,n),e.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling;else{if(Ic(),r===s){e=ro(t,e,n);break e}Zn(t,e,r,n)}e=e.child}return e;case 5:return EC(e),t===null&&t2(e),r=e.type,s=e.pendingProps,i=t!==null?t.memoizedProps:null,o=s.children,Xv(r,s)?o=null:i!==null&&Xv(r,i)&&(e.flags|=32),QC(t,e),Zn(t,e,o,n),e.child;case 6:return t===null&&t2(e),null;case 13:return eP(t,e,n);case 4:return yx(e,e.stateNode.containerInfo),r=e.pendingProps,t===null?e.child=Ec(e,null,r,n):Zn(t,e,r,n),e.child;case 11:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:Es(r,s),L3(t,e,r,s,n);case 7:return Zn(t,e,e.pendingProps,n),e.child;case 8:return Zn(t,e,e.pendingProps.children,n),e.child;case 12:return Zn(t,e,e.pendingProps.children,n),e.child;case 10:e:{if(r=e.type._context,s=e.pendingProps,i=e.memoizedProps,o=s.value,mt(Pf,r._currentValue),r._currentValue=o,i!==null)if(Fs(i.value,o)){if(i.children===s.children&&!Cr.current){e=ro(t,e,n);break e}}else for(i=e.child,i!==null&&(i.return=e);i!==null;){var a=i.dependencies;if(a!==null){o=i.child;for(var l=a.firstContext;l!==null;){if(l.context===r){if(i.tag===1){l=Vi(-1,n&-n),l.tag=2;var c=i.updateQueue;if(c!==null){c=c.shared;var u=c.pending;u===null?l.next=l:(l.next=u.next,u.next=l),c.pending=l}}i.lanes|=n,l=i.alternate,l!==null&&(l.lanes|=n),n2(i.return,n,e),a.lanes|=n;break}l=l.next}}else if(i.tag===10)o=i.type===e.type?null:i.child;else if(i.tag===18){if(o=i.return,o===null)throw Error(oe(341));o.lanes|=n,a=o.alternate,a!==null&&(a.lanes|=n),n2(o,n,e),o=i.sibling}else o=i.child;if(o!==null)o.return=i;else for(o=i;o!==null;){if(o===e){o=null;break}if(i=o.sibling,i!==null){i.return=o.return,o=i;break}o=o.return}i=o}Zn(t,e,s.children,n),e=e.child}return e;case 9:return s=e.type,r=e.pendingProps.children,gc(e,n),s=ys(s),r=r(s),e.flags|=1,Zn(t,e,r,n),e.child;case 14:return r=e.type,s=Es(r,e.pendingProps),s=Es(r.type,s),N3(t,e,r,s,n);case 15:return XC(t,e,e.type,e.pendingProps,n);case 17:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:Es(r,s),bp(t,e),e.tag=1,Pr(r)?(t=!0,wf(e)):t=!1,gc(e,n),VC(e,r,s),s2(e,r,s,n),a2(null,e,r,!0,t,n);case 19:return tP(t,e,n);case 22:return ZC(t,e,n)}throw Error(oe(156,e.tag))};function yP(t,e){return W9(t,e)}function LN(t,e,n,r){this.tag=t,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function cs(t,e,n,r){return new LN(t,e,n,r)}function Dx(t){return t=t.prototype,!(!t||!t.isReactComponent)}function NN(t){if(typeof t=="function")return Dx(t)?1:0;if(t!=null){if(t=t.$$typeof,t===ZS)return 11;if(t===QS)return 14}return 2}function Zo(t,e){var n=t.alternate;return n===null?(n=cs(t.tag,e,t.key,t.mode),n.elementType=t.elementType,n.type=t.type,n.stateNode=t.stateNode,n.alternate=t,t.alternate=n):(n.pendingProps=e,n.type=t.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=t.flags&14680064,n.childLanes=t.childLanes,n.lanes=t.lanes,n.child=t.child,n.memoizedProps=t.memoizedProps,n.memoizedState=t.memoizedState,n.updateQueue=t.updateQueue,e=t.dependencies,n.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},n.sibling=t.sibling,n.index=t.index,n.ref=t.ref,n}function kp(t,e,n,r,s,i){var o=2;if(r=t,typeof t=="function")Dx(t)&&(o=1);else if(typeof t=="string")o=5;else e:switch(t){case Kl:return Ya(n.children,s,i,e);case XS:o=8,s|=8;break;case Tv:return t=cs(12,n,e,s|2),t.elementType=Tv,t.lanes=i,t;case Mv:return t=cs(13,n,e,s),t.elementType=Mv,t.lanes=i,t;case _v:return t=cs(19,n,e,s),t.elementType=_v,t.lanes=i,t;case E9:return Bg(n,s,i,e);default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case k9:o=10;break e;case I9:o=9;break e;case ZS:o=11;break e;case QS:o=14;break e;case Do:o=16,r=null;break e}throw Error(oe(130,t==null?t:typeof t,""))}return e=cs(o,n,e,s),e.elementType=t,e.type=r,e.lanes=i,e}function Ya(t,e,n,r){return t=cs(7,t,r,e),t.lanes=n,t}function Bg(t,e,n,r){return t=cs(22,t,r,e),t.elementType=E9,t.lanes=n,t.stateNode={isHidden:!1},t}function E1(t,e,n){return t=cs(6,t,null,e),t.lanes=n,t}function T1(t,e,n){return e=cs(4,t.children!==null?t.children:[],t.key,e),e.lanes=n,e.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},e}function zN(t,e,n,r,s){this.tag=e,this.containerInfo=t,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=l1(0),this.expirationTimes=l1(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=l1(0),this.identifierPrefix=r,this.onRecoverableError=s,this.mutableSourceEagerHydrationData=null}function jx(t,e,n,r,s,i,o,a,l){return t=new zN(t,e,n,a,l),e===1?(e=1,i===!0&&(e|=8)):e=0,i=cs(3,null,null,e),t.current=i,i.stateNode=t,i.memoizedState={element:r,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},mx(i),t}function FN(t,e,n){var r=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:Wl,key:r==null?null:""+r,children:t,containerInfo:e,implementation:n}}function vP(t){if(!t)return ra;t=t._reactInternals;e:{if(Sl(t)!==t||t.tag!==1)throw Error(oe(170));var e=t;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(Pr(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(oe(171))}if(t.tag===1){var n=t.type;if(Pr(n))return vC(t,n,e)}return e}function SP(t,e,n,r,s,i,o,a,l){return t=jx(n,r,!0,t,s,i,o,a,l),t.context=vP(null),n=t.current,r=Jn(),s=Xo(n),i=Vi(r,s),i.callback=e??null,qo(n,i,s),t.current.lanes=s,ph(t,s,r),kr(t,r),t}function Ug(t,e,n,r){var s=e.current,i=Jn(),o=Xo(s);return n=vP(n),e.context===null?e.context=n:e.pendingContext=n,e=Vi(i,o),e.payload={element:t},r=r===void 0?null:r,r!==null&&(e.callback=r),t=qo(s,e,o),t!==null&&(Ns(t,s,o,i),Sp(t,s,o)),o}function Rf(t){if(t=t.current,!t.child)return null;switch(t.child.tag){case 5:return t.child.stateNode;default:return t.child.stateNode}}function Y3(t,e){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var n=t.retryLane;t.retryLane=n!==0&&n<e?n:e}}function Rx(t,e){Y3(t,e),(t=t.alternate)&&Y3(t,e)}function $N(){return null}var xP=typeof reportError=="function"?reportError:function(t){console.error(t)};function Ox(t){this._internalRoot=t}Hg.prototype.render=Ox.prototype.render=function(t){var e=this._internalRoot;if(e===null)throw Error(oe(409));Ug(t,e,null,null)};Hg.prototype.unmount=Ox.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var e=t.containerInfo;rl(function(){Ug(null,t,null,null)}),e[to]=null}};function Hg(t){this._internalRoot=t}Hg.prototype.unstable_scheduleHydration=function(t){if(t){var e=Z9();t={blockedOn:null,target:t,priority:e};for(var n=0;n<Ro.length&&e!==0&&e<Ro[n].priority;n++);Ro.splice(n,0,t),n===0&&J9(t)}};function Lx(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}function Wg(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11&&(t.nodeType!==8||t.nodeValue!==" react-mount-point-unstable "))}function X3(){}function BN(t,e,n,r,s){if(s){if(typeof r=="function"){var i=r;r=function(){var c=Rf(o);i.call(c)}}var o=SP(e,r,t,0,null,!1,!1,"",X3);return t._reactRootContainer=o,t[to]=o.current,Rd(t.nodeType===8?t.parentNode:t),rl(),o}for(;s=t.lastChild;)t.removeChild(s);if(typeof r=="function"){var a=r;r=function(){var c=Rf(l);a.call(c)}}var l=jx(t,0,!1,null,null,!1,!1,"",X3);return t._reactRootContainer=l,t[to]=l.current,Rd(t.nodeType===8?t.parentNode:t),rl(function(){Ug(e,l,n,r)}),l}function Kg(t,e,n,r,s){var i=n._reactRootContainer;if(i){var o=i;if(typeof s=="function"){var a=s;s=function(){var l=Rf(o);a.call(l)}}Ug(e,o,t,s)}else o=BN(n,e,t,s,r);return Rf(o)}Y9=function(t){switch(t.tag){case 3:var e=t.stateNode;if(e.current.memoizedState.isDehydrated){var n=Fu(e.pendingLanes);n!==0&&(tx(e,n|1),kr(e,Gt()),!(Ze&6)&&(_c=Gt()+500,va()))}break;case 13:rl(function(){var r=no(t,1);if(r!==null){var s=Jn();Ns(r,t,1,s)}}),Rx(t,1)}};nx=function(t){if(t.tag===13){var e=no(t,134217728);if(e!==null){var n=Jn();Ns(e,t,134217728,n)}Rx(t,134217728)}};X9=function(t){if(t.tag===13){var e=Xo(t),n=no(t,e);if(n!==null){var r=Jn();Ns(n,t,e,r)}Rx(t,e)}};Z9=function(){return at};Q9=function(t,e){var n=at;try{return at=t,e()}finally{at=n}};$v=function(t,e,n){switch(e){case"input":if(jv(t,n),e=n.name,n.type==="radio"&&e!=null){for(n=t;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<n.length;e++){var r=n[e];if(r!==t&&r.form===t.form){var s=Og(r);if(!s)throw Error(oe(90));M9(r),jv(r,s)}}}break;case"textarea":A9(t,n);break;case"select":e=n.value,e!=null&&dc(t,!!n.multiple,e,!1)}};z9=Mx;F9=rl;var UN={usingClientEntryPoint:!1,Events:[gh,Yl,Og,L9,N9,Mx]},vu={findFiberByHostInstance:Ha,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},HN={bundleType:vu.bundleType,version:vu.version,rendererPackageName:vu.rendererPackageName,rendererConfig:vu.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:ho.ReactCurrentDispatcher,findHostInstanceByFiber:function(t){return t=U9(t),t===null?null:t.stateNode},findFiberByHostInstance:vu.findFiberByHostInstance||$N,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var g0=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!g0.isDisabled&&g0.supportsFiber)try{Ag=g0.inject(HN),hi=g0}catch{}}Yr.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=UN;Yr.createPortal=function(t,e){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!Lx(e))throw Error(oe(200));return FN(t,e,null,n)};Yr.createRoot=function(t,e){if(!Lx(t))throw Error(oe(299));var n=!1,r="",s=xP;return e!=null&&(e.unstable_strictMode===!0&&(n=!0),e.identifierPrefix!==void 0&&(r=e.identifierPrefix),e.onRecoverableError!==void 0&&(s=e.onRecoverableError)),e=jx(t,1,!1,null,null,n,!1,r,s),t[to]=e.current,Rd(t.nodeType===8?t.parentNode:t),new Ox(e)};Yr.findDOMNode=function(t){if(t==null)return null;if(t.nodeType===1)return t;var e=t._reactInternals;if(e===void 0)throw typeof t.render=="function"?Error(oe(188)):(t=Object.keys(t).join(","),Error(oe(268,t)));return t=U9(e),t=t===null?null:t.stateNode,t};Yr.flushSync=function(t){return rl(t)};Yr.hydrate=function(t,e,n){if(!Wg(e))throw Error(oe(200));return Kg(null,t,e,!0,n)};Yr.hydrateRoot=function(t,e,n){if(!Lx(t))throw Error(oe(405));var r=n!=null&&n.hydratedSources||null,s=!1,i="",o=xP;if(n!=null&&(n.unstable_strictMode===!0&&(s=!0),n.identifierPrefix!==void 0&&(i=n.identifierPrefix),n.onRecoverableError!==void 0&&(o=n.onRecoverableError)),e=SP(e,null,t,1,n??null,s,!1,i,o),t[to]=e.current,Rd(t),r)for(t=0;t<r.length;t++)n=r[t],s=n._getVersion,s=s(n._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[n,s]:e.mutableSourceEagerHydrationData.push(n,s);return new Hg(e)};Yr.render=function(t,e,n){if(!Wg(e))throw Error(oe(200));return Kg(null,t,e,!1,n)};Yr.unmountComponentAtNode=function(t){if(!Wg(t))throw Error(oe(40));return t._reactRootContainer?(rl(function(){Kg(null,null,t,!1,function(){t._reactRootContainer=null,t[to]=null})}),!0):!1};Yr.unstable_batchedUpdates=Mx;Yr.unstable_renderSubtreeIntoContainer=function(t,e,n,r){if(!Wg(n))throw Error(oe(200));if(t==null||t._reactInternals===void 0)throw Error(oe(38));return Kg(t,e,n,!1,r)};Yr.version="18.3.1-next-f1338f8080-20240426";function wP(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(wP)}catch(t){console.error(t)}}wP(),w9.exports=Yr;var xl=w9.exports;const WN=ga(xl);var bP,Z3=xl;bP=Iv.createRoot=Z3.createRoot,Iv.hydrateRoot=Z3.hydrateRoot;var Su=function(t){return t&&t.Math===Math&&t},nr=Su(typeof globalThis=="object"&&globalThis)||Su(typeof window=="object"&&window)||Su(typeof self=="object"&&self)||Su(typeof Hn=="object"&&Hn)||Su(typeof Hn=="object"&&Hn)||function(){return this}()||Function("return this")(),Nx={},rr=function(t){try{return!!t()}catch{return!0}},KN=rr,Sa=!KN(function(){return Object.defineProperty({},1,{get:function(){return 7}})[1]!==7}),GN=rr,Gg=!GN(function(){var t=(function(){}).bind();return typeof t!="function"||t.hasOwnProperty("prototype")}),VN=Gg,m0=Function.prototype.call,po=VN?m0.bind(m0):function(){return m0.apply(m0,arguments)},CP={},PP={}.propertyIsEnumerable,kP=Object.getOwnPropertyDescriptor,qN=kP&&!PP.call({1:2},1);CP.f=qN?function(e){var n=kP(this,e);return!!n&&n.enumerable}:PP;var IP=function(t,e){return{enumerable:!(t&1),configurable:!(t&2),writable:!(t&4),value:e}},EP=Gg,TP=Function.prototype,S2=TP.call,YN=EP&&TP.bind.bind(S2,S2),fn=EP?YN:function(t){return function(){return S2.apply(t,arguments)}},MP=fn,XN=MP({}.toString),ZN=MP("".slice),Gc=function(t){return ZN(XN(t),8,-1)},QN=fn,JN=rr,ez=Gc,M1=Object,tz=QN("".split),nz=JN(function(){return!M1("z").propertyIsEnumerable(0)})?function(t){return ez(t)==="String"?tz(t,""):M1(t)}:M1,Vg=function(t){return t==null},rz=Vg,sz=TypeError,Vc=function(t){if(rz(t))throw new sz("Can't call method on "+t);return t},iz=nz,oz=Vc,qg=function(t){return iz(oz(t))},_1=typeof document=="object"&&document.all,sr=typeof _1>"u"&&_1!==void 0?function(t){return typeof t=="function"||t===_1}:function(t){return typeof t=="function"},az=sr,wl=function(t){return typeof t=="object"?t!==null:az(t)},A1=nr,lz=sr,cz=function(t){return lz(t)?t:void 0},Yg=function(t,e){return arguments.length<2?cz(A1[t]):A1[t]&&A1[t][e]},uz=fn,_P=uz({}.isPrototypeOf),dz=nr,Q3=dz.navigator,J3=Q3&&Q3.userAgent,hz=J3?String(J3):"",AP=nr,D1=hz,e5=AP.process,t5=AP.Deno,n5=e5&&e5.versions||t5&&t5.version,r5=n5&&n5.v8,Ds,Of;r5&&(Ds=r5.split("."),Of=Ds[0]>0&&Ds[0]<4?1:+(Ds[0]+Ds[1]));!Of&&D1&&(Ds=D1.match(/Edge\/(\d+)/),(!Ds||Ds[1]>=74)&&(Ds=D1.match(/Chrome\/(\d+)/),Ds&&(Of=+Ds[1])));var pz=Of,s5=pz,fz=rr,gz=nr,mz=gz.String,DP=!!Object.getOwnPropertySymbols&&!fz(function(){var t=Symbol("symbol detection");return!mz(t)||!(Object(t)instanceof Symbol)||!Symbol.sham&&s5&&s5<41}),yz=DP,jP=yz&&!Symbol.sham&&typeof Symbol.iterator=="symbol",vz=Yg,Sz=sr,xz=_P,wz=jP,bz=Object,RP=wz?function(t){return typeof t=="symbol"}:function(t){var e=vz("Symbol");return Sz(e)&&xz(e.prototype,bz(t))},Cz=String,Pz=function(t){try{return Cz(t)}catch{return"Object"}},kz=sr,Iz=Pz,Ez=TypeError,zx=function(t){if(kz(t))return t;throw new Ez(Iz(t)+" is not a function")},Tz=zx,Mz=Vg,Fx=function(t,e){var n=t[e];return Mz(n)?void 0:Tz(n)},j1=po,R1=sr,O1=wl,_z=TypeError,Az=function(t,e){var n,r;if(e==="string"&&R1(n=t.toString)&&!O1(r=j1(n,t))||R1(n=t.valueOf)&&!O1(r=j1(n,t))||e!=="string"&&R1(n=t.toString)&&!O1(r=j1(n,t)))return r;throw new _z("Can't convert object to primitive value")},OP={exports:{}},i5=nr,Dz=Object.defineProperty,$x=function(t,e){try{Dz(i5,t,{value:e,configurable:!0,writable:!0})}catch{i5[t]=e}return e},jz=nr,Rz=$x,o5="__core-js_shared__",a5=OP.exports=jz[o5]||Rz(o5,{});(a5.versions||(a5.versions=[])).push({version:"3.38.1",mode:"global",copyright:"© 2014-2024 Denis Pushkarev (zloirock.ru)",license:"https://github.com/zloirock/core-js/blob/v3.38.1/LICENSE",source:"https://github.com/zloirock/core-js"});var Bx=OP.exports,l5=Bx,Ux=function(t,e){return l5[t]||(l5[t]=e||{})},Oz=Vc,Lz=Object,yh=function(t){return Lz(Oz(t))},Nz=fn,zz=yh,Fz=Nz({}.hasOwnProperty),xa=Object.hasOwn||function(e,n){return Fz(zz(e),n)},$z=fn,Bz=0,Uz=Math.random(),Hz=$z(1 .toString),LP=function(t){return"Symbol("+(t===void 0?"":t)+")_"+Hz(++Bz+Uz,36)},Wz=nr,Kz=Ux,c5=xa,Gz=LP,Vz=DP,qz=jP,nc=Wz.Symbol,L1=Kz("wks"),Yz=qz?nc.for||nc:nc&&nc.withoutSetter||Gz,fo=function(t){return c5(L1,t)||(L1[t]=Vz&&c5(nc,t)?nc[t]:Yz("Symbol."+t)),L1[t]},Xz=po,u5=wl,d5=RP,Zz=Fx,Qz=Az,Jz=fo,eF=TypeError,tF=Jz("toPrimitive"),nF=function(t,e){if(!u5(t)||d5(t))return t;var n=Zz(t,tF),r;if(n){if(e===void 0&&(e="default"),r=Xz(n,t,e),!u5(r)||d5(r))return r;throw new eF("Can't convert object to primitive value")}return e===void 0&&(e="number"),Qz(t,e)},rF=nF,sF=RP,NP=function(t){var e=rF(t,"string");return sF(e)?e:e+""},iF=nr,h5=wl,x2=iF.document,oF=h5(x2)&&h5(x2.createElement),zP=function(t){return oF?x2.createElement(t):{}},aF=Sa,lF=rr,cF=zP,FP=!aF&&!lF(function(){return Object.defineProperty(cF("div"),"a",{get:function(){return 7}}).a!==7}),uF=Sa,dF=po,hF=CP,pF=IP,fF=qg,gF=NP,mF=xa,yF=FP,p5=Object.getOwnPropertyDescriptor;Nx.f=uF?p5:function(e,n){if(e=fF(e),n=gF(n),yF)try{return p5(e,n)}catch{}if(mF(e,n))return pF(!dF(hF.f,e,n),e[n])};var qc={},vF=Sa,SF=rr,$P=vF&&SF(function(){return Object.defineProperty(function(){},"prototype",{value:42,writable:!1}).prototype!==42}),xF=wl,wF=String,bF=TypeError,bl=function(t){if(xF(t))return t;throw new bF(wF(t)+" is not an object")},CF=Sa,PF=FP,kF=$P,y0=bl,f5=NP,IF=TypeError,N1=Object.defineProperty,EF=Object.getOwnPropertyDescriptor,z1="enumerable",F1="configurable",$1="writable";qc.f=CF?kF?function(e,n,r){if(y0(e),n=f5(n),y0(r),typeof e=="function"&&n==="prototype"&&"value"in r&&$1 in r&&!r[$1]){var s=EF(e,n);s&&s[$1]&&(e[n]=r.value,r={configurable:F1 in r?r[F1]:s[F1],enumerable:z1 in r?r[z1]:s[z1],writable:!1})}return N1(e,n,r)}:N1:function(e,n,r){if(y0(e),n=f5(n),y0(r),PF)try{return N1(e,n,r)}catch{}if("get"in r||"set"in r)throw new IF("Accessors not supported");return"value"in r&&(e[n]=r.value),e};var TF=Sa,MF=qc,_F=IP,Hx=TF?function(t,e,n){return MF.f(t,e,_F(1,n))}:function(t,e,n){return t[e]=n,t},BP={exports:{}},w2=Sa,AF=xa,UP=Function.prototype,DF=w2&&Object.getOwnPropertyDescriptor,Wx=AF(UP,"name"),jF=Wx&&(function(){}).name==="something",RF=Wx&&(!w2||w2&&DF(UP,"name").configurable),OF={EXISTS:Wx,PROPER:jF,CONFIGURABLE:RF},LF=fn,NF=sr,b2=Bx,zF=LF(Function.toString);NF(b2.inspectSource)||(b2.inspectSource=function(t){return zF(t)});var HP=b2.inspectSource,FF=nr,$F=sr,g5=FF.WeakMap,BF=$F(g5)&&/native code/.test(String(g5)),UF=Ux,HF=LP,m5=UF("keys"),WP=function(t){return m5[t]||(m5[t]=HF(t))},Kx={},WF=BF,KP=nr,KF=wl,GF=Hx,B1=xa,U1=Bx,VF=WP,qF=Kx,y5="Object already initialized",C2=KP.TypeError,YF=KP.WeakMap,Lf,Hd,Nf,XF=function(t){return Nf(t)?Hd(t):Lf(t,{})},ZF=function(t){return function(e){var n;if(!KF(e)||(n=Hd(e)).type!==t)throw new C2("Incompatible receiver, "+t+" required");return n}};if(WF||U1.state){var Zs=U1.state||(U1.state=new YF);Zs.get=Zs.get,Zs.has=Zs.has,Zs.set=Zs.set,Lf=function(t,e){if(Zs.has(t))throw new C2(y5);return e.facade=t,Zs.set(t,e),e},Hd=function(t){return Zs.get(t)||{}},Nf=function(t){return Zs.has(t)}}else{var Ml=VF("state");qF[Ml]=!0,Lf=function(t,e){if(B1(t,Ml))throw new C2(y5);return e.facade=t,GF(t,Ml,e),e},Hd=function(t){return B1(t,Ml)?t[Ml]:{}},Nf=function(t){return B1(t,Ml)}}var GP={set:Lf,get:Hd,has:Nf,enforce:XF,getterFor:ZF},Gx=fn,QF=rr,JF=sr,v0=xa,P2=Sa,e$=OF.CONFIGURABLE,t$=HP,VP=GP,n$=VP.enforce,r$=VP.get,v5=String,Ip=Object.defineProperty,s$=Gx("".slice),i$=Gx("".replace),o$=Gx([].join),a$=P2&&!QF(function(){return Ip(function(){},"length",{value:8}).length!==8}),l$=String(String).split("String"),c$=BP.exports=function(t,e,n){s$(v5(e),0,7)==="Symbol("&&(e="["+i$(v5(e),/^Symbol\(([^)]*)\).*$/,"$1")+"]"),n&&n.getter&&(e="get "+e),n&&n.setter&&(e="set "+e),(!v0(t,"name")||e$&&t.name!==e)&&(P2?Ip(t,"name",{value:e,configurable:!0}):t.name=e),a$&&n&&v0(n,"arity")&&t.length!==n.arity&&Ip(t,"length",{value:n.arity});try{n&&v0(n,"constructor")&&n.constructor?P2&&Ip(t,"prototype",{writable:!1}):t.prototype&&(t.prototype=void 0)}catch{}var r=n$(t);return v0(r,"source")||(r.source=o$(l$,typeof e=="string"?e:"")),t};Function.prototype.toString=c$(function(){return JF(this)&&r$(this).source||t$(this)},"toString");var u$=BP.exports,d$=sr,h$=qc,p$=u$,f$=$x,qP=function(t,e,n,r){r||(r={});var s=r.enumerable,i=r.name!==void 0?r.name:e;if(d$(n)&&p$(n,i,r),r.global)s?t[e]=n:f$(e,n);else{try{r.unsafe?t[e]&&(s=!0):delete t[e]}catch{}s?t[e]=n:h$.f(t,e,{value:n,enumerable:!1,configurable:!r.nonConfigurable,writable:!r.nonWritable})}return t},YP={},g$=Math.ceil,m$=Math.floor,y$=Math.trunc||function(e){var n=+e;return(n>0?m$:g$)(n)},v$=y$,Cl=function(t){var e=+t;return e!==e||e===0?0:v$(e)},S$=Cl,x$=Math.max,w$=Math.min,b$=function(t,e){var n=S$(t);return n<0?x$(n+e,0):w$(n,e)},C$=Cl,P$=Math.min,XP=function(t){var e=C$(t);return e>0?P$(e,9007199254740991):0},k$=XP,vh=function(t){return k$(t.length)},I$=qg,E$=b$,T$=vh,S5=function(t){return function(e,n,r){var s=I$(e),i=T$(s);if(i===0)return!t&&-1;var o=E$(r,i),a;if(t&&n!==n){for(;i>o;)if(a=s[o++],a!==a)return!0}else for(;i>o;o++)if((t||o in s)&&s[o]===n)return t||o||0;return!t&&-1}},M$={includes:S5(!0),indexOf:S5(!1)},_$=fn,H1=xa,A$=qg,D$=M$.indexOf,j$=Kx,x5=_$([].push),ZP=function(t,e){var n=A$(t),r=0,s=[],i;for(i in n)!H1(j$,i)&&H1(n,i)&&x5(s,i);for(;e.length>r;)H1(n,i=e[r++])&&(~D$(s,i)||x5(s,i));return s},Vx=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"],R$=ZP,O$=Vx,L$=O$.concat("length","prototype");YP.f=Object.getOwnPropertyNames||function(e){return R$(e,L$)};var QP={};QP.f=Object.getOwnPropertySymbols;var N$=Yg,z$=fn,F$=YP,$$=QP,B$=bl,U$=z$([].concat),H$=N$("Reflect","ownKeys")||function(e){var n=F$.f(B$(e)),r=$$.f;return r?U$(n,r(e)):n},w5=xa,W$=H$,K$=Nx,G$=qc,V$=function(t,e,n){for(var r=W$(e),s=G$.f,i=K$.f,o=0;o<r.length;o++){var a=r[o];!w5(t,a)&&!(n&&w5(n,a))&&s(t,a,i(e,a))}},q$=rr,Y$=sr,X$=/#|\.prototype\./,Sh=function(t,e){var n=Q$[Z$(t)];return n===eB?!0:n===J$?!1:Y$(e)?q$(e):!!e},Z$=Sh.normalize=function(t){return String(t).replace(X$,".").toLowerCase()},Q$=Sh.data={},J$=Sh.NATIVE="N",eB=Sh.POLYFILL="P",tB=Sh,S0=nr,nB=Nx.f,rB=Hx,sB=qP,iB=$x,oB=V$,aB=tB,Yc=function(t,e){var n=t.target,r=t.global,s=t.stat,i,o,a,l,c,u;if(r?o=S0:s?o=S0[n]||iB(n,{}):o=S0[n]&&S0[n].prototype,o)for(a in e){if(c=e[a],t.dontCallGetSet?(u=nB(o,a),l=u&&u.value):l=o[a],i=aB(r?a:n+(s?".":"#")+a,t.forced),!i&&l!==void 0){if(typeof c==typeof l)continue;oB(c,l)}(t.sham||l&&l.sham)&&rB(c,"sham",!0),sB(o,a,c,t)}},JP={},lB=ZP,cB=Vx,uB=Object.keys||function(e){return lB(e,cB)},dB=Sa,hB=$P,pB=qc,fB=bl,gB=qg,mB=uB;JP.f=dB&&!hB?Object.defineProperties:function(e,n){fB(e);for(var r=gB(n),s=mB(n),i=s.length,o=0,a;i>o;)pB.f(e,a=s[o++],r[a]);return e};var yB=Yg,vB=yB("document","documentElement"),SB=bl,xB=JP,b5=Vx,wB=Kx,bB=vB,CB=zP,PB=WP,C5=">",P5="<",k2="prototype",I2="script",ek=PB("IE_PROTO"),W1=function(){},tk=function(t){return P5+I2+C5+t+P5+"/"+I2+C5},k5=function(t){t.write(tk("")),t.close();var e=t.parentWindow.Object;return t=null,e},kB=function(){var t=CB("iframe"),e="java"+I2+":",n;return t.style.display="none",bB.appendChild(t),t.src=String(e),n=t.contentWindow.document,n.open(),n.write(tk("document.F=Object")),n.close(),n.F},x0,Ep=function(){try{x0=new ActiveXObject("htmlfile")}catch{}Ep=typeof document<"u"?document.domain&&x0?k5(x0):kB():k5(x0);for(var t=b5.length;t--;)delete Ep[k2][b5[t]];return Ep()};wB[ek]=!0;var nk=Object.create||function(e,n){var r;return e!==null?(W1[k2]=SB(e),r=new W1,W1[k2]=null,r[ek]=e):r=Ep(),n===void 0?r:xB.f(r,n)},IB=fo,EB=nk,TB=qc.f,E2=IB("unscopables"),T2=Array.prototype;T2[E2]===void 0&&TB(T2,E2,{configurable:!0,value:EB(null)});var qx=function(t){T2[E2][t]=!0},MB=Yc,_B=yh,AB=vh,DB=Cl,jB=qx;MB({target:"Array",proto:!0},{at:function(e){var n=_B(this),r=AB(n),s=DB(e),i=s>=0?s:r+s;return i<0||i>=r?void 0:n[i]}});jB("at");var RB=nr,OB=fn,xh=function(t,e){return OB(RB[t].prototype[e])},LB=xh;LB("Array","at");var NB=Gc,rk=Array.isArray||function(e){return NB(e)==="Array"},zB=TypeError,FB=9007199254740991,$B=function(t){if(t>FB)throw zB("Maximum allowed index exceeded");return t},BB=Gc,UB=fn,HB=function(t){if(BB(t)==="Function")return UB(t)},I5=HB,WB=zx,KB=Gg,GB=I5(I5.bind),VB=function(t,e){return WB(t),e===void 0?t:KB?GB(t,e):function(){return t.apply(e,arguments)}},qB=rk,YB=vh,XB=$B,ZB=VB,sk=function(t,e,n,r,s,i,o,a){for(var l=s,c=0,u=o?ZB(o,a):!1,h,p;c<r;)c in n&&(h=u?u(n[c],c,e):n[c],i>0&&qB(h)?(p=YB(h),l=sk(t,e,h,p,l,i-1)-1):(XB(l+1),t[l]=h),l++),c++;return l},ik=sk,QB=fo,JB=QB("toStringTag"),ok={};ok[JB]="z";var eU=String(ok)==="[object z]",tU=eU,nU=sr,Tp=Gc,rU=fo,sU=rU("toStringTag"),iU=Object,oU=Tp(function(){return arguments}())==="Arguments",aU=function(t,e){try{return t[e]}catch{}},ak=tU?Tp:function(t){var e,n,r;return t===void 0?"Undefined":t===null?"Null":typeof(n=aU(e=iU(t),sU))=="string"?n:oU?Tp(e):(r=Tp(e))==="Object"&&nU(e.callee)?"Arguments":r},lU=fn,cU=rr,lk=sr,uU=ak,dU=Yg,hU=HP,ck=function(){},uk=dU("Reflect","construct"),Yx=/^\s*(?:class|function)\b/,pU=lU(Yx.exec),fU=!Yx.test(ck),xu=function(e){if(!lk(e))return!1;try{return uk(ck,[],e),!0}catch{return!1}},dk=function(e){if(!lk(e))return!1;switch(uU(e)){case"AsyncFunction":case"GeneratorFunction":case"AsyncGeneratorFunction":return!1}try{return fU||!!pU(Yx,hU(e))}catch{return!0}};dk.sham=!0;var gU=!uk||cU(function(){var t;return xu(xu.call)||!xu(Object)||!xu(function(){t=!0})||t})?dk:xu,E5=rk,mU=gU,yU=wl,vU=fo,SU=vU("species"),T5=Array,xU=function(t){var e;return E5(t)&&(e=t.constructor,mU(e)&&(e===T5||E5(e.prototype))?e=void 0:yU(e)&&(e=e[SU],e===null&&(e=void 0))),e===void 0?T5:e},wU=xU,hk=function(t,e){return new(wU(t))(e===0?0:e)},bU=Yc,CU=ik,PU=zx,kU=yh,IU=vh,EU=hk;bU({target:"Array",proto:!0},{flatMap:function(e){var n=kU(this),r=IU(n),s;return PU(e),s=EU(n,0),s.length=CU(s,n,n,r,0,1,e,arguments.length>1?arguments[1]:void 0),s}});var TU=qx;TU("flatMap");var MU=xh;MU("Array","flatMap");var _U=Yc,AU=ik,DU=yh,jU=vh,RU=Cl,OU=hk;_U({target:"Array",proto:!0},{flat:function(){var e=arguments.length?arguments[0]:void 0,n=DU(this),r=jU(n),s=OU(n,0);return s.length=AU(s,n,n,r,0,e===void 0?1:RU(e)),s}});var LU=qx;LU("flat");var NU=xh;NU("Array","flat");var zU=ak,FU=String,wh=function(t){if(zU(t)==="Symbol")throw new TypeError("Cannot convert a Symbol value to a string");return FU(t)},$U=Yc,BU=fn,UU=Vc,HU=Cl,WU=wh,KU=rr,GU=BU("".charAt),VU=KU(function(){return"𠮷".at(-2)!=="\uD842"});$U({target:"String",proto:!0,forced:VU},{at:function(e){var n=WU(UU(this)),r=n.length,s=HU(e),i=s>=0?s:r+s;return i<0||i>=r?void 0:GU(n,i)}});var qU=xh;qU("String","at");var YU=bl,pk=function(){var t=YU(this),e="";return t.hasIndices&&(e+="d"),t.global&&(e+="g"),t.ignoreCase&&(e+="i"),t.multiline&&(e+="m"),t.dotAll&&(e+="s"),t.unicode&&(e+="u"),t.unicodeSets&&(e+="v"),t.sticky&&(e+="y"),e},Xx=rr,XU=nr,Zx=XU.RegExp,Qx=Xx(function(){var t=Zx("a","y");return t.lastIndex=2,t.exec("abcd")!==null}),ZU=Qx||Xx(function(){return!Zx("a","y").sticky}),QU=Qx||Xx(function(){var t=Zx("^r","gy");return t.lastIndex=2,t.exec("str")!==null}),JU={BROKEN_CARET:QU,MISSED_STICKY:ZU,UNSUPPORTED_Y:Qx},eH=rr,tH=nr,nH=tH.RegExp,rH=eH(function(){var t=nH(".","s");return!(t.dotAll&&t.test(`
`)&&t.flags==="s")}),sH=rr,iH=nr,oH=iH.RegExp,aH=sH(function(){var t=oH("(?<a>b)","g");return t.exec("b").groups.a!=="b"||"b".replace(t,"$<a>c")!=="bc"}),rc=po,Xg=fn,lH=wh,cH=pk,uH=JU,dH=Ux,hH=nk,pH=GP.get,fH=rH,gH=aH,mH=dH("native-string-replace",String.prototype.replace),zf=RegExp.prototype.exec,M2=zf,yH=Xg("".charAt),vH=Xg("".indexOf),SH=Xg("".replace),K1=Xg("".slice),_2=function(){var t=/a/,e=/b*/g;return rc(zf,t,"a"),rc(zf,e,"a"),t.lastIndex!==0||e.lastIndex!==0}(),fk=uH.BROKEN_CARET,A2=/()??/.exec("")[1]!==void 0,xH=_2||A2||fk||fH||gH;xH&&(M2=function(e){var n=this,r=pH(n),s=lH(e),i=r.raw,o,a,l,c,u,h,p;if(i)return i.lastIndex=n.lastIndex,o=rc(M2,i,s),n.lastIndex=i.lastIndex,o;var f=r.groups,v=fk&&n.sticky,m=rc(cH,n),x=n.source,y=0,S=s;if(v&&(m=SH(m,"y",""),vH(m,"g")===-1&&(m+="g"),S=K1(s,n.lastIndex),n.lastIndex>0&&(!n.multiline||n.multiline&&yH(s,n.lastIndex-1)!==`
`)&&(x="(?: "+x+")",S=" "+S,y++),a=new RegExp("^(?:"+x+")",m)),A2&&(a=new RegExp("^"+x+"$(?!\\s)",m)),_2&&(l=n.lastIndex),c=rc(zf,v?a:n,S),v?c?(c.input=K1(c.input,y),c[0]=K1(c[0],y),c.index=n.lastIndex,n.lastIndex+=c[0].length):n.lastIndex=0:_2&&c&&(n.lastIndex=n.global?c.index+c[0].length:l),A2&&c&&c.length>1&&rc(mH,c[0],a,function(){for(u=1;u<arguments.length-2;u++)arguments[u]===void 0&&(c[u]=void 0)}),c&&f)for(c.groups=h=hH(null),u=0;u<f.length;u++)p=f[u],h[p[0]]=c[p[1]];return c});var Jx=M2,wH=Yc,M5=Jx;wH({target:"RegExp",proto:!0,forced:/./.exec!==M5},{exec:M5});var bH=Gg,gk=Function.prototype,_5=gk.apply,A5=gk.call,CH=typeof Reflect=="object"&&Reflect.apply||(bH?A5.bind(_5):function(){return A5.apply(_5,arguments)}),D5=po,j5=qP,PH=Jx,R5=rr,mk=fo,kH=Hx,IH=mk("species"),G1=RegExp.prototype,EH=function(t,e,n,r){var s=mk(t),i=!R5(function(){var c={};return c[s]=function(){return 7},""[t](c)!==7}),o=i&&!R5(function(){var c=!1,u=/a/;return t==="split"&&(u={},u.constructor={},u.constructor[IH]=function(){return u},u.flags="",u[s]=/./[s]),u.exec=function(){return c=!0,null},u[s](""),!c});if(!i||!o||n){var a=/./[s],l=e(s,""[t],function(c,u,h,p,f){var v=u.exec;return v===PH||v===G1.exec?i&&!f?{done:!0,value:D5(a,u,h,p)}:{done:!0,value:D5(c,h,u,p)}:{done:!1}});j5(String.prototype,t,l[0]),j5(G1,s,l[1])}r&&kH(G1[s],"sham",!0)},e4=fn,TH=Cl,MH=wh,_H=Vc,AH=e4("".charAt),O5=e4("".charCodeAt),DH=e4("".slice),L5=function(t){return function(e,n){var r=MH(_H(e)),s=TH(n),i=r.length,o,a;return s<0||s>=i?t?"":void 0:(o=O5(r,s),o<55296||o>56319||s+1===i||(a=O5(r,s+1))<56320||a>57343?t?AH(r,s):o:t?DH(r,s,s+2):(o-55296<<10)+(a-56320)+65536)}},jH={codeAt:L5(!1),charAt:L5(!0)},RH=jH.charAt,OH=function(t,e,n){return e+(n?RH(t,e).length:1)},t4=fn,LH=yh,NH=Math.floor,V1=t4("".charAt),zH=t4("".replace),q1=t4("".slice),FH=/\$([$&'`]|\d{1,2}|<[^>]*>)/g,$H=/\$([$&'`]|\d{1,2})/g,yk=function(t,e,n,r,s,i){var o=n+t.length,a=r.length,l=$H;return s!==void 0&&(s=LH(s),l=FH),zH(i,l,function(c,u){var h;switch(V1(u,0)){case"$":return"$";case"&":return t;case"`":return q1(e,0,n);case"'":return q1(e,o);case"<":h=s[q1(u,1,-1)];break;default:var p=+u;if(p===0)return c;if(p>a){var f=NH(p/10);return f===0?c:f<=a?r[f-1]===void 0?V1(u,1):r[f-1]+V1(u,1):c}h=r[p-1]}return h===void 0?"":h})},N5=po,BH=bl,UH=sr,HH=Gc,WH=Jx,KH=TypeError,GH=function(t,e){var n=t.exec;if(UH(n)){var r=N5(n,t,e);return r!==null&&BH(r),r}if(HH(t)==="RegExp")return N5(WH,t,e);throw new KH("RegExp#exec called on incompatible receiver")},VH=CH,z5=po,Zg=fn,qH=EH,YH=rr,XH=bl,ZH=sr,QH=Vg,JH=Cl,eW=XP,_l=wh,tW=Vc,nW=OH,rW=Fx,sW=yk,iW=GH,oW=fo,D2=oW("replace"),aW=Math.max,lW=Math.min,cW=Zg([].concat),Y1=Zg([].push),F5=Zg("".indexOf),$5=Zg("".slice),uW=function(t){return t===void 0?t:String(t)},dW=function(){return"a".replace(/./,"$0")==="$0"}(),B5=function(){return/./[D2]?/./[D2]("a","$0")==="":!1}(),hW=!YH(function(){var t=/./;return t.exec=function(){var e=[];return e.groups={a:"7"},e},"".replace(t,"$<a>")!=="7"});qH("replace",function(t,e,n){var r=B5?"$":"$0";return[function(i,o){var a=tW(this),l=QH(i)?void 0:rW(i,D2);return l?z5(l,i,a,o):z5(e,_l(a),i,o)},function(s,i){var o=XH(this),a=_l(s);if(typeof i=="string"&&F5(i,r)===-1&&F5(i,"$<")===-1){var l=n(e,o,a,i);if(l.done)return l.value}var c=ZH(i);c||(i=_l(i));var u=o.global,h;u&&(h=o.unicode,o.lastIndex=0);for(var p=[],f;f=iW(o,a),!(f===null||(Y1(p,f),!u));){var v=_l(f[0]);v===""&&(o.lastIndex=nW(a,eW(o.lastIndex),h))}for(var m="",x=0,y=0;y<p.length;y++){f=p[y];for(var S=_l(f[0]),w=aW(lW(JH(f.index),a.length),0),P=[],E,M=1;M<f.length;M++)Y1(P,uW(f[M]));var I=f.groups;if(c){var _=cW([S],P,w,a);I!==void 0&&Y1(_,I),E=_l(VH(i,void 0,_))}else E=sW(S,a,w,P,I,i);w>=x&&(m+=$5(a,x,w)+E,x=w+S.length)}return m+$5(a,x)}]},!hW||!dW||B5);var pW=wl,fW=Gc,gW=fo,mW=gW("match"),yW=function(t){var e;return pW(t)&&((e=t[mW])!==void 0?!!e:fW(t)==="RegExp")},vW=po,SW=xa,xW=_P,wW=pk,U5=RegExp.prototype,bW=function(t){var e=t.flags;return e===void 0&&!("flags"in U5)&&!SW(t,"flags")&&xW(U5,t)?vW(wW,t):e},CW=Yc,PW=po,n4=fn,H5=Vc,kW=sr,IW=Vg,EW=yW,wu=wh,TW=Fx,MW=bW,_W=yk,AW=fo,DW=AW("replace"),jW=TypeError,X1=n4("".indexOf);n4("".replace);var W5=n4("".slice),RW=Math.max;CW({target:"String",proto:!0},{replaceAll:function(e,n){var r=H5(this),s,i,o,a,l,c,u,h,p,f,v=0,m="";if(!IW(e)){if(s=EW(e),s&&(i=wu(H5(MW(e))),!~X1(i,"g")))throw new jW("`.replaceAll` does not allow non-global regexes");if(o=TW(e,DW),o)return PW(o,e,r,n)}for(a=wu(r),l=wu(e),c=kW(n),c||(n=wu(n)),u=l.length,h=RW(1,u),p=X1(a,l);p!==-1;)f=c?wu(n(l,p,a)):_W(l,a,p,[],void 0,n),m+=W5(a,v,p)+f,v=p+u,p=p+h>a.length?-1:X1(a,l,p+h);return v<a.length&&(m+=W5(a,v)),m}});var OW=xh;OW("String","replaceAll");function vk(t){return t&&typeof t=="object"&&"parents"in t}function Sk(t){for(let e=0,n=t.parents.length;e<n;e++)if(t.parents[e].__unsafe__getWithoutCapture(!0),t.parents[e].lastChangedEpoch!==t.parentEpochs[e])return!0;return!1}const Ff=(t,e)=>{if(t.children.remove(e)&&t.children.isEmpty&&vk(t))for(let n=0,r=t.parents.length;n<r;n++)Ff(t.parents[n],t)},r4=(t,e)=>{if(t.children.add(e)&&vk(t))for(let n=0,r=t.parents.length;n<r;n++)r4(t.parents[n],t)};function xk(t,e){return t===e||Object.is(t,e)||!!(t&&e&&typeof t.equals=="function"&&t.equals(e))}function wa(t,e){const n=Symbol.for(`com.tldraw.state/${t}`),r=globalThis;return r[n]??(r[n]=e()),r[n]}const qi=wa("empty_array",()=>Object.freeze([])),K5=8;class $f{constructor(){g(this,"arraySize",0);g(this,"array",Array(K5));g(this,"set",null)}get isEmpty(){if(this.array)return this.arraySize===0;if(this.set)return this.set.size===0;throw new Error("no set or array")}add(e){if(this.array)return this.array.indexOf(e)!==-1?!1:this.arraySize<K5?(this.array[this.arraySize]=e,this.arraySize++,!0):(this.set=new Set(this.array),this.array=null,this.set.add(e),!0);if(this.set)return this.set.has(e)?!1:(this.set.add(e),!0);throw new Error("no set or array")}remove(e){if(this.array){const n=this.array.indexOf(e);return n===-1?!1:(this.array[n]=void 0,this.arraySize--,n!==this.arraySize&&(this.array[n]=this.array[this.arraySize],this.array[this.arraySize]=void 0),!0)}if(this.set)return this.set.has(e)?(this.set.delete(e),!0):!1;throw new Error("no set or array")}visit(e){if(this.array){for(let n=0;n<this.arraySize;n++){const r=this.array[n];typeof r<"u"&&e(r)}return}if(this.set){this.set.forEach(e);return}throw new Error("no set or array")}has(e){return this.array?this.array.indexOf(e)!==-1:this.set.has(e)}clear(){this.set?this.set.clear():(this.arraySize=0,this.array=[])}size(){return this.set?this.set.size:this.arraySize}}const Ur=Symbol.for("com.tldraw.state/RESET_VALUE");class wk{constructor(e){g(this,"index",0);g(this,"buffer");this.capacity=e,this.buffer=new Array(e)}pushEntry(e,n,r){if(r!==void 0){if(r===Ur){this.clear();return}this.buffer[this.index]=[e,n,r],this.index=(this.index+1)%this.capacity}}clear(){this.index=0,this.buffer.fill(void 0)}getChangesSince(e){const{index:n,capacity:r,buffer:s}=this;for(let i=0;i<r;i++){const o=(n-1+r-i)%r,a=s[o];if(!a)return Ur;const[l,c]=a;if(i===0&&e>=c)return[];if(l<=e&&e<c){const u=i+1,h=new Array(u);for(let p=0;p<u;p++)h[p]=s[(o+p)%r][2];return h}}return Ur}}class LW{constructor(e,n){g(this,"offset",0);g(this,"maybeRemoved");this.below=e,this.child=n}}const Tt=wa("capture",()=>({stack:null}));function w0(t){const e=Tt.stack;Tt.stack=null;try{return t()}finally{Tt.stack=e}}function bk(t){Tt.stack=new LW(Tt.stack,t),t.parentSet.clear()}function Ck(){const t=Tt.stack;if(Tt.stack=t.below,t.offset<t.child.parents.length){for(let e=t.offset;e<t.child.parents.length;e++){const n=t.child.parents[e];t.child.parentSet.has(n)||Ff(n,t.child)}t.child.parents.length=t.offset,t.child.parentEpochs.length=t.offset}if(t.maybeRemoved)for(let e=0;e<t.maybeRemoved.length;e++){const n=t.maybeRemoved[e];t.child.parentSet.has(n)||Ff(n,t.child)}}function Bf(t){if(Tt.stack){if(Tt.stack.child.parentSet.has(t))return;if(Tt.stack.child.parentSet.add(t),Tt.stack.child.isActivelyListening&&r4(t,Tt.stack.child),Tt.stack.offset<Tt.stack.child.parents.length){const n=Tt.stack.child.parents[Tt.stack.offset];n!==t&&(Tt.stack.maybeRemoved?Tt.stack.maybeRemoved.push(n):Tt.stack.maybeRemoved=[n])}Tt.stack.child.parents[Tt.stack.offset]=t,Tt.stack.child.parentEpochs[Tt.stack.offset]=t.lastChangedEpoch,Tt.stack.offset++}}const Fo=-1;class NW{constructor(e,n,r){g(this,"_isActivelyListening",!1);g(this,"lastTraversedEpoch",Fo);g(this,"lastReactedEpoch",Fo);g(this,"_scheduleCount",0);g(this,"parentSet",new $f);g(this,"parentEpochs",[]);g(this,"parents",[]);g(this,"_scheduleEffect");g(this,"maybeExecute",()=>{this._isActivelyListening&&this.execute()});this.name=e,this.runEffect=n,this._scheduleEffect=r==null?void 0:r.scheduleEffect}get isActivelyListening(){return this._isActivelyListening}get scheduleCount(){return this._scheduleCount}maybeScheduleEffect(){if(this._isActivelyListening&&this.lastReactedEpoch!==pr()){if(this.parents.length&&!Sk(this)){this.lastReactedEpoch=pr();return}this.scheduleEffect()}}scheduleEffect(){this._scheduleCount++,this._scheduleEffect?this._scheduleEffect(this.maybeExecute):this.execute()}attach(){this._isActivelyListening=!0;for(let e=0,n=this.parents.length;e<n;e++)r4(this.parents[e],this)}detach(){this._isActivelyListening=!1;for(let e=0,n=this.parents.length;e<n;e++)Ff(this.parents[e],this)}execute(){try{bk(this);const e=pr(),n=this.runEffect(this.lastReactedEpoch);return this.lastReactedEpoch=e,n}finally{Ck()}}}const Xc=wa("EffectScheduler",()=>NW);function ba(t,e,n){const r=new Xc(t,e,n);return r.attach(),r.scheduleEffect(),()=>{r.detach()}}function zW(t,e,n){const r=new Xc(t,e,n);return{scheduler:r,start:s=>{const i=(s==null?void 0:s.force)??!1;r.attach(),i?r.scheduleEffect():r.maybeScheduleEffect()},stop:()=>{r.detach()}}}class FW{constructor(e){g(this,"initialAtomValues",new Map);this.parent=e}get isRoot(){return this.parent===null}commit(){this.isRoot?Pk(this.initialAtomValues.keys()):this.initialAtomValues.forEach((e,n)=>{this.parent.initialAtomValues.has(n)||this.parent.initialAtomValues.set(n,e)})}abort(){ct.globalEpoch++,this.initialAtomValues.forEach((e,n)=>{var r;n.set(e),(r=n.historyBuffer)==null||r.clear()}),this.commit()}}const ct=wa("transactions",()=>({globalEpoch:Fo+1,globalIsReacting:!1,currentTransaction:null,cleanupReactors:null,reactionEpoch:Fo+1}));function $W(){return ct.reactionEpoch}function pr(){return ct.globalEpoch}function BW(){return ct.globalIsReacting}function s4(t,e){e.lastTraversedEpoch!==ct.globalEpoch&&(e.lastTraversedEpoch=ct.globalEpoch,e instanceof Xc?t.add(e):e.children.visit(n=>s4(t,n)))}function Pk(t){var e;if(ct.globalIsReacting)throw new Error("cannot change atoms during reaction cycle");try{ct.globalIsReacting=!0,ct.reactionEpoch=ct.globalEpoch;const n=new Set;for(const s of t)s.children.visit(i=>s4(n,i));for(const s of n)s.maybeScheduleEffect();let r=0;for(;(e=ct.cleanupReactors)!=null&&e.size;){if(r++>1e3)throw new Error("Reaction update depth limit exceeded");const s=ct.cleanupReactors;ct.cleanupReactors=null;for(const i of s)i.maybeScheduleEffect()}}finally{ct.cleanupReactors=null,ct.globalIsReacting=!1}}function UW(t,e){if(ct.globalIsReacting){const n=ct.cleanupReactors??(ct.cleanupReactors=new Set);t.children.visit(r=>s4(n,r))}else ct.currentTransaction?ct.currentTransaction.initialAtomValues.has(t)||ct.currentTransaction.initialAtomValues.set(t,e):Pk([t])}function HW(){ct.globalEpoch++}function WW(t){const e=new FW(ct.currentTransaction);ct.currentTransaction=e;try{let n,r=!1;try{n=t(()=>r=!0)}catch(s){throw e.abort(),s}return r?e.abort():e.commit(),n}finally{ct.currentTransaction=ct.currentTransaction.parent}}function zs(t){return ct.currentTransaction?t():WW(t)}class KW{constructor(e,n,r){g(this,"isEqual");g(this,"computeDiff");g(this,"lastChangedEpoch",pr());g(this,"children",new $f);g(this,"historyBuffer");this.name=e,this.current=n,this.isEqual=(r==null?void 0:r.isEqual)??null,r&&(r.historyLength&&(this.historyBuffer=new wk(r.historyLength)),this.computeDiff=r.computeDiff)}__unsafe__getWithoutCapture(e){return this.current}get(){return Bf(this),this.current}set(e,n){var s,i;if(((s=this.isEqual)==null?void 0:s.call(this,this.current,e))??xk(this.current,e))return this.current;HW(),this.historyBuffer&&this.historyBuffer.pushEntry(this.lastChangedEpoch,pr(),n??((i=this.computeDiff)==null?void 0:i.call(this,this.current,e,this.lastChangedEpoch,pr()))??Ur),this.lastChangedEpoch=pr();const r=this.current;return this.current=e,UW(this,r),e}update(e){return this.set(e(this.current))}getDiffSince(e){var n;return Bf(this),e>=this.lastChangedEpoch?qi:((n=this.historyBuffer)==null?void 0:n.getChangesSince(e))??Ur}}const kk=wa("Atom",()=>KW);function Qt(t,e,n){return new kk(t,e,n)}let G5=!1;function GW(){G5||(G5=!0,console.warn(`Using \`@computed\` as a decorator for getters is deprecated and will be removed in the near future. Please refactor to use \`@computed\` as a decorator for methods.

// Before
@computed
get foo() {
	return 'foo'
}

// After
@computed
getFoo() {
	return 'foo'
}
`))}const Bu=Symbol.for("com.tldraw.state/UNINITIALIZED"),Xa=t=>t===Bu,j2=wa("WithDiff",()=>class{constructor(e,n){this.value=e,this.diff=n}});function Uu(t,e){return new j2(t,e)}class VW{constructor(e,n,r){g(this,"lastChangedEpoch",Fo);g(this,"lastTraversedEpoch",Fo);g(this,"lastCheckedEpoch",Fo);g(this,"parentSet",new $f);g(this,"parents",[]);g(this,"parentEpochs",[]);g(this,"children",new $f);g(this,"historyBuffer");g(this,"state",Bu);g(this,"error",null);g(this,"computeDiff");g(this,"isEqual");this.name=e,this.derive=n,r!=null&&r.historyLength&&(this.historyBuffer=new wk(r.historyLength)),this.computeDiff=r==null?void 0:r.computeDiff,this.isEqual=(r==null?void 0:r.isEqual)??xk}get isActivelyListening(){return!this.children.isEmpty}__unsafe__getWithoutCapture(e){var s;const n=this.lastChangedEpoch===Fo,r=pr();if(!n&&(this.lastCheckedEpoch===r||this.isActivelyListening&&BW()&&this.lastTraversedEpoch<$W()||!Sk(this)))if(this.lastCheckedEpoch=r,this.error){if(e)return this.state;throw this.error.thrownValue}else return this.state;try{bk(this);const i=this.derive(this.state,this.lastCheckedEpoch),o=i instanceof j2?i.value:i,a=this.state===Bu;if(a||!this.isEqual(o,this.state)){if(this.historyBuffer&&!a){const l=i instanceof j2?i.diff:void 0;this.historyBuffer.pushEntry(this.lastChangedEpoch,pr(),l??((s=this.computeDiff)==null?void 0:s.call(this,this.state,o,this.lastCheckedEpoch,pr()))??Ur)}this.lastChangedEpoch=pr(),this.state=o}return this.error=null,this.lastCheckedEpoch=pr(),this.state}catch(i){if(this.state!==Bu&&(this.state=Bu,this.lastChangedEpoch=pr()),this.lastCheckedEpoch=pr(),this.historyBuffer&&this.historyBuffer.clear(),this.error={thrownValue:i},!e)throw i;return this.state}finally{Ck()}}get(){try{return this.__unsafe__getWithoutCapture()}finally{Bf(this)}}getDiffSince(e){var n;return this.__unsafe__getWithoutCapture(!0),Bf(this),e>=this.lastChangedEpoch?qi:((n=this.historyBuffer)==null?void 0:n.getChangesSince(e))??Ur}}const Qg=wa("Computed",()=>VW);function qW(t={},e,n,r){const s=r.value,i=Symbol.for("__@tldraw/state__computed__"+n);return r.value=function(){let o=this[i];return o||(o=new Qg(n,s.bind(this),t),Object.defineProperty(this,i,{enumerable:!1,configurable:!1,writable:!1,value:o})),o.get()},r.value[XW]=!0,r}function V5(t={},e,n,r){return r.get?(GW(),YW(t,e,n,r)):qW(t,e,n,r)}function YW(t={},e,n,r){const s=r.get,i=Symbol.for("__@tldraw/state__computed__"+n);return r.get=function(){let o=this[i];return o||(o=new Qg(n,s.bind(this),t),Object.defineProperty(this,i,{enumerable:!1,configurable:!1,writable:!1,value:o})),o.get()},r}const XW="@@__isComputedMethod__@@";function ee(){if(arguments.length===1){const t=arguments[0];return(e,n,r)=>V5(t,e,n,r)}else return typeof arguments[0]=="string"?new Qg(arguments[0],arguments[1],arguments[2]):V5(void 0,arguments[0],arguments[1],arguments[2])}function ZW(t){return t instanceof kk||t instanceof Qg}const Ik=1,QW=wa("apiVersion",()=>Ik);if(QW!==Ik)throw new Error("You have multiple incompatible versions of @tldraw/state in your app. Please deduplicate the package.");var Ek="Expected a function",q5=NaN,JW="[object Symbol]",eK=/^\s+|\s+$/g,tK=/^[-+]0x[0-9a-f]+$/i,nK=/^0b[01]+$/i,rK=/^0o[0-7]+$/i,sK=parseInt,iK=typeof Hn=="object"&&Hn&&Hn.Object===Object&&Hn,oK=typeof self=="object"&&self&&self.Object===Object&&self,aK=iK||oK||Function("return this")(),lK=Object.prototype,cK=lK.toString,uK=Math.max,dK=Math.min,Z1=function(){return aK.Date.now()};function hK(t,e,n){var r,s,i,o,a,l,c=0,u=!1,h=!1,p=!0;if(typeof t!="function")throw new TypeError(Ek);e=Y5(e)||0,Uf(n)&&(u=!!n.leading,h="maxWait"in n,i=h?uK(Y5(n.maxWait)||0,e):i,p="trailing"in n?!!n.trailing:p);function f(M){var I=r,_=s;return r=s=void 0,c=M,o=t.apply(_,I),o}function v(M){return c=M,a=setTimeout(y,e),u?f(M):o}function m(M){var I=M-l,_=M-c,D=e-I;return h?dK(D,i-_):D}function x(M){var I=M-l,_=M-c;return l===void 0||I>=e||I<0||h&&_>=i}function y(){var M=Z1();if(x(M))return S(M);a=setTimeout(y,m(M))}function S(M){return a=void 0,p&&r?f(M):(r=s=void 0,o)}function w(){a!==void 0&&clearTimeout(a),c=0,r=l=s=a=void 0}function P(){return a===void 0?o:S(Z1())}function E(){var M=Z1(),I=x(M);if(r=arguments,s=this,l=M,I){if(a===void 0)return v(l);if(h)return a=setTimeout(y,e),f(l)}return a===void 0&&(a=setTimeout(y,e)),o}return E.cancel=w,E.flush=P,E}function pK(t,e,n){var r=!0,s=!0;if(typeof t!="function")throw new TypeError(Ek);return Uf(n)&&(r="leading"in n?!!n.leading:r,s="trailing"in n?!!n.trailing:s),hK(t,e,{leading:r,maxWait:e,trailing:s})}function Uf(t){var e=typeof t;return!!t&&(e=="object"||e=="function")}function fK(t){return!!t&&typeof t=="object"}function gK(t){return typeof t=="symbol"||fK(t)&&cK.call(t)==JW}function Y5(t){if(typeof t=="number")return t;if(gK(t))return q5;if(Uf(t)){var e=typeof t.valueOf=="function"?t.valueOf():t;t=Uf(e)?e+"":e}if(typeof t!="string")return t===0?t:+t;t=t.replace(eK,"");var n=nK.test(t);return n||rK.test(t)?sK(t.slice(2),n?2:8):tK.test(t)?q5:+t}var mK=pK;const Tk=ga(mK);var yK=200,i4="__lodash_hash_undefined__",vK=1/0,SK="[object Function]",xK="[object GeneratorFunction]",wK=/[\\^$.*+?()[\]{}|]/g,bK=/^\[object .+?Constructor\]$/,CK=typeof Hn=="object"&&Hn&&Hn.Object===Object&&Hn,PK=typeof self=="object"&&self&&self.Object===Object&&self,o4=CK||PK||Function("return this")();function kK(t,e){var n=t?t.length:0;return!!n&&EK(t,e,0)>-1}function IK(t,e,n,r){for(var s=t.length,i=n+-1;++i<s;)if(e(t[i],i,t))return i;return-1}function EK(t,e,n){if(e!==e)return IK(t,TK,n);for(var r=n-1,s=t.length;++r<s;)if(t[r]===e)return r;return-1}function TK(t){return t!==t}function MK(t,e){return t.has(e)}function _K(t,e){return t==null?void 0:t[e]}function AK(t){var e=!1;if(t!=null&&typeof t.toString!="function")try{e=!!(t+"")}catch{}return e}function Mk(t){var e=-1,n=Array(t.size);return t.forEach(function(r){n[++e]=r}),n}var DK=Array.prototype,jK=Function.prototype,_k=Object.prototype,Q1=o4["__core-js_shared__"],X5=function(){var t=/[^.]+$/.exec(Q1&&Q1.keys&&Q1.keys.IE_PROTO||"");return t?"Symbol(src)_1."+t:""}(),Ak=jK.toString,a4=_k.hasOwnProperty,RK=_k.toString,OK=RegExp("^"+Ak.call(a4).replace(wK,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),LK=DK.splice,NK=l4(o4,"Map"),J1=l4(o4,"Set"),Wd=l4(Object,"create");function sl(t){var e=-1,n=t?t.length:0;for(this.clear();++e<n;){var r=t[e];this.set(r[0],r[1])}}function zK(){this.__data__=Wd?Wd(null):{}}function FK(t){return this.has(t)&&delete this.__data__[t]}function $K(t){var e=this.__data__;if(Wd){var n=e[t];return n===i4?void 0:n}return a4.call(e,t)?e[t]:void 0}function BK(t){var e=this.__data__;return Wd?e[t]!==void 0:a4.call(e,t)}function UK(t,e){var n=this.__data__;return n[t]=Wd&&e===void 0?i4:e,this}sl.prototype.clear=zK;sl.prototype.delete=FK;sl.prototype.get=$K;sl.prototype.has=BK;sl.prototype.set=UK;function Zc(t){var e=-1,n=t?t.length:0;for(this.clear();++e<n;){var r=t[e];this.set(r[0],r[1])}}function HK(){this.__data__=[]}function WK(t){var e=this.__data__,n=Jg(e,t);if(n<0)return!1;var r=e.length-1;return n==r?e.pop():LK.call(e,n,1),!0}function KK(t){var e=this.__data__,n=Jg(e,t);return n<0?void 0:e[n][1]}function GK(t){return Jg(this.__data__,t)>-1}function VK(t,e){var n=this.__data__,r=Jg(n,t);return r<0?n.push([t,e]):n[r][1]=e,this}Zc.prototype.clear=HK;Zc.prototype.delete=WK;Zc.prototype.get=KK;Zc.prototype.has=GK;Zc.prototype.set=VK;function Qc(t){var e=-1,n=t?t.length:0;for(this.clear();++e<n;){var r=t[e];this.set(r[0],r[1])}}function qK(){this.__data__={hash:new sl,map:new(NK||Zc),string:new sl}}function YK(t){return em(this,t).delete(t)}function XK(t){return em(this,t).get(t)}function ZK(t){return em(this,t).has(t)}function QK(t,e){return em(this,t).set(t,e),this}Qc.prototype.clear=qK;Qc.prototype.delete=YK;Qc.prototype.get=XK;Qc.prototype.has=ZK;Qc.prototype.set=QK;function Hf(t){var e=-1,n=t?t.length:0;for(this.__data__=new Qc;++e<n;)this.add(t[e])}function JK(t){return this.__data__.set(t,i4),this}function eG(t){return this.__data__.has(t)}Hf.prototype.add=Hf.prototype.push=JK;Hf.prototype.has=eG;function Jg(t,e){for(var n=t.length;n--;)if(lG(t[n][0],e))return n;return-1}function tG(t){if(!Dk(t)||iG(t))return!1;var e=cG(t)||AK(t)?OK:bK;return e.test(oG(t))}function nG(t,e,n){var r=-1,s=kK,i=t.length,o=!0,a=[],l=a;if(i>=yK){var c=rG(t);if(c)return Mk(c);o=!1,s=MK,l=new Hf}else l=a;e:for(;++r<i;){var u=t[r],h=u;if(u=u!==0?u:0,o&&h===h){for(var p=l.length;p--;)if(l[p]===h)continue e;a.push(u)}else s(l,h,n)||(l!==a&&l.push(h),a.push(u))}return a}var rG=J1&&1/Mk(new J1([,-0]))[1]==vK?function(t){return new J1(t)}:uG;function em(t,e){var n=t.__data__;return sG(e)?n[typeof e=="string"?"string":"hash"]:n.map}function l4(t,e){var n=_K(t,e);return tG(n)?n:void 0}function sG(t){var e=typeof t;return e=="string"||e=="number"||e=="symbol"||e=="boolean"?t!=="__proto__":t===null}function iG(t){return!!X5&&X5 in t}function oG(t){if(t!=null){try{return Ak.call(t)}catch{}try{return t+""}catch{}}return""}function aG(t){return t&&t.length?nG(t):[]}function lG(t,e){return t===e||t!==t&&e!==e}function cG(t){var e=Dk(t)?RK.call(t):"";return e==SK||e==xK}function Dk(t){var e=typeof t;return!!t&&(e=="object"||e=="function")}function uG(){}var dG=aG;const hG=ga(dG),Hu={Good:"#40C057",Mid:"#FFC078",Poor:"#E03131"},pG=Hu.Good;class jk{constructor(){g(this,"startTime",0);g(this,"name","");g(this,"frames",0);g(this,"started",!1);g(this,"frame",null);g(this,"recordFrame",()=>{this.frames++,this.started&&(this.frame=requestAnimationFrame(this.recordFrame))})}start(e){this.name=e,this.frames=0,this.started=!0,this.frame!==null&&cancelAnimationFrame(this.frame),this.frame=requestAnimationFrame(this.recordFrame),this.startTime=performance.now()}stop(){this.started=!1,this.frame!==null&&cancelAnimationFrame(this.frame);const e=(performance.now()-this.startTime)/1e3,n=e===0?0:Math.floor(this.frames/e),r=n>55?Hu.Good:n>30?Hu.Mid:Hu.Poor,s=r===Hu.Mid?"black":"white",i=this.name[0].toUpperCase()+this.name.slice(1);console.debug(`%cPerf%c ${i} %c${n}%c fps`,`color: white; background: ${pG};padding: 2px;border-radius: 3px;`,"font-weight: normal",`font-weight: bold; padding: 2px; background: ${r};color: ${s};`,"font-weight: normal")}isStarted(){return this.started}}function c4(t,e){const n=[];e:for(const r of t){for(const s of n)if(e?e(r,s):r===s)continue e;n.push(r)}return n}function Le(t){return t.filter(e=>e!=null)}function xn(t){return t[t.length-1]}function fG(t,e){let n,r=1/0;for(const s of t){const i=e(s);i<r&&(n=s,r=i)}return n}function gG(t,e){if(t===e)return!0;if(t.length!==e.length)return!1;for(let n=0;n<t.length;n++)if(!Object.is(t[n],e[n]))return!1;return!0}class so{constructor(){g(this,"items",new WeakMap)}get(e,n){return this.items.has(e)||this.items.set(e,n(e)),this.items.get(e)}}function Rk(t){const e=(...n)=>{try{return t(...n)}catch(r){throw r instanceof Error&&Error.captureStackTrace&&Error.captureStackTrace(r,e),r}};return e}const Kd=()=>{},Qo={ok(t){return{ok:!0,value:t}},err(t){return{ok:!1,error:t}}};function Cn(t,e){const n=e&&t&&typeof t=="object"&&e in t?t[e]:t;throw new Error(`Unknown switch case ${n}`)}const We=Rk((t,e)=>{if(!t)throw new Error(e||"Assertion Error")}),as=Rk((t,e)=>{if(t==null)throw new Error(e??"value must be defined");return t});function Ok(t,e){let n;const r=(...s)=>(n||(n={},n.promise=new Promise((i,o)=>{n.resolve=i,n.reject=o})),clearTimeout(n.timeout),n.latestArgs=s,n.timeout=setTimeout(()=>{const i=n;n=void 0;try{i.resolve(t(...i.latestArgs))}catch(o){i.reject(o)}},e),n.promise);return r.cancel=()=>{n&&clearTimeout(n.timeout)},r}const Z5=new WeakMap;function u4(t,e){if(typeof t!="object"||t===null)return;let n=Z5.get(t);n||(n={tags:{},extras:{}},Z5.set(t,n)),e.tags&&(n.tags={...n.tags,...e.tags}),e.extras&&(n.extras={...n.extras,...e.extras})}async function yi(t,e){return window.fetch(t,{referrerPolicy:"strict-origin-when-cross-origin",...e})}const Ac=(t,e)=>{const n=new window.Image(t,e);return n.referrerPolicy="strict-origin-when-cross-origin",n};class Za{static async dataUrlToArrayBuffer(e){return yi(e).then(function(n){return n.arrayBuffer()})}static async blobToDataUrl(e){return await new Promise((n,r)=>{if(e){const s=new FileReader;s.onload=()=>n(s.result),s.onerror=i=>r(i),s.onabort=i=>r(i),s.readAsDataURL(e)}})}static async blobToText(e){return await new Promise((n,r)=>{if(e){const s=new FileReader;s.onload=()=>n(s.result),s.onerror=i=>r(i),s.onabort=i=>r(i),s.readAsText(e)}})}}function R2(t){let e=0;for(let n=0;n<t.length;n++)e=(e<<5)-e+t.charCodeAt(n),e|=0;return e+""}function mG(t){const e=new DataView(t);let n=0;for(let r=0;r<e.byteLength;r++)n=(n<<5)-n+e.getUint8(r),n|=0;return n+""}/*!
 * MIT License: https://github.com/vHeemstra/is-apng/blob/main/license
 * Copyright (c) Philip van Heemstra
 */function yG(t){const e=new Uint8Array(t);if(!e||!(typeof Buffer<"u"&&Buffer.isBuffer(e)||e instanceof Uint8Array)||e.length<16||!(e[0]===137&&e[1]===80&&e[2]===78&&e[3]===71&&e[4]===13&&e[5]===10&&e[6]===26&&e[7]===10))return!1;function r(i,o,a,l,c=1024){if(!o)return-1;o=new RegExp(o,"g");const u=o.source.length,h=new TextDecoder,p=i.length;if(typeof l>"u"&&(l=p),a>=p||l<=0||a>=l)return-1;i=i.subarray(a,l);let f=-1,v=0,m=0,x="";e:for(;v<i.length;){const y=v+c,S=i.subarray(v,y),w=h.decode(S,{stream:!0}),P=x+w;let E,M=-1;for(;(E=o.exec(P))!==null;){M=E.index-x.length,f=m+M;break e}v=y,m+=w.length;const I=M>-1?M+u:w.length-u;x=w.slice(I)}return f>=0&&(f+=a>=0?a:p+a),f}const s=r(e,"IDAT",12);return s>=12?r(e,"acTL",8,s)>=8:!1}const vG=t=>new Uint8Array(t)[3]===44;/*!
 * MIT License
 * Modified code originally from <https://github.com/qzb/is-animated>
 * Copyright (c) 2016 Józef Sokołowski <j.k.sokolowski@gmail.com>
 */function Q5(t,e){let n=0;for(;t[e+n];)n+=t[e+n]+1;return n+1}function SG(t){return new TextDecoder("ascii").decode(t.slice(0,3))==="GIF"}function xG(t){const e=new Uint8Array(t);let n,r,s=0,i=0;if(!SG(t))return!1;for(n=e[10]&128,r=e[10]&7,s+=6,s+=7,s+=n?3*Math.pow(2,r+1):0;i<2&&s<e.length;)switch(e[s]){case 44:i+=1,n=e[s+9]&128,r=e[s+9]&7,s+=10,s+=n?3*Math.pow(2,r+1):0,s+=Q5(e,s+1)+1;break;case 33:s+=2,s+=Q5(e,s);break;case 59:s=e.length;break;default:s=e.length;break}return i>1}let O2=[0,1996959894,3993919788,2567524794,124634137,1886057615,3915621685,2657392035,249268274,2044508324,3772115230,2547177864,162941995,2125561021,3887607047,2428444049,498536548,1789927666,4089016648,2227061214,450548861,1843258603,4107580753,2211677639,325883990,1684777152,4251122042,2321926636,335633487,1661365465,4195302755,2366115317,997073096,1281953886,3579855332,2724688242,1006888145,1258607687,3524101629,2768942443,901097722,1119000684,3686517206,2898065728,853044451,1172266101,3705015759,2882616665,651767980,1373503546,3369554304,3218104598,565507253,1454621731,3485111705,3099436303,671266974,1594198024,3322730930,2970347812,795835527,1483230225,3244367275,3060149565,1994146192,31158534,2563907772,4023717930,1907459465,112637215,2680153253,3904427059,2013776290,251722036,2517215374,3775830040,2137656763,141376813,2439277719,3865271297,1802195444,476864866,2238001368,4066508878,1812370925,453092731,2181625025,4111451223,1706088902,314042704,2344532202,4240017532,1658658271,366619977,2362670323,4224994405,1303535960,984961486,2747007092,3569037538,1256170817,1037604311,2765210733,3554079995,1131014506,879679996,2909243462,3663771856,1141124467,855842277,2852801631,3708648649,1342533948,654459306,3188396048,3373015174,1466479909,544179635,3110523913,3462522015,1591671054,702138776,2966460450,3352799412,1504918807,783551873,3082640443,3233442989,3988292384,2596254646,62317068,1957810842,3939845945,2647816111,81470997,1943803523,3814918930,2489596804,225274430,2053790376,3826175755,2466906013,167816743,2097651377,4027552580,2265490386,503444072,1762050814,4150417245,2154129355,426522225,1852507879,4275313526,2312317920,282753626,1742555852,4189708143,2394877945,397917763,1622183637,3604390888,2714866558,953729732,1340076626,3518719985,2797360999,1068828381,1219638859,3624741850,2936675148,906185462,1090812512,3747672003,2825379669,829329135,1181335161,3412177804,3160834842,628085408,1382605366,3423369109,3138078467,570562233,1426400815,3317316542,2998733608,733239954,1555261956,3268935591,3050360625,752459403,1541320221,2607071920,3965973030,1969922972,40735498,2617837225,3943577151,1913087877,83908371,2512341634,3803740692,2075208622,213261112,2463272603,3855990285,2094854071,198958881,2262029012,4057260610,1759359992,534414190,2176718541,4139329115,1873836001,414664567,2282248934,4279200368,1711684554,285281116,2405801727,4167216745,1634467795,376229701,2685067896,3608007406,1308918612,956543938,2808555105,3495958263,1231636301,1047427035,2932959818,3654703836,1088359270,936918e3,2847714899,3736837829,1202900863,817233897,3183342108,3401237130,1404277552,615818150,3134207493,3453421203,1423857449,601450431,3009837614,3294710456,1567103746,711928724,3020668471,3272380065,1510334235,755167117];typeof Int32Array<"u"&&(O2=new Int32Array(O2));/*!
 * MIT License: https://github.com/alexgorbatchev/crc/blob/master/LICENSE
 * Copyright: 2014 Alex Gorbatchev
 * Code: crc32, https://github.com/alexgorbatchev/crc/blob/master/src/calculators/crc32.ts
 */const wG=(t,e)=>{let n=~~e^-1;for(let r=0;r<t.length;r++)n=O2[(n^t[r])&255]^n>>>8;return n^-1},J5=4,e6=4;class si{static isPng(e,n){return e.getUint8(n+0)===137&&e.getUint8(n+1)===80&&e.getUint8(n+2)===78&&e.getUint8(n+3)===71&&e.getUint8(n+4)===13&&e.getUint8(n+5)===10&&e.getUint8(n+6)===26&&e.getUint8(n+7)===10}static getChunkType(e,n){return[String.fromCharCode(e.getUint8(n)),String.fromCharCode(e.getUint8(n+1)),String.fromCharCode(e.getUint8(n+2)),String.fromCharCode(e.getUint8(n+3))].join("")}static readChunks(e,n=0){const r={};if(!si.isPng(e,n))throw new Error("Not a PNG");for(n+=8;n<=e.buffer.byteLength;){const s=n,i=e.getInt32(n);n+=4;const o=si.getChunkType(e,n);if(o==="IDAT"&&r[o]){n+=i+J5+e6;continue}if(o==="IEND")break;r[o]={start:s,dataOffset:n+4,size:i},n+=i+J5+e6}return r}static parsePhys(e,n){return{ppux:e.getUint32(n),ppuy:e.getUint32(n+4),unit:e.getUint8(n+4)}}static findChunk(e,n){return si.readChunks(e)[n]}static setPhysChunk(e,n=1,r){let s=46,i=0;const o=si.findChunk(e,"pHYs");o&&(s=o.start,i=o.size);const a=si.findChunk(e,"IDAT");a&&(s=a.start,i=0);const l=new ArrayBuffer(21),c=new DataView(l);c.setUint32(0,9),c.setUint8(4,112),c.setUint8(5,72),c.setUint8(6,89),c.setUint8(7,115);const u=2835.5;c.setInt32(8,u*n),c.setInt32(12,u*n),c.setInt8(16,1);const h=new Uint8Array(l.slice(4,17));c.setInt32(17,wG(h));const p=e.buffer.slice(0,s),f=e.buffer.slice(s+i);return new Blob([p,l,f],r)}}/*!
 * MIT License: https://github.com/sindresorhus/is-webp/blob/main/license
 * Copyright (c) Sindre Sorhus <sindresorhus@gmail.com> (https://sindresorhus.com)
 */function bG(t){return!t||t.length<12?!1:t[8]===87&&t[9]===69&&t[10]===66&&t[11]===80}function CG(t){const e=new Uint8Array(t);return!bG(e)||!e||e.length<21?!1:(e[20]>>1&1)===1}const Lk=Object.freeze(["image/svg+xml"]),Nk=Object.freeze(["image/jpeg","image/png","image/webp"]),zk=Object.freeze(["image/gif","image/apng","image/avif"]),d4=Object.freeze([...Nk,...Lk,...zk]),Fk=Object.freeze(["video/mp4","video/webm","video/quicktime"]),PG=[...d4,...Fk].join(",");class oi{static loadVideo(e){return new Promise((n,r)=>{const s=document.createElement("video");s.onloadeddata=()=>n(s),s.onerror=i=>{console.error(i),r(new Error("Could not load video"))},s.crossOrigin="anonymous",s.src=e})}static loadImage(e){return new Promise((n,r)=>{const s=Ac();s.onload=()=>n(s),s.onerror=i=>{console.error(i),r(new Error("Could not load image"))},s.crossOrigin="anonymous",s.referrerPolicy="strict-origin-when-cross-origin",s.src=e})}static async getVideoSize(e){return oi.usingObjectURL(e,async n=>{const r=await oi.loadVideo(n);return{w:r.videoWidth,h:r.videoHeight}})}static async getImageSize(e){const n=await oi.usingObjectURL(e,oi.loadImage);try{if(e.type==="image/png"){const r=new DataView(await e.arrayBuffer());if(si.isPng(r,0)){const s=si.findChunk(r,"pHYs");if(s){const i=si.parsePhys(r,s.dataOffset);if(i.unit===0&&i.ppux===i.ppuy){const o=Math.max(i.ppux/2834.5,1);return{w:Math.round(n.naturalWidth/o),h:Math.round(n.naturalHeight/o)}}}}}}catch(r){return console.error(r),{w:n.naturalWidth,h:n.naturalHeight}}return{w:n.naturalWidth,h:n.naturalHeight}}static async isAnimated(e){return e.type==="image/gif"?xG(await e.arrayBuffer()):e.type==="image/avif"?vG(await e.arrayBuffer()):e.type==="image/webp"?CG(await e.arrayBuffer()):e.type==="image/apng"?yG(await e.arrayBuffer()):!1}static isAnimatedImageType(e){return zk.includes(e||"")}static isStaticImageType(e){return Nk.includes(e||"")}static isVectorImageType(e){return Lk.includes(e||"")}static isImageType(e){return d4.includes(e)}static async usingObjectURL(e,n){const r=URL.createObjectURL(e);try{return await n(r)}finally{URL.revokeObjectURL(r)}}}function mr(t,e,n){return t+(e-t)*n}function Hs(t=""){let e=0,n=0,r=0,s=0;function i(){const o=e^e<<11;return e=n,n=r,r=s,s^=(s>>>19^o^o>>>8)>>>0,s/4294967296*2}for(let o=0;o<t.length+64;o++)e^=t.charCodeAt(o)|0,i();return i}function Dc(t,e,n,r=!1){const[s,i]=e,[o,a]=n,l=o+(t-s)/(i-s)*(a-o);return r?o<a?Math.max(Math.min(l,a),o):Math.max(Math.min(l,o),a):l}function fi(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function xr(t,e){if(fi(t,e))return t[e]}function t6(t){return Object.keys(t)}function Rt(t){return Object.values(t)}function In(t){return Object.entries(t)}function $k(t){return Object.fromEntries(t)}function gd(t,e){const n={};let r=!1;for(const[s,i]of In(t))e(s,i)?n[s]=i:r=!0;return r?n:t}function bh(t,e){const n={};for(const[r,s]of In(t)){const i=e(r,s);n[r]=i}return n}function h4(t,e){if(t===e)return!0;const n=new Set(Object.keys(t)),r=new Set(Object.keys(e));if(n.size!==r.size)return!1;for(const s of n)if(!r.has(s)||!Object.is(t[s],e[s]))return!1;return!0}const zr="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz",Bk="a0",Uk="A00000000000000000000000000";function Hk(t){if(t>="a"&&t<="z")return t.charCodeAt(0)-97+2;if(t>="A"&&t<="Z")return 90-t.charCodeAt(0)+2;throw new Error("Invalid index key head: "+t)}function Wk(t){if(t.length!==Hk(t.charAt(0)))throw new Error("invalid integer part of index key: "+t)}function n6(t){if(t===void 0)throw Error("n is undefined")}function r6(t){Wk(t);const[e,...n]=t.split("");let r=!0;for(let s=n.length-1;r&&s>=0;s--){const i=zr.indexOf(n[s])+1;i===zr.length?n[s]="0":(n[s]=zr.charAt(i),r=!1)}if(r){if(e==="Z")return"a0";if(e==="z")return;const s=String.fromCharCode(e.charCodeAt(0)+1);return s>"a"?n.push("0"):n.pop(),s+n.join("")}else return e+n.join("")}function kG(t){Wk(t);const[e,...n]=t.split("");let r=!0;for(let s=n.length-1;r&&s>=0;s--){const i=zr.indexOf(n[s])-1;i===-1?n[s]=zr.slice(-1):(n[s]=zr.charAt(i),r=!1)}if(r){if(e==="a")return"Z"+zr.slice(-1);if(e==="A")return;const s=String.fromCharCode(e.charCodeAt(0)-1);return s<"Z"?n.push(zr.slice(-1)):n.pop(),s+n.join("")}else return e+n.join("")}function sc(t,e){if(e!==void 0&&t>=e)throw new Error(t+" >= "+e);if(t.slice(-1)==="0"||e&&e.slice(-1)==="0")throw new Error("trailing zero");if(e){let s=0;for(;(t.charAt(s)||"0")===e.charAt(s);)s++;if(s>0)return e.slice(0,s)+sc(t.slice(s),e.slice(s))}const n=t?zr.indexOf(t.charAt(0)):0,r=e!==void 0?zr.indexOf(e.charAt(0)):zr.length;if(r-n>1){const s=Math.round(.5*(n+r));return zr.charAt(s)}else return e&&e.length>1?e.slice(0,1):zr.charAt(n)+sc(t.slice(1),void 0)}function Wu(t){const e=Hk(t.charAt(0));if(e>t.length)throw new Error("invalid index: "+t);return t.slice(0,e)}function L2(t){if(t===Uk)throw new Error("invalid index: "+t);const e=Wu(t);if(t.slice(e.length).slice(-1)==="0")throw new Error("invalid index: "+t)}function Al(t,e){if(t!==void 0&&L2(t),e!==void 0&&L2(e),t!==void 0&&e!==void 0&&t>=e)throw new Error(t+" >= "+e);if(t===void 0&&e===void 0)return Bk;if(t===void 0){if(e===void 0)throw Error("b is undefined");const a=Wu(e),l=e.slice(a.length);if(a===Uk)return a+sc("",l);if(a<e)return a;const c=kG(a);return n6(c),c}if(e===void 0){const a=Wu(t),l=t.slice(a.length),c=r6(a);return c===void 0?a+sc(l,void 0):c}const n=Wu(t),r=t.slice(n.length),s=Wu(e),i=e.slice(s.length);if(n===s)return n+sc(r,i);const o=r6(n);return n6(o),o<e?o:n+sc(r,void 0)}function sa(t,e,n){if(n===0)return[];if(n===1)return[Al(t,e)];if(e===void 0){let i=Al(t,e);const o=[i];for(let a=0;a<n-1;a++)i=Al(i,e),o.push(i);return o}if(t===void 0){let i=Al(t,e);const o=[i];for(let a=0;a<n-1;a++)i=Al(t,i),o.push(i);return o.reverse(),o}const r=Math.floor(n/2),s=Al(t,e);return[...sa(t,s,r),s,...sa(s,e,n-r-1)]}const Kk=Bk;function IG(t){L2(t)}function jc(t,e,n){return sa(t,e,n)}function ey(t,e){return sa(t,void 0,e)}function Gd(t,e){return sa(t,e,1)[0]}function js(t){return sa(t,void 0,1)[0]}function EG(t){return sa(void 0,t,1)[0]}function Vd(t,e="a1"){return[e,...sa(e,void 0,t)]}function Un(t,e){return t.index<e.index?-1:t.index>e.index?1:0}function TG(t,e){return t.id>e.id?1:-1}function p4(t){try{return localStorage.getItem(t)}catch{return null}}function f4(t,e){try{localStorage.setItem(t,e)}catch{}}function MG(){try{localStorage.clear()}catch{}}function Gk(t){try{return sessionStorage.getItem(t)}catch{return null}}function g4(t,e){try{sessionStorage.setItem(t,e)}catch{}}function Vk(t){try{sessionStorage.removeItem(t)}catch{}}function _G(){try{sessionStorage.clear()}catch{}}const qk=()=>typeof process<"u"&&!1,ai=[],AG=60,md=Math.ceil(1e3/AG);let Ua,ty=0,Wf=0;const DG=()=>{const t=ai.splice(0,ai.length);for(const e of t)e()};function m4(){if(Ua)return;const t=Date.now(),e=t-Wf;if(ty+e<md){Ua=requestAnimationFrame(()=>{Ua=void 0,m4()});return}Ua=requestAnimationFrame(()=>{Ua=void 0,Wf=t,ty=Math.min(ty+e-md,md*10),DG()})}let Kf=!1;function s6(t){if(qk())return t.cancel=()=>Ua&&cancelAnimationFrame(Ua),t;const e=()=>{ai.includes(t)||(ai.push(t),Kf||(Kf=!0,Wf=Date.now()-md-1),m4())};return e.cancel=()=>{const n=ai.indexOf(t);n>-1&&ai.splice(n,1)},e}function Yk(t){return qk()?(t(),()=>{}):(ai.includes(t)||(ai.push(t),Kf||(Kf=!0,Wf=Date.now()-md-1),m4()),()=>{const e=ai.indexOf(t);e>-1&&ai.splice(e,1)})}class jG{constructor(){g(this,"timeouts",[]);g(this,"intervals",[]);g(this,"rafs",[])}setTimeout(e,n,...r){const s=window.setTimeout(e,n,r);return this.timeouts.push(s),s}setInterval(e,n,...r){const s=window.setInterval(e,n,r);return this.intervals.push(s),s}requestAnimationFrame(e){const n=window.requestAnimationFrame(e);return this.rafs.push(n),n}dispose(){this.timeouts.forEach(e=>clearTimeout(e)),this.intervals.forEach(e=>clearInterval(e)),this.rafs.forEach(e=>cancelAnimationFrame(e)),this.timeouts.length=0,this.intervals.length=0,this.rafs.length=0}}function RG(t){return t!==null}function OG(){return typeof globalThis<"u"&&globalThis.structuredClone?[globalThis.structuredClone,!0]:typeof global<"u"&&global.structuredClone?[global.structuredClone,!0]:typeof window<"u"&&window.structuredClone?[window.structuredClone,!0]:[t=>t&&JSON.parse(JSON.stringify(t)),!1]}const Xk=OG(),yt=Xk[0];Xk[1];const LG=Object.getPrototypeOf(yt({})),i6=new Set;function NG(t){i6.has(t)||(i6.add(t),console.warn(`[tldraw] ${t}`))}var ny={};const y4={enableLicensing:zG("enableLicensing",{defaults:{all:!0,production:!1}})},Zk=ur("pointerCaptureTrackingObject",{defaults:{all:new Map},shouldStoreForSession:!1}),Vt={logPreventDefaults:ur("logPreventDefaults",{defaults:{all:!1}}),logPointerCaptures:ur("logPointerCaptures",{defaults:{all:!1}}),logElementRemoves:ur("logElementRemoves",{defaults:{all:!1}}),debugSvg:ur("debugSvg",{defaults:{all:!1}}),showFps:ur("showFps",{defaults:{all:!1}}),measurePerformance:ur("measurePerformance",{defaults:{all:!1}}),throwToBlob:ur("throwToBlob",{defaults:{all:!1}}),reconnectOnPing:ur("reconnectOnPing",{defaults:{all:!1}}),debugCursors:ur("debugCursors",{defaults:{all:!1}}),forceSrgb:ur("forceSrgbColors",{defaults:{all:!1}}),debugGeometry:ur("debugGeometry",{defaults:{all:!1}}),hideShapes:ur("hideShapes",{defaults:{all:!1}}),editOnType:ur("editOnType",{defaults:{all:!1}})};if(typeof Element<"u"){const t=Element.prototype.removeChild;ba("element removal logging",()=>{Vt.logElementRemoves.get()?Element.prototype.removeChild=function(e){return console.warn("[tldraw] removing child:",e),t.call(this,e)}:Element.prototype.removeChild=t})}function ur(t,{defaults:e,shouldStoreForSession:n=!0}){return Qk({name:t,defaults:e,shouldStoreForSession:n})}function zG(t,{defaults:e,shouldStoreForSession:n=!0}){return Qk({name:t,defaults:e,shouldStoreForSession:n})}function Qk(t){const e=$G(t),n=t.shouldStoreForSession?FG(t.name):null,r=Qt(`debug:${t.name}`,n??e);return typeof window<"u"&&(t.shouldStoreForSession&&ba(`debug:${t.name}`,()=>{const s=r.get();s===e?Vk(`tldraw_debug:${t.name}`):g4(`tldraw_debug:${t.name}`,JSON.stringify(s))}),Object.defineProperty(window,`tldraw${t.name.replace(/^[a-z]/,s=>s.toUpperCase())}`,{get(){return r.get()},set(s){r.set(s)},configurable:!0})),Object.assign(r,t)}function FG(t){try{return JSON.parse(Gk(`tldraw_debug:${t}`)??"null")}catch{return null}}function ry(t){try{return t()}catch{return null}}function $G(t){switch(ry(()=>ny.TLDRAW_ENV)??ry(()=>ny.VERCEL_PUBLIC_TLDRAW_ENV)??ry(()=>ny.NEXT_PUBLIC_TLDRAW_ENV)??"production"){case"production":return t.defaults.production??t.defaults.all;case"preview":case"staging":return t.defaults.staging??t.defaults.all;default:return t.defaults.development??t.defaults.all}}class Mp{constructor(e){g(this,"nextValue");g(this,"diff");this.previousValue=e}get(){var r,s,i,o;const e=((s=(r=this.diff)==null?void 0:r.removed)==null?void 0:s.size)??0,n=((o=(i=this.diff)==null?void 0:i.added)==null?void 0:o.size)??0;if(!(e===0&&n===0))return{value:this.nextValue,diff:this.diff}}_add(e,n){var r,s;this.nextValue??(this.nextValue=new Set(this.previousValue)),this.nextValue.add(e),this.diff??(this.diff={}),n?(r=this.diff.removed)==null||r.delete(e):((s=this.diff).added??(s.added=new Set),this.diff.added.add(e))}add(e){var s,i,o;const n=this.previousValue.has(e);if(n)return((i=(s=this.diff)==null?void 0:s.removed)==null?void 0:i.has(e))?this._add(e,n):void 0;(o=this.nextValue)!=null&&o.has(e)||this._add(e,n)}_remove(e,n){var r,s;this.nextValue??(this.nextValue=new Set(this.previousValue)),this.nextValue.delete(e),this.diff??(this.diff={}),n?((r=this.diff).removed??(r.removed=new Set),this.diff.removed.add(e)):(s=this.diff.added)==null||s.delete(e)}remove(e){var s,i,o,a;const n=this.previousValue.has(e);if(!n)return((i=(s=this.diff)==null?void 0:s.added)==null?void 0:i.has(e))?this._remove(e,n):void 0;(a=(o=this.diff)==null?void 0:o.removed)!=null&&a.has(e)||this._remove(e,n)}}let Jk=(t=21)=>crypto.getRandomValues(new Uint8Array(t)).reduce((e,n)=>(n&=63,n<36?e+=n.toString(36):n<62?e+=(n-26).toString(36).toUpperCase():n>62?e+="-":e+="_",e),"");class tm{constructor(e,n){g(this,"createDefaultProperties");g(this,"validator");g(this,"ephemeralKeys");g(this,"ephemeralKeySet");g(this,"scope");g(this,"isInstance",e=>(e==null?void 0:e.typeName)===this.typeName);this.typeName=e,this.createDefaultProperties=n.createDefaultProperties,this.validator=n.validator??{validate:s=>s},this.scope=n.scope??"document",this.ephemeralKeys=n.ephemeralKeys;const r=new Set;if(n.ephemeralKeys)for(const[s,i]of In(n.ephemeralKeys))i&&r.add(s);this.ephemeralKeySet=r}create(e){const n={...this.createDefaultProperties(),id:this.createId()};for(const[r,s]of Object.entries(e))s!==void 0&&(n[r]=s);return n.typeName=this.typeName,n}clone(e){return{...yt(e),id:this.createId()}}createId(e){return this.typeName+":"+(e??Jk())}createCustomId(e){return this.typeName+":"+e}parseId(e){if(!this.isId(e))throw new Error(`ID "${e}" is not a valid ID for type "${this.typeName}"`);return e.slice(this.typeName.length+1)}isId(e){if(!e)return!1;for(let n=0;n<this.typeName.length;n++)if(e[n]!==this.typeName[n])return!1;return e[this.typeName.length]===":"}withDefaultProperties(e){return new tm(this.typeName,{createDefaultProperties:e,validator:this.validator,scope:this.scope,ephemeralKeys:this.ephemeralKeys})}validate(e,n){return n&&this.validator.validateUsingKnownGoodVersion?this.validator.validateUsingKnownGoodVersion(n,e):this.validator.validate(e)}}function ki(t,e){return new tm(t,{createDefaultProperties:()=>({}),validator:e.validator,scope:e.scope,ephemeralKeys:e.ephemeralKeys})}function Gf(){return{added:{},updated:{},removed:{}}}function qd(t){const e={added:t.removed,removed:t.added,updated:{}};for(const[n,r]of Object.values(t.updated))e.updated[n.id]=[r,n];return e}function eI(t){return Object.keys(t.added).length===0&&Object.keys(t.updated).length===0&&Object.keys(t.removed).length===0}function nm(t){const e={added:{},removed:{},updated:{}};return yd(e,t),e}function yd(t,e){for(const n of e){for(const[r,s]of In(n.added))if(t.removed[r]){const i=t.removed[r];delete t.removed[r],i!==s&&(t.updated[r]=[i,s])}else t.added[r]=s;for(const[r,[s,i]]of In(n.updated)){if(t.added[r]){t.added[r]=i,delete t.updated[r],delete t.removed[r];continue}if(t.updated[r]){t.updated[r]=[t.updated[r][0],i],delete t.removed[r];continue}t.updated[r]=n.updated[r],delete t.removed[r]}for(const[r,s]of In(n.removed))t.added[r]?delete t.added[r]:t.updated[r]?(t.removed[r]=t.updated[r][0],delete t.updated[r]):t.removed[r]=s}}var Vf={exports:{}};Vf.exports;(function(t,e){var n=200,r="__lodash_hash_undefined__",s=1,i=2,o=9007199254740991,a="[object Arguments]",l="[object Array]",c="[object AsyncFunction]",u="[object Boolean]",h="[object Date]",p="[object Error]",f="[object Function]",v="[object GeneratorFunction]",m="[object Map]",x="[object Number]",y="[object Null]",S="[object Object]",w="[object Promise]",P="[object Proxy]",E="[object RegExp]",M="[object Set]",I="[object String]",_="[object Symbol]",D="[object Undefined]",R="[object WeakMap]",$="[object ArrayBuffer]",U="[object DataView]",O="[object Float32Array]",N="[object Float64Array]",H="[object Int8Array]",Z="[object Int16Array]",q="[object Int32Array]",V="[object Uint8Array]",Q="[object Uint8ClampedArray]",ne="[object Uint16Array]",le="[object Uint32Array]",de=/[\\^$.*+?()[\]{}|]/g,_e=/^\[object .+?Constructor\]$/,je=/^(?:0|[1-9]\d*)$/,ce={};ce[O]=ce[N]=ce[H]=ce[Z]=ce[q]=ce[V]=ce[Q]=ce[ne]=ce[le]=!0,ce[a]=ce[l]=ce[$]=ce[u]=ce[U]=ce[h]=ce[p]=ce[f]=ce[m]=ce[x]=ce[S]=ce[E]=ce[M]=ce[I]=ce[R]=!1;var tt=typeof Hn=="object"&&Hn&&Hn.Object===Object&&Hn,Ue=typeof self=="object"&&self&&self.Object===Object&&self,et=tt||Ue||Function("return this")(),Ge=e&&!e.nodeType&&e,lt=Ge&&!0&&t&&!t.nodeType&&t,nt=lt&&lt.exports===Ge,qn=nt&&tt.process,en=function(){try{return qn&&qn.binding&&qn.binding("util")}catch{}}(),an=en&&en.isTypedArray;function Et(L,W){for(var te=-1,ge=L==null?0:L.length,wt=0,Re=[];++te<ge;){var Bt=L[te];W(Bt,te,L)&&(Re[wt++]=Bt)}return Re}function tn(L,W){for(var te=-1,ge=W.length,wt=L.length;++te<ge;)L[wt+te]=W[te];return L}function _r(L,W){for(var te=-1,ge=L==null?0:L.length;++te<ge;)if(W(L[te],te,L))return!0;return!1}function qs(L,W){for(var te=-1,ge=Array(L);++te<L;)ge[te]=W(te);return ge}function Ar(L){return function(W){return L(W)}}function uR(L,W){return L.has(W)}function dR(L,W){return L==null?void 0:L[W]}function hR(L){var W=-1,te=Array(L.size);return L.forEach(function(ge,wt){te[++W]=[wt,ge]}),te}function pR(L,W){return function(te){return L(W(te))}}function fR(L){var W=-1,te=Array(L.size);return L.forEach(function(ge){te[++W]=ge}),te}var gR=Array.prototype,mR=Function.prototype,Kh=Object.prototype,Xm=et["__core-js_shared__"],kb=mR.toString,Ys=Kh.hasOwnProperty,Ib=function(){var L=/[^.]+$/.exec(Xm&&Xm.keys&&Xm.keys.IE_PROTO||"");return L?"Symbol(src)_1."+L:""}(),Eb=Kh.toString,yR=RegExp("^"+kb.call(Ys).replace(de,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),Tb=nt?et.Buffer:void 0,Gh=et.Symbol,Mb=et.Uint8Array,_b=Kh.propertyIsEnumerable,vR=gR.splice,_a=Gh?Gh.toStringTag:void 0,Ab=Object.getOwnPropertySymbols,SR=Tb?Tb.isBuffer:void 0,xR=pR(Object.keys,Object),Zm=El(et,"DataView"),au=El(et,"Map"),Qm=El(et,"Promise"),Jm=El(et,"Set"),e1=El(et,"WeakMap"),lu=El(Object,"create"),wR=ja(Zm),bR=ja(au),CR=ja(Qm),PR=ja(Jm),kR=ja(e1),Db=Gh?Gh.prototype:void 0,t1=Db?Db.valueOf:void 0;function Aa(L){var W=-1,te=L==null?0:L.length;for(this.clear();++W<te;){var ge=L[W];this.set(ge[0],ge[1])}}function IR(){this.__data__=lu?lu(null):{},this.size=0}function ER(L){var W=this.has(L)&&delete this.__data__[L];return this.size-=W?1:0,W}function TR(L){var W=this.__data__;if(lu){var te=W[L];return te===r?void 0:te}return Ys.call(W,L)?W[L]:void 0}function MR(L){var W=this.__data__;return lu?W[L]!==void 0:Ys.call(W,L)}function _R(L,W){var te=this.__data__;return this.size+=this.has(L)?0:1,te[L]=lu&&W===void 0?r:W,this}Aa.prototype.clear=IR,Aa.prototype.delete=ER,Aa.prototype.get=TR,Aa.prototype.has=MR,Aa.prototype.set=_R;function Ai(L){var W=-1,te=L==null?0:L.length;for(this.clear();++W<te;){var ge=L[W];this.set(ge[0],ge[1])}}function AR(){this.__data__=[],this.size=0}function DR(L){var W=this.__data__,te=qh(W,L);if(te<0)return!1;var ge=W.length-1;return te==ge?W.pop():vR.call(W,te,1),--this.size,!0}function jR(L){var W=this.__data__,te=qh(W,L);return te<0?void 0:W[te][1]}function RR(L){return qh(this.__data__,L)>-1}function OR(L,W){var te=this.__data__,ge=qh(te,L);return ge<0?(++this.size,te.push([L,W])):te[ge][1]=W,this}Ai.prototype.clear=AR,Ai.prototype.delete=DR,Ai.prototype.get=jR,Ai.prototype.has=RR,Ai.prototype.set=OR;function Da(L){var W=-1,te=L==null?0:L.length;for(this.clear();++W<te;){var ge=L[W];this.set(ge[0],ge[1])}}function LR(){this.size=0,this.__data__={hash:new Aa,map:new(au||Ai),string:new Aa}}function NR(L){var W=Yh(this,L).delete(L);return this.size-=W?1:0,W}function zR(L){return Yh(this,L).get(L)}function FR(L){return Yh(this,L).has(L)}function $R(L,W){var te=Yh(this,L),ge=te.size;return te.set(L,W),this.size+=te.size==ge?0:1,this}Da.prototype.clear=LR,Da.prototype.delete=NR,Da.prototype.get=zR,Da.prototype.has=FR,Da.prototype.set=$R;function Vh(L){var W=-1,te=L==null?0:L.length;for(this.__data__=new Da;++W<te;)this.add(L[W])}function BR(L){return this.__data__.set(L,r),this}function UR(L){return this.__data__.has(L)}Vh.prototype.add=Vh.prototype.push=BR,Vh.prototype.has=UR;function bo(L){var W=this.__data__=new Ai(L);this.size=W.size}function HR(){this.__data__=new Ai,this.size=0}function WR(L){var W=this.__data__,te=W.delete(L);return this.size=W.size,te}function KR(L){return this.__data__.get(L)}function GR(L){return this.__data__.has(L)}function VR(L,W){var te=this.__data__;if(te instanceof Ai){var ge=te.__data__;if(!au||ge.length<n-1)return ge.push([L,W]),this.size=++te.size,this;te=this.__data__=new Da(ge)}return te.set(L,W),this.size=te.size,this}bo.prototype.clear=HR,bo.prototype.delete=WR,bo.prototype.get=KR,bo.prototype.has=GR,bo.prototype.set=VR;function qR(L,W){var te=Xh(L),ge=!te&&cO(L),wt=!te&&!ge&&n1(L),Re=!te&&!ge&&!wt&&Bb(L),Bt=te||ge||wt||Re,ln=Bt?qs(L.length,String):[],yn=ln.length;for(var Dt in L)Ys.call(L,Dt)&&!(Bt&&(Dt=="length"||wt&&(Dt=="offset"||Dt=="parent")||Re&&(Dt=="buffer"||Dt=="byteLength"||Dt=="byteOffset")||sO(Dt,yn)))&&ln.push(Dt);return ln}function qh(L,W){for(var te=L.length;te--;)if(Nb(L[te][0],W))return te;return-1}function YR(L,W,te){var ge=W(L);return Xh(L)?ge:tn(ge,te(L))}function cu(L){return L==null?L===void 0?D:y:_a&&_a in Object(L)?nO(L):lO(L)}function jb(L){return uu(L)&&cu(L)==a}function Rb(L,W,te,ge,wt){return L===W?!0:L==null||W==null||!uu(L)&&!uu(W)?L!==L&&W!==W:XR(L,W,te,ge,Rb,wt)}function XR(L,W,te,ge,wt,Re){var Bt=Xh(L),ln=Xh(W),yn=Bt?l:Co(L),Dt=ln?l:Co(W);yn=yn==a?S:yn,Dt=Dt==a?S:Dt;var Dr=yn==S,Ps=Dt==S,Dn=yn==Dt;if(Dn&&n1(L)){if(!n1(W))return!1;Bt=!0,Dr=!1}if(Dn&&!Dr)return Re||(Re=new bo),Bt||Bb(L)?Ob(L,W,te,ge,wt,Re):eO(L,W,yn,te,ge,wt,Re);if(!(te&s)){var es=Dr&&Ys.call(L,"__wrapped__"),ts=Ps&&Ys.call(W,"__wrapped__");if(es||ts){var Po=es?L.value():L,Di=ts?W.value():W;return Re||(Re=new bo),wt(Po,Di,te,ge,Re)}}return Dn?(Re||(Re=new bo),tO(L,W,te,ge,wt,Re)):!1}function ZR(L){if(!$b(L)||oO(L))return!1;var W=zb(L)?yR:_e;return W.test(ja(L))}function QR(L){return uu(L)&&Fb(L.length)&&!!ce[cu(L)]}function JR(L){if(!aO(L))return xR(L);var W=[];for(var te in Object(L))Ys.call(L,te)&&te!="constructor"&&W.push(te);return W}function Ob(L,W,te,ge,wt,Re){var Bt=te&s,ln=L.length,yn=W.length;if(ln!=yn&&!(Bt&&yn>ln))return!1;var Dt=Re.get(L);if(Dt&&Re.get(W))return Dt==W;var Dr=-1,Ps=!0,Dn=te&i?new Vh:void 0;for(Re.set(L,W),Re.set(W,L);++Dr<ln;){var es=L[Dr],ts=W[Dr];if(ge)var Po=Bt?ge(ts,es,Dr,W,L,Re):ge(es,ts,Dr,L,W,Re);if(Po!==void 0){if(Po)continue;Ps=!1;break}if(Dn){if(!_r(W,function(Di,Ra){if(!uR(Dn,Ra)&&(es===Di||wt(es,Di,te,ge,Re)))return Dn.push(Ra)})){Ps=!1;break}}else if(!(es===ts||wt(es,ts,te,ge,Re))){Ps=!1;break}}return Re.delete(L),Re.delete(W),Ps}function eO(L,W,te,ge,wt,Re,Bt){switch(te){case U:if(L.byteLength!=W.byteLength||L.byteOffset!=W.byteOffset)return!1;L=L.buffer,W=W.buffer;case $:return!(L.byteLength!=W.byteLength||!Re(new Mb(L),new Mb(W)));case u:case h:case x:return Nb(+L,+W);case p:return L.name==W.name&&L.message==W.message;case E:case I:return L==W+"";case m:var ln=hR;case M:var yn=ge&s;if(ln||(ln=fR),L.size!=W.size&&!yn)return!1;var Dt=Bt.get(L);if(Dt)return Dt==W;ge|=i,Bt.set(L,W);var Dr=Ob(ln(L),ln(W),ge,wt,Re,Bt);return Bt.delete(L),Dr;case _:if(t1)return t1.call(L)==t1.call(W)}return!1}function tO(L,W,te,ge,wt,Re){var Bt=te&s,ln=Lb(L),yn=ln.length,Dt=Lb(W),Dr=Dt.length;if(yn!=Dr&&!Bt)return!1;for(var Ps=yn;Ps--;){var Dn=ln[Ps];if(!(Bt?Dn in W:Ys.call(W,Dn)))return!1}var es=Re.get(L);if(es&&Re.get(W))return es==W;var ts=!0;Re.set(L,W),Re.set(W,L);for(var Po=Bt;++Ps<yn;){Dn=ln[Ps];var Di=L[Dn],Ra=W[Dn];if(ge)var Ub=Bt?ge(Ra,Di,Dn,W,L,Re):ge(Di,Ra,Dn,L,W,Re);if(!(Ub===void 0?Di===Ra||wt(Di,Ra,te,ge,Re):Ub)){ts=!1;break}Po||(Po=Dn=="constructor")}if(ts&&!Po){var Zh=L.constructor,Qh=W.constructor;Zh!=Qh&&"constructor"in L&&"constructor"in W&&!(typeof Zh=="function"&&Zh instanceof Zh&&typeof Qh=="function"&&Qh instanceof Qh)&&(ts=!1)}return Re.delete(L),Re.delete(W),ts}function Lb(L){return YR(L,hO,rO)}function Yh(L,W){var te=L.__data__;return iO(W)?te[typeof W=="string"?"string":"hash"]:te.map}function El(L,W){var te=dR(L,W);return ZR(te)?te:void 0}function nO(L){var W=Ys.call(L,_a),te=L[_a];try{L[_a]=void 0;var ge=!0}catch{}var wt=Eb.call(L);return ge&&(W?L[_a]=te:delete L[_a]),wt}var rO=Ab?function(L){return L==null?[]:(L=Object(L),Et(Ab(L),function(W){return _b.call(L,W)}))}:pO,Co=cu;(Zm&&Co(new Zm(new ArrayBuffer(1)))!=U||au&&Co(new au)!=m||Qm&&Co(Qm.resolve())!=w||Jm&&Co(new Jm)!=M||e1&&Co(new e1)!=R)&&(Co=function(L){var W=cu(L),te=W==S?L.constructor:void 0,ge=te?ja(te):"";if(ge)switch(ge){case wR:return U;case bR:return m;case CR:return w;case PR:return M;case kR:return R}return W});function sO(L,W){return W=W??o,!!W&&(typeof L=="number"||je.test(L))&&L>-1&&L%1==0&&L<W}function iO(L){var W=typeof L;return W=="string"||W=="number"||W=="symbol"||W=="boolean"?L!=="__proto__":L===null}function oO(L){return!!Ib&&Ib in L}function aO(L){var W=L&&L.constructor,te=typeof W=="function"&&W.prototype||Kh;return L===te}function lO(L){return Eb.call(L)}function ja(L){if(L!=null){try{return kb.call(L)}catch{}try{return L+""}catch{}}return""}function Nb(L,W){return L===W||L!==L&&W!==W}var cO=jb(function(){return arguments}())?jb:function(L){return uu(L)&&Ys.call(L,"callee")&&!_b.call(L,"callee")},Xh=Array.isArray;function uO(L){return L!=null&&Fb(L.length)&&!zb(L)}var n1=SR||fO;function dO(L,W){return Rb(L,W)}function zb(L){if(!$b(L))return!1;var W=cu(L);return W==f||W==v||W==c||W==P}function Fb(L){return typeof L=="number"&&L>-1&&L%1==0&&L<=o}function $b(L){var W=typeof L;return L!=null&&(W=="object"||W=="function")}function uu(L){return L!=null&&typeof L=="object"}var Bb=an?Ar(an):QR;function hO(L){return uO(L)?qR(L):JR(L)}function pO(){return[]}function fO(){return!1}t.exports=dO})(Vf,Vf.exports);var BG=Vf.exports;const il=ga(BG);function UG(t){if(t.length===0)return new Set;const e=t[0],n=t.slice(1),r=new Set;for(const s of e)n.every(i=>i.has(s))&&r.add(s);return r}function HG(t,e){const n={};for(const r of e)t.has(r)||(n.added??(n.added=new Set),n.added.add(r));for(const r of t)e.has(r)||(n.removed??(n.removed=new Set),n.removed.add(r));return n.added||n.removed?n:void 0}function o6(t,e){for(const[n,r]of Object.entries(t)){const s=r,i=e[n];if("eq"in s&&i!==s.eq||"neq"in s&&i===s.neq||"gt"in s&&(typeof i!="number"||i<=s.gt))return!1}return!0}function a6(t,e,n){const r=Object.fromEntries(Object.keys(n).map(s=>[s,new Set]));for(const[s,i]of Object.entries(n))if("eq"in i){const a=t.index(e,s).get().get(i.eq);if(a)for(const l of a)r[s].add(l)}else if("neq"in i){const o=t.index(e,s);for(const[a,l]of o.get())if(a!==i.neq)for(const c of l)r[s].add(c)}else if("gt"in i){const o=t.index(e,s);for(const[a,l]of o.get())if(a>i.gt)for(const c of l)r[s].add(c)}return UG(Object.values(r))}class WG{constructor(e,n){g(this,"indexCache",new Map);g(this,"historyCache",new Map);this.atoms=e,this.history=n}filterHistory(e){if(this.historyCache.has(e))return this.historyCache.get(e);const n=ee("filterHistory:"+e,(r,s)=>{if(Xa(r))return this.history.get();const i=this.history.getDiffSince(s);if(i===Ur)return this.history.get();const o={added:{},removed:{},updated:{}};let a=0,l=0,c=0;for(const u of i){for(const h of Rt(u.added))if(h.typeName===e)if(o.removed[h.id]){const p=o.removed[h.id];delete o.removed[h.id],l--,p!==h&&(o.updated[h.id]=[p,h],c++)}else o.added[h.id]=h,a++;for(const[h,p]of Rt(u.updated))p.typeName===e&&(o.added[p.id]?o.added[p.id]=p:o.updated[p.id]?o.updated[p.id]=[o.updated[p.id][0],p]:(o.updated[p.id]=[h,p],c++));for(const h of Rt(u.removed))h.typeName===e&&(o.added[h.id]?(delete o.added[h.id],a--):o.updated[h.id]?(o.removed[h.id]=o.updated[h.id][0],delete o.updated[h.id],c--,l++):(o.removed[h.id]=h,l++))}return a||l||c?Uu(this.history.get(),o):r},{historyLength:100});return this.historyCache.set(e,n),n}index(e,n){const r=e+":"+n;if(this.indexCache.has(r))return this.indexCache.get(r);const s=this.__uncached_createIndex(e,n);return this.indexCache.set(r,s),s}__uncached_createIndex(e,n){const r=this.filterHistory(e),s=()=>{r.get();const i=new Map;for(const o of Rt(this.atoms.get())){const a=o.get();if(a.typeName===e){const l=a[n];i.has(l)||i.set(l,new Set),i.get(l).add(a.id)}}return i};return ee("index:"+e+":"+n,(i,o)=>{if(Xa(i))return s();const a=r.getDiffSince(o);if(a===Ur)return s();const l=new Map,c=(f,v)=>{let m=l.get(f);m||(m=new Mp(i.get(f)??new Set)),m.add(v),l.set(f,m)},u=(f,v)=>{let m=l.get(f);m||(m=new Mp(i.get(f)??new Set)),m.remove(v),l.set(f,m)};for(const f of a){for(const v of Rt(f.added))if(v.typeName===e){const m=v[n];c(m,v.id)}for(const[v,m]of Rt(f.updated))if(m.typeName===e){const x=v[n],y=m[n];x!==y&&(u(x,m.id),c(y,m.id))}for(const v of Rt(f.removed))if(v.typeName===e){const m=v[n];u(m,v.id)}}let h,p;for(const[f,v]of l){const m=v.get();m&&(h||(h=new Map(i)),p||(p=new Map),m.value.size===0?h.delete(f):h.set(f,m.value),p.set(f,m.diff))}return h&&p?Uu(h,p):i},{historyLength:100})}record(e,n=()=>({}),r="record:"+e+(n?":"+n.toString():"")){const s=this.ids(e,n,r);return ee(r,()=>{var i;for(const o of s.get())return(i=this.atoms.get()[o])==null?void 0:i.get()})}records(e,n=()=>({}),r="records:"+e+(n?":"+n.toString():"")){const s=this.ids(e,n,"ids:"+r);return ee(r,()=>[...s.get()].map(i=>{const o=this.atoms.get()[i];if(!o)throw new Error("no atom found for record id: "+i);return o.get()}))}ids(e,n=()=>({}),r="ids:"+e+(n?":"+n.toString():"")){const s=this.filterHistory(e),i=()=>{s.get();const l=n();return Object.keys(l).length===0?new Set(Rt(this.atoms.get()).flatMap(c=>{const u=c.get();return u.typeName===e?u.id:[]})):a6(this,e,l)},o=l=>{const c=i(),u=HG(l,c);return u?Uu(c,u):l},a=ee("ids_query:"+r,n,{isEqual:il});return ee("query:"+r,(l,c)=>{const u=a.get();if(Xa(l))return i();if(c<a.lastChangedEpoch)return o(l);const h=s.getDiffSince(c);if(h===Ur)return o(l);const p=new Mp(l);for(const v of h){for(const m of Rt(v.added))m.typeName===e&&o6(u,m)&&p.add(m.id);for(const[m,x]of Rt(v.updated))x.typeName===e&&(o6(u,x)?p.add(x.id):p.remove(x.id));for(const m of Rt(v.removed))m.typeName===e&&p.remove(m.id)}const f=p.get();return f?Uu(f.value,f.diff):l},{historyLength:50})}exec(e,n){const r=a6(this,e,n);if(r.size===0)return qi;const s=this.atoms.get();return[...r].map(i=>s[i].get())}}class KG{constructor(e){g(this,"_beforeCreateHandlers",{});g(this,"_afterCreateHandlers",{});g(this,"_beforeChangeHandlers",{});g(this,"_afterChangeHandlers",{});g(this,"_beforeDeleteHandlers",{});g(this,"_afterDeleteHandlers",{});g(this,"_operationCompleteHandlers",[]);g(this,"_isEnabled",!0);this.store=e}isEnabled(){return this._isEnabled}setIsEnabled(e){this._isEnabled=e}handleBeforeCreate(e,n){if(!this._isEnabled)return e;const r=this._beforeCreateHandlers[e.typeName];if(r){let s=e;for(const i of r)s=i(s,n);return s}return e}handleAfterCreate(e,n){if(!this._isEnabled)return;const r=this._afterCreateHandlers[e.typeName];if(r)for(const s of r)s(e,n)}handleBeforeChange(e,n,r){if(!this._isEnabled)return n;const s=this._beforeChangeHandlers[n.typeName];if(s){let i=n;for(const o of s)i=o(e,i,r);return i}return n}handleAfterChange(e,n,r){if(!this._isEnabled)return;const s=this._afterChangeHandlers[n.typeName];if(s)for(const i of s)i(e,n,r)}handleBeforeDelete(e,n){if(!this._isEnabled)return!0;const r=this._beforeDeleteHandlers[e.typeName];if(r){for(const s of r)if(s(e,n)===!1)return!1}return!0}handleAfterDelete(e,n){if(!this._isEnabled)return;const r=this._afterDeleteHandlers[e.typeName];if(r)for(const s of r)s(e,n)}handleOperationComplete(e){if(this._isEnabled)for(const n of this._operationCompleteHandlers)n(e)}register(e){const n=[];for(const[r,s]of Object.entries(e))s!=null&&s.beforeCreate&&n.push(this.registerBeforeCreateHandler(r,s.beforeCreate)),s!=null&&s.afterCreate&&n.push(this.registerAfterCreateHandler(r,s.afterCreate)),s!=null&&s.beforeChange&&n.push(this.registerBeforeChangeHandler(r,s.beforeChange)),s!=null&&s.afterChange&&n.push(this.registerAfterChangeHandler(r,s.afterChange)),s!=null&&s.beforeDelete&&n.push(this.registerBeforeDeleteHandler(r,s.beforeDelete)),s!=null&&s.afterDelete&&n.push(this.registerAfterDeleteHandler(r,s.afterDelete));return()=>{for(const r of n)r()}}registerBeforeCreateHandler(e,n){return this._beforeCreateHandlers[e]||(this._beforeCreateHandlers[e]=[]),this._beforeCreateHandlers[e].push(n),()=>Oa(this._beforeCreateHandlers[e],n)}registerAfterCreateHandler(e,n){return this._afterCreateHandlers[e]||(this._afterCreateHandlers[e]=[]),this._afterCreateHandlers[e].push(n),()=>Oa(this._afterCreateHandlers[e],n)}registerBeforeChangeHandler(e,n){return this._beforeChangeHandlers[e]||(this._beforeChangeHandlers[e]=[]),this._beforeChangeHandlers[e].push(n),()=>Oa(this._beforeChangeHandlers[e],n)}registerAfterChangeHandler(e,n){return this._afterChangeHandlers[e]||(this._afterChangeHandlers[e]=[]),this._afterChangeHandlers[e].push(n),()=>Oa(this._afterChangeHandlers[e],n)}registerBeforeDeleteHandler(e,n){return this._beforeDeleteHandlers[e]||(this._beforeDeleteHandlers[e]=[]),this._beforeDeleteHandlers[e].push(n),()=>Oa(this._beforeDeleteHandlers[e],n)}registerAfterDeleteHandler(e,n){return this._afterDeleteHandlers[e]||(this._afterDeleteHandlers[e]=[]),this._afterDeleteHandlers[e].push(n),()=>Oa(this._afterDeleteHandlers[e],n)}registerOperationCompleteHandler(e){return this._operationCompleteHandlers.push(e),()=>Oa(this._operationCompleteHandlers,e)}}function Oa(t,e){const n=t.indexOf(e);n>=0&&t.splice(n,1)}class v4{constructor(e){g(this,"id");g(this,"atoms",Qt("store_atoms",{}));g(this,"history",Qt("history",0,{historyLength:1e3}));g(this,"query",new WG(this.atoms,this.history));g(this,"listeners",new Set);g(this,"historyAccumulator",new VG);g(this,"historyReactor");g(this,"cancelHistoryReactor",()=>{});g(this,"schema");g(this,"props");g(this,"scopedTypes");g(this,"sideEffects",new KG(this));g(this,"put",(e,n)=>{this.atomic(()=>{const r={},s={},i=this.atoms.__unsafe__getWithoutCapture();let o=null,a,l=!1;const c=this.isMergingRemoteChanges?"remote":"user";for(let u=0,h=e.length;u<h;u++){a=e[u];const p=(o??i)[a.id];if(p){const f=p.__unsafe__getWithoutCapture();if(a=this.sideEffects.handleBeforeChange(f,a,c),this.schema.validateRecord(this,a,n??"updateRecord",f)===f)continue;p.set(a),l=!0;const m=p.__unsafe__getWithoutCapture();r[a.id]=[f,m],this.addDiffForAfterEvent(f,m)}else a=this.sideEffects.handleBeforeCreate(a,c),l=!0,a=this.schema.validateRecord(this,a,n??"createRecord",null),s[a.id]=a,this.addDiffForAfterEvent(null,a),o||(o={...i}),o[a.id]=Qt("atom:"+a.id,a)}o&&this.atoms.set(o),l&&this.updateHistory({added:s,updated:r,removed:{}})})});g(this,"remove",e=>{this.atomic(()=>{const n=new Set,r=this.isMergingRemoteChanges?"remote":"user";if(this.sideEffects.isEnabled())for(const i of e){const o=this.atoms.__unsafe__getWithoutCapture()[i];o&&this.sideEffects.handleBeforeDelete(o.get(),r)===!1&&n.add(i)}let s;this.atoms.update(i=>{let o;for(const a of e){if(n.has(a)||!(a in i))continue;o||(o={...i}),s||(s={}),delete o[a];const l=i[a].get();s[a]=l,this.addDiffForAfterEvent(l,null)}return o??i}),s&&this.updateHistory({added:{},updated:{},removed:s})})});g(this,"get",e=>{var n;return(n=this.atoms.get()[e])==null?void 0:n.get()});g(this,"unsafeGetWithoutCapture",e=>{var n;return(n=this.atoms.get()[e])==null?void 0:n.__unsafe__getWithoutCapture()});g(this,"serialize",(e="document")=>{const n={};for(const[r,s]of In(this.atoms.get())){const i=s.get();(e==="all"||this.scopedTypes[e].has(i.typeName))&&(n[r]=i)}return n});g(this,"allRecords",()=>Rt(this.atoms.get()).map(e=>e.get()));g(this,"clear",()=>{this.remove(t6(this.atoms.get()))});g(this,"update",(e,n)=>{const r=this.atoms.get()[e];if(!r){console.error(`Record ${e} not found. This is probably an error`);return}this.put([n(r.__unsafe__getWithoutCapture())])});g(this,"has",e=>!!this.atoms.get()[e]);g(this,"listen",(e,n)=>{this._flushHistory();const r={onHistory:e,filters:{source:(n==null?void 0:n.source)??"all",scope:(n==null?void 0:n.scope)??"all"}};return this.listeners.add(r),this.historyReactor.scheduler.isActivelyListening||this.historyReactor.start(),()=>{this.listeners.delete(r),this.listeners.size===0&&this.historyReactor.stop()}});g(this,"isMergingRemoteChanges",!1);g(this,"mergeRemoteChanges",e=>{if(this.isMergingRemoteChanges)return e();if(this._isInAtomicOp)throw new Error("Cannot merge remote changes while in atomic operation");try{this.isMergingRemoteChanges=!0,zs(e)}finally{this.isMergingRemoteChanges=!1}});g(this,"createComputedCache",(e,n,r)=>{const s=new so;return{get:i=>{const o=this.atoms.get()[i];if(o)return s.get(o,()=>{const a=r?ee(o.name+":equals",()=>o.get(),{isEqual:r}):o;return ee(e+":"+i,()=>n(a.get()))}).get()}}});g(this,"createSelectedComputedCache",(e,n,r)=>{const s=new so;return{get:i=>{const o=this.atoms.get()[i];if(o)return s.get(o,()=>{const a=ee(e+":"+i+":selector",()=>n(o.get()));return ee(e+":"+i,()=>r(a.get()))}).get()}}});g(this,"_integrityChecker");g(this,"_isPossiblyCorrupted",!1);g(this,"pendingAfterEvents",null);g(this,"_isInAtomicOp",!1);const{initialData:n,schema:r,id:s}=e;this.id=s??Jk(),this.schema=r,this.props=e.props,n&&this.atoms.set($k(In(n).map(([i,o])=>[i,Qt("atom:"+i,this.schema.validateRecord(this,o,"initialize",null))]))),this.historyReactor=zW("Store.historyReactor",()=>{this.history.get(),this._flushHistory()},{scheduleEffect:i=>this.cancelHistoryReactor=Yk(i)}),this.scopedTypes={document:new Set(Rt(this.schema.types).filter(i=>i.scope==="document").map(i=>i.typeName)),session:new Set(Rt(this.schema.types).filter(i=>i.scope==="session").map(i=>i.typeName)),presence:new Set(Rt(this.schema.types).filter(i=>i.scope==="presence").map(i=>i.typeName))}}_flushHistory(){if(this.historyAccumulator.hasChanges()){const e=this.historyAccumulator.flush();for(const{changes:n,source:r}of e){let s=null,i=null,o=null;for(const{onHistory:a,filters:l}of this.listeners)if(!(l.source!=="all"&&l.source!==r))if(l.scope!=="all")if(l.scope==="document"){if(i??(i=this.filterChangesByScope(n,"document")),!i)continue;a({changes:i,source:r})}else if(l.scope==="session"){if(s??(s=this.filterChangesByScope(n,"session")),!s)continue;a({changes:s,source:r})}else{if(o??(o=this.filterChangesByScope(n,"presence")),!o)continue;a({changes:o,source:r})}else a({changes:n,source:r})}}}dispose(){this.cancelHistoryReactor()}filterChangesByScope(e,n){const r={added:gd(e.added,(s,i)=>this.scopedTypes[n].has(i.typeName)),updated:gd(e.updated,(s,i)=>this.scopedTypes[n].has(i[1].typeName)),removed:gd(e.removed,(s,i)=>this.scopedTypes[n].has(i.typeName))};return Object.keys(r.added).length===0&&Object.keys(r.updated).length===0&&Object.keys(r.removed).length===0?null:r}updateHistory(e){this.historyAccumulator.add({changes:e,source:this.isMergingRemoteChanges?"remote":"user"}),this.listeners.size===0&&this.historyAccumulator.clear(),this.history.set(this.history.get()+1,e)}validate(e){this.allRecords().forEach(n=>this.schema.validateRecord(this,n,e,null))}getStoreSnapshot(e="document"){return{store:this.serialize(e),schema:this.schema.serialize()}}getSnapshot(e="document"){return console.warn("[tldraw] `Store.getSnapshot` is deprecated and will be removed in a future release. Use `getSnapshot` from the `tldraw` package instead."),this.getStoreSnapshot(e)}migrateSnapshot(e){const n=this.schema.migrateStoreSnapshot(e);if(n.type==="error")throw new Error(`Failed to migrate snapshot: ${n.reason}`);return{store:n.value,schema:this.schema.serialize()}}loadStoreSnapshot(e){const n=this.schema.migrateStoreSnapshot(e);if(n.type==="error")throw new Error(`Failed to migrate snapshot: ${n.reason}`);const r=this.sideEffects.isEnabled();try{this.sideEffects.setIsEnabled(!1),this.atomic(()=>{this.clear(),this.put(Object.values(n.value)),this.ensureStoreIsUsable()})}finally{this.sideEffects.setIsEnabled(r)}}loadSnapshot(e){console.warn("[tldraw] `Store.loadSnapshot` is deprecated and will be removed in a future release. Use `loadSnapshot` from the 'tldraw' package instead."),this.loadStoreSnapshot(e)}extractingChanges(e){const n=[],r=this.historyAccumulator.addInterceptor(s=>n.push(s.changes));try{return zs(e),nm(n)}finally{r()}}applyDiff(e,{runCallbacks:n=!0,ignoreEphemeralKeys:r=!1}={}){this.atomic(()=>{const s=Rt(e.added);for(const[o,a]of Rt(e.updated)){const l=this.schema.getType(a.typeName);if(r&&l.ephemeralKeySet.size){const c=this.get(a.id);if(!c){s.push(a);continue}let u=null;for(const[h,p]of Object.entries(a))l.ephemeralKeySet.has(h)||Object.is(p,xr(c,h))||(u||(u={...c}),u[h]=p);u&&s.push(u)}else s.push(a)}const i=t6(e.removed);s.length&&this.put(s),i.length&&this.remove(i)},n)}ensureStoreIsUsable(){this.atomic(()=>{var e;this._integrityChecker??(this._integrityChecker=this.schema.createIntegrityChecker(this)),(e=this._integrityChecker)==null||e.call(this)})}markAsPossiblyCorrupted(){this._isPossiblyCorrupted=!0}isPossiblyCorrupted(){return this._isPossiblyCorrupted}addDiffForAfterEvent(e,n){if(We(this.pendingAfterEvents,"must be in event operation"),e===n||(e&&n&&We(e.id===n.id),!e&&!n))return;const r=(e||n).id,s=this.pendingAfterEvents.get(r);s?s.after=n:this.pendingAfterEvents.set(r,{before:e,after:n})}flushAtomicCallbacks(){let e=0;const n=this.isMergingRemoteChanges?"remote":"user";for(;this.pendingAfterEvents;){const r=this.pendingAfterEvents;if(this.pendingAfterEvents=null,!!this.sideEffects.isEnabled()){if(e++,e>100)throw new Error("Maximum store update depth exceeded, bailing out");for(const{before:s,after:i}of r.values())s&&i?this.sideEffects.handleAfterChange(s,i,n):s&&!i?this.sideEffects.handleAfterDelete(s,n):!s&&i&&this.sideEffects.handleAfterCreate(i,n);this.pendingAfterEvents||this.sideEffects.handleOperationComplete(n)}}}atomic(e,n=!0){return zs(()=>{if(this._isInAtomicOp)return this.pendingAfterEvents||(this.pendingAfterEvents=new Map),e();this.pendingAfterEvents=new Map;const r=this.sideEffects.isEnabled();this.sideEffects.setIsEnabled(n??r),this._isInAtomicOp=!0;try{const s=e();return this.flushAtomicCallbacks(),s}finally{this.pendingAfterEvents=null,this.sideEffects.setIsEnabled(r),this._isInAtomicOp=!1}})}addHistoryInterceptor(e){return this.historyAccumulator.addInterceptor(n=>e(n,this.isMergingRemoteChanges?"remote":"user"))}}function GG(t){if(t.length===0)return[];const e=[];let n=[t[0]],r;for(let s=1,i=t.length;s<i;s++)r=t[s],n[0].source!==r.source&&(e.push(n),n=[]),n.push(r);return e.push(n),e.map(s=>({source:s[0].source,changes:nm(s.map(i=>i.changes))}))}class VG{constructor(){g(this,"_history",[]);g(this,"_interceptors",new Set)}addInterceptor(e){return this._interceptors.add(e),()=>{this._interceptors.delete(e)}}add(e){this._history.push(e);for(const n of this._interceptors)n(e)}flush(){const e=GG(this._history);return this._history=[],e}clear(){this._history=[]}hasChanges(){return this._history.length>0}}function qG(t,e,n){const r=new so;return{get(s,i){return r.get(s,()=>(s instanceof v4?s:s.store).createComputedCache(t,l=>e(s,l),n)).get(i)}}}function YG(t){const e=[];for(let n=t.length-1;n>=0;n--){const r=t[n];if("id"in r)e.unshift(r);else{const s=r.dependsOn,i=e[0];i&&(e[0]={...i,dependsOn:s.concat(i.dependsOn??[])})}}return e}function yc({sequence:t,sequenceId:e,retroactive:n=!0}){const r={sequenceId:e,retroactive:n,sequence:YG(t)};return tI(r),r}function Er(t,e){return Object.fromEntries(In(e).map(([n,r])=>[n,`${t}/${r}`]))}function Zr(t){const e=t.sequenceId;return yc({sequenceId:e,retroactive:t.retroactive??!0,sequence:t.sequence.map(n=>"id"in n?{...n,scope:"record",filter:r=>{var s,i;return r.typeName===t.recordType&&(((s=n.filter)==null?void 0:s.call(n,r))??!0)&&(((i=t.filter)==null?void 0:i.call(t,r))??!0)}}:n)})}function XG(t){const e=new Map(t.map(i=>[i.id,i])),n=new Set,r=[];function s(i){We(!n.has(i.id),`Circular dependency in migrations: ${i.id}`),n.add(i.id);const{version:o,sequenceId:a}=qf(i.id),l=e.get(`${a}/${o-1}`);if(l&&s(l),i.dependsOn)for(const c of i.dependsOn){const u=e.get(c);u&&s(u)}e.delete(i.id),r.push(i)}for(const i of e.values())s(i);return r}function qf(t){const[e,n]=t.split("/");return{sequenceId:e,version:parseInt(n)}}function l6(t,e){e&&We(t.startsWith(e+"/"),`Every migration in sequence '${e}' must have an id starting with '${e}/'. Got invalid id: '${t}'`),We(t.match(/^(.*?)\/(0|[1-9]\d*)$/),`Invalid migration id: '${t}'`)}function tI(t){if(We(!t.sequenceId.includes("/"),`sequenceId cannot contain a '/', got ${t.sequenceId}`),We(t.sequenceId.length,"sequenceId must be a non-empty string"),t.sequence.length===0)return;l6(t.sequence[0].id,t.sequenceId);let e=qf(t.sequence[0].id).version;We(e===1,`Expected the first migrationId to be '${t.sequenceId}/1' but got '${t.sequence[0].id}'`);for(let n=1;n<t.sequence.length;n++){const r=t.sequence[n].id;l6(r,t.sequenceId);const s=qf(r).version;We(s===e+1,`Migration id numbers must increase in increments of 1, expected ${t.sequenceId}/${e+1} but got '${t.sequence[n].id}'`),e=s}}var _o=(t=>(t.IncompatibleSubtype="incompatible-subtype",t.UnknownType="unknown-type",t.TargetVersionTooNew="target-version-too-new",t.TargetVersionTooOld="target-version-too-old",t.MigrationError="migration-error",t.UnrecognizedSubtype="unrecognized-subtype",t))(_o||{});function ZG(t){if(t.schemaVersion>2||t.schemaVersion<1)return Qo.err("Bad schema version");if(t.schemaVersion===2)return Qo.ok(t);const e={schemaVersion:2,sequences:{}};for(const[n,r]of Object.entries(t.recordVersions))if(e.sequences[`com.tldraw.${n}`]=r.version,"subTypeKey"in r)for(const[s,i]of Object.entries(r.subTypeVersions))e.sequences[`com.tldraw.${n}.${s}`]=i;return Qo.ok(e)}class S4{constructor(e,n){g(this,"migrations",{});g(this,"sortedMigrations");var s;this.types=e,this.options=n;for(const i of n.migrations??[])We(!this.migrations[i.sequenceId],`Duplicate migration sequenceId ${i.sequenceId}`),tI(i),this.migrations[i.sequenceId]=i;const r=Object.values(this.migrations).flatMap(i=>i.sequence);this.sortedMigrations=XG(r);for(const i of this.sortedMigrations)if((s=i.dependsOn)!=null&&s.length)for(const o of i.dependsOn){const a=r.find(l=>l.id===o);We(a,`Migration '${i.id}' depends on missing migration '${o}'`)}}static create(e,n){return new S4(e,n??{})}validateRecord(e,n,r,s){try{const i=xr(this.types,n.typeName);if(!i)throw new Error(`Missing definition for record type ${n.typeName}`);return i.validate(n,s??void 0)}catch(i){if(this.options.onValidationFailure)return this.options.onValidationFailure({store:e,record:n,phase:r,recordBefore:s,error:i});throw i}}getMigrationsSince(e){const n=ZG(e);if(!n.ok)return n;const r=n.value,s=new Set(Object.keys(r.sequences).filter(o=>this.migrations[o]));for(const o in this.migrations)r.sequences[o]===void 0&&this.migrations[o].retroactive&&s.add(o);if(s.size===0)return Qo.ok([]);const i=new Set;for(const o of s){const a=r.sequences[o];if(typeof a!="number"&&this.migrations[o].retroactive||a===0){for(const u of this.migrations[o].sequence)i.add(u.id);continue}const l=`${o}/${a}`,c=this.migrations[o].sequence.findIndex(u=>u.id===l);if(c===-1)return Qo.err("Incompatible schema?");for(const u of this.migrations[o].sequence.slice(c+1))i.add(u.id)}return Qo.ok(this.sortedMigrations.filter(({id:o})=>i.has(o)))}migratePersistedRecord(e,n,r="up"){const s=this.getMigrationsSince(n);if(!s.ok)return console.error("Error migrating record",s.error),{type:"error",reason:_o.MigrationError};let i=s.value;if(i.length===0)return{type:"success",value:e};if(i.some(o=>o.scope==="store"))return{type:"error",reason:r==="down"?_o.TargetVersionTooOld:_o.TargetVersionTooNew};if(r==="down"){if(!i.every(o=>o.down))return{type:"error",reason:_o.TargetVersionTooOld};i=i.slice().reverse()}e=yt(e);try{for(const o of i){if(o.scope==="store")throw new Error;if(!(o.filter?o.filter(e):!0))continue;const l=o[r](e);l&&(e=yt(l))}}catch(o){return console.error("Error migrating record",o),{type:"error",reason:_o.MigrationError}}return{type:"success",value:e}}migrateStoreSnapshot(e){let{store:n}=e;const r=this.getMigrationsSince(e.schema);if(!r.ok)return console.error("Error migrating store",r.error),{type:"error",reason:_o.MigrationError};const s=r.value;if(s.length===0)return{type:"success",value:n};n=yt(n);try{for(const i of s)if(i.scope==="record")for(const[o,a]of Object.entries(n)){if(!(i.filter?i.filter(a):!0))continue;const c=i.up(a);c&&(n[o]=yt(c))}else if(i.scope==="store"){const o=i.up(n);o&&(n=yt(o))}else Cn(i)}catch(i){return console.error("Error migrating store",i),{type:"error",reason:_o.MigrationError}}return{type:"success",value:n}}createIntegrityChecker(e){var n,r;return((r=(n=this.options).createIntegrityChecker)==null?void 0:r.call(n,e))??void 0}serialize(){return{schemaVersion:2,sequences:Object.fromEntries(Object.values(this.migrations).map(({sequenceId:e,sequence:n})=>[e,n.length?qf(n.at(-1).id).version:0]))}}serializeEarliestVersion(){return{schemaVersion:2,sequences:Object.fromEntries(Object.values(this.migrations).map(({sequenceId:e})=>[e,0]))}}getType(e){const n=xr(this.types,e);return We(n,"record type does not exists"),n}}function QG(t){if(!t.length)return null;let e="";for(const n of t)typeof n=="number"?e+=`.${n}`:n.startsWith("(")?e.endsWith(")")?e=`${e.slice(0,-1)}, ${n.slice(1)}`:e+=n:e+=`.${n}`;return e=e.replace(/id = [^,]+, /,"").replace(/id = [^)]+/,""),e.startsWith(".")?e.slice(1):e}class qe extends Error{constructor(n,r=[]){const s=QG(r),i=n.split(`
`).map((o,a)=>a===0?o:`  ${o}`).join(`
`);super(r?`At ${s}: ${i}`:i);g(this,"name","ValidationError");this.rawMessage=n,this.path=r}}function Ir(t,e){try{return e()}catch(n){throw n instanceof qe?new qe(n.rawMessage,[t,...n.path]):new qe(n.toString(),[t])}}function ia(t){if(t===null)return"null";if(Array.isArray(t))return"an array";const e=typeof t;switch(e){case"bigint":case"boolean":case"function":case"number":case"string":case"symbol":return`a ${e}`;case"object":return`an ${e}`;case"undefined":return"undefined";default:Cn(e)}}class ir{constructor(e,n){this.validationFn=e,this.validateUsingKnownGoodVersionFn=n}validate(e){return this.validationFn(e)}validateUsingKnownGoodVersion(e,n){return Object.is(e,n)?e:this.validateUsingKnownGoodVersionFn?this.validateUsingKnownGoodVersionFn(e,n):this.validate(n)}isValid(e){try{return this.validate(e),!0}catch{return!1}}nullable(){return sV(this)}optional(){return rI(this)}refine(e){return new ir(n=>e(this.validate(n)),(n,r)=>{const s=this.validateUsingKnownGoodVersion(n,r);return Object.is(n,s)?n:e(s)})}check(e,n){return typeof e=="string"?this.refine(r=>(Ir(`(check ${e})`,()=>n(r)),r)):this.refine(r=>(e(r),r))}}class JG extends ir{constructor(e){super(n=>{const r=c6.validate(n);for(let s=0;s<r.length;s++)Ir(s,()=>e.validate(r[s]));return r},(n,r)=>{if(!e.validateUsingKnownGoodVersion)return this.validate(r);const s=c6.validate(r);let i=n.length!==s.length;for(let o=0;o<s.length;o++){const a=s[o];if(o>=n.length){i=!0,Ir(o,()=>e.validate(a));continue}if(Object.is(n[o],a))continue;const l=Ir(o,()=>e.validateUsingKnownGoodVersion(n[o],a));Object.is(l,n[o])||(i=!0)}return i?r:n}),this.itemValidator=e}nonEmpty(){return this.check(e=>{if(e.length===0)throw new qe("Expected a non-empty array")})}lengthGreaterThan1(){return this.check(e=>{if(e.length<=1)throw new qe("Expected an array with length greater than 1")})}}class Yf extends ir{constructor(e,n=!1){super(r=>{if(typeof r!="object"||r===null)throw new qe(`Expected object, got ${ia(r)}`);for(const[s,i]of Object.entries(e))Ir(s,()=>{i.validate(xr(r,s))});if(!n){for(const s of Object.keys(r))if(!fi(e,s))throw new qe("Unexpected property",[s])}return r},(r,s)=>{if(typeof s!="object"||s===null)throw new qe(`Expected object, got ${ia(s)}`);let i=!1;for(const[o,a]of Object.entries(e)){const l=xr(r,o),c=xr(s,o);if(Object.is(l,c))continue;const u=Ir(o,()=>{const h=a;return h.validateUsingKnownGoodVersion?h.validateUsingKnownGoodVersion(l,c):h.validate(c)});Object.is(u,l)||(i=!0)}if(!n){for(const o of Object.keys(s))if(!fi(e,o))throw new qe("Unexpected property",[o])}for(const o of Object.keys(r))if(!fi(s,o)){i=!0;break}return i?s:r}),this.config=e,this.shouldAllowUnknownProperties=n}allowUnknownProperties(){return new Yf(this.config,!0)}extend(e){return new Yf({...this.config,...e})}}class rm extends ir{constructor(e,n,r,s){super(i=>{this.expectObject(i);const{matchingSchema:o,variant:a}=this.getMatchingSchemaAndVariant(i);return o===void 0?this.unknownValueValidation(i,a):Ir(`(${e} = ${a})`,()=>o.validate(i))},(i,o)=>{this.expectObject(o),this.expectObject(i);const{matchingSchema:a,variant:l}=this.getMatchingSchemaAndVariant(o);return a===void 0?this.unknownValueValidation(o,l):xr(i,e)!==xr(o,e)?Ir(`(${e} = ${l})`,()=>a.validate(o)):Ir(`(${e} = ${l})`,()=>a.validateUsingKnownGoodVersion?a.validateUsingKnownGoodVersion(i,o):a.validate(o))}),this.key=e,this.config=n,this.unknownValueValidation=r,this.useNumberKeys=s}expectObject(e){if(typeof e!="object"||e===null)throw new qe(`Expected an object, got ${ia(e)}`,[])}getMatchingSchemaAndVariant(e){const n=xr(e,this.key);if(!this.useNumberKeys&&typeof n!="string")throw new qe(`Expected a string for key "${this.key}", got ${ia(n)}`);if(this.useNumberKeys&&!Number.isFinite(Number(n)))throw new qe(`Expected a number for key "${this.key}", got "${n}"`);return{matchingSchema:fi(this.config,n)?this.config[n]:void 0,variant:n}}validateUnknownVariants(e){return new rm(this.key,this.config,e,this.useNumberKeys)}}class eV extends ir{constructor(e,n){super(r=>{if(typeof r!="object"||r===null)throw new qe(`Expected object, got ${ia(r)}`);for(const[s,i]of Object.entries(r))Ir(s,()=>{e.validate(s),n.validate(i)});return r},(r,s)=>{if(typeof s!="object"||s===null)throw new qe(`Expected object, got ${ia(s)}`);let i=!1;for(const[o,a]of Object.entries(s)){if(!fi(r,o)){i=!0,Ir(o,()=>{e.validate(o),n.validate(a)});continue}const l=xr(r,o),c=a;if(Object.is(l,c))continue;const u=Ir(o,()=>n.validateUsingKnownGoodVersion?n.validateUsingKnownGoodVersion(l,c):n.validate(c));Object.is(u,l)||(i=!0)}for(const o of Object.keys(r))if(!fi(s,o)){i=!0;break}return i?s:r}),this.keyValidator=e,this.valueValidator=n}}function x4(t){return new ir(e=>{if(typeof e!==t)throw new qe(`Expected ${t}, got ${ia(e)}`);return e})}const tV=new ir(t=>t),De=x4("string"),ke=x4("number").check(t=>{if(Number.isNaN(t))throw new qe("Expected a number, got NaN");if(!Number.isFinite(t))throw new qe(`Expected a finite number, got ${t}`)}),Xf=ke.check(t=>{if(t<0)throw new qe(`Expected a positive number, got ${t}`)}),Xt=ke.check(t=>{if(t<=0)throw new qe(`Expected a non-zero positive number, got ${t}`)}),nI=ke.check(t=>{if(!Number.isInteger(t))throw new qe(`Expected an integer, got ${t}`)}),_p=nI.check(t=>{if(t<0)throw new qe(`Expected a positive integer, got ${t}`)}),nV=nI.check(t=>{if(t<=0)throw new qe(`Expected a non-zero positive integer, got ${t}`)}),ze=x4("boolean");function Kn(t){return new ir(e=>{if(e!==t)throw new qe(`Expected ${t}, got ${JSON.stringify(e)}`);return t})}const c6=new ir(t=>{if(!Array.isArray(t))throw new qe(`Expected an array, got ${ia(t)}`);return t});function wn(t){return new JG(t)}function $e(t){return new Yf(t)}function N2(t){return typeof t=="object"&&t!==null&&(Object.getPrototypeOf(t)===Object.prototype||Object.getPrototypeOf(t)===null||Object.getPrototypeOf(t)===LG)}function z2(t){return t===null||typeof t=="number"||typeof t=="string"||typeof t=="boolean"?!0:Array.isArray(t)?t.every(z2):N2(t)?Object.values(t).every(z2):!1}const bn=new ir(t=>{if(z2(t))return t;throw new qe(`Expected json serializable value, got ${typeof t}`)},(t,e)=>{if(Array.isArray(t)&&Array.isArray(e)){let n=t.length!==e.length;for(let r=0;r<e.length;r++){if(r>=t.length){n=!0,bn.validate(e[r]);continue}const s=t[r],i=e[r];if(Object.is(s,i))continue;const o=bn.validateUsingKnownGoodVersion(s,i);Object.is(o,s)||(n=!0)}return n?e:t}else if(N2(t)&&N2(e)){let n=!1;for(const r of Object.keys(e)){if(!fi(t,r)){n=!0,bn.validate(e[r]);continue}const s=t[r],i=e[r];if(Object.is(s,i))continue;const o=bn.validateUsingKnownGoodVersion(s,i);Object.is(o,s)||(n=!0)}for(const r of Object.keys(t))if(!fi(e,r)){n=!0;break}return n?e:t}else return bn.validate(e)});function Zf(t,e){return new eV(t,e)}function w4(t,e){return new rm(t,e,(n,r)=>{throw new qe(`Expected one of ${Object.keys(e).map(s=>JSON.stringify(s)).join(" or ")}, got ${JSON.stringify(r)}`,[t])},!1)}function rV(t,e){return new rm(t,e,(n,r)=>{throw new qe(`Expected one of ${Object.keys(e).map(s=>JSON.stringify(s)).join(" or ")}, got ${JSON.stringify(r)}`,[t])},!0)}function Ii(t,e){return new ir(n=>Ir(t,()=>e.validate(n)),(n,r)=>Ir(t,()=>e.validateUsingKnownGoodVersion?e.validateUsingKnownGoodVersion(n,r):e.validate(r)))}function sm(t){return new ir(e=>{if(!t.has(e)){const n=Array.from(t,r=>JSON.stringify(r)).join(" or ");throw new qe(`Expected ${n}, got ${e}`)}return e})}function rI(t){return new ir(e=>{if(e!==void 0)return t.validate(e)},(e,n)=>{if(!(e===void 0&&n===void 0)&&n!==void 0)return t.validateUsingKnownGoodVersion&&e!==void 0?t.validateUsingKnownGoodVersion(e,n):t.validate(n)})}function sV(t){return new ir(e=>e===null?null:t.validate(e),(e,n)=>n===null?null:t.validateUsingKnownGoodVersion&&e!==null?t.validateUsingKnownGoodVersion(e,n):t.validate(n))}function im(...t){return sm(new Set(t))}function b4(t){try{return new URL(t)}catch{if(t.startsWith("/")||t.startsWith("./"))try{return new URL(t,"http://example.com")}catch{throw new qe(`Expected a valid url, got ${JSON.stringify(t)}`)}throw new qe(`Expected a valid url, got ${JSON.stringify(t)}`)}}const iV=new Set(["http:","https:","mailto:"]),Vr=De.check(t=>{if(t==="")return;const e=b4(t);if(!iV.has(e.protocol.toLowerCase()))throw new qe(`Expected a valid url, got ${JSON.stringify(t)} (invalid protocol)`)}),oV=new Set(["http:","https:","data:","asset:"]),ol=De.check(t=>{if(t==="")return;const e=b4(t);if(!oV.has(e.protocol.toLowerCase()))throw new qe(`Expected a valid url, got ${JSON.stringify(t)} (invalid protocol)`)});De.check(t=>{if(t==="")return;if(!b4(t).protocol.toLowerCase().match(/^https?:$/))throw new qe(`Expected a valid url, got ${JSON.stringify(t)} (invalid protocol)`)});const C4=De.refine(t=>{try{return IG(t),t}catch{throw new qe(`Expected an index key, got ${JSON.stringify(t)}`)}});function Hr(t){return De.refine(e=>{if(!e.startsWith(`${t}:`))throw new Error(`${t} ID must start with "${t}:"`);return e})}const om=Hr("asset");function P4(t,e){return $e({id:om,typeName:Kn("asset"),type:Kn(t),props:e,meta:bn})}const al=$e({x:ke,y:ke,z:ke.optional()}),vd=$e({x:ke,y:ke,w:ke,h:ke});let sI=(t=21)=>crypto.getRandomValues(new Uint8Array(t)).reduce((e,n)=>(n&=63,n<36?e+=n.toString(36):n<62?e+=(n-26).toString(36).toUpperCase():n>62?e+="-":e+="_",e),"");const iI=ke.check(t=>{if(t<0||t>1)throw new qe("Opacity must be between 0 and 1")}),aV=De.refine(t=>{if(!t.startsWith("page:")&&!t.startsWith("shape:"))throw new Error('Parent ID must start with "page:" or "shape:"');return t}),rs=Hr("shape");function lV(t,e,n){return $e({id:rs,typeName:Kn("shape"),x:ke,y:ke,rotation:ke,index:C4,parentId:aV,type:Kn(t),isLocked:ze,opacity:iI,props:e?$e(e):bn,meta:n?$e(n):bn})}const cV=Hr("binding");function uV(t,e,n){return $e({id:cV,typeName:Kn("binding"),type:Kn(t),fromId:rs,toId:rs,props:e?$e(e):bn,meta:n?$e(n):bn})}Er("com.tldraw.binding",{});Zr({sequenceId:"com.tldraw.binding",recordType:"binding",sequence:[]});function Qa(t){return`binding:${sI()}`}function dV(t){return ki("binding",{scope:"document",validator:Ii("binding",w4("type",bh(t,(e,{props:n,meta:r})=>uV(e,n,r))))}).withDefaultProperties(()=>({meta:{}}))}class _n{constructor(e,n,r){this.id=e,this.defaultValue=n,this.type=r}static define(e,n){const{defaultValue:r,type:s=tV}=n;return new _n(e,r,s)}static defineEnum(e,n){const{defaultValue:r,values:s}=n;return new hV(e,r,s)}setDefaultValue(e){this.defaultValue=e}validate(e){return this.type.validate(e)}validateUsingKnownGoodVersion(e,n){return this.type.validateUsingKnownGoodVersion?this.type.validateUsingKnownGoodVersion(e,n):this.validate(n)}}class hV extends _n{constructor(e,n,r){super(e,n,im(...r)),this.values=r}}const b0=Er("com.tldraw.shape",{AddIsLocked:1,HoistOpacity:2,AddMeta:3,AddWhite:4}),pV=Zr({sequenceId:"com.tldraw.shape",recordType:"shape",sequence:[{id:b0.AddIsLocked,up:t=>{t.isLocked=!1},down:t=>{delete t.isLocked}},{id:b0.HoistOpacity,up:t=>{t.opacity=Number(t.props.opacity??"1"),delete t.props.opacity},down:t=>{const e=t.opacity;delete t.opacity,t.props.opacity=e<.175?"0.1":e<.375?"0.25":e<.625?"0.5":e<.875?"0.75":"1"}},{id:b0.AddMeta,up:t=>{t.meta={}}},{id:b0.AddWhite,up:t=>{},down:t=>{t.props.color==="white"&&(t.props.color="black")}}]});function ic(t){return t?t.typeName==="shape":!1}function fr(t){return t?t.startsWith("shape:"):!1}function ot(t){return`shape:${t??sI()}`}function oI(t){const e=new Map;for(const[n,r]of Object.entries(t))if(r instanceof _n){if(e.has(r))throw new Error(`Duplicate style prop ${r.id}. Each style prop can only be used once within a shape.`);e.set(r,n)}return e}function Ws(t,e){return bh(e,(n,r)=>`com.tldraw.shape.${t}/${r}`)}function fV(t){return ki("shape",{scope:"document",validator:Ii("shape",w4("type",bh(t,(e,{props:n,meta:r})=>lV(e,n,r))))}).withDefaultProperties(()=>({x:0,y:0,rotation:0,isLocked:!1,opacity:1,meta:{}}))}function u6(t,e){const n=[];for(const[r,{migrations:s}]of Object.entries(e)){const i=`com.tldraw.${t}.${r}`;s?"sequenceId"in s?(We(i===s.sequenceId,`sequenceId mismatch for ${r} ${tm} migrations. Expected '${i}', got '${s.sequenceId}'`),n.push(s)):"sequence"in s?n.push(yc({sequenceId:i,retroactive:!1,sequence:s.sequence.map(o=>"id"in o?aI(t,r,o):o)})):n.push(yc({sequenceId:i,retroactive:!1,sequence:Object.keys(s.migrators).map(o=>Number(o)).sort((o,a)=>o-a).map(o=>({id:`${i}/${o}`,scope:"record",filter:a=>a.typeName===t&&a.type===r,up:a=>{const l=s.migrators[o].up(a);if(l)return l},down:a=>{const l=s.migrators[o].down(a);if(l)return l}}))})):n.push(yc({sequenceId:i,retroactive:!1,sequence:[]}))}return n}function aI(t,e,n){return{id:n.id,dependsOn:n.dependsOn,scope:"record",filter:r=>r.typeName===t&&r.type===e,up:r=>{const s=n.up(r.props);s&&(r.props=s)},down:typeof n.down=="function"?r=>{const s=n.down(r.props);s&&(r.props=s)}:void 0}}const lI=["black","grey","light-violet","violet","blue","light-blue","yellow","orange","green","light-green","light-red","red","white"],Qf={lightMode:{id:"light",text:"#000000",background:"rgb(249, 250, 251)",solid:"#fcfffe",black:{solid:"#1d1d1d",fill:"#1d1d1d",note:{fill:"#FCE19C",text:"#000000"},semi:"#e8e8e8",pattern:"#494949",highlight:{srgb:"#fddd00",p3:"color(display-p3 0.972 0.8705 0.05)"}},blue:{solid:"#4465e9",fill:"#4465e9",note:{fill:"#8AA3FF",text:"#000000"},semi:"#dce1f8",pattern:"#6681ee",highlight:{srgb:"#10acff",p3:"color(display-p3 0.308 0.6632 0.9996)"}},green:{solid:"#099268",fill:"#099268",note:{fill:"#6FC896",text:"#000000"},semi:"#d3e9e3",pattern:"#39a785",highlight:{srgb:"#00ffc8",p3:"color(display-p3 0.2536 0.984 0.7981)"}},grey:{solid:"#9fa8b2",fill:"#9fa8b2",note:{fill:"#C0CAD3",text:"#000000"},semi:"#eceef0",pattern:"#bcc3c9",highlight:{srgb:"#cbe7f1",p3:"color(display-p3 0.8163 0.9023 0.9416)"}},"light-blue":{solid:"#4ba1f1",fill:"#4ba1f1",note:{fill:"#9BC4FD",text:"#000000"},semi:"#ddedfa",pattern:"#6fbbf8",highlight:{srgb:"#00f4ff",p3:"color(display-p3 0.1512 0.9414 0.9996)"}},"light-green":{solid:"#4cb05e",fill:"#4cb05e",note:{fill:"#98D08A",text:"#000000"},semi:"#dbf0e0",pattern:"#65cb78",highlight:{srgb:"#65f641",p3:"color(display-p3 0.563 0.9495 0.3857)"}},"light-red":{solid:"#f87777",fill:"#f87777",note:{fill:"#F7A5A1",text:"#000000"},semi:"#f4dadb",pattern:"#fe9e9e",highlight:{srgb:"#ff7fa3",p3:"color(display-p3 0.9988 0.5301 0.6397)"}},"light-violet":{solid:"#e085f4",fill:"#e085f4",note:{fill:"#DFB0F9",text:"#000000"},semi:"#f5eafa",pattern:"#e9acf8",highlight:{srgb:"#ff88ff",p3:"color(display-p3 0.9676 0.5652 0.9999)"}},orange:{solid:"#e16919",fill:"#e16919",note:{fill:"#FAA475",text:"#000000"},semi:"#f8e2d4",pattern:"#f78438",highlight:{srgb:"#ffa500",p3:"color(display-p3 0.9988 0.6905 0.266)"}},red:{solid:"#e03131",fill:"#e03131",note:{fill:"#FC8282",text:"#000000"},semi:"#f4dadb",pattern:"#e55959",highlight:{srgb:"#ff636e",p3:"color(display-p3 0.9992 0.4376 0.45)"}},violet:{solid:"#ae3ec9",fill:"#ae3ec9",note:{fill:"#DB91FD",text:"#000000"},semi:"#ecdcf2",pattern:"#bd63d3",highlight:{srgb:"#c77cff",p3:"color(display-p3 0.7469 0.5089 0.9995)"}},yellow:{solid:"#f1ac4b",fill:"#f1ac4b",note:{fill:"#FED49A",text:"#000000"},semi:"#f9f0e6",pattern:"#fecb92",highlight:{srgb:"#fddd00",p3:"color(display-p3 0.972 0.8705 0.05)"}},white:{solid:"#FFFFFF",fill:"#FFFFFF",semi:"#f5f5f5",pattern:"#f9f9f9",note:{fill:"#FFFFFF",text:"#000000"},highlight:{srgb:"#ffffff",p3:"color(display-p3 1 1 1)"}}},darkMode:{id:"dark",text:"hsl(210, 17%, 98%)",background:"hsl(240, 5%, 6.5%)",solid:"#010403",black:{solid:"#f2f2f2",fill:"#f2f2f2",note:{fill:"#2c2c2c",text:"#f2f2f2"},semi:"#2c3036",pattern:"#989898",highlight:{srgb:"#d2b700",p3:"color(display-p3 0.8078 0.7225 0.0312)"}},blue:{solid:"#4f72fc",fill:"#4f72fc",note:{fill:"#2A3F98",text:"#f2f2f2"},semi:"#262d40",pattern:"#3a4b9e",highlight:{srgb:"#0079d2",p3:"color(display-p3 0.0032 0.4655 0.7991)"}},green:{solid:"#099268",fill:"#099268",note:{fill:"#014429",text:"#f2f2f2"},semi:"#253231",pattern:"#366a53",highlight:{srgb:"#009774",p3:"color(display-p3 0.0085 0.582 0.4604)"}},grey:{solid:"#9398b0",fill:"#9398b0",note:{fill:"#56595F",text:"#f2f2f2"},semi:"#33373c",pattern:"#7c8187",highlight:{srgb:"#9cb4cb",p3:"color(display-p3 0.6299 0.7012 0.7856)"}},"light-blue":{solid:"#4dabf7",fill:"#4dabf7",note:{fill:"#1F5495",text:"#f2f2f2"},semi:"#2a3642",pattern:"#4d7aa9",highlight:{srgb:"#00bdc8",p3:"color(display-p3 0.0023 0.7259 0.7735)"}},"light-green":{solid:"#40c057",fill:"#40c057",note:{fill:"#21581D",text:"#f2f2f2"},semi:"#2a3830",pattern:"#4e874e",highlight:{srgb:"#00a000",p3:"color(display-p3 0.2711 0.6172 0.0195)"}},"light-red":{solid:"#ff8787",fill:"#ff8787",note:{fill:"#923632",text:"#f2f2f2"},semi:"#3b3235",pattern:"#a56767",highlight:{srgb:"#db005b",p3:"color(display-p3 0.7849 0.0585 0.3589)"}},"light-violet":{solid:"#e599f7",fill:"#e599f7",note:{fill:"#762F8E",text:"#f2f2f2"},semi:"#383442",pattern:"#9770a9",highlight:{srgb:"#c400c7",p3:"color(display-p3 0.7024 0.0403 0.753)"}},orange:{solid:"#f76707",fill:"#f76707",note:{fill:"#843906",text:"#f2f2f2"},semi:"#3a2e2a",pattern:"#9f552d",highlight:{srgb:"#d07a00",p3:"color(display-p3 0.7699 0.4937 0.0085)"}},red:{solid:"#e03131",fill:"#e03131",note:{fill:"#89231A",text:"#f2f2f2"},semi:"#36292b",pattern:"#8f3734",highlight:{srgb:"#de002c",p3:"color(display-p3 0.7978 0.0509 0.2035)"}},violet:{solid:"#ae3ec9",fill:"#ae3ec9",note:{fill:"#681683",text:"#f2f2f2"},semi:"#31293c",pattern:"#763a8b",highlight:{srgb:"#9e00ee",p3:"color(display-p3 0.5651 0.0079 0.8986)"}},yellow:{solid:"#ffc034",fill:"#ffc034",note:{fill:"#98571B",text:"#f2f2f2"},semi:"#3c3934",pattern:"#fecb92",highlight:{srgb:"#d2b700",p3:"color(display-p3 0.8078 0.7225 0.0312)"}},white:{solid:"#f3f3f3",fill:"#f3f3f3",semi:"#f5f5f5",pattern:"#f9f9f9",note:{fill:"#eaeaea",text:"#1d1d1d"},highlight:{srgb:"#ffffff",p3:"color(display-p3 1 1 1)"}}}};function go(t){return t.isDarkMode?Qf.darkMode:Qf.lightMode}const qr=_n.defineEnum("tldraw:color",{defaultValue:"black",values:lI}),cI=_n.defineEnum("tldraw:labelColor",{defaultValue:"black",values:lI}),ll=_n.defineEnum("tldraw:dash",{defaultValue:"draw",values:["draw","solid","dashed","dotted"]}),cl=_n.defineEnum("tldraw:fill",{defaultValue:"none",values:["none","semi","solid","pattern","fill"]}),vi=_n.defineEnum("tldraw:font",{defaultValue:"draw",values:["draw","sans","serif","mono"]}),uI={draw:"'tldraw_draw', sans-serif",sans:"'tldraw_sans', sans-serif",serif:"'tldraw_serif', serif",mono:"'tldraw_mono', monospace"},Si=_n.defineEnum("tldraw:size",{defaultValue:"m",values:["s","m","l","xl"]}),dI=["arrow","triangle","square","dot","pipe","diamond","inverted","bar","none"],Jf=_n.defineEnum("tldraw:arrowheadStart",{defaultValue:"none",values:dI}),eg=_n.defineEnum("tldraw:arrowheadEnd",{defaultValue:"arrow",values:dI}),hI={labelColor:cI,color:qr,fill:cl,dash:ll,size:Si,arrowheadStart:Jf,arrowheadEnd:eg,font:vi,start:al,end:al,bend:ke,text:De,labelPosition:ke,scale:Xt},Bl=Ws("arrow",{AddLabelColor:1,AddIsPrecise:2,AddLabelPosition:3,ExtractBindings:4,AddScale:5});function C0(t){return aI("shape","arrow",t)}const pI=yc({sequenceId:"com.tldraw.shape.arrow",retroactive:!1,sequence:[C0({id:Bl.AddLabelColor,up:t=>{t.labelColor="black"},down:"retired"}),C0({id:Bl.AddIsPrecise,up:({start:t,end:e})=>{t.type==="binding"&&(t.isPrecise=!(t.normalizedAnchor.x===.5&&t.normalizedAnchor.y===.5)),e.type==="binding"&&(e.isPrecise=!(e.normalizedAnchor.x===.5&&e.normalizedAnchor.y===.5))},down:({start:t,end:e})=>{t.type==="binding"&&(t.isPrecise||(t.normalizedAnchor={x:.5,y:.5}),delete t.isPrecise),e.type==="binding"&&(e.isPrecise||(e.normalizedAnchor={x:.5,y:.5}),delete e.isPrecise)}}),C0({id:Bl.AddLabelPosition,up:t=>{t.labelPosition=.5},down:t=>{delete t.labelPosition}}),{id:Bl.ExtractBindings,scope:"store",up:t=>{const e=Object.values(t).filter(n=>n.typeName==="shape"&&n.type==="arrow");for(const n of e){const{start:r,end:s}=n.props;if(r.type==="binding"){const i=Qa(),o={typeName:"binding",id:i,type:"arrow",fromId:n.id,toId:r.boundShapeId,meta:{},props:{terminal:"start",normalizedAnchor:r.normalizedAnchor,isExact:r.isExact,isPrecise:r.isPrecise}};t[i]=o,n.props.start={x:0,y:0}}else delete n.props.start.type;if(s.type==="binding"){const i=Qa(),o={typeName:"binding",id:i,type:"arrow",fromId:n.id,toId:s.boundShapeId,meta:{},props:{terminal:"end",normalizedAnchor:s.normalizedAnchor,isExact:s.isExact,isPrecise:s.isPrecise}};t[i]=o,n.props.end={x:0,y:0}}else delete n.props.end.type}}},C0({id:Bl.AddScale,up:t=>{t.scale=1},down:t=>{delete t.scale}})]}),fI={terminal:im("start","end"),normalizedAnchor:al,isExact:ze,isPrecise:ze},gI={sequence:[{dependsOn:[Bl.ExtractBindings]}]},gV=Ii("camera",$e({typeName:Kn("camera"),id:Hr("camera"),x:ke,y:ke,z:ke,meta:bn})),mV=Er("com.tldraw.camera",{AddMeta:1}),yV=Zr({sequenceId:"com.tldraw.camera",recordType:"camera",sequence:[{id:mV.AddMeta,up:t=>{t.meta={}}}]}),Rs=ki("camera",{validator:gV,scope:"session"}).withDefaultProperties(()=>({x:0,y:0,z:1,meta:{}})),vV=new Set(["none","default","pointer","cross","grab","rotate","grabbing","resize-edge","resize-corner","text","move","ew-resize","ns-resize","nesw-resize","nwse-resize","nesw-rotate","nwse-rotate","swne-rotate","senw-rotate","zoom-in","zoom-out"]),mI=sm(vV),SV=$e({type:mI,rotation:ke}),xV=new Set(["accent","white","black","selection-stroke","selection-fill","laser","muted-1"]),wV=sm(xV),bV=new Set(["starting","paused","active","stopping"]),yI=$e({id:De,points:wn(al),size:Xf,color:wV,opacity:ke,state:sm(bV),delay:ke,shrink:ke,taper:ze}),Yd=Hr("page"),CV=Ii("page",$e({typeName:Kn("page"),id:Yd,name:De,index:C4,meta:bn})),PV=Er("com.tldraw.page",{AddMeta:1}),kV=Zr({sequenceId:"com.tldraw.page",recordType:"page",sequence:[{id:PV.AddMeta,up:t=>{t.meta={}}}]}),io=ki("page",{validator:CV,scope:"document"}).withDefaultProperties(()=>({meta:{}}));function dr(t){return io.isId(t)}const IV={id:!1,typeName:!1,currentPageId:!1,opacityForNextShape:!1,stylesForNextShape:!1,followingUserId:!1,highlightedUserIds:!1,brush:!1,cursor:!1,scribbles:!1,isFocusMode:!0,isDebugMode:!0,isToolLocked:!0,exportBackground:!0,screenBounds:!0,insets:!0,zoomBrush:!1,chatMessage:!1,isChatting:!1,isPenMode:!1,isGridMode:!0,isFocused:!0,devicePixelRatio:!0,isCoarsePointer:!0,isHoveringCanvas:!1,openMenus:!1,isChangingStyle:!1,isReadonly:!0,meta:!1,duplicateProps:!1},vI=t=>t?gd(t,e=>IV[e]):null;Hr("instance");function EV(t){const e={};for(const[r,s]of t)e[r]=rI(s);const n=Ii("instance",$e({typeName:Kn("instance"),id:Hr("instance"),currentPageId:Yd,followingUserId:De.nullable(),brush:vd.nullable(),opacityForNextShape:iI,stylesForNextShape:$e(e),cursor:SV,scribbles:wn(yI),isFocusMode:ze,isDebugMode:ze,isToolLocked:ze,exportBackground:ze,screenBounds:vd,insets:wn(ze),zoomBrush:vd.nullable(),isPenMode:ze,isGridMode:ze,chatMessage:De,isChatting:ze,highlightedUserIds:wn(De),isFocused:ze,devicePixelRatio:ke,isCoarsePointer:ze,isHoveringCanvas:ze.nullable(),openMenus:wn(De),isChangingStyle:ze,isReadonly:ze,meta:bn,duplicateProps:$e({shapeIds:wn(Hr("shape")),offset:$e({x:ke,y:ke})}).nullable()}));return ki("instance",{validator:n,scope:"session",ephemeralKeys:{currentPageId:!1,meta:!1,followingUserId:!0,opacityForNextShape:!0,stylesForNextShape:!0,brush:!0,cursor:!0,scribbles:!0,isFocusMode:!0,isDebugMode:!0,isToolLocked:!0,exportBackground:!0,screenBounds:!0,insets:!0,zoomBrush:!0,isPenMode:!0,isGridMode:!0,chatMessage:!0,isChatting:!0,highlightedUserIds:!0,isFocused:!0,devicePixelRatio:!0,isCoarsePointer:!0,isHoveringCanvas:!0,openMenus:!0,isChangingStyle:!0,isReadonly:!0,duplicateProps:!0}}).withDefaultProperties(()=>({followingUserId:null,opacityForNextShape:1,stylesForNextShape:{},brush:null,scribbles:[],cursor:{type:"default",rotation:0},isFocusMode:!1,exportBackground:!1,isDebugMode:!1,isToolLocked:!1,screenBounds:{x:0,y:0,w:1080,h:720},insets:[!1,!1,!1,!1],zoomBrush:null,isGridMode:!1,isPenMode:!1,chatMessage:"",isChatting:!1,highlightedUserIds:[],isFocused:!1,devicePixelRatio:typeof window>"u"?1:window.devicePixelRatio,isCoarsePointer:!1,isHoveringCanvas:null,openMenus:[],isChangingStyle:!1,isReadonly:!1,meta:{},duplicateProps:null}))}const bt=Er("com.tldraw.instance",{AddTransparentExportBgs:1,RemoveDialog:2,AddToolLockMode:3,RemoveExtraPropsForNextShape:4,AddLabelColor:5,AddFollowingUserId:6,RemoveAlignJustify:7,AddZoom:8,AddVerticalAlign:9,AddScribbleDelay:10,RemoveUserId:11,AddIsPenModeAndIsGridMode:12,HoistOpacity:13,AddChat:14,AddHighlightedUserIds:15,ReplacePropsForNextShapeWithStylesForNextShape:16,AddMeta:17,RemoveCursorColor:18,AddLonelyProperties:19,ReadOnlyReadonly:20,AddHoveringCanvas:21,AddScribbles:22,AddInset:23,AddDuplicateProps:24,RemoveCanMoveCamera:25}),TV=Zr({sequenceId:"com.tldraw.instance",recordType:"instance",sequence:[{id:bt.AddTransparentExportBgs,up:t=>({...t,exportBackground:!0})},{id:bt.RemoveDialog,up:({dialog:t,...e})=>e},{id:bt.AddToolLockMode,up:t=>({...t,isToolLocked:!1})},{id:bt.RemoveExtraPropsForNextShape,up:({propsForNextShape:t,...e})=>({...e,propsForNextShape:Object.fromEntries(Object.entries(t).filter(([n])=>["color","labelColor","dash","fill","size","font","align","verticalAlign","icon","geo","arrowheadStart","arrowheadEnd","spline"].includes(n)))})},{id:bt.AddLabelColor,up:({propsForNextShape:t,...e})=>({...e,propsForNextShape:{...t,labelColor:"black"}})},{id:bt.AddFollowingUserId,up:t=>({...t,followingUserId:null})},{id:bt.RemoveAlignJustify,up:t=>{let e=t.propsForNextShape.align;return e==="justify"&&(e="start"),{...t,propsForNextShape:{...t.propsForNextShape,align:e}}}},{id:bt.AddZoom,up:t=>({...t,zoomBrush:null})},{id:bt.AddVerticalAlign,up:t=>({...t,propsForNextShape:{...t.propsForNextShape,verticalAlign:"middle"}})},{id:bt.AddScribbleDelay,up:t=>t.scribble!==null?{...t,scribble:{...t.scribble,delay:0}}:{...t}},{id:bt.RemoveUserId,up:({userId:t,...e})=>e},{id:bt.AddIsPenModeAndIsGridMode,up:t=>({...t,isPenMode:!1,isGridMode:!1})},{id:bt.HoistOpacity,up:({propsForNextShape:{opacity:t,...e},...n})=>({...n,opacityForNextShape:Number(t??"1"),propsForNextShape:e})},{id:bt.AddChat,up:t=>({...t,chatMessage:"",isChatting:!1})},{id:bt.AddHighlightedUserIds,up:t=>({...t,highlightedUserIds:[]})},{id:bt.ReplacePropsForNextShapeWithStylesForNextShape,up:({propsForNextShape:t,...e})=>({...e,stylesForNextShape:{}})},{id:bt.AddMeta,up:t=>({...t,meta:{}})},{id:bt.RemoveCursorColor,up:t=>{const{color:e,...n}=t.cursor;return{...t,cursor:n}}},{id:bt.AddLonelyProperties,up:t=>({...t,canMoveCamera:!0,isFocused:!1,devicePixelRatio:1,isCoarsePointer:!1,openMenus:[],isChangingStyle:!1,isReadOnly:!1})},{id:bt.ReadOnlyReadonly,up:({isReadOnly:t,...e})=>({...e,isReadonly:t})},{id:bt.AddHoveringCanvas,up:t=>({...t,isHoveringCanvas:null})},{id:bt.AddScribbles,up:({scribble:t,...e})=>({...e,scribbles:[]})},{id:bt.AddInset,up:t=>({...t,insets:[!1,!1,!1,!1]}),down:({insets:t,...e})=>({...e})},{id:bt.AddDuplicateProps,up:t=>({...t,duplicateProps:null}),down:({duplicateProps:t,...e})=>({...e})},{id:bt.RemoveCanMoveCamera,up:({canMoveCamera:t,...e})=>({...e}),down:t=>({...t,canMoveCamera:!0})}]}),Fn="instance:instance",MV=Ii("instance_page_state",$e({typeName:Kn("instance_page_state"),id:Hr("instance_page_state"),pageId:Yd,selectedShapeIds:wn(rs),hintingShapeIds:wn(rs),erasingShapeIds:wn(rs),hoveredShapeId:rs.nullable(),editingShapeId:rs.nullable(),croppingShapeId:rs.nullable(),focusedGroupId:rs.nullable(),meta:bn})),bu=Er("com.tldraw.instance_page_state",{AddCroppingId:1,RemoveInstanceIdAndCameraId:2,AddMeta:3,RenameProperties:4,RenamePropertiesAgain:5}),_V=Zr({sequenceId:"com.tldraw.instance_page_state",recordType:"instance_page_state",sequence:[{id:bu.AddCroppingId,up(t){t.croppingShapeId=null}},{id:bu.RemoveInstanceIdAndCameraId,up(t){delete t.instanceId,delete t.cameraId}},{id:bu.AddMeta,up:t=>{t.meta={}}},{id:bu.RenameProperties,up:t=>{},down:t=>{}},{id:bu.RenamePropertiesAgain,up:t=>{t.selectedShapeIds=t.selectedIds,delete t.selectedIds,t.hintingShapeIds=t.hintingIds,delete t.hintingIds,t.erasingShapeIds=t.erasingIds,delete t.erasingIds,t.hoveredShapeId=t.hoveredId,delete t.hoveredId,t.editingShapeId=t.editingId,delete t.editingId,t.croppingShapeId=t.croppingShapeId??t.croppingId??null,delete t.croppingId,t.focusedGroupId=t.focusLayerId,delete t.focusLayerId},down:t=>{t.selectedIds=t.selectedShapeIds,delete t.selectedShapeIds,t.hintingIds=t.hintingShapeIds,delete t.hintingShapeIds,t.erasingIds=t.erasingShapeIds,delete t.erasingShapeIds,t.hoveredId=t.hoveredShapeId,delete t.hoveredShapeId,t.editingId=t.editingShapeId,delete t.editingShapeId,t.croppingId=t.croppingShapeId,delete t.croppingShapeId,t.focusLayerId=t.focusedGroupId,delete t.focusedGroupId}}]}),us=ki("instance_page_state",{validator:MV,scope:"session",ephemeralKeys:{pageId:!1,selectedShapeIds:!1,editingShapeId:!1,croppingShapeId:!1,meta:!1,hintingShapeIds:!0,erasingShapeIds:!0,hoveredShapeId:!0,focusedGroupId:!0}}).withDefaultProperties(()=>({editingShapeId:null,croppingShapeId:null,selectedShapeIds:[],hoveredShapeId:null,erasingShapeIds:[],hintingShapeIds:[],focusedGroupId:null,meta:{}})),AV=Ii("pointer",$e({typeName:Kn("pointer"),id:Hr("pointer"),x:ke,y:ke,lastActivityTimestamp:ke,meta:bn})),DV=Er("com.tldraw.pointer",{AddMeta:1}),jV=Zr({sequenceId:"com.tldraw.pointer",recordType:"pointer",sequence:[{id:DV.AddMeta,up:t=>{t.meta={}}}]}),k4=ki("pointer",{validator:AV,scope:"session"}).withDefaultProperties(()=>({x:0,y:0,lastActivityTimestamp:0,meta:{}})),Xd=k4.createId("pointer"),RV=Ii("instance_presence",$e({typeName:Kn("instance_presence"),id:Hr("instance_presence"),userId:De,userName:De,lastActivityTimestamp:ke,followingUserId:De.nullable(),cursor:$e({x:ke,y:ke,type:mI,rotation:ke}),color:De,camera:$e({x:ke,y:ke,z:ke}),screenBounds:vd,selectedShapeIds:wn(Hr("shape")),currentPageId:Hr("page"),brush:vd.nullable(),scribbles:wn(yI),chatMessage:De,meta:bn})),Cu=Er("com.tldraw.instance_presence",{AddScribbleDelay:1,RemoveInstanceId:2,AddChatMessage:3,AddMeta:4,RenameSelectedShapeIds:5}),OV=Zr({sequenceId:"com.tldraw.instance_presence",recordType:"instance_presence",sequence:[{id:Cu.AddScribbleDelay,up:t=>{t.scribble!==null&&(t.scribble.delay=0)}},{id:Cu.RemoveInstanceId,up:t=>{delete t.instanceId}},{id:Cu.AddChatMessage,up:t=>{t.chatMessage=""}},{id:Cu.AddMeta,up:t=>{t.meta={}}},{id:Cu.RenameSelectedShapeIds,up:t=>{}}]}),F2=ki("instance_presence",{validator:RV,scope:"presence"}).withDefaultProperties(()=>({lastActivityTimestamp:0,followingUserId:null,color:"#FF0000",camera:{x:0,y:0,z:1},cursor:{x:0,y:0,type:"default",rotation:0},screenBounds:{x:0,y:0,w:1,h:1},selectedShapeIds:[],brush:null,scribbles:[],chatMessage:"",meta:{}})),LV=(t,e)=>n=>ee("instancePresence",()=>{const r=n.get(Fn),s=n.get(us.createId(r==null?void 0:r.currentPageId)),i=n.get(Rs.createId(r==null?void 0:r.currentPageId)),o=n.get(Xd),a=t.get();return!s||!r||!i||!o||!a?null:F2.create({id:F2.createId(n.id),selectedShapeIds:s.selectedShapeIds,brush:r.brush,scribbles:r.scribbles,userId:a.id,userName:a.name,followingUserId:r.followingUserId,camera:{x:i.x,y:i.y,z:i.z},color:a.color,currentPageId:r.currentPageId,cursor:{x:o.x,y:o.y,rotation:r.cursor.rotation,type:r.cursor.type},lastActivityTimestamp:o.lastActivityTimestamp,screenBounds:r.screenBounds,chatMessage:r.chatMessage,meta:{}})}),NV=Ii("document",$e({typeName:Kn("document"),id:Kn("document:document"),gridSize:ke,name:De,meta:bn})),d6=Er("com.tldraw.document",{AddName:1,AddMeta:2}),zV=Zr({sequenceId:"com.tldraw.document",recordType:"document",sequence:[{id:d6.AddName,up:t=>{t.name=""},down:t=>{delete t.name}},{id:d6.AddMeta,up:t=>{t.meta={}}}]}),I4=ki("document",{validator:NV,scope:"document"}).withDefaultProperties(()=>({gridSize:10,name:"",meta:{}})),$2=I4.createId("document");function FV(t,e){return t.index<e.index?-1:t.index>e.index?1:0}function h6(t){t.typeName==="asset"&&("src"in t&&(t.src="<redacted>"),"src"in t.props&&(t.props.src="<redacted>"))}const $V=({error:t,phase:e,record:n,recordBefore:r})=>{throw u4(t,{tags:{origin:"store.validateRecord",storePhase:e,isExistingValidationIssue:e==="initialize"},extras:{recordBefore:r?h6(yt(r)):void 0,recordAfter:h6(yt(n))}}),t};function BV(){return[io.create({id:"page:page",name:"Page 1",index:"a1",meta:{}})]}function UV(t){const e=t.query.ids("page"),n=()=>{if(!t.has($2))return t.put([I4.create({id:$2,name:t.props.defaultName})]),n();if(!t.has(Xd))return t.put([k4.create({id:Xd})]),n();const r=e.get();if(r.size===0)return t.put(BV()),n();const s=()=>[...r].map(l=>t.get(l)).sort(FV)[0].id,i=t.get(Fn);if(i){if(!r.has(i.currentPageId))return t.put([{...i,currentPageId:s()}]),n()}else return t.put([t.schema.types.instance.create({id:Fn,currentPageId:s(),exportBackground:!0})]),n();const o=new Set,a=new Set;for(const l of r){const c=us.createId(l);t.has(c)||o.add(c);const u=Rs.createId(l);t.has(u)||a.add(u)}o.size>0&&t.put([...o].map(l=>us.create({id:l,pageId:us.parseId(l)}))),a.size>0&&t.put([...a].map(l=>Rs.create({id:l})))};return n}const HV=P4("bookmark",$e({title:De,description:De,image:De,favicon:De,src:ol.nullable()})),p6=Er("com.tldraw.asset.bookmark",{MakeUrlsValid:1,AddFavicon:2}),WV=Zr({sequenceId:"com.tldraw.asset.bookmark",recordType:"asset",filter:t=>t.type==="bookmark",sequence:[{id:p6.MakeUrlsValid,up:t=>{ol.isValid(t.props.src)||(t.props.src="")},down:t=>{}},{id:p6.AddFavicon,up:t=>{ol.isValid(t.props.favicon)||(t.props.favicon="")},down:t=>{delete t.props.favicon}}]}),KV=P4("image",$e({w:ke,h:ke,name:De,isAnimated:ze,mimeType:De.nullable(),src:ol.nullable(),fileSize:Xt.optional()})),Pu=Er("com.tldraw.asset.image",{AddIsAnimated:1,RenameWidthHeight:2,MakeUrlsValid:3,AddFileSize:4,MakeFileSizeOptional:5}),GV=Zr({sequenceId:"com.tldraw.asset.image",recordType:"asset",filter:t=>t.type==="image",sequence:[{id:Pu.AddIsAnimated,up:t=>{t.props.isAnimated=!1},down:t=>{delete t.props.isAnimated}},{id:Pu.RenameWidthHeight,up:t=>{t.props.w=t.props.width,t.props.h=t.props.height,delete t.props.width,delete t.props.height},down:t=>{t.props.width=t.props.w,t.props.height=t.props.h,delete t.props.w,delete t.props.h}},{id:Pu.MakeUrlsValid,up:t=>{ol.isValid(t.props.src)||(t.props.src="")},down:t=>{}},{id:Pu.AddFileSize,up:t=>{t.props.fileSize=-1},down:t=>{delete t.props.fileSize}},{id:Pu.MakeFileSizeOptional,up:t=>{t.props.fileSize===-1&&(t.props.fileSize=void 0)},down:t=>{t.props.fileSize===void 0&&(t.props.fileSize=-1)}}]}),VV=P4("video",$e({w:ke,h:ke,name:De,isAnimated:ze,mimeType:De.nullable(),src:ol.nullable(),fileSize:ke.optional()})),ku=Er("com.tldraw.asset.video",{AddIsAnimated:1,RenameWidthHeight:2,MakeUrlsValid:3,AddFileSize:4,MakeFileSizeOptional:5}),qV=Zr({sequenceId:"com.tldraw.asset.video",recordType:"asset",filter:t=>t.type==="video",sequence:[{id:ku.AddIsAnimated,up:t=>{t.props.isAnimated=!1},down:t=>{delete t.props.isAnimated}},{id:ku.RenameWidthHeight,up:t=>{t.props.w=t.props.width,t.props.h=t.props.height,delete t.props.width,delete t.props.height},down:t=>{t.props.width=t.props.w,t.props.height=t.props.h,delete t.props.w,delete t.props.h}},{id:ku.MakeUrlsValid,up:t=>{ol.isValid(t.props.src)||(t.props.src="")},down:t=>{}},{id:ku.AddFileSize,up:t=>{t.props.fileSize=-1},down:t=>{delete t.props.fileSize}},{id:ku.MakeFileSizeOptional,up:t=>{t.props.fileSize===-1&&(t.props.fileSize=void 0)},down:t=>{t.props.fileSize===void 0&&(t.props.fileSize=-1)}}]}),YV=Ii("asset",w4("type",{image:KV,video:VV,bookmark:HV})),XV=Er("com.tldraw.asset",{AddMeta:1}),ZV=Zr({sequenceId:"com.tldraw.asset",recordType:"asset",sequence:[{id:XV.AddMeta,up:t=>{t.meta={}}}]}),Ga=ki("asset",{validator:YV,scope:"document"}).withDefaultProperties(()=>({meta:{}})),SI={w:Xt,h:Xt,assetId:om.nullable(),url:Vr},f6=Ws("bookmark",{NullAssetId:1,MakeUrlsValid:2}),xI={sequence:[{id:f6.NullAssetId,up:t=>{t.assetId===void 0&&(t.assetId=null)},down:"retired"},{id:f6.MakeUrlsValid,up:t=>{Vr.isValid(t.url)||(t.url="")},down:t=>{}}]},wI=$e({type:im("free","straight"),points:wn(al)}),bI={color:qr,fill:cl,dash:ll,size:Si,segments:wn(wI),isComplete:ze,isClosed:ze,isPen:ze,scale:Xt},g6=Ws("draw",{AddInPen:1,AddScale:2}),CI={sequence:[{id:g6.AddInPen,up:t=>{const{points:e}=t.segments[0];if(e.length===0){t.isPen=!1;return}let n=!(e[0].z===0||e[0].z===.5);e[1]&&(n=n&&!(e[1].z===0||e[1].z===.5)),t.isPen=n},down:"retired"},{id:g6.AddScale,up:t=>{t.scale=1},down:t=>{delete t.scale}}]};var QV={};const m6=/(^\/r\/[^/]+\/?$)/,rt=t=>{try{return new URL(t)}catch{return}},Ch=[{type:"tldraw",title:"tldraw",hostnames:["beta.tldraw.com","tldraw.com","localhost:3000"],minWidth:300,minHeight:300,width:720,height:500,doesResize:!0,overridePermissions:{"allow-top-navigation":!0},toEmbedUrl:t=>{const e=rt(t);if(e&&e.pathname.match(m6))return t},fromEmbedUrl:t=>{const e=rt(t);if(e&&e.pathname.match(m6))return t}},{type:"figma",title:"Figma",hostnames:["figma.com"],width:720,height:500,doesResize:!0,toEmbedUrl:t=>{if(t.match(/https:\/\/([\w\.-]+\.)?figma.com\/(file|proto)\/([0-9a-zA-Z]{22,128})(?:\/.*)?$/)&&!t.includes("figma.com/embed"))return`https://www.figma.com/embed?embed_host=share&url=${t}`},fromEmbedUrl:t=>{const e=rt(t);if(e&&e.pathname.match(/^\/embed\/?$/)){const n=e.searchParams.get("url");if(n)return n}}},{type:"google_maps",title:"Google Maps",hostnames:["google.*"],width:720,height:500,doesResize:!0,overridePermissions:{"allow-presentation":!0},toEmbedUrl:t=>{if(t.includes("/maps/")){const e=t.match(/@(.*),(.*),(.*)z/);let n;if(e){const[,r,s,i]=e;n=`https://${new URL(t).host.replace("www.","")}/maps/embed/v1/view?key=${QV.NEXT_PUBLIC_GC_API_KEY}&center=${r},${s}&zoom=${i}`}else n="";return n}},fromEmbedUrl:t=>{const e=rt(t);if(!e)return;if(e.pathname.match(/^\/maps\/embed\/v1\/view\/?$/)&&e.searchParams.has("center")&&e.searchParams.get("zoom")){const r=e.searchParams.get("zoom"),[s,i]=e.searchParams.get("center").split(",");return`https://www.google.com/maps/@${s},${i},${r}z`}}},{type:"val_town",title:"Val Town",hostnames:["val.town"],minWidth:260,minHeight:100,width:720,height:500,doesResize:!0,toEmbedUrl:t=>{const e=rt(t),n=e&&e.pathname.match(/\/v\/(.+)\/?/);if(n)return`https://www.val.town/embed/${n[1]}`},fromEmbedUrl:t=>{const e=rt(t),n=e&&e.pathname.match(/\/embed\/(.+)\/?/);if(n)return`https://www.val.town/v/${n[1]}`}},{type:"codesandbox",title:"CodeSandbox",hostnames:["codesandbox.io"],minWidth:300,minHeight:300,width:720,height:500,doesResize:!0,toEmbedUrl:t=>{const e=rt(t),n=e&&e.pathname.match(/\/s\/([^/]+)\/?/);if(n)return`https://codesandbox.io/embed/${n[1]}`},fromEmbedUrl:t=>{const e=rt(t),n=e&&e.pathname.match(/\/embed\/([^/]+)\/?/);if(n)return`https://codesandbox.io/s/${n[1]}`}},{type:"codepen",title:"Codepen",hostnames:["codepen.io"],minWidth:300,minHeight:300,width:520,height:400,doesResize:!0,toEmbedUrl:t=>{const e=/https:\/\/codepen.io\/([^/]+)\/pen\/([^/]+)/,n=t.match(e);if(n){const[r,s,i]=n;return`https://codepen.io/${s}/embed/${i}`}},fromEmbedUrl:t=>{const e=/https:\/\/codepen.io\/([^/]+)\/embed\/([^/]+)/,n=t.match(e);if(n){const[r,s,i]=n;return`https://codepen.io/${s}/pen/${i}`}}},{type:"scratch",title:"Scratch",hostnames:["scratch.mit.edu"],width:520,height:400,doesResize:!1,toEmbedUrl:t=>{const e=/https?:\/\/scratch.mit.edu\/projects\/([^/]+)/,n=t.match(e);if(n){const[r,s]=n;return`https://scratch.mit.edu/projects/embed/${s}`}},fromEmbedUrl:t=>{const e=/https:\/\/scratch.mit.edu\/projects\/embed\/([^/]+)/,n=t.match(e);if(n){const[r,s]=n;return`https://scratch.mit.edu/projects/${s}`}}},{type:"youtube",title:"YouTube",hostnames:["*.youtube.com","youtube.com","youtu.be"],width:800,height:450,doesResize:!0,overridePermissions:{"allow-presentation":!0,"allow-popups-to-escape-sandbox":!0},isAspectRatioLocked:!0,toEmbedUrl:t=>{const e=rt(t);if(!e)return;const n=e.hostname.replace(/^www./,"");if(n==="youtu.be")return`https://www.youtube.com/embed/${e.pathname.split("/").filter(Boolean)[0]}`;if((n==="youtube.com"||n==="m.youtube.com")&&e.pathname.match(/^\/watch/))return`https://www.youtube.com/embed/${e.searchParams.get("v")}`},fromEmbedUrl:t=>{const e=rt(t);if(!e)return;if(e.hostname.replace(/^www./,"")==="youtube.com"){const r=e.pathname.match(/^\/embed\/([^/]+)\/?/);if(r)return`https://www.youtube.com/watch?v=${r[1]}`}}},{type:"google_calendar",title:"Google Calendar",hostnames:["calendar.google.*"],width:720,height:500,minWidth:460,minHeight:360,doesResize:!0,instructionLink:"https://support.google.com/calendar/answer/41207?hl=en",overridePermissions:{"allow-popups-to-escape-sandbox":!0},toEmbedUrl:t=>{const e=rt(t),n=e==null?void 0:e.searchParams.get("cid");if(e!=null&&e.pathname.match(/\/calendar\/u\/0/)&&n){e.pathname="/calendar/embed";const r=Array.from(e.searchParams.keys());for(const s of r)e.searchParams.delete(s);return e.searchParams.set("src",n),e.href}},fromEmbedUrl:t=>{const e=rt(t),n=e==null?void 0:e.searchParams.get("src");if(e!=null&&e.pathname.match(/\/calendar\/embed/)&&n){e.pathname="/calendar/u/0";const r=Array.from(e.searchParams.keys());for(const s of r)e.searchParams.delete(s);return e.searchParams.set("cid",n),e.href}}},{type:"google_slides",title:"Google Slides",hostnames:["docs.google.*"],width:720,height:500,minWidth:460,minHeight:360,doesResize:!0,overridePermissions:{"allow-popups-to-escape-sandbox":!0},toEmbedUrl:t=>{const e=rt(t);if(e!=null&&e.pathname.match(/^\/presentation/)&&(e!=null&&e.pathname.match(/\/pub\/?$/))){e.pathname=e.pathname.replace(/\/pub$/,"/embed");const n=Array.from(e.searchParams.keys());for(const r of n)e.searchParams.delete(r);return e.href}},fromEmbedUrl:t=>{const e=rt(t);if(e!=null&&e.pathname.match(/^\/presentation/)&&(e!=null&&e.pathname.match(/\/embed\/?$/))){e.pathname=e.pathname.replace(/\/embed$/,"/pub");const n=Array.from(e.searchParams.keys());for(const r of n)e.searchParams.delete(r);return e.href}}},{type:"github_gist",title:"GitHub Gist",hostnames:["gist.github.com"],width:720,height:500,doesResize:!0,toEmbedUrl:t=>{const e=rt(t);if(e&&e.pathname.match(/\/([^/]+)\/([^/]+)/))return t.split("/").pop()?t:void 0},fromEmbedUrl:t=>{const e=rt(t);if(e&&e.pathname.match(/\/([^/]+)\/([^/]+)/))return t.split("/").pop()?t:void 0}},{type:"replit",title:"Replit",hostnames:["replit.com"],width:720,height:500,doesResize:!0,toEmbedUrl:t=>{const e=rt(t);if(e&&e.pathname.match(/\/@([^/]+)\/([^/]+)/))return`${t}?embed=true`},fromEmbedUrl:t=>{const e=rt(t);if(e&&e.pathname.match(/\/@([^/]+)\/([^/]+)/)&&e.searchParams.has("embed"))return e.searchParams.delete("embed"),e.href}},{type:"felt",title:"Felt",hostnames:["felt.com"],width:720,height:500,doesResize:!0,toEmbedUrl:t=>{const e=rt(t);if(e&&e.pathname.match(/^\/map\//))return e.origin+"/embed"+e.pathname},fromEmbedUrl:t=>{const e=rt(t);if(e&&e.pathname.match(/^\/embed\/map\//))return e.pathname=e.pathname.replace(/^\/embed/,""),e.href}},{type:"spotify",title:"Spotify",hostnames:["open.spotify.com"],width:720,height:500,minHeight:500,overrideOutlineRadius:12,doesResize:!0,toEmbedUrl:t=>{const e=rt(t);if(e&&e.pathname.match(/^\/(artist|album)\//))return e.origin+"/embed"+e.pathname},fromEmbedUrl:t=>{const e=rt(t);if(e&&e.pathname.match(/^\/embed\/(artist|album)\//))return e.origin+e.pathname.replace(/^\/embed/,"")}},{type:"vimeo",title:"Vimeo",hostnames:["vimeo.com","player.vimeo.com"],width:640,height:360,doesResize:!0,isAspectRatioLocked:!0,toEmbedUrl:t=>{const e=rt(t);if(e&&e.hostname==="vimeo.com"&&e.pathname.match(/^\/[0-9]+/))return"https://player.vimeo.com/video/"+e.pathname.split("/")[1]+"?title=0&byline=0"},fromEmbedUrl:t=>{const e=rt(t);if(e&&e.hostname==="player.vimeo.com"){const n=e.pathname.match(/^\/video\/([^/]+)\/?$/);if(n)return"https://vimeo.com/"+n[1]}}},{type:"excalidraw",title:"Excalidraw",hostnames:["excalidraw.com"],width:720,height:500,doesResize:!0,isAspectRatioLocked:!0,toEmbedUrl:t=>{const e=rt(t);if(e&&e.hash.match(/#room=/))return t},fromEmbedUrl:t=>{const e=rt(t);if(e&&e.hash.match(/#room=/))return t}},{type:"observable",title:"Observable",hostnames:["observablehq.com"],width:720,height:500,doesResize:!0,isAspectRatioLocked:!1,backgroundColor:"#fff",toEmbedUrl:t=>{const e=rt(t);if(e&&e.pathname.match(/^\/@([^/]+)\/([^/]+)\/?$/))return`${e.origin}/embed${e.pathname}?cell=*`;if(e&&e.pathname.match(/^\/d\/([^/]+)\/?$/)){const n=e.pathname.replace(/^\/d/,"");return`${e.origin}/embed${n}?cell=*`}},fromEmbedUrl:t=>{const e=rt(t);if(e&&e.pathname.match(/^\/embed\/@([^/]+)\/([^/]+)\/?$/))return`${e.origin}${e.pathname.replace("/embed","")}#cell-*`;if(e&&e.pathname.match(/^\/embed\/([^/]+)\/?$/))return`${e.origin}${e.pathname.replace("/embed","/d")}#cell-*`}},{type:"desmos",title:"Desmos",hostnames:["desmos.com"],width:700,height:450,doesResize:!0,toEmbedUrl:t=>{const e=rt(t);if(e&&e.hostname==="www.desmos.com"&&e.pathname.match(/^\/calculator\/([^/]+)\/?$/)&&e.search===""&&e.hash==="")return`${t}?embed`},fromEmbedUrl:t=>{const e=rt(t);if(e&&e.hostname==="www.desmos.com"&&e.pathname.match(/^\/calculator\/([^/]+)\/?$/)&&e.search==="?embed"&&e.hash==="")return t.replace("?embed","")}}],JV={"allow-downloads-without-user-activation":!1,"allow-downloads":!1,"allow-modals":!1,"allow-orientation-lock":!1,"allow-pointer-lock":!1,"allow-popups":!0,"allow-popups-to-escape-sandbox":!1,"allow-presentation":!1,"allow-storage-access-by-user-activation":!1,"allow-top-navigation":!1,"allow-top-navigation-by-user-activation":!1,"allow-scripts":!0,"allow-same-origin":!0,"allow-forms":!0},PI={w:Xt,h:Xt,url:De},P0=Ws("embed",{GenOriginalUrlInEmbed:1,RemoveDoesResize:2,RemoveTmpOldUrl:3,RemovePermissionOverrides:4}),kI={sequence:[{id:P0.GenOriginalUrlInEmbed,up:t=>{try{const e=t.url,n=new URL(e).host.replace("www.","");let r;for(const s of Ch)if(s.hostnames.includes(n))try{r=s.fromEmbedUrl(e)}catch(i){console.warn(i)}t.tmpOldUrl=t.url,t.url=r??""}catch{t.url="",t.tmpOldUrl=t.url}},down:"retired"},{id:P0.RemoveDoesResize,up:t=>{delete t.doesResize},down:"retired"},{id:P0.RemoveTmpOldUrl,up:t=>{delete t.tmpOldUrl},down:"retired"},{id:P0.RemovePermissionOverrides,up:t=>{delete t.overridePermissions},down:"retired"}]},II={w:Xt,h:Xt,name:De},EI={sequence:[]},tg=_n.defineEnum("tldraw:horizontalAlign",{defaultValue:"middle",values:["start","middle","end","start-legacy","end-legacy","middle-legacy"]}),ng=_n.defineEnum("tldraw:verticalAlign",{defaultValue:"middle",values:["start","middle","end"]}),Os=_n.defineEnum("tldraw:geo",{defaultValue:"rectangle",values:["cloud","rectangle","ellipse","triangle","diamond","pentagon","hexagon","octagon","star","rhombus","rhombus-2","oval","trapezoid","arrow-right","arrow-left","arrow-up","arrow-down","x-box","check-box","heart"]}),TI={geo:Os,labelColor:cI,color:qr,fill:cl,dash:ll,size:Si,font:vi,align:tg,verticalAlign:ng,url:Vr,w:Xt,h:Xt,growY:Xf,text:De,scale:Xt},ji=Ws("geo",{AddUrlProp:1,AddLabelColor:2,RemoveJustify:3,AddCheckBox:4,AddVerticalAlign:5,MigrateLegacyAlign:6,AddCloud:7,MakeUrlsValid:8,AddScale:9}),MI={sequence:[{id:ji.AddUrlProp,up:t=>{t.url=""},down:"retired"},{id:ji.AddLabelColor,up:t=>{t.labelColor="black"},down:"retired"},{id:ji.RemoveJustify,up:t=>{t.align==="justify"&&(t.align="start")},down:"retired"},{id:ji.AddCheckBox,up:t=>{},down:"retired"},{id:ji.AddVerticalAlign,up:t=>{t.verticalAlign="middle"},down:"retired"},{id:ji.MigrateLegacyAlign,up:t=>{let e;switch(t.align){case"start":e="start-legacy";break;case"end":e="end-legacy";break;default:e="middle-legacy";break}t.align=e},down:"retired"},{id:ji.AddCloud,up:t=>{},down:"retired"},{id:ji.MakeUrlsValid,up:t=>{Vr.isValid(t.url)||(t.url="")},down:t=>{}},{id:ji.AddScale,up:t=>{t.scale=1},down:t=>{delete t.scale}}]},_I={},AI={sequence:[]},DI={color:qr,size:Si,segments:wn(wI),isComplete:ze,isPen:ze,scale:Xt},eq=Ws("highlight",{AddScale:1}),jI={sequence:[{id:eq.AddScale,up:t=>{t.scale=1},down:t=>{delete t.scale}}]},tq=$e({topLeft:al,bottomRight:al}),RI={w:Xt,h:Xt,playing:ze,url:Vr,assetId:om.nullable(),crop:tq.nullable(),flipX:ze,flipY:ze},k0=Ws("image",{AddUrlProp:1,AddCropProp:2,MakeUrlsValid:3,AddFlipProps:4}),OI={sequence:[{id:k0.AddUrlProp,up:t=>{t.url=""},down:"retired"},{id:k0.AddCropProp,up:t=>{t.crop=null},down:t=>{delete t.crop}},{id:k0.MakeUrlsValid,up:t=>{Vr.isValid(t.url)||(t.url="")},down:t=>{}},{id:k0.AddFlipProps,up:t=>{t.flipX=!1,t.flipY=!1},down:t=>{delete t.flipX,delete t.flipY}}]},rg=_n.defineEnum("tldraw:spline",{defaultValue:"line",values:["cubic","line"]}),nq=$e({id:De,index:C4,x:ke,y:ke}),LI={color:qr,dash:ll,size:Si,spline:rg,points:Zf(De,nq),scale:Xt},Iu=Ws("line",{AddSnapHandles:1,RemoveExtraHandleProps:2,HandlesToPoints:3,PointIndexIds:4,AddScale:5}),NI={sequence:[{id:Iu.AddSnapHandles,up:t=>{for(const e of Object.values(t.handles))e.canSnap=!0},down:"retired"},{id:Iu.RemoveExtraHandleProps,up:t=>{t.handles=$k(Object.values(t.handles).map(e=>[e.index,{x:e.x,y:e.y}]))},down:t=>{const e=Object.entries(t.handles).map(([n,r])=>({index:n,...r})).sort(Un);t.handles=Object.fromEntries(e.map((n,r)=>{const s=r===0?"start":r===e.length-1?"end":`handle:${n.index}`;return[s,{id:s,type:"vertex",canBind:!1,canSnap:!0,index:n.index,x:n.x,y:n.y}]}))}},{id:Iu.HandlesToPoints,up:t=>{const e=Object.entries(t.handles).map(([n,{x:r,y:s}])=>({x:r,y:s,index:n})).sort(Un);t.points=e.map(({x:n,y:r})=>({x:n,y:r})),delete t.handles},down:t=>{const e=Vd(t.points.length);t.handles=Object.fromEntries(t.points.map((n,r)=>[e[r],{x:n.x,y:n.y}])),delete t.points}},{id:Iu.PointIndexIds,up:t=>{const e=Vd(t.points.length);t.points=Object.fromEntries(t.points.map((n,r)=>{const s=e[r];return[s,{id:s,index:s,x:n.x,y:n.y}]}))},down:t=>{const e=Object.values(t.points).sort(Un);t.points=e.map(({x:n,y:r})=>({x:n,y:r}))}},{id:Iu.AddScale,up:t=>{t.scale=1},down:t=>{delete t.scale}}]},zI={color:qr,size:Si,font:vi,fontSizeAdjustment:Xf,align:tg,verticalAlign:ng,growY:Xf,url:Vr,text:De,scale:Xt},La=Ws("note",{AddUrlProp:1,RemoveJustify:2,MigrateLegacyAlign:3,AddVerticalAlign:4,MakeUrlsValid:5,AddFontSizeAdjustment:6,AddScale:7}),FI={sequence:[{id:La.AddUrlProp,up:t=>{t.url=""},down:"retired"},{id:La.RemoveJustify,up:t=>{t.align==="justify"&&(t.align="start")},down:"retired"},{id:La.MigrateLegacyAlign,up:t=>{switch(t.align){case"start":t.align="start-legacy";return;case"end":t.align="end-legacy";return;default:t.align="middle-legacy";return}},down:"retired"},{id:La.AddVerticalAlign,up:t=>{t.verticalAlign="middle"},down:"retired"},{id:La.MakeUrlsValid,up:t=>{Vr.isValid(t.url)||(t.url="")},down:t=>{}},{id:La.AddFontSizeAdjustment,up:t=>{t.fontSizeAdjustment=0},down:t=>{delete t.fontSizeAdjustment}},{id:La.AddScale,up:t=>{t.scale=1},down:t=>{delete t.scale}}]},B2=_n.defineEnum("tldraw:textAlign",{defaultValue:"start",values:["start","middle","end"]}),$I={color:qr,size:Si,font:vi,textAlign:B2,w:Xt,text:De,scale:Xt,autoSize:ze},y6=Ws("text",{RemoveJustify:1,AddTextAlign:2}),BI={sequence:[{id:y6.RemoveJustify,up:t=>{t.align==="justify"&&(t.align="start")},down:"retired"},{id:y6.AddTextAlign,up:t=>{t.textAlign=t.align,delete t.align},down:t=>{t.align=t.textAlign,delete t.textAlign}}]},UI={w:Xt,h:Xt,time:ke,playing:ze,url:Vr,assetId:om.nullable()},v6=Ws("video",{AddUrlProp:1,MakeUrlsValid:2}),HI={sequence:[{id:v6.AddUrlProp,up:t=>{t.url=""},down:"retired"},{id:v6.MakeUrlsValid,up:t=>{Vr.isValid(t.url)||(t.url="")},down:t=>{}}]},I0=Er("com.tldraw.store",{RemoveCodeAndIconShapeTypes:1,AddInstancePresenceType:2,RemoveTLUserAndPresenceAndAddPointer:3,RemoveUserDocument:4}),rq=yc({sequenceId:"com.tldraw.store",retroactive:!1,sequence:[{id:I0.RemoveCodeAndIconShapeTypes,scope:"store",up:t=>{for(const[e,n]of In(t))n.typeName==="shape"&&(n.type==="icon"||n.type==="code")&&delete t[e]}},{id:I0.AddInstancePresenceType,scope:"store",up(t){}},{id:I0.RemoveTLUserAndPresenceAndAddPointer,scope:"store",up:t=>{for(const[e,n]of In(t))n.typeName.match(/^(user|user_presence)$/)&&delete t[e]}},{id:I0.RemoveUserDocument,scope:"store",up:t=>{for(const[e,n]of In(t))n.typeName.match("user_document")&&delete t[e]}}]}),sq={arrow:{migrations:pI,props:hI},bookmark:{migrations:xI,props:SI},draw:{migrations:CI,props:bI},embed:{migrations:kI,props:PI},frame:{migrations:EI,props:II},geo:{migrations:MI,props:TI},group:{migrations:AI,props:_I},highlight:{migrations:jI,props:DI},image:{migrations:OI,props:RI},line:{migrations:NI,props:LI},note:{migrations:FI,props:zI},text:{migrations:BI,props:$I},video:{migrations:HI,props:UI}},iq={arrow:{migrations:gI,props:fI}};function oq({shapes:t=sq,bindings:e=iq,migrations:n}={}){const r=new Map;for(const a of Rt(t))for(const l of oI(a.props??{}).keys()){if(r.has(l.id)&&r.get(l.id)!==l)throw new Error(`Multiple StyleProp instances with the same id: ${l.id}`);r.set(l.id,l)}const s=fV(t),i=dV(e),o=EV(r);return S4.create({asset:Ga,binding:i,camera:Rs,document:I4,instance:o,instance_page_state:us,page:io,instance_presence:F2,pointer:k4,shape:s},{migrations:[rq,ZV,yV,zV,TV,_V,kV,OV,jV,pV,WV,GV,qV,...u6("shape",t),...u6("binding",e),...n??[]],onValidationFailure:$V,createIntegrityChecker:UV})}const Zd=[{locale:"id",label:"Bahasa Indonesia"},{locale:"ca",label:"Català"},{locale:"cs",label:"Čeština"},{locale:"da",label:"Danish"},{locale:"de",label:"Deutsch"},{locale:"en",label:"English"},{locale:"es",label:"Español"},{locale:"fr",label:"Français"},{locale:"gl",label:"Galego"},{locale:"hr",label:"Hrvatski"},{locale:"it",label:"Italiano"},{locale:"hu",label:"Magyar"},{locale:"no",label:"Norwegian"},{locale:"pl",label:"Polski"},{locale:"pt-br",label:"Português - Brasil"},{locale:"pt-pt",label:"Português - Europeu"},{locale:"ro",label:"Română"},{locale:"ru",label:"Russian"},{locale:"sl",label:"Slovenščina"},{locale:"fi",label:"Suomi"},{locale:"sv",label:"Svenska"},{locale:"vi",label:"Tiếng Việt"},{locale:"tr",label:"Türkçe"},{locale:"uk",label:"Ukrainian"},{locale:"he",label:"עברית"},{locale:"ar",label:"عربي"},{locale:"fa",label:"فارسی"},{locale:"ku",label:"کوردی"},{locale:"ne",label:"नेपाली"},{locale:"hi-in",label:"हिन्दी"},{locale:"te",label:"తెలుగు"},{locale:"th",label:"ภาษาไทย"},{locale:"my",label:"မြန်မာစာ"},{locale:"ko-kr",label:"한국어"},{locale:"ja",label:"日本語"},{locale:"zh-cn",label:"简体中文"},{locale:"zh-tw",label:"繁體中文 (台灣)"}];function aq(){const t=typeof window<"u"?window.navigator.languages??["en"]:["en"];return lq(t)}function lq(t){for(const e of t){const n=cq(e);if(n)return n}return"en"}const S6={zh:"zh-cn",pt:"pt-br",ko:"ko-kr",hi:"hi-in"};function cq(t){const e=Zd.find(s=>s.locale===t.toLowerCase());if(e)return e.locale;const[n,r]=t.split(/[-_]/).map(s=>s.toLowerCase());if(r){const s=Zd.find(i=>i.locale===n);if(s)return s.locale}return n in S6?S6[n]:null}function am(t,e){const n=Ne.useRef(e);n.current=e;const[r,s,i]=Ne.useMemo(()=>{let o=null;const a=u=>(o=u,()=>{o=null}),l=new Xc(`useStateTracking(${t})`,()=>{var u;return(u=n.current)==null?void 0:u.call(n)},{scheduleEffect(){o==null||o()}});return[l,a,()=>l.scheduleCount]},[t]);return Ne.useSyncExternalStore(s,i,i),Ne.useEffect(()=>(r.attach(),r.maybeScheduleEffect(),()=>{r.detach()}),[r]),r.execute()}const x6={apply(t,e,n){return am(t.displayName??t.name??"tracked(???)",()=>t.apply(e,n))}},uq=Symbol.for("react.memo"),dq=Symbol.for("react.forward_ref");function gn(t){let e=null;const n=t.$$typeof;return n===uq&&(t=t.type,e=t.compare),n===dq?C.memo(C.forwardRef(new Proxy(t.render,x6))):C.memo(new Proxy(t,x6),e)}function hq(t,e,n){return C.useState(()=>{const r=typeof e=="function"?e():e;return Qt(`useAtom(${t})`,r,n)})[0]}function pq(){const t=arguments[0],e=arguments[1],n=arguments.length===3?void 0:arguments[2],r=arguments.length===3?arguments[2]:arguments[3];return C.useMemo(()=>ee(`useComputed(${t})`,e,n),r)}function Jo(t,e,n=qi){C.useEffect(()=>{const r=new Xc(t,e);return r.attach(),r.execute(),()=>{r.detach()}},n)}function J(){const t=arguments,e=t.length===3?t[2]:[t[0]],n=t.length===3?t[0]:`useValue(${t[0].name})`,r=C.useRef(!0);r.current=!0;const s=C.useMemo(()=>t.length===1?t[0]:ee(n,()=>{if(r.current)return t[1]();try{return t[1]()}catch{return{}}}),e);try{const{subscribe:i,getSnapshot:o}=C.useMemo(()=>({subscribe:a=>ba(`useValue(${n})`,()=>{s.get(),a()}),getSnapshot:()=>s.get()}),[s]);return C.useSyncExternalStore(i,o,o)}finally{r.current=!1}}var WI={exports:{}};/*!
	Copyright (c) 2018 Jed Watson.
	Licensed under the MIT License (MIT), see
	http://jedwatson.github.io/classnames
*/(function(t){(function(){var e={}.hasOwnProperty;function n(){for(var i="",o=0;o<arguments.length;o++){var a=arguments[o];a&&(i=s(i,r(a)))}return i}function r(i){if(typeof i=="string"||typeof i=="number")return i;if(typeof i!="object")return"";if(Array.isArray(i))return n.apply(null,i);if(i.toString!==Object.prototype.toString&&!i.toString.toString().includes("[native code]"))return i.toString();var o="";for(var a in i)e.call(i,a)&&i[a]&&(o=s(o,a));return o}function s(i,o){return o?i?i+" "+o:i+o:i}t.exports?(n.default=n,t.exports=n):window.classNames=n})()})(WI);var fq=WI.exports;const be=ga(fq),KI="2.4.4",w6={major:"2024-06-28T10:56:07.893Z",minor:"2024-07-22T16:42:50.301Z",patch:"2024-08-05T17:56:04.722Z"},gq={error:null};class GI extends C.Component{constructor(){super(...arguments);g(this,"state",gq)}static getDerivedStateFromError(n){return{error:n}}componentDidCatch(n){var r,s;(s=(r=this.props).onError)==null||s.call(r,n)}render(){const{error:n}=this.state;if(n!==null){const{fallback:r}=this.props;return d.jsx(r,{error:n})}return this.props.children}}function Qd({children:t,fallback:e,...n}){return e===null?t:d.jsx(GI,{fallback:e,...n,children:t})}const lm=C.createContext(null);function G(){const t=Ne.useContext(lm);if(!t)throw new Error("useEditor must be used inside of the <Tldraw /> or <TldrawEditor /> components");return t}function mq(){return d.jsx("div",{className:"tl-background"})}function Jc(t,e,n,r,s,i){C.useLayoutEffect(()=>{const o=t.current;if(!o||e===void 0)return;let a=`translate(${e}px, ${n}px)`;r!==void 0&&(a+=` scale(${r})`),s!==void 0&&(a+=` rotate(${s}rad)`),i&&(a+=` translate(${i.x}px, ${i.y}px)`),o.style.transform=a})}const dn={linear:t=>t,easeInQuad:t=>t*t,easeOutQuad:t=>t*(2-t),easeInOutQuad:t=>t<.5?2*t*t:-1+(4-2*t)*t,easeInCubic:t=>t*t*t,easeOutCubic:t=>--t*t*t+1,easeInOutCubic:t=>t<.5?4*t*t*t:(t-1)*(2*t-2)*(2*t-2)+1,easeInQuart:t=>t*t*t*t,easeOutQuart:t=>1- --t*t*t*t,easeInOutQuart:t=>t<.5?8*t*t*t*t:1-8*--t*t*t*t,easeInQuint:t=>t*t*t*t*t,easeOutQuint:t=>1+--t*t*t*t*t,easeInOutQuint:t=>t<.5?16*t*t*t*t*t:1+16*--t*t*t*t*t,easeInSine:t=>1-Math.cos(t*Math.PI/2),easeOutSine:t=>Math.sin(t*Math.PI/2),easeInOutSine:t=>-(Math.cos(Math.PI*t)-1)/2,easeInExpo:t=>t<=0?0:Math.pow(2,10*t-10),easeOutExpo:t=>t>=1?1:1-Math.pow(2,-10*t),easeInOutExpo:t=>t<=0?0:t>=1?1:t<.5?Math.pow(2,20*t-10)/2:(2-Math.pow(2,-20*t+10))/2};class b{constructor(e=0,n=0,r=1){this.x=e,this.y=n,this.z=r}get pressure(){return this.z}set(e=this.x,n=this.y,r=this.z){return this.x=e,this.y=n,this.z=r,this}setTo({x:e=0,y:n=0,z:r=1}){return this.x=e,this.y=n,this.z=r,this}rot(e){if(e===0)return this;const{x:n,y:r}=this,s=Math.sin(e),i=Math.cos(e);return this.x=n*i-r*s,this.y=n*s+r*i,this}rotWith(e,n){if(n===0)return this;const r=this.x-e.x,s=this.y-e.y,i=Math.sin(n),o=Math.cos(n);return this.x=e.x+(r*o-s*i),this.y=e.y+(r*i+s*o),this}clone(){const{x:e,y:n,z:r}=this;return new b(e,n,r)}sub(e){return this.x-=e.x,this.y-=e.y,this}subXY(e,n){return this.x-=e,this.y-=n,this}subScalar(e){return this.x-=e,this.y-=e,this}add(e){return this.x+=e.x,this.y+=e.y,this}addXY(e,n){return this.x+=e,this.y+=n,this}addScalar(e){return this.x+=e,this.y+=e,this}clamp(e,n){return this.x=Math.max(this.x,e),this.y=Math.max(this.y,e),n!==void 0&&(this.x=Math.min(this.x,n),this.y=Math.min(this.y,n)),this}div(e){return this.x/=e,this.y/=e,this}divV(e){return this.x/=e.x,this.y/=e.y,this}mul(e){return this.x*=e,this.y*=e,this}mulV(e){return this.x*=e.x,this.y*=e.y,this}abs(){return this.x=Math.abs(this.x),this.y=Math.abs(this.y),this}nudge(e,n){const r=b.Tan(e,this);return this.add(r.mul(n))}neg(){return this.x*=-1,this.y*=-1,this}cross(e){return this.x=this.y*e.z-this.z*e.y,this.y=this.z*e.x-this.x*e.z,this}dpr(e){return b.Dpr(this,e)}cpr(e){return b.Cpr(this,e)}len2(){return b.Len2(this)}len(){return b.Len(this)}pry(e){return b.Pry(this,e)}per(){const{x:e,y:n}=this;return this.x=n,this.y=-e,this}uni(){return b.Uni(this)}tan(e){return b.Tan(this,e)}dist(e){return b.Dist(this,e)}distanceToLineSegment(e,n){return b.DistanceToLineSegment(e,n,this)}slope(e){return b.Slope(this,e)}snapToGrid(e){return this.x=Math.round(this.x/e)*e,this.y=Math.round(this.y/e)*e,this}angle(e){return b.Angle(this,e)}toAngle(){return b.ToAngle(this)}lrp(e,n){return this.x=this.x+(e.x-this.x)*n,this.y=this.y+(e.y-this.y)*n,this}equals(e){return b.Equals(this,e)}equalsXY(e,n){return b.EqualsXY(this,e,n)}norm(){const e=this.len();return this.x=e===0?0:this.x/e,this.y=e===0?0:this.y/e,this}toFixed(){return b.ToFixed(this)}toString(){return b.ToString(b.ToFixed(this))}toJson(){return b.ToJson(this)}toArray(){return b.ToArray(this)}static Add(e,n){return new b(e.x+n.x,e.y+n.y)}static AddXY(e,n,r){return new b(e.x+n,e.y+r)}static Sub(e,n){return new b(e.x-n.x,e.y-n.y)}static SubXY(e,n,r){return new b(e.x-n,e.y-r)}static AddScalar(e,n){return new b(e.x+n,e.y+n)}static SubScalar(e,n){return new b(e.x-n,e.y-n)}static Div(e,n){return new b(e.x/n,e.y/n)}static Mul(e,n){return new b(e.x*n,e.y*n)}static DivV(e,n){return new b(e.x/n.x,e.y/n.y)}static MulV(e,n){return new b(e.x*n.x,e.y*n.y)}static Neg(e){return new b(-e.x,-e.y)}static Per(e){return new b(e.y,-e.x)}static Abs(e){return new b(Math.abs(e.x),Math.abs(e.y))}static Dist(e,n){return((e.y-n.y)**2+(e.x-n.x)**2)**.5}static DistMin(e,n,r){return(e.x-n.x)*(e.x-n.x)+(e.y-n.y)*(e.y-n.y)<r**2}static Dist2(e,n){return(e.x-n.x)*(e.x-n.x)+(e.y-n.y)*(e.y-n.y)}static Dpr(e,n){return e.x*n.x+e.y*n.y}static Cross(e,n){return new b(e.y*n.z-e.z*n.y,e.z*n.x-e.x*n.z)}static Cpr(e,n){return e.x*n.y-n.x*e.y}static Len2(e){return e.x*e.x+e.y*e.y}static Len(e){return(e.x*e.x+e.y*e.y)**.5}static Pry(e,n){return b.Dpr(e,n)/b.Len(n)}static Uni(e){return b.Div(e,b.Len(e))}static Tan(e,n){return b.Uni(b.Sub(e,n))}static Min(e,n){return new b(Math.min(e.x,n.x),Math.min(e.y,n.y))}static Max(e,n){return new b(Math.max(e.x,n.x),Math.max(e.y,n.y))}static From({x:e,y:n,z:r=1}){return new b(e,n,r)}static FromArray(e){return new b(e[0],e[1])}static Rot(e,n=0){const r=Math.sin(n),s=Math.cos(n);return new b(e.x*s-e.y*r,e.x*r+e.y*s)}static RotWith(e,n,r){const s=e.x-n.x,i=e.y-n.y,o=Math.sin(r),a=Math.cos(r);return new b(n.x+(s*a-i*o),n.y+(s*o+i*a))}static NearestPointOnLineThroughPoint(e,n,r){return b.Mul(n,b.Sub(r,e).pry(n)).add(e)}static NearestPointOnLineSegment(e,n,r,s=!0){if(b.Equals(e,r)||b.Equals(n,r))return b.From(r);const i=b.Tan(n,e),o=b.Add(e,b.Mul(i,b.Sub(r,e).pry(i)));if(s){if(o.x<Math.min(e.x,n.x))return b.Cast(e.x<n.x?e:n);if(o.x>Math.max(e.x,n.x))return b.Cast(e.x>n.x?e:n);if(o.y<Math.min(e.y,n.y))return b.Cast(e.y<n.y?e:n);if(o.y>Math.max(e.y,n.y))return b.Cast(e.y>n.y?e:n)}return o}static DistanceToLineThroughPoint(e,n,r){return b.Dist(r,b.NearestPointOnLineThroughPoint(e,n,r))}static DistanceToLineSegment(e,n,r,s=!0){return b.Dist(r,b.NearestPointOnLineSegment(e,n,r,s))}static Snap(e,n=1){return new b(Math.round(e.x/n)*n,Math.round(e.y/n)*n)}static Cast(e){return e instanceof b?e:b.From(e)}static Slope(e,n){return e.x===n.y?NaN:(e.y-n.y)/(e.x-n.x)}static IsNaN(e){return isNaN(e.x)||isNaN(e.y)}static Angle(e,n){return Math.atan2(n.y-e.y,n.x-e.x)}static Lrp(e,n,r){return b.Sub(n,e).mul(r).add(e)}static Med(e,n){return new b((e.x+n.x)/2,(e.y+n.y)/2)}static Equals(e,n){return Math.abs(e.x-n.x)<1e-4&&Math.abs(e.y-n.y)<1e-4}static EqualsXY(e,n,r){return e.x===n&&e.y===r}static Clockwise(e,n,r){return(r.x-e.x)*(n.y-e.y)-(n.x-e.x)*(r.y-e.y)<0}static Rescale(e,n){const r=b.Len(e);return new b(n*e.x/r,n*e.y/r)}static ScaleWithOrigin(e,n,r){return b.Sub(e,r).mul(n).add(r)}static ToFixed(e){return new b(Ui(e.x),Ui(e.y))}static ToInt(e){return new b(parseInt(e.x.toFixed(0)),parseInt(e.y.toFixed(0)),parseInt((e.z??0).toFixed(0)))}static ToCss(e){return`${e.x},${e.y}`}static Nudge(e,n,r){return b.Add(e,b.Tan(n,e).mul(r))}static ToString(e){return`${e.x}, ${e.y}`}static ToAngle(e){let n=Math.atan2(e.y,e.x);return n<0&&(n+=Math.PI*2),n}static FromAngle(e,n=1){return new b(Math.cos(e)*n,Math.sin(e)*n)}static ToArray(e){return[e.x,e.y,e.z]}static ToJson(e){const{x:n,y:r,z:s}=e;return{x:n,y:r,z:s}}static Average(e){const n=e.length,r=new b(0,0);if(n===0)return r;for(let s=0;s<n;s++)r.add(e[s]);return r.div(n)}static Clamp(e,n,r){return r===void 0?new b(Math.min(Math.max(e.x,n)),Math.min(Math.max(e.y,n))):new b(Math.min(Math.max(e.x,n),r),Math.min(Math.max(e.y,n),r))}static PointsBetween(e,n,r=6){const s=[];for(let i=0;i<r;i++){const o=dn.easeInQuad(i/(r-1)),a=b.Lrp(e,n,o);a.z=Math.min(1,.5+Math.abs(.5-yq(o))*.65),s.push(a)}return s}static SnapToGrid(e,n=8){return new b(Math.round(e.x/n)*n,Math.round(e.y/n)*n)}}const yq=t=>t<.5?2*t*t:-1+(4-2*t)*t;function Xe(t){return`${K(t.x)},${K(t.y)} `}function yr(t,e){return`${K((t.x+e.x)/2)},${K((t.y+e.y)/2)} `}const Qe=Math.PI,vt=Qe/2,it=Qe*2,vq=Math.sin;function cn(t,e,n){return Math.max(e,typeof n<"u"?Math.min(t,n):t)}function E0(t,e=1e10){return t?Math.round(t*e)/e:0}function ea(t,e,n=1e-6){return Math.abs(t-e)<=n}function VI(t,e){const n=Math.pow(t-e,2)/Math.pow(t+e,2);return Qe*(t+e)*(1+3*n/(10+Math.sqrt(4-3*n)))}function ta(t){return t=t%it,t<0?t=t+it:t===0&&(t=0),t}function Ph(t,e){return t=ta(t),e=ta(e),t>e&&(e+=it),e-t}function qI(t,e){return it-Ph(t,e)}function Ap(t,e){const n=(e-t)%it;return 2*n%it-n}function U2(t){return(it+t)%it}function sg(t,e){const n=it/e;let r=Math.floor((U2(t)+n/2)/n)*n%it;return r<Qe&&(r+=it),r>Qe&&(r-=it),r}function YI(t,e){return t===e||ea(t%(Math.PI/2)-e%(Math.PI/2),0)}function Sq(t){return t*Qe/180}function xq(t){return t*180/Qe}function ul(t,e,n){return new b(t.x,t.y).add(b.FromAngle(n,e))}function sy(t,e,n){const r=t/2,s=e/2,i=[];let o=1/0,a=-1/0,l=1/0,c=-1/0;for(let v=0;v<n;v++){const m=it/n,x=-vt+v*m,y=r+r*Math.cos(x),S=s+s*Math.sin(x);y<o&&(o=y),S<l&&(l=S),y>a&&(a=y),S>c&&(c=S),i.push(new b(y,S))}const u=a-o,h=c-l,p=t-u,f=e-h;if(p!==0||f!==0)for(let v=0;v<i.length;v++){const m=i[v];m.x=(m.x-o)/u*t,m.y=(m.y-l)/h*e}return i}function Eu(t,e,n,r){return t<r&&n<e}function Ms(t,e,n,r){const s=Math.max(t,n),i=Math.min(e,r);return s<=i?[s,i]:null}function b6(t,e,n){return(e.x-t.x)*(n.y-t.y)-(n.x-t.x)*(e.y-t.y)}function Wr(t,e){let n=0,r,s;for(let i=0;i<e.length;i++){if(r=e[i],r.x===t.x&&r.y===t.y||(s=e[(i+1)%e.length],b.Dist(t,r)+b.Dist(t,s)===b.Dist(r,s)))return!0;r.y<=t.y?s.y>t.y&&b6(r,s,t)>0&&(n+=1):s.y<=t.y&&b6(r,s,t)<0&&(n-=1)}return n!==0}function K(t){return Math.round(t*1e4)/1e4}function Ui(t){return Math.round(t*100)/100}const C6=t=>Math.abs(t)<Number.MAX_SAFE_INTEGER;function Lo(t,e,n){return n<0?Ph(t,e):qI(t,e)}function H2(t,e,n,r){let s;if(Math.abs(t)>Qe){s=Ap(e,r);const i=Ap(r,n);return Math.abs(s)<Math.abs(i)?s/t:(t-i)/t}else{s=Ap(e,r);const i=s/t;return Math.sign(s)!==Math.sign(t)?Math.abs(i)>.5?1:0:i}}function wq(t,e,n,r){const s=2*((e-t)%it)%it-(e-t)%it;return r?(it-Math.abs(s))*(n?1:-1):s}function E4(t,e,n){const r=-2*(t.x*(e.y-n.y)-t.y*(e.x-n.x)+e.x*n.y-n.x*e.y);return new b(((t.x*t.x+t.y*t.y)*(n.y-e.y)+(e.x*e.x+e.y*e.y)*(t.y-n.y)+(n.x*n.x+n.y*n.y)*(e.y-t.y))/r,((t.x*t.x+t.y*t.y)*(e.x-n.x)+(e.x*e.x+e.y*e.y)*(n.x-t.x)+(n.x*n.x+n.y*n.y)*(t.x-e.x))/r)}function bq(t,e,n,r,s){if(n===null)return[b.From(t),b.From(e)];const i=[],o=b.Angle(n,t),a=b.Angle(n,e),l=Ph(o,a);for(let c=0;c<s;c++){const u=c/(s-1),h=o+l*u,p=ul(n,r,h);i.push(p)}return i}const iy=({brush:t,color:e,opacity:n,className:r})=>{const s=C.useRef(null);Jc(s,t.x,t.y);const i=K(Math.max(1,t.w)),o=K(Math.max(1,t.h));return d.jsx("svg",{className:"tl-overlays__item",ref:s,children:e?d.jsxs("g",{className:"tl-brush",opacity:n,children:[d.jsx("rect",{width:i,height:o,fill:e,opacity:.75}),d.jsx("rect",{width:i,height:o,fill:"none",stroke:e,opacity:.1})]}):d.jsx("rect",{className:`tl-brush tl-brush__default ${r}`,width:i,height:o})})},P6={isLocked:!1,wheelBehavior:"pan",panSpeed:1,zoomSpeed:1,zoomSteps:[.1,.25,.5,1,2,4,8]},oy={duration:0,easing:dn.easeInOutCubic},k6={CAMERA_MOVE:-10},Cq=["top","right","bottom","left"],I6=0,T4=2,T0=1,E6=5,Pq=128;function ig(t){if(t instanceof HTMLElement)return t;if(t.parentElement)return ig(t.parentElement);throw Error("Could not find a parent element of an HTML type!")}function Ve(t){t.preventDefault(),Vt.logPreventDefaults.get()&&console.warn("preventDefault called on event:",t)}function kh(t,e){if(t.setPointerCapture(e.pointerId),Vt.logPointerCaptures.get()){const n=Zk.get();n.set(t,(n.get(t)??0)+1),console.warn("setPointerCapture called on element:",t,e)}}function Ih(t,e){if(t.hasPointerCapture(e.pointerId)&&(t.releasePointerCapture(e.pointerId),Vt.logPointerCaptures.get())){const n=Zk.get();n.get(t)===1?n.delete(t):n.has(t)?n.set(t,n.get(t)-1):console.warn("Release without capture"),console.warn("releasePointerCapture called on element:",t,e)}}const sn=t=>t.stopPropagation(),On=(t,e,n)=>{t&&t.style.setProperty(e,n)};function wr(t){return t.isKilled=!0,{point:{x:t.clientX,y:t.clientY,z:t.pressure},shiftKey:t.shiftKey,altKey:t.altKey,ctrlKey:t.metaKey||t.ctrlKey,pointerId:t.pointerId,button:t.button,isPen:t.pointerType==="pen"}}function XI(){const t=G();return C.useMemo(function(){let r,s;function i(m){if(!m.isKilled){if(m.button===T4){t.dispatch({type:"pointer",target:"canvas",name:"right_click",...wr(m)});return}m.button!==0&&m.button!==1&&m.button!==5||(kh(m.currentTarget,m),t.dispatch({type:"pointer",target:"canvas",name:"pointer_down",...wr(m)}))}}function o(m){m.isKilled||m.clientX===r&&m.clientY===s||(r=m.clientX,s=m.clientY,t.dispatch({type:"pointer",target:"canvas",name:"pointer_move",...wr(m)}))}function a(m){m.isKilled||m.button!==0&&m.button!==1&&m.button!==2&&m.button!==5||(r=m.clientX,s=m.clientY,Ih(m.currentTarget,m),t.dispatch({type:"pointer",target:"canvas",name:"pointer_up",...wr(m)}))}function l(m){if(m.isKilled||t.getInstanceState().isPenMode&&m.pointerType!=="pen")return;const x=m.pointerType==="mouse"||m.pointerType==="pen";t.updateInstanceState({isHoveringCanvas:x?!0:null})}function c(m){if(m.isKilled||t.getInstanceState().isPenMode&&m.pointerType!=="pen")return;const x=m.pointerType==="mouse"||m.pointerType==="pen";t.updateInstanceState({isHoveringCanvas:x?!1:null})}function u(m){m.isKilled=!0,Ve(m)}function h(m){m.isKilled=!0,m.target instanceof HTMLElement&&m.target.tagName!=="A"&&m.target.tagName!=="TEXTAREA"&&!(t.getEditingShape()&&m.target.className.includes("tl-text-content"))&&Ve(m)}function p(m){Ve(m)}async function f(m){var y,S;if(Ve(m),!((S=(y=m.dataTransfer)==null?void 0:y.files)!=null&&S.length))return;const x=Array.from(m.dataTransfer.files);await t.putExternalContent({type:"files",files:x,point:t.screenToPage({x:m.clientX,y:m.clientY}),ignoreParent:!1})}function v(m){sn(m)}return{onPointerDown:i,onPointerMove:o,onPointerUp:a,onPointerEnter:l,onPointerLeave:c,onDragOver:p,onDrop:f,onTouchStart:u,onTouchEnd:h,onClick:v}},[t])}function kq(){const t=G();C.useEffect(()=>{let e=t.getInstanceState().isCoarsePointer;const n=o=>{const a=o.pointerType!=="mouse";e!==a&&(e=a,t.updateInstanceState({isCoarsePointer:a}))};window.addEventListener("pointerdown",n,{capture:!0});const r=window.matchMedia&&window.matchMedia("(any-pointer: coarse)"),s=t.environment.isFirefox&&!t.environment.isAndroid&&!t.environment.isIos,i=()=>{const o=s?!1:r.matches;e===o&&(e=o,t.updateInstanceState({isCoarsePointer:o}))};return r&&(r.addEventListener("change",i),i()),()=>{window.removeEventListener("pointerdown",n,{capture:!0}),r&&r.removeEventListener("change",i)}},[t])}const ZI=C.createContext(null);function Iq({container:t,children:e}){return d.jsx(ZI.Provider,{value:t,children:e})}function mn(){return as(C.useContext(ZI),"useContainer used outside of <Tldraw />")}function Eq(){const t=G(),e=mn(),n=J("isFocused",()=>t.getIsFocused(),[t]);C.useEffect(()=>{if(typeof window>"u"||!("matchMedia"in window))return;let r=null;const s=()=>{r!=null&&r();const i=`(resolution: ${window.devicePixelRatio}dppx)`,o=matchMedia(i),a=l=>{l.type==="change"&&s()};o.addEventListener?o.addEventListener("change",s):o.addListener&&o.addListener(a),r=()=>{o.removeEventListener?o.removeEventListener("change",s):o.removeListener&&o.removeListener(a)},t.updateInstanceState({devicePixelRatio:window.devicePixelRatio})};return s(),()=>{r==null||r()}},[t]),C.useEffect(()=>{if(!n)return;const r=a=>{if(a.altKey&&(t.isIn("zoom")||!t.getPath().endsWith(".idle"))&&!M0()&&Ve(a),a.isKilled)return;switch(a.isKilled=!0,a.key){case"=":case"-":case"0":{if(a.metaKey||a.ctrlKey){Ve(a);return}break}case"Tab":{if(M0()||t.getIsMenuOpen())return;break}case",":return;case"Escape":{if((t.getEditingShape()||t.getSelectedShapeIds().length>0)&&a.preventDefault(),t.getOpenMenus().length>0)return;t.inputs.keys.has("Escape")||(t.inputs.keys.add("Escape"),t.cancel(),t.focus());return}default:if(M0()||t.getIsMenuOpen())return}const l={type:"keyboard",name:a.repeat?"key_repeat":"key_down",key:a.key,code:a.code,shiftKey:a.shiftKey,altKey:a.altKey,ctrlKey:a.metaKey||a.ctrlKey};t.dispatch(l)},s=a=>{if(a.isKilled||(a.isKilled=!0,M0()||t.getIsMenuOpen())||a.key===",")return;const l={type:"keyboard",name:"key_up",key:a.key,code:a.code,shiftKey:a.shiftKey,altKey:a.altKey,ctrlKey:a.metaKey||a.ctrlKey};t.dispatch(l)};function i(a){var l,c;if(e.contains(a.target)){const u=a.touches[0].pageX,h=a.touches[0].radiusX||0;(u-h<10||u+h>t.getViewportScreenBounds().width-10)&&(((l=a.target)==null?void 0:l.tagName)==="BUTTON"&&((c=a.target)==null||c.click()),Ve(a))}}const o=a=>{e.contains(a.target)&&(a.ctrlKey||a.metaKey)&&Ve(a)};return e.addEventListener("touchstart",i,{passive:!1}),e.addEventListener("wheel",o,{passive:!1}),document.addEventListener("gesturestart",Ve),document.addEventListener("gesturechange",Ve),document.addEventListener("gestureend",Ve),e.addEventListener("keydown",r),e.addEventListener("keyup",s),()=>{e.removeEventListener("touchstart",i),e.removeEventListener("wheel",o),document.removeEventListener("gesturestart",Ve),document.removeEventListener("gesturechange",Ve),document.removeEventListener("gestureend",Ve),e.removeEventListener("keydown",r),e.removeEventListener("keyup",s)}},[t,e,n])}const Tq=["input","select","button","textarea"];function M0(){const{activeElement:t}=document;return!!(t&&(t.getAttribute("contenteditable")||Tq.indexOf(t.tagName.toLowerCase())>-1))}const Mq=["textarea","input"];function _q(t){const e=G();C.useEffect(()=>{const n=t.current;if(!n)return;const r=s=>{var i;if(s instanceof PointerEvent&&s.pointerType==="pen"){s.isKilled=!0;const{target:o}=s;if(Mq.includes((i=o.tagName)==null?void 0:i.toLocaleLowerCase())||e.isIn("select.editing_shape"))return;Ve(s)}};return n.addEventListener("touchstart",r),n.addEventListener("touchend",r),()=>{n.removeEventListener("touchstart",r),n.removeEventListener("touchend",r)}},[e,t])}function Aq(t,e,n){return Math.max(e,Math.min(t,n))}const Pn={toVector(t,e){return t===void 0&&(t=e),Array.isArray(t)?t:[t,t]},add(t,e){return[t[0]+e[0],t[1]+e[1]]},sub(t,e){return[t[0]-e[0],t[1]-e[1]]},addTo(t,e){t[0]+=e[0],t[1]+=e[1]},subTo(t,e){t[0]-=e[0],t[1]-=e[1]}};function T6(t,e,n){return e===0||Math.abs(e)===1/0?Math.pow(t,n*5):t*e*n/(e+n*t)}function M6(t,e,n,r=.15){return r===0?Aq(t,e,n):t<e?-T6(e-t,n-e,r)+e:t>n?+T6(t-n,n-e,r)+n:t}function Dq(t,[e,n],[r,s]){const[[i,o],[a,l]]=t;return[M6(e,i,o,r),M6(n,a,l,s)]}function jq(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function Rq(t){var e=jq(t,"string");return typeof e=="symbol"?e:String(e)}function Nn(t,e,n){return e=Rq(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function _6(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(s){return Object.getOwnPropertyDescriptor(t,s).enumerable})),n.push.apply(n,r)}return n}function Nt(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?_6(Object(n),!0).forEach(function(r){Nn(t,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):_6(Object(n)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(n,r))})}return t}const QI={pointer:{start:"down",change:"move",end:"up"},mouse:{start:"down",change:"move",end:"up"},touch:{start:"start",change:"move",end:"end"},gesture:{start:"start",change:"change",end:"end"}};function A6(t){return t?t[0].toUpperCase()+t.slice(1):""}const Oq=["enter","leave"];function Lq(t=!1,e){return t&&!Oq.includes(e)}function Nq(t,e="",n=!1){const r=QI[t],s=r&&r[e]||e;return"on"+A6(t)+A6(s)+(Lq(n,s)?"Capture":"")}const zq=["gotpointercapture","lostpointercapture"];function Fq(t){let e=t.substring(2).toLowerCase();const n=!!~e.indexOf("passive");n&&(e=e.replace("passive",""));const r=zq.includes(e)?"capturecapture":"capture",s=!!~e.indexOf(r);return s&&(e=e.replace("capture","")),{device:e,capture:s,passive:n}}function $q(t,e=""){const n=QI[t],r=n&&n[e]||e;return t+r}function JI(t){return"touches"in t}function Bq(t){return JI(t)?"touch":"pointerType"in t?t.pointerType:"mouse"}function Uq(t){return Array.from(t.touches).filter(e=>{var n,r;return e.target===t.currentTarget||((n=t.currentTarget)===null||n===void 0||(r=n.contains)===null||r===void 0?void 0:r.call(n,e.target))})}function W2(t,e){try{const n=e.clientX-t.clientX,r=e.clientY-t.clientY,s=(e.clientX+t.clientX)/2,i=(e.clientY+t.clientY)/2,o=Math.hypot(n,r);return{angle:-(Math.atan2(n,r)*180)/Math.PI,distance:o,origin:[s,i]}}catch{}return null}function Hq(t){return Uq(t).map(e=>e.identifier)}function D6(t,e){const[n,r]=Array.from(t.touches).filter(s=>e.includes(s.identifier));return W2(n,r)}const j6=40,R6=800;function eE(t){let{deltaX:e,deltaY:n,deltaMode:r}=t;return r===1?(e*=j6,n*=j6):r===2&&(e*=R6,n*=R6),[e,n]}function Wq(t){const e={};if("buttons"in t&&(e.buttons=t.buttons),"shiftKey"in t){const{shiftKey:n,altKey:r,metaKey:s,ctrlKey:i}=t;Object.assign(e,{shiftKey:n,altKey:r,metaKey:s,ctrlKey:i})}return e}function og(t,...e){return typeof t=="function"?t(...e):t}function Kq(){}function Gq(...t){return t.length===0?Kq:t.length===1?t[0]:function(){let e;for(const n of t)e=n.apply(this,arguments)||e;return e}}function O6(t,e){return Object.assign({},e,t||{})}const Vq=32;class tE{constructor(e,n,r){this.ctrl=e,this.args=n,this.key=r,this.state||(this.state={},this.computeValues([0,0]),this.computeInitial(),this.init&&this.init(),this.reset())}get state(){return this.ctrl.state[this.key]}set state(e){this.ctrl.state[this.key]=e}get shared(){return this.ctrl.state.shared}get eventStore(){return this.ctrl.gestureEventStores[this.key]}get timeoutStore(){return this.ctrl.gestureTimeoutStores[this.key]}get config(){return this.ctrl.config[this.key]}get sharedConfig(){return this.ctrl.config.shared}get handler(){return this.ctrl.handlers[this.key]}reset(){const{state:e,shared:n,ingKey:r,args:s}=this;n[r]=e._active=e.active=e._blocked=e._force=!1,e._step=[!1,!1],e.intentional=!1,e._movement=[0,0],e._distance=[0,0],e._direction=[0,0],e._delta=[0,0],e._bounds=[[-1/0,1/0],[-1/0,1/0]],e.args=s,e.axis=void 0,e.memo=void 0,e.elapsedTime=e.timeDelta=0,e.direction=[0,0],e.distance=[0,0],e.overflow=[0,0],e._movementBound=[!1,!1],e.velocity=[0,0],e.movement=[0,0],e.delta=[0,0],e.timeStamp=0}start(e){const n=this.state,r=this.config;n._active||(this.reset(),this.computeInitial(),n._active=!0,n.target=e.target,n.currentTarget=e.currentTarget,n.lastOffset=r.from?og(r.from,n):n.offset,n.offset=n.lastOffset,n.startTime=n.timeStamp=e.timeStamp)}computeValues(e){const n=this.state;n._values=e,n.values=this.config.transform(e)}computeInitial(){const e=this.state;e._initial=e._values,e.initial=e.values}compute(e){const{state:n,config:r,shared:s}=this;n.args=this.args;let i=0;if(e&&(n.event=e,r.preventDefault&&e.cancelable&&n.event.preventDefault(),n.type=e.type,s.touches=this.ctrl.pointerIds.size||this.ctrl.touchIds.size,s.locked=!!document.pointerLockElement,Object.assign(s,Wq(e)),s.down=s.pressed=s.buttons%2===1||s.touches>0,i=e.timeStamp-n.timeStamp,n.timeStamp=e.timeStamp,n.elapsedTime=n.timeStamp-n.startTime),n._active){const M=n._delta.map(Math.abs);Pn.addTo(n._distance,M)}this.axisIntent&&this.axisIntent(e);const[o,a]=n._movement,[l,c]=r.threshold,{_step:u,values:h}=n;if(r.hasCustomTransform?(u[0]===!1&&(u[0]=Math.abs(o)>=l&&h[0]),u[1]===!1&&(u[1]=Math.abs(a)>=c&&h[1])):(u[0]===!1&&(u[0]=Math.abs(o)>=l&&Math.sign(o)*l),u[1]===!1&&(u[1]=Math.abs(a)>=c&&Math.sign(a)*c)),n.intentional=u[0]!==!1||u[1]!==!1,!n.intentional)return;const p=[0,0];if(r.hasCustomTransform){const[M,I]=h;p[0]=u[0]!==!1?M-u[0]:0,p[1]=u[1]!==!1?I-u[1]:0}else p[0]=u[0]!==!1?o-u[0]:0,p[1]=u[1]!==!1?a-u[1]:0;this.restrictToAxis&&!n._blocked&&this.restrictToAxis(p);const f=n.offset,v=n._active&&!n._blocked||n.active;v&&(n.first=n._active&&!n.active,n.last=!n._active&&n.active,n.active=s[this.ingKey]=n._active,e&&(n.first&&("bounds"in r&&(n._bounds=og(r.bounds,n)),this.setup&&this.setup()),n.movement=p,this.computeOffset()));const[m,x]=n.offset,[[y,S],[w,P]]=n._bounds;n.overflow=[m<y?-1:m>S?1:0,x<w?-1:x>P?1:0],n._movementBound[0]=n.overflow[0]?n._movementBound[0]===!1?n._movement[0]:n._movementBound[0]:!1,n._movementBound[1]=n.overflow[1]?n._movementBound[1]===!1?n._movement[1]:n._movementBound[1]:!1;const E=n._active?r.rubberband||[0,0]:[0,0];if(n.offset=Dq(n._bounds,n.offset,E),n.delta=Pn.sub(n.offset,f),this.computeMovement(),v&&(!n.last||i>Vq)){n.delta=Pn.sub(n.offset,f);const M=n.delta.map(Math.abs);Pn.addTo(n.distance,M),n.direction=n.delta.map(Math.sign),n._direction=n._delta.map(Math.sign),!n.first&&i>0&&(n.velocity=[M[0]/i,M[1]/i],n.timeDelta=i)}}emit(){const e=this.state,n=this.shared,r=this.config;if(e._active||this.clean(),(e._blocked||!e.intentional)&&!e._force&&!r.triggerAllEvents)return;const s=this.handler(Nt(Nt(Nt({},n),e),{},{[this.aliasKey]:e.values}));s!==void 0&&(e.memo=s)}clean(){this.eventStore.clean(),this.timeoutStore.clean()}}function qq([t,e],n){const r=Math.abs(t),s=Math.abs(e);if(r>s&&r>n)return"x";if(s>r&&s>n)return"y"}class Yq extends tE{constructor(...e){super(...e),Nn(this,"aliasKey","xy")}reset(){super.reset(),this.state.axis=void 0}init(){this.state.offset=[0,0],this.state.lastOffset=[0,0]}computeOffset(){this.state.offset=Pn.add(this.state.lastOffset,this.state.movement)}computeMovement(){this.state.movement=Pn.sub(this.state.offset,this.state.lastOffset)}axisIntent(e){const n=this.state,r=this.config;if(!n.axis&&e){const s=typeof r.axisThreshold=="object"?r.axisThreshold[Bq(e)]:r.axisThreshold;n.axis=qq(n._movement,s)}n._blocked=(r.lockDirection||!!r.axis)&&!n.axis||!!r.axis&&r.axis!==n.axis}restrictToAxis(e){if(this.config.axis||this.config.lockDirection)switch(this.state.axis){case"x":e[1]=0;break;case"y":e[0]=0;break}}}const Xq=t=>t,L6=.15,nE={enabled(t=!0){return t},eventOptions(t,e,n){return Nt(Nt({},n.shared.eventOptions),t)},preventDefault(t=!1){return t},triggerAllEvents(t=!1){return t},rubberband(t=0){switch(t){case!0:return[L6,L6];case!1:return[0,0];default:return Pn.toVector(t)}},from(t){if(typeof t=="function")return t;if(t!=null)return Pn.toVector(t)},transform(t,e,n){const r=t||n.shared.transform;return this.hasCustomTransform=!!r,r||Xq},threshold(t){return Pn.toVector(t,0)}},Zq=0,Eh=Nt(Nt({},nE),{},{axis(t,e,{axis:n}){if(this.lockDirection=n==="lock",!this.lockDirection)return n},axisThreshold(t=Zq){return t},bounds(t={}){if(typeof t=="function")return i=>Eh.bounds(t(i));if("current"in t)return()=>t.current;if(typeof HTMLElement=="function"&&t instanceof HTMLElement)return t;const{left:e=-1/0,right:n=1/0,top:r=-1/0,bottom:s=1/0}=t;return[[e,n],[r,s]]}}),Th=typeof window<"u"&&window.document&&window.document.createElement;function rE(){return Th&&"ontouchstart"in window}function Qq(){return rE()||Th&&window.navigator.maxTouchPoints>1}function Jq(){return Th&&"onpointerdown"in window}function eY(){return Th&&"exitPointerLock"in window.document}function tY(){try{return"constructor"in GestureEvent}catch{return!1}}const ls={isBrowser:Th,gesture:tY(),touch:rE(),touchscreen:Qq(),pointer:Jq(),pointerLock:eY()},nY=250,rY=180,sY=.5,iY=50,oY=250,aY=10,N6={mouse:0,touch:0,pen:8};Nt(Nt({},Eh),{},{device(t,e,{pointer:{touch:n=!1,lock:r=!1,mouse:s=!1}={}}){return this.pointerLock=r&&ls.pointerLock,ls.touch&&n?"touch":this.pointerLock?"mouse":ls.pointer&&!s?"pointer":ls.touch?"touch":"mouse"},preventScrollAxis(t,e,{preventScroll:n}){if(this.preventScrollDelay=typeof n=="number"?n:n||n===void 0&&t?nY:void 0,!(!ls.touchscreen||n===!1))return t||(n!==void 0?"y":void 0)},pointerCapture(t,e,{pointer:{capture:n=!0,buttons:r=1,keys:s=!0}={}}){return this.pointerButtons=r,this.keys=s,!this.pointerLock&&this.device==="pointer"&&n},threshold(t,e,{filterTaps:n=!1,tapsThreshold:r=3,axis:s=void 0}){const i=Pn.toVector(t,n?r:s?1:0);return this.filterTaps=n,this.tapsThreshold=r,i},swipe({velocity:t=sY,distance:e=iY,duration:n=oY}={}){return{velocity:this.transform(Pn.toVector(t)),distance:this.transform(Pn.toVector(e)),duration:n}},delay(t=0){switch(t){case!0:return rY;case!1:return 0;default:return t}},axisThreshold(t){return t?Nt(Nt({},N6),t):N6},keyboardDisplacement(t=aY){return t}});function sE(t){const[e,n]=t.overflow,[r,s]=t._delta,[i,o]=t._direction;(e<0&&r>0&&i<0||e>0&&r<0&&i>0)&&(t._movement[0]=t._movementBound[0]),(n<0&&s>0&&o<0||n>0&&s<0&&o>0)&&(t._movement[1]=t._movementBound[1])}const lY=30,cY=100;class uY extends tE{constructor(...e){super(...e),Nn(this,"ingKey","pinching"),Nn(this,"aliasKey","da")}init(){this.state.offset=[1,0],this.state.lastOffset=[1,0],this.state._pointerEvents=new Map}reset(){super.reset();const e=this.state;e._touchIds=[],e.canceled=!1,e.cancel=this.cancel.bind(this),e.turns=0}computeOffset(){const{type:e,movement:n,lastOffset:r}=this.state;e==="wheel"?this.state.offset=Pn.add(n,r):this.state.offset=[(1+n[0])*r[0],n[1]+r[1]]}computeMovement(){const{offset:e,lastOffset:n}=this.state;this.state.movement=[e[0]/n[0],e[1]-n[1]]}axisIntent(){const e=this.state,[n,r]=e._movement;if(!e.axis){const s=Math.abs(n)*lY-Math.abs(r);s<0?e.axis="angle":s>0&&(e.axis="scale")}}restrictToAxis(e){this.config.lockDirection&&(this.state.axis==="scale"?e[1]=0:this.state.axis==="angle"&&(e[0]=0))}cancel(){const e=this.state;e.canceled||setTimeout(()=>{e.canceled=!0,e._active=!1,this.compute(),this.emit()},0)}touchStart(e){this.ctrl.setEventIds(e);const n=this.state,r=this.ctrl.touchIds;if(n._active&&n._touchIds.every(i=>r.has(i))||r.size<2)return;this.start(e),n._touchIds=Array.from(r).slice(0,2);const s=D6(e,n._touchIds);s&&this.pinchStart(e,s)}pointerStart(e){if(e.buttons!=null&&e.buttons%2!==1)return;this.ctrl.setEventIds(e),e.target.setPointerCapture(e.pointerId);const n=this.state,r=n._pointerEvents,s=this.ctrl.pointerIds;if(n._active&&Array.from(r.keys()).every(o=>s.has(o))||(r.size<2&&r.set(e.pointerId,e),n._pointerEvents.size<2))return;this.start(e);const i=W2(...Array.from(r.values()));i&&this.pinchStart(e,i)}pinchStart(e,n){const r=this.state;r.origin=n.origin,this.computeValues([n.distance,n.angle]),this.computeInitial(),this.compute(e),this.emit()}touchMove(e){if(!this.state._active)return;const n=D6(e,this.state._touchIds);n&&this.pinchMove(e,n)}pointerMove(e){const n=this.state._pointerEvents;if(n.has(e.pointerId)&&n.set(e.pointerId,e),!this.state._active)return;const r=W2(...Array.from(n.values()));r&&this.pinchMove(e,r)}pinchMove(e,n){const r=this.state,s=r._values[1],i=n.angle-s;let o=0;Math.abs(i)>270&&(o+=Math.sign(i)),this.computeValues([n.distance,n.angle-360*o]),r.origin=n.origin,r.turns=o,r._movement=[r._values[0]/r._initial[0]-1,r._values[1]-r._initial[1]],this.compute(e),this.emit()}touchEnd(e){this.ctrl.setEventIds(e),this.state._active&&this.state._touchIds.some(n=>!this.ctrl.touchIds.has(n))&&(this.state._active=!1,this.compute(e),this.emit())}pointerEnd(e){const n=this.state;this.ctrl.setEventIds(e);try{e.target.releasePointerCapture(e.pointerId)}catch{}n._pointerEvents.has(e.pointerId)&&n._pointerEvents.delete(e.pointerId),n._active&&n._pointerEvents.size<2&&(n._active=!1,this.compute(e),this.emit())}gestureStart(e){e.cancelable&&e.preventDefault();const n=this.state;n._active||(this.start(e),this.computeValues([e.scale,e.rotation]),n.origin=[e.clientX,e.clientY],this.compute(e),this.emit())}gestureMove(e){if(e.cancelable&&e.preventDefault(),!this.state._active)return;const n=this.state;this.computeValues([e.scale,e.rotation]),n.origin=[e.clientX,e.clientY];const r=n._movement;n._movement=[e.scale-1,e.rotation],n._delta=Pn.sub(n._movement,r),this.compute(e),this.emit()}gestureEnd(e){this.state._active&&(this.state._active=!1,this.compute(e),this.emit())}wheel(e){const n=this.config.modifierKey;n&&(Array.isArray(n)?!n.find(r=>e[r]):!e[n])||(this.state._active?this.wheelChange(e):this.wheelStart(e),this.timeoutStore.add("wheelEnd",this.wheelEnd.bind(this)))}wheelStart(e){this.start(e),this.wheelChange(e)}wheelChange(e){"uv"in e||e.cancelable&&e.preventDefault();const r=this.state;r._delta=[-eE(e)[1]/cY*r.offset[0],0],Pn.addTo(r._movement,r._delta),sE(r),this.state.origin=[e.clientX,e.clientY],this.compute(e),this.emit()}wheelEnd(){this.state._active&&(this.state._active=!1,this.compute(),this.emit())}bind(e){const n=this.config.device;n&&(e(n,"start",this[n+"Start"].bind(this)),e(n,"change",this[n+"Move"].bind(this)),e(n,"end",this[n+"End"].bind(this)),e(n,"cancel",this[n+"End"].bind(this)),e("lostPointerCapture","",this[n+"End"].bind(this))),this.config.pinchOnWheel&&e("wheel","",this.wheel.bind(this),{passive:!1})}}const dY=Nt(Nt({},nE),{},{device(t,e,{shared:n,pointer:{touch:r=!1}={}}){if(n.target&&!ls.touch&&ls.gesture)return"gesture";if(ls.touch&&r)return"touch";if(ls.touchscreen){if(ls.pointer)return"pointer";if(ls.touch)return"touch"}},bounds(t,e,{scaleBounds:n={},angleBounds:r={}}){const s=o=>{const a=O6(og(n,o),{min:-1/0,max:1/0});return[a.min,a.max]},i=o=>{const a=O6(og(r,o),{min:-1/0,max:1/0});return[a.min,a.max]};return typeof n!="function"&&typeof r!="function"?[s(),i()]:o=>[s(o),i(o)]},threshold(t,e,n){return this.lockDirection=n.axis==="lock",Pn.toVector(t,this.lockDirection?[.1,3]:0)},modifierKey(t){return t===void 0?"ctrlKey":t},pinchOnWheel(t=!0){return t}});Nt(Nt({},Eh),{},{mouseOnly:(t=!0)=>t});class hY extends Yq{constructor(...e){super(...e),Nn(this,"ingKey","wheeling")}wheel(e){this.state._active||this.start(e),this.wheelChange(e),this.timeoutStore.add("wheelEnd",this.wheelEnd.bind(this))}wheelChange(e){const n=this.state;n._delta=eE(e),Pn.addTo(n._movement,n._delta),sE(n),this.compute(e),this.emit()}wheelEnd(){this.state._active&&(this.state._active=!1,this.compute(),this.emit())}bind(e){e("wheel","",this.wheel.bind(this))}}const pY=Eh;Nt(Nt({},Eh),{},{mouseOnly:(t=!0)=>t});const M4=new Map,K2=new Map;function fY(t){M4.set(t.key,t.engine),K2.set(t.key,t.resolver)}const gY={key:"pinch",engine:uY,resolver:dY},mY={key:"wheel",engine:hY,resolver:pY};function yY(t,e){if(t==null)return{};var n={},r=Object.keys(t),s,i;for(i=0;i<r.length;i++)s=r[i],!(e.indexOf(s)>=0)&&(n[s]=t[s]);return n}function vY(t,e){if(t==null)return{};var n=yY(t,e),r,s;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);for(s=0;s<i.length;s++)r=i[s],!(e.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(t,r)&&(n[r]=t[r])}return n}const SY={target(t){if(t)return()=>"current"in t?t.current:t},enabled(t=!0){return t},window(t=ls.isBrowser?window:void 0){return t},eventOptions({passive:t=!0,capture:e=!1}={}){return{passive:t,capture:e}},transform(t){return t}},xY=["target","eventOptions","window","enabled","transform"];function Dp(t={},e){const n={};for(const[r,s]of Object.entries(e))switch(typeof s){case"function":n[r]=s.call(n,t[r],r,t);break;case"object":n[r]=Dp(t[r],s);break;case"boolean":s&&(n[r]=t[r]);break}return n}function wY(t,e,n={}){const r=t,{target:s,eventOptions:i,window:o,enabled:a,transform:l}=r,c=vY(r,xY);if(n.shared=Dp({target:s,eventOptions:i,window:o,enabled:a,transform:l},SY),e){const u=K2.get(e);n[e]=Dp(Nt({shared:n.shared},c),u)}else for(const u in c){const h=K2.get(u);h&&(n[u]=Dp(Nt({shared:n.shared},c[u]),h))}return n}class iE{constructor(e,n){Nn(this,"_listeners",new Set),this._ctrl=e,this._gestureKey=n}add(e,n,r,s,i){const o=this._listeners,a=$q(n,r),l=this._gestureKey?this._ctrl.config[this._gestureKey].eventOptions:{},c=Nt(Nt({},l),i);e.addEventListener(a,s,c);const u=()=>{e.removeEventListener(a,s,c),o.delete(u)};return o.add(u),u}clean(){this._listeners.forEach(e=>e()),this._listeners.clear()}}class bY{constructor(){Nn(this,"_timeouts",new Map)}add(e,n,r=140,...s){this.remove(e),this._timeouts.set(e,window.setTimeout(n,r,...s))}remove(e){const n=this._timeouts.get(e);n&&window.clearTimeout(n)}clean(){this._timeouts.forEach(e=>void window.clearTimeout(e)),this._timeouts.clear()}}class CY{constructor(e){Nn(this,"gestures",new Set),Nn(this,"_targetEventStore",new iE(this)),Nn(this,"gestureEventStores",{}),Nn(this,"gestureTimeoutStores",{}),Nn(this,"handlers",{}),Nn(this,"config",{}),Nn(this,"pointerIds",new Set),Nn(this,"touchIds",new Set),Nn(this,"state",{shared:{shiftKey:!1,metaKey:!1,ctrlKey:!1,altKey:!1}}),PY(this,e)}setEventIds(e){if(JI(e))return this.touchIds=new Set(Hq(e)),this.touchIds;if("pointerId"in e)return e.type==="pointerup"||e.type==="pointercancel"?this.pointerIds.delete(e.pointerId):e.type==="pointerdown"&&this.pointerIds.add(e.pointerId),this.pointerIds}applyHandlers(e,n){this.handlers=e,this.nativeHandlers=n}applyConfig(e,n){this.config=wY(e,n,this.config)}clean(){this._targetEventStore.clean();for(const e of this.gestures)this.gestureEventStores[e].clean(),this.gestureTimeoutStores[e].clean()}effect(){return this.config.shared.target&&this.bind(),()=>this._targetEventStore.clean()}bind(...e){const n=this.config.shared,r={};let s;if(!(n.target&&(s=n.target(),!s))){if(n.enabled){for(const o of this.gestures){const a=this.config[o],l=z6(r,a.eventOptions,!!s);if(a.enabled){const c=M4.get(o);new c(this,e,o).bind(l)}}const i=z6(r,n.eventOptions,!!s);for(const o in this.nativeHandlers)i(o,"",a=>this.nativeHandlers[o](Nt(Nt({},this.state.shared),{},{event:a,args:e})),void 0,!0)}for(const i in r)r[i]=Gq(...r[i]);if(!s)return r;for(const i in r){const{device:o,capture:a,passive:l}=Fq(i);this._targetEventStore.add(s,o,"",r[i],{capture:a,passive:l})}}}}function Dl(t,e){t.gestures.add(e),t.gestureEventStores[e]=new iE(t,e),t.gestureTimeoutStores[e]=new bY}function PY(t,e){e.drag&&Dl(t,"drag"),e.wheel&&Dl(t,"wheel"),e.scroll&&Dl(t,"scroll"),e.move&&Dl(t,"move"),e.pinch&&Dl(t,"pinch"),e.hover&&Dl(t,"hover")}const z6=(t,e,n)=>(r,s,i,o={},a=!1)=>{var l,c;const u=(l=o.capture)!==null&&l!==void 0?l:e.capture,h=(c=o.passive)!==null&&c!==void 0?c:e.passive;let p=a?r:Nq(r,s,u);n&&h&&(p+="Passive"),t[p]=t[p]||[],t[p].push(i)},kY=/^on(Drag|Wheel|Scroll|Move|Pinch|Hover)/;function IY(t){const e={},n={},r=new Set;for(let s in t)kY.test(s)?(r.add(RegExp.lastMatch),n[s]=t[s]):e[s]=t[s];return[n,e,r]}function jl(t,e,n,r,s,i){if(!t.has(n)||!M4.has(r))return;const o=n+"Start",a=n+"End",l=c=>{let u;return c.first&&o in e&&e[o](c),n in e&&(u=e[n](c)),c.last&&a in e&&e[a](c),u};s[r]=l,i[r]=i[r]||{}}function EY(t,e){const[n,r,s]=IY(t),i={};return jl(s,n,"onDrag","drag",i,e),jl(s,n,"onWheel","wheel",i,e),jl(s,n,"onScroll","scroll",i,e),jl(s,n,"onPinch","pinch",i,e),jl(s,n,"onMove","move",i,e),jl(s,n,"onHover","hover",i,e),{handlers:i,config:e,nativeHandlers:r}}function TY(t,e={},n,r){const s=Ne.useMemo(()=>new CY(t),[]);if(s.applyHandlers(t,r),s.applyConfig(e,n),Ne.useEffect(s.effect.bind(s)),Ne.useEffect(()=>s.clean.bind(s),[]),e.target===void 0)return s.bind.bind(s)}function MY(t){return t.forEach(fY),function(n,r){const{handlers:s,nativeHandlers:i,config:o}=EY(n,r||{});return TY(s,o,void 0,i)}}const F6=10,_Y=/Mac|iPod|iPhone|iPad/.test(typeof window>"u"?"node":window.navigator.platform);function oE(t){let{deltaY:e,deltaX:n}=t,r=0;return t.ctrlKey||t.altKey||t.metaKey?r=(Math.abs(e)>F6?F6*Math.sign(e):e)/100:t.shiftKey&&!_Y&&(n=e,e=0),{x:-n,y:-e,z:-r}}const AY=MY([mY,gY]);let Rl;const DY=t=>Rl===void 0?(Rl=t,!1):t-Rl>120&&t-Rl<160?(Rl=t,!0):(Rl=t,!1);function jY(t){const e=G(),n=C.useMemo(()=>{let r="not sure";const s=({event:m})=>{if(!e.getInstanceState().isFocused||(r="not sure",DY(Date.now())))return;const x=e.getEditingShapeId();if(x){const w=e.getShape(x);if(w&&e.getShapeUtil(w).canScroll(w)){const E=e.getShapePageBounds(x);if(E!=null&&E.containsPoint(e.inputs.currentPagePoint))return}}Ve(m),sn(m);const y=oE(m);if(y.x===0&&y.y===0)return;const S={type:"wheel",name:"wheel",delta:y,point:new b(m.clientX,m.clientY),shiftKey:m.shiftKey,altKey:m.altKey,ctrlKey:m.metaKey||m.ctrlKey};e.dispatch(S)};let i=1,o=1,a=1,l=0;const c=new b,u=new b,h=m=>{const x=t.current;r="not sure";const{event:y,origin:S,da:w}=m;y instanceof WheelEvent||(y.target===x||x!=null&&x.contains(y.target))&&(u.x=S[0],u.y=S[1],c.x=S[0],c.y=S[1],i=w[0],o=e.getZoomLevel(),e.dispatch({type:"pinch",name:"pinch_start",point:{x:S[0],y:S[1],z:e.getZoomLevel()},delta:{x:0,y:0},shiftKey:y.shiftKey,altKey:y.altKey,ctrlKey:y.metaKey||y.ctrlKey}))},p=m=>{if(m&&(r="zooming"),r==="zooming")return;const x=Math.abs(l-i),y=b.Dist(c,u);switch(r){case"not sure":{x>24?r="zooming":y>16&&(r="panning");break}case"panning":{x>64&&(r="zooming");break}}};return{onWheel:s,onPinchStart:h,onPinchEnd:m=>{const x=t.current,{event:y,origin:S,offset:w}=m;if(y instanceof WheelEvent||!(y.target===x||x!=null&&x.contains(y.target)))return;const P=w[0];r="not sure",e.timers.requestAnimationFrame(()=>{e.dispatch({type:"pinch",name:"pinch_end",point:{x:S[0],y:S[1],z:P},delta:{x:S[0],y:S[1]},shiftKey:y.shiftKey,altKey:y.altKey,ctrlKey:y.metaKey||y.ctrlKey})})},onPinch:m=>{const x=t.current,{event:y,origin:S,offset:w,da:P}=m;if(y instanceof WheelEvent||!(y.target===x||x!=null&&x.contains(y.target)))return;const E=m.type==="gesturechange"||m.type==="gestureend";l=P[0];const M=S[0]-u.x,I=S[1]-u.y;switch(u.x=S[0],u.y=S[1],p(E),r){case"zooming":{a=w[0],e.dispatch({type:"pinch",name:"pinch",point:{x:S[0],y:S[1],z:a},delta:{x:M,y:I},shiftKey:y.shiftKey,altKey:y.altKey,ctrlKey:y.metaKey||y.ctrlKey});break}case"panning":{e.dispatch({type:"pinch",name:"pinch",point:{x:S[0],y:S[1],z:o},delta:{x:M,y:I},shiftKey:y.shiftKey,altKey:y.altKey,ctrlKey:y.metaKey||y.ctrlKey});break}}}}},[e,t]);AY(n,{target:t,eventOptions:{passive:!1},pinch:{from:()=>[e.getZoomLevel(),0],scaleBounds:()=>({from:e.getZoomLevel(),max:8,min:.05})}})}function ay(t,e,n){const r=t.getShape(e),s=t.getShapeHandles(r);return{shape:r,handle:s.find(i=>i.id===n)}}function RY(t,e){const n=G();return C.useMemo(()=>{const r=l=>{if(l.isKilled)return;const c=ig(l.currentTarget);kh(c,l);const{shape:u,handle:h}=ay(n,t,e);h&&n.dispatch({type:"pointer",target:"handle",handle:h,shape:u,name:"pointer_down",...wr(l)})};let s,i;return{onPointerDown:r,onPointerMove:l=>{if(l.isKilled||l.clientX===s&&l.clientY===i)return;s=l.clientX,i=l.clientY;const{shape:c,handle:u}=ay(n,t,e);u&&n.dispatch({type:"pointer",target:"handle",handle:u,shape:c,name:"pointer_move",...wr(l)})},onPointerUp:l=>{if(l.isKilled)return;const c=ig(l.currentTarget);Ih(c,l);const{shape:u,handle:h}=ay(n,t,e);h&&n.dispatch({type:"pointer",target:"handle",handle:h,shape:u,name:"pointer_up",...wr(l)})}}},[n,t,e])}const Pt=class Pt{constructor(e=0,n=0,r=0,s=0){g(this,"x",0);g(this,"y",0);g(this,"w",0);g(this,"h",0);this.x=e,this.y=n,this.w=r,this.h=s}get point(){return new b(this.x,this.y)}set point(e){this.x=e.x,this.y=e.y}get minX(){return this.x}set minX(e){this.x=e}get midX(){return this.x+this.w/2}get maxX(){return this.x+this.w}get minY(){return this.y}set minY(e){this.y=e}get midY(){return this.y+this.h/2}get maxY(){return this.y+this.h}get width(){return this.w}set width(e){this.w=e}get height(){return this.h}set height(e){this.h=e}get aspectRatio(){return this.width/this.height}get center(){return new b(this.midX,this.midY)}set center(e){this.minX=e.x-this.width/2,this.minY=e.y-this.height/2}get corners(){return[new b(this.minX,this.minY),new b(this.maxX,this.minY),new b(this.maxX,this.maxY),new b(this.minX,this.maxY)]}get cornersAndCenter(){return[new b(this.minX,this.minY),new b(this.maxX,this.minY),new b(this.maxX,this.maxY),new b(this.minX,this.maxY),this.center]}get sides(){const{corners:e}=this;return[[e[0],e[1]],[e[1],e[2]],[e[2],e[3]],[e[3],e[0]]]}get size(){return new b(this.w,this.h)}toFixed(){return this.x=E0(this.x),this.y=E0(this.y),this.w=E0(this.w),this.h=E0(this.h),this}setTo(e){return this.x=e.x,this.y=e.y,this.w=e.w,this.h=e.h,this}set(e=0,n=0,r=0,s=0){return this.x=e,this.y=n,this.w=r,this.h=s,this}expand(e){const n=Math.min(this.minX,e.minX),r=Math.min(this.minY,e.minY),s=Math.max(this.maxX,e.maxX),i=Math.max(this.maxY,e.maxY);return this.x=n,this.y=r,this.w=s-n,this.h=i-r,this}expandBy(e){return this.x-=e,this.y-=e,this.w+=e*2,this.h+=e*2,this}scale(e){return this.x/=e,this.y/=e,this.w/=e,this.h/=e,this}clone(){const{x:e,y:n,w:r,h:s}=this;return new Pt(e,n,r,s)}translate(e){return this.x+=e.x,this.y+=e.y,this}snapToGrid(e){const n=Math.round(this.minX/e)*e,r=Math.round(this.minY/e)*e,s=Math.round(this.maxX/e)*e,i=Math.round(this.maxY/e)*e;this.minX=n,this.minY=r,this.width=Math.max(1,s-n),this.height=Math.max(1,i-r)}collides(e){return Pt.Collides(this,e)}contains(e){return Pt.Contains(this,e)}includes(e){return Pt.Includes(this,e)}containsPoint(e,n=0){return Pt.ContainsPoint(this,e,n)}getHandlePoint(e){switch(e){case"top_left":return new b(this.minX,this.minY);case"top_right":return new b(this.maxX,this.minY);case"bottom_left":return new b(this.minX,this.maxY);case"bottom_right":return new b(this.maxX,this.maxY);case"top":return new b(this.midX,this.minY);case"right":return new b(this.maxX,this.midY);case"bottom":return new b(this.midX,this.maxY);case"left":return new b(this.minX,this.midY)}}toJson(){return{x:this.minX,y:this.minY,w:this.w,h:this.h}}resize(e,n,r){const{minX:s,minY:i,maxX:o,maxY:a}=this;let{minX:l,minY:c,maxX:u,maxY:h}=this;switch(e){case"left":case"top_left":case"bottom_left":{l+=n;break}case"right":case"top_right":case"bottom_right":{u+=n;break}}switch(e){case"top":case"top_left":case"top_right":{c+=r;break}case"bottom":case"bottom_left":case"bottom_right":{h+=r;break}}const p=(u-l)/(o-s),f=(h-c)/(a-i),v=p<0,m=f<0;if(v){const x=u;u=l,l=x}if(m){const x=h;h=c,c=x}this.minX=l,this.minY=c,this.width=Math.abs(u-l),this.height=Math.abs(h-c)}union(e){const n=Math.min(this.minX,e.x),r=Math.min(this.minY,e.y),s=Math.max(this.maxX,e.w+e.x),i=Math.max(this.maxY,e.h+e.y);return this.x=n,this.y=r,this.width=s-n,this.height=i-r,this}static From(e){return new Pt(e.x,e.y,e.w,e.h)}static FromCenter(e,n){return new Pt(e.x-n.x/2,e.y-n.y/2,n.x,n.y)}static FromPoints(e){if(e.length===0)return new Pt;let n=1/0,r=1/0,s=-1/0,i=-1/0,o;for(let a=0,l=e.length;a<l;a++)o=e[a],n=Math.min(o.x,n),r=Math.min(o.y,r),s=Math.max(o.x,s),i=Math.max(o.y,i);return new Pt(n,r,s-n,i-r)}static Expand(e,n){const r=Math.min(n.minX,e.minX),s=Math.min(n.minY,e.minY),i=Math.max(n.maxX,e.maxX),o=Math.max(n.maxY,e.maxY);return new Pt(r,s,i-r,o-s)}static ExpandBy(e,n){return new Pt(e.minX-n,e.minY-n,e.width+n*2,e.height+n*2)}static Resize(e,n,r,s,i=!1){const{minX:o,minY:a,maxX:l,maxY:c}=e;let{minX:u,minY:h,maxX:p,maxY:f}=e;switch(n){case"left":case"top_left":case"bottom_left":{u+=r;break}case"right":case"top_right":case"bottom_right":{p+=r;break}}switch(n){case"top":case"top_left":case"top_right":{h+=s;break}case"bottom":case"bottom_left":case"bottom_right":{f+=s;break}}const v=(p-u)/(l-o),m=(f-h)/(c-a),x=v<0,y=m<0;if(i){const w=(l-o)/(c-a),P=Math.abs(p-u),E=Math.abs(f-h),M=P*(m<0?1:-1)*(1/w),I=E*(v<0?1:-1)*w,_=w<P/E;switch(n){case"top_left":{_?h=f+M:u=p+I;break}case"top_right":{_?h=f+M:p=u-I;break}case"bottom_right":{_?f=h-M:p=u-I;break}case"bottom_left":{_?f=h-M:u=p+I;break}case"bottom":case"top":{const D=(u+p)/2,R=E*w;u=D-R/2,p=D+R/2;break}case"left":case"right":{const D=(h+f)/2,R=P/w;h=D-R/2,f=D+R/2;break}}}if(x){const w=p;p=u,u=w}if(y){const w=f;f=h,h=w}const S=new Pt(u,h,Math.abs(p-u),Math.abs(f-h));return{box:S,scaleX:+(S.width/e.width*(v>0?1:-1)).toFixed(5),scaleY:+(S.height/e.height*(m>0?1:-1)).toFixed(5)}}equals(e){return Pt.Equals(this,e)}static Equals(e,n){return n.x===e.x&&n.y===e.y&&n.w===e.w&&n.h===e.h}zeroFix(){return this.w=Math.max(1,this.w),this.h=Math.max(1,this.h),this}static ZeroFix(e){return new Pt(e.x,e.y,Math.max(1,e.w),Math.max(1,e.h))}};g(Pt,"Collides",(e,n)=>!(e.maxX<n.minX||e.minX>n.maxX||e.maxY<n.minY||e.minY>n.maxY)),g(Pt,"Contains",(e,n)=>e.minX<n.minX&&e.minY<n.minY&&e.maxY>n.maxY&&e.maxX>n.maxX),g(Pt,"Includes",(e,n)=>Pt.Collides(e,n)||Pt.Contains(e,n)),g(Pt,"ContainsPoint",(e,n,r=0)=>!(n.x<e.minX-r||n.y<e.minY-r||n.x>e.maxX+r||n.y>e.maxY+r)),g(Pt,"Common",e=>{let n=1/0,r=1/0,s=-1/0,i=-1/0;for(let o=0;o<e.length;o++){const a=e[o];n=Math.min(n,a.minX),r=Math.min(r,a.minY),s=Math.max(s,a.maxX),i=Math.max(i,a.maxY)}return new Pt(n,r,s-n,i-r)}),g(Pt,"Sides",(e,n=0)=>{const{corners:r}=e;return[[r[0],r[1]],[r[1],r[2]],[r[2],r[3]],[r[3],r[0]]]});let fe=Pt;function OY(t){switch(t){case"top":return"bottom";case"bottom":return"top";case"top_left":return"bottom_left";case"top_right":return"bottom_right";case"bottom_left":return"top_left";case"bottom_right":return"top_right";default:return t}}function LY(t){switch(t){case"left":return"right";case"right":return"left";case"top_left":return"top_right";case"top_right":return"top_left";case"bottom_left":return"bottom_right";case"bottom_right":return"bottom_left";default:return t}}function NY(t){return t==="top_left"||t==="top_right"||t==="bottom_right"||t==="bottom_left"}function zY(t){const e=G();C.useLayoutEffect(()=>{let n=new fe;function r(){const c=t.current;if(!c)return null;const u=c.getBoundingClientRect(),h=new fe(u.left||u.x,u.top||u.y,Math.max(u.width,1),Math.max(u.height,1));n.equals(h)||(e.updateViewportScreenBounds(h),n=h)}r();const s=Tk(r,200,{trailing:!0}),i=e.timers.setInterval(s,1e3);window.addEventListener("resize",s);const o=new ResizeObserver(c=>{c[0].contentRect&&s()}),a=t.current;let l=null;return a&&(o.observe(a),l=FY(a),l.addEventListener("scroll",s)),()=>{clearInterval(i),window.removeEventListener("resize",s),o.disconnect(),l==null||l.removeEventListener("scroll",s),s.cancel()}},[e,t])}/*!
 * Author: excalidraw
 * MIT License: https://github.com/excalidraw/excalidraw/blob/master/LICENSE
 * https://github.com/excalidraw/excalidraw/blob/48c3465b19f10ec755b3eb84e21a01a468e96e43/packages/excalidraw/utils.ts#L600
 */const FY=t=>{let e=t.parentElement;for(;e;){if(e===document.body)return document;const{overflowY:n}=window.getComputedStyle(e);if(e.scrollHeight>e.clientHeight&&(n==="auto"||n==="scroll"||n==="overlay"))return e;e=e.parentElement}return document},st=class st{constructor(e,n,r,s,i,o){g(this,"a",1);g(this,"b",0);g(this,"c",0);g(this,"d",1);g(this,"e",0);g(this,"f",0);this.a=e,this.b=n,this.c=r,this.d=s,this.e=i,this.f=o}equals(e){return this===e||this.a===e.a&&this.b===e.b&&this.c===e.c&&this.d===e.d&&this.e===e.e&&this.f===e.f}identity(){return this.a=1,this.b=0,this.c=0,this.d=1,this.e=0,this.f=0,this}multiply(e){const n=e,{a:r,b:s,c:i,d:o,e:a,f:l}=this;return this.a=r*n.a+i*n.b,this.c=r*n.c+i*n.d,this.e=r*n.e+i*n.f+a,this.b=s*n.a+o*n.b,this.d=s*n.c+o*n.d,this.f=s*n.e+o*n.f+l,this}rotate(e,n,r){return e===0?this:n===void 0?this.multiply(st.Rotate(e)):this.translate(n,r).multiply(st.Rotate(e)).translate(-n,-r)}translate(e,n){return this.multiply(st.Translate(e,n))}scale(e,n){return this.multiply(st.Scale(e,n))}invert(){const{a:e,b:n,c:r,d:s,e:i,f:o}=this,a=e*s-n*r;return this.a=s/a,this.b=n/-a,this.c=r/-a,this.d=e/a,this.e=(s*i-r*o)/-a,this.f=(n*i-e*o)/a,this}applyToPoint(e){return st.applyToPoint(this,e)}applyToPoints(e){return st.applyToPoints(this,e)}rotation(){return st.Rotation(this)}point(){return st.Point(this)}decomposed(){return st.Decompose(this)}toCssString(){return st.toCssString(this)}setTo(e){return Object.assign(this,e),this}decompose(){return st.Decompose(this)}clone(){return new st(this.a,this.b,this.c,this.d,this.e,this.f)}static Identity(){return new st(1,0,0,1,0,0)}static Translate(e,n){return new st(1,0,0,1,e,n)}static Rotate(e,n,r){if(e===0)return st.Identity();const s=Math.cos(e),i=Math.sin(e),o=new st(s,i,-i,s,0,0);return n===void 0?o:st.Compose(st.Translate(n,r),o,st.Translate(-n,-r))}static Multiply(e,n){return{a:e.a*n.a+e.c*n.b,c:e.a*n.c+e.c*n.d,e:e.a*n.e+e.c*n.f+e.e,b:e.b*n.a+e.d*n.b,d:e.b*n.c+e.d*n.d,f:e.b*n.e+e.d*n.f+e.f}}static Inverse(e){const n=e.a*e.d-e.b*e.c;return{a:e.d/n,b:e.b/-n,c:e.c/-n,d:e.a/n,e:(e.d*e.e-e.c*e.f)/-n,f:(e.b*e.e-e.a*e.f)/n}}static Absolute(e){const n=e.a*e.d-e.b*e.c;return{a:e.d/n,b:e.b/-n,c:e.c/-n,d:e.a/n,e:(e.d*e.e-e.c*e.f)/n,f:(e.b*e.e-e.a*e.f)/-n}}static Compose(...e){const n=st.Identity();for(let r=0,s=e.length;r<s;r++)n.multiply(e[r]);return n}static Point(e){return new b(e.e,e.f)}static Rotation(e){let n;if(e.a!==0||e.c!==0){const r=(e.a*e.a+e.c*e.c)**.5;n=Math.acos(e.a/r)*(e.c>0?-1:1)}else if(e.b!==0||e.d!==0){const r=(e.b*e.b+e.d*e.d)**.5;n=vt+Math.acos(e.b/r)*(e.d>0?-1:1)}else n=0;return U2(n)}static Decompose(e){let n,r,s;if(e.a!==0||e.c!==0){const i=(e.a*e.a+e.c*e.c)**.5;n=i,r=(e.a*e.d-e.b*e.c)/i,s=Math.acos(e.a/i)*(e.c>0?-1:1)}else if(e.b!==0||e.d!==0){const i=(e.b*e.b+e.d*e.d)**.5;n=(e.a*e.d-e.b*e.c)/i,r=i,s=vt+Math.acos(e.b/i)*(e.d>0?-1:1)}else n=0,r=0,s=0;return{x:e.e,y:e.f,scaleX:n,scaleY:r,rotation:U2(s)}}static Smooth(e,n=1e10){return e.a=Math.round(e.a*n)/n,e.b=Math.round(e.b*n)/n,e.c=Math.round(e.c*n)/n,e.d=Math.round(e.d*n)/n,e.e=Math.round(e.e*n)/n,e.f=Math.round(e.f*n)/n,e}static toCssString(e){return`matrix(${K(e.a)}, ${K(e.b)}, ${K(e.c)}, ${K(e.d)}, ${K(e.e)}, ${K(e.f)})`}static applyToPoint(e,n){return new b(e.a*n.x+e.c*n.y+e.e,e.b*n.x+e.d*n.y+e.f,n.z)}static applyToXY(e,n,r){return[e.a*n+e.c*r+e.e,e.b*n+e.d*r+e.f]}static applyToPoints(e,n){return n.map(r=>new b(e.a*r.x+e.c*r.y+e.e,e.b*r.x+e.d*r.y+e.f,r.z))}static applyToBounds(e,n){return new fe(e.e+n.minX,e.f+n.minY,n.width,n.height)}static From(e){return new st(e.a,e.b,e.c,e.d,e.e,e.f)}static Cast(e){return e instanceof st?e:st.From(e)}};g(st,"Scale",(e,n,r,s)=>{const i=new st(e,0,0,n,0,0);return r===void 0?i:st.Compose(st.Translate(r,s),i,st.Translate(-r,-s))});let xe=st;function aE(t,e){return e===0?t:aE(e,t%e)}function lE(t){const e=t.toString().split(".")[1];if(!e)return 1;const n=Math.pow(10,e.length),r=parseInt(e,10);return n/aE(r,n)}class Ca{constructor(e){g(this,"isFilled",!1);g(this,"isClosed",!0);g(this,"isLabel",!1);g(this,"debugColor");g(this,"ignore");g(this,"_vertices");g(this,"_bounds");g(this,"_area");g(this,"_length");this.isFilled=e.isFilled,this.isClosed=e.isClosed,this.isLabel=e.isLabel??!1,this.debugColor=e.debugColor,this.ignore=e.ignore}hitTestPoint(e,n=0,r=!1){return this.isClosed&&(this.isFilled||r)&&Wr(e,this.vertices)?!0:b.Dist2(e,this.nearestPoint(e))<=n*n}distanceToPoint(e,n=!1){return e.dist(this.nearestPoint(e))*(this.isClosed&&(this.isFilled||n)&&Wr(e,this.vertices)?-1:1)}distanceToLineSegment(e,n){if(e.equals(n))return this.distanceToPoint(e);const{vertices:r}=this;let s,i=1/0,o,a,l;for(let c=0;c<r.length;c++)a=r[c],l=b.NearestPointOnLineSegment(e,n,a,!0),o=b.Dist2(a,l),o<i&&(i=o,s=l);if(!s)throw Error("nearest point not found");return this.isClosed&&this.isFilled&&Wr(s,this.vertices)?-i:i}hitTestLineSegment(e,n,r=0){return this.distanceToLineSegment(e,n)<=r}nearestPointOnLineSegment(e,n){const{vertices:r}=this;let s,i=1/0,o,a,l;for(let c=0;c<r.length;c++)a=r[c],l=b.NearestPointOnLineSegment(e,n,a,!0),o=b.Dist2(a,l),o<i&&(i=o,s=l);if(!s)throw Error("nearest point not found");return s}isPointInBounds(e,n=0){const{bounds:r}=this;return!(e.x<r.minX-n||e.y<r.minY-n||e.x>r.maxX+n||e.y>r.maxY+n)}get vertices(){return this._vertices||(this._vertices=this.getVertices()),this._vertices}getBounds(){return fe.FromPoints(this.vertices)}get bounds(){return this._bounds||(this._bounds=this.getBounds()),this._bounds}get center(){return this.bounds.center}get area(){return this._area||(this._area=this.getArea()),this._area}getArea(){if(!this.isClosed)return 0;const{vertices:e}=this;let n=0;for(let r=0,s=e.length;r<s;r++){const i=e[r],o=e[(r+1)%s];n+=i.x*o.y-o.x*i.y}return n/2}toSimpleSvgPath(){let e="";const{vertices:n}=this,r=n.length;if(r===0)return e;e+=`M${n[0].x},${n[0].y}`;for(let s=1;s<r;s++)e+=`L${n[s].x},${n[s].y}`;return this.isClosed&&(e+="Z"),e}get length(){return this._length?this._length:(this._length=this.getLength(),this._length)}getLength(){const{vertices:e}=this;let n,r=e[0],s=0;for(let i=1;i<e.length;i++)n=e[i],s+=b.Dist2(r,n),r=n;return Math.sqrt(s)}}class $s extends Ca{constructor(n){super({...n,isClosed:!0,isFilled:!1});g(this,"children",[]);g(this,"ignoredChildren",[]);for(const r of n.children)r.ignore?this.ignoredChildren.push(r):this.children.push(r);if(this.children.length===0)throw Error("Group2d must have at least one child")}getVertices(){return this.children.filter(n=>!n.isLabel).flatMap(n=>n.vertices)}nearestPoint(n){let r=1/0,s;const{children:i}=this;if(i.length===0)throw Error("no children");let o,a;for(const l of i)o=l.nearestPoint(n),a=b.Dist2(o,n),a<r&&(r=a,s=o);if(!s)throw Error("nearest point not found");return s}distanceToPoint(n,r=!1){return Math.min(...this.children.map((s,i)=>s.distanceToPoint(n,r||i>0)))}hitTestPoint(n,r,s){return!!this.children.filter(i=>!i.isLabel).find(i=>i.hitTestPoint(n,r,s))}hitTestLineSegment(n,r,s){return!!this.children.filter(i=>!i.isLabel).find(i=>i.hitTestLineSegment(n,r,s))}getArea(){return this.children[0].area}toSimpleSvgPath(){let n="";for(const s of this.children)n+=s.toSimpleSvgPath();const r=fe.FromPoints(this.vertices).corners;for(let s=0,i=r.length;s<i;s++){const o=r[s],a=r[(s-1+i)%i],l=o.dist(a),c=r[(s+1)%i],u=o.dist(c),h=o.clone().lrp(a,4/l),p=o,f=o.clone().lrp(c,4/u);n+=`M${h.x},${h.y} L${p.x},${p.y} L${f.x},${f.y} `}return n}getLength(){return this.children.reduce((n,r)=>r.isLabel?n:n+r.length,0)}getSvgPathData(){return this.children.map((n,r)=>n.isLabel?"":n.getSvgPathData(r===0)).join(" ")}}function $Y(t=!0){const[e,n]=C.useState(0),r=G();C.useEffect(()=>{if(!t)return;const s=()=>n(i=>i+1);return r.on("tick",s),()=>{r.off("tick",s)}},[r,t])}const BY=gn(function({showStroke:e=!0,showVertices:n=!0,showClosestPointOnOutline:r=!0}){const s=G();$Y(r);const i=s.getZoomLevel(),o=s.getRenderingShapes(),{inputs:{currentPagePoint:a}}=s;return d.jsx("svg",{style:{position:"absolute",pointerEvents:"none",zIndex:999999999,top:0,left:0,overflow:"visible"},children:o.map(l=>{const c=s.getShape(l.id);if(c.type==="group")return null;const u=s.getShapeGeometry(c),h=s.getShapePageTransform(c),p=s.getPointInShapeSpace(c,a),f=u.nearestPoint(p),v=u.distanceToPoint(p,!0),m=Math.abs(v)*i,x=v<0,{vertices:y}=u;return d.jsxs("g",{transform:h.toCssString(),strokeLinecap:"round",strokeLinejoin:"round",children:[e&&d.jsx("g",{stroke:u.debugColor??"red",opacity:"1",strokeWidth:2/i,fill:"none",children:d.jsx(cE,{geometry:u})}),n&&y.map((S,w)=>d.jsx("circle",{cx:S.x,cy:S.y,r:2/i,fill:`hsl(${Dc(w,[0,y.length-1],[120,200])}, 100%, 50%)`,stroke:"black",strokeWidth:1/i},`v${w}`)),r&&m<150&&d.jsx("line",{x1:f.x,y1:f.y,x2:p.x,y2:p.y,opacity:1-m/150,stroke:x?"goldenrod":"dodgerblue",strokeWidth:2/i})]},l.id+"_outline")})})});function cE({geometry:t}){return t instanceof $s?d.jsx(d.Fragment,{children:[...t.children,...t.ignoredChildren].map((e,n)=>d.jsx(cE,{geometry:e},n))}):d.jsx("path",{d:t.toSimpleSvgPath()})}function uE(t){return hG(t)}function dE(){const t=G(),e=pq("userIds",()=>uE(t.getCollaborators().map(n=>n.userId)).sort(),{isEqual:(n,r)=>{var s;return n.join(",")===((s=r.join)==null?void 0:s.call(r,","))}},[t]);return J(e)}function cm(t){const e=G();return J(`latestPresence:${t}`,()=>e.getCollaborators().find(r=>r.userId===t),[e,t])??null}const UY=gn(function(){return dE().map(n=>d.jsx(HY,{collaboratorId:n},n))}),HY=gn(function({collaboratorId:e}){const n=G(),r=cm(e),s=KY(n,r);if(!(r&&r.currentPageId===n.getCurrentPageId()))return null;switch(s){case"inactive":{const{followingUserId:i,highlightedUserIds:o}=n.getInstanceState();if(!(i===r.userId||o.includes(r.userId)))return null;break}case"idle":{const{highlightedUserIds:i}=n.getInstanceState();if(r.followingUserId===n.user.getId()&&!(r.chatMessage||i.includes(r.userId)))return null;break}}return d.jsx(WY,{latestPresence:r})}),WY=gn(function({latestPresence:e}){const n=G(),{CollaboratorBrush:r,CollaboratorScribble:s,CollaboratorCursor:i,CollaboratorHint:o,CollaboratorShapeIndicator:a}=_t(),l=n.getZoomLevel(),c=n.getViewportPageBounds(),{userId:u,chatMessage:h,brush:p,scribbles:f,selectedShapeIds:v,userName:m,cursor:x,color:y}=e,S=!(x.x<c.minX-12/l||x.y<c.minY-16/l||x.x>c.maxX-12/l||x.y>c.maxY-16/l);return d.jsxs(d.Fragment,{children:[p&&r?d.jsx(r,{className:"tl-collaborator__brush",brush:p,color:y,opacity:.1},u+"_brush"):null,S&&i?d.jsx(i,{className:"tl-collaborator__cursor",point:x,color:y,zoom:l,name:m!=="New User"?m:null,chatMessage:h},u+"_cursor"):o?d.jsx(o,{className:"tl-collaborator__cursor-hint",point:x,color:y,zoom:l,viewport:c},u+"_cursor_hint"):null,s&&f.length?d.jsx(d.Fragment,{children:f.map(w=>d.jsx(s,{className:"tl-collaborator__scribble",scribble:w,color:y,zoom:l,opacity:w.color==="laser"?.5:.1},u+"_scribble_"+w.id))}):null,a&&v.map(w=>d.jsx(a,{className:"tl-collaborator__shape-indicator",shapeId:w,color:y,opacity:.5},u+"_"+w))]})});function $6(t,e){return e>t.options.collaboratorInactiveTimeoutMs?"inactive":e>t.options.collaboratorIdleTimeoutMs?"idle":"active"}function KY(t,e){const n=C.useRef((e==null?void 0:e.lastActivityTimestamp)??-1),[r,s]=C.useState(()=>$6(t,Date.now()-n.current));return C.useEffect(()=>{const i=t.timers.setInterval(()=>{s($6(t,Date.now()-n.current))},t.options.collaboratorCheckIntervalMs);return()=>clearInterval(i)},[t]),e&&(n.current=e.lastActivityTimestamp),r}const hE=C.memo(function({id:e,shape:n,util:r,index:s,backgroundIndex:i,opacity:o,dprMultiple:a}){const l=G(),{ShapeErrorFallback:c}=_t(),u=C.useRef(null),h=C.useRef(null),p=C.useRef({transform:"",clipPath:"none",width:0,height:0,x:0,y:0,isCulled:!1});Jo("set shape stuff",()=>{const m=l.getShape(e);if(!m)return;const x=p.current,y=l.getShapeClipPath(e)??"none";y!==x.clipPath&&(On(u.current,"clip-path",y),On(h.current,"clip-path",y),x.clipPath=y);const S=l.getShapePageTransform(e),w=xe.toCssString(S),P=l.getShapeGeometry(m).bounds;w!==x.transform&&(On(u.current,"transform",w),On(h.current,"transform",w),x.transform=w);const E=P.w%a,M=P.h%a,I=E===0?P.w:P.w+(a-E),_=M===0?P.h:P.h+(a-M);(I!==x.width||_!==x.height)&&(On(u.current,"width",Math.max(I,a)+"px"),On(u.current,"height",Math.max(_,a)+"px"),On(h.current,"width",Math.max(I,a)+"px"),On(h.current,"height",Math.max(_,a)+"px"),x.width=I,x.height=_)},[l]),Jo("set opacity and z-index",()=>{const m=u.current,x=h.current;On(m,"opacity",o),On(x,"opacity",o),On(m,"z-index",s),On(x,"z-index",i)},[o,s,i]),Jo("set display",()=>{if(!l.getShape(e))return;const y=l.getCulledShapes().has(e);y!==p.current.isCulled&&(On(u.current,"display",y?"none":"block"),On(h.current,"display",y?"none":"block"),p.current.isCulled=y)},[l]);const f=C.useCallback(m=>l.annotateError(m,{origin:"shape",willCrashApp:!1}),[l]);if(!n)return null;const v="fill"in n.props&&n.props.fill!=="none";return d.jsxs(d.Fragment,{children:[r.backgroundComponent&&d.jsx("div",{ref:h,className:"tl-shape tl-shape-background","data-shape-type":n.type,draggable:!1,children:d.jsx(Qd,{fallback:c,onError:f,children:d.jsx(VY,{shape:n,util:r})})}),d.jsx("div",{ref:u,className:"tl-shape","data-shape-type":n.type,"data-shape-is-filled":v,draggable:!1,children:d.jsx(Qd,{fallback:c,onError:f,children:d.jsx(GY,{shape:n,util:r})})})]})}),GY=C.memo(function({shape:e,util:n}){return am("InnerShape:"+e.type,()=>n.component(n.editor.store.unsafeGetWithoutCapture(e.id)))},(t,e)=>t.shape.props===e.shape.props&&t.shape.meta===e.shape.meta),VY=C.memo(function({shape:e,util:n}){return am("InnerShape:"+e.type,()=>{var r;return(r=n.backgroundComponent)==null?void 0:r.call(n,n.editor.store.unsafeGetWithoutCapture(e.id))})},(t,e)=>t.shape.props===e.shape.props&&t.shape.meta===e.shape.meta);function qY({className:t}){const e=G(),{Background:n,SvgDefs:r,ShapeIndicators:s}=_t(),i=C.useRef(null),o=C.useRef(null),a=C.useRef(null),l=mn();zY(i),Eq(),kq(),jY(i),_q(i);const c=C.useRef({lodDisableTextOutline:!1,allowTextOutline:!0});Jo("position layers",function(){const{x:S,y:w,z:P}=e.getCamera();if(c.current.allowTextOutline&&e.environment.isSafari&&(l.style.setProperty("--tl-text-outline","none"),c.current.allowTextOutline=!1),c.current.allowTextOutline&&P<e.options.textShadowLod!==c.current.lodDisableTextOutline){const I=P<e.options.textShadowLod;l.style.setProperty("--tl-text-outline",I?"none":"var(--tl-text-outline-reference)"),c.current.lodDisableTextOutline=I}const E=P>=1?Dc(P,[1,8],[.125,.5],!0):Dc(P,[.1,1],[-2,.125],!0),M=`scale(${K(P)}) translate(${K(S+E)}px,${K(w+E)}px)`;On(o.current,"transform",M),On(a.current,"transform",M)},[e,l]);const u=XI(),h=J("shapeSvgDefs",()=>{const y=new Map;for(const S of Rt(e.shapeUtils)){if(!S)return;const w=S.getCanvasSvgDefs();for(const{key:P,component:E}of w)y.has(P)||y.set(P,d.jsx(E,{},P))}return[...y.values()]},[e]),p=J("debug_shapes",()=>Vt.hideShapes.get(),[Vt]),f=J("debug_svg",()=>Vt.debugSvg.get(),[Vt]),v=J("debug_geometry",()=>Vt.debugGeometry.get(),[Vt]),m=J("isEditingAnything",()=>e.getEditingShapeId()!==null,[e]),x=J("isSelectingAnything",()=>!!e.getSelectedShapeIds().length,[e]);return d.jsxs(d.Fragment,{children:[d.jsxs("div",{ref:i,draggable:!1,"data-iseditinganything":m,"data-isselectinganything":x,className:be("tl-canvas",t),"data-testid":"canvas",...u,children:[d.jsx("svg",{className:"tl-svg-context",children:d.jsxs("defs",{children:[h,d.jsx(lX,{}),d.jsx(cX,{}),r&&d.jsx(r,{})]})}),n&&d.jsx("div",{className:"tl-background__wrapper",children:d.jsx(n,{})}),d.jsx(XY,{}),d.jsxs("div",{ref:o,className:"tl-html-layer tl-shapes",draggable:!1,children:[d.jsx(pX,{}),d.jsx(hX,{}),p?null:f?d.jsx(sX,{}):d.jsx(oX,{})]}),d.jsx("div",{className:"tl-overlays",children:d.jsxs("div",{ref:a,className:"tl-html-layer",children:[v?d.jsx(BY,{}):null,d.jsx(tX,{}),d.jsx(QY,{}),d.jsx(ZY,{}),d.jsx(JY,{}),s&&d.jsx(s,{}),d.jsx(aX,{}),d.jsx(eX,{}),d.jsx(dX,{}),d.jsx(UY,{})]})}),d.jsx(fX,{})]}),d.jsx(YY,{})]})}function YY(){const{InFrontOfTheCanvas:t}=_t();return t?d.jsx(t,{}):null}function XY(){const t=G(),e=J("gridSize",()=>t.getDocumentSettings().gridSize,[t]),{x:n,y:r,z:s}=J("camera",()=>t.getCamera(),[t]),i=J("isGridMode",()=>t.getInstanceState().isGridMode,[t]),{Grid:o}=_t();return o&&i?d.jsx(o,{x:n,y:r,z:s,size:e}):null}function ZY(){const t=G(),e=J("scribbles",()=>t.getInstanceState().scribbles,[t]),n=J("zoomLevel",()=>t.getZoomLevel(),[t]),{Scribble:r}=_t();return r&&e.length?e.map(s=>d.jsx(r,{className:"tl-user-scribble",scribble:s,zoom:n},s.id)):null}function QY(){const t=G(),e=J("brush",()=>t.getInstanceState().brush,[t]),{Brush:n}=_t();return n&&e?d.jsx(n,{className:"tl-user-brush",brush:e}):null}function JY(){const t=G(),e=J("zoomBrush",()=>t.getInstanceState().zoomBrush,[t]),{ZoomBrush:n}=_t();return n&&e?d.jsx(n,{className:"tl-user-brush tl-zoom-brush",brush:e}):null}function eX(){const t=G(),e=J("snapLines",()=>t.snaps.getIndicators(),[t]),n=J("zoomLevel",()=>t.getZoomLevel(),[t]),{SnapIndicator:r}=_t();return r&&e.length>0?e.map(s=>d.jsx(r,{className:"tl-user-snapline",line:s,zoom:n},s.id)):null}function tX(){const t=G(),e=J("handles shapeIdWithHandles",()=>{const{isReadonly:n,isChangingStyle:r}=t.getInstanceState();if(n||r)return!1;const s=t.getOnlySelectedShape();return!s||!t.getShapeHandles(s)?!1:s.id},[t]);return e?d.jsx(nX,{shapeId:e}):null}function nX({shapeId:t}){const e=G(),{Handles:n}=_t(),r=J("zoomLevel",()=>e.getZoomLevel(),[e]),s=J("coarse pointer",()=>e.getInstanceState().isCoarsePointer,[e]),i=J("handles transform",()=>e.getShapePageTransform(t),[e,t]),o=J("handles",()=>{const a=e.getShapeHandles(t);if(!a)return null;const l=(s?e.options.coarseHandleRadius:e.options.handleRadius)/r*2;return a.filter(c=>c.type!=="virtual"||!a.some(u=>u!==c&&u.type==="vertex"&&b.Dist(c,u)<l)).sort(c=>c.type==="vertex"?1:-1)},[e,r,s,t]);return!n||!o||!i?null:d.jsx(n,{children:d.jsx("g",{transform:xe.toCssString(i),children:o.map(a=>d.jsx(rX,{shapeId:t,handle:a,zoom:r,isCoarse:s},a.id))})})}function rX({shapeId:t,handle:e,zoom:n,isCoarse:r}){const s=RY(t,e.id),{Handle:i}=_t();return i?d.jsx("g",{"aria-label":"handle",transform:`translate(${e.x}, ${e.y})`,...s,children:d.jsx(i,{shapeId:t,handle:e,zoom:n,isCoarse:r})}):null}function sX(){const t=G(),e=J("rendering shapes",()=>t.getRenderingShapes(),[t]),n=J("dpr multiple",()=>lE(Math.floor(t.getInstanceState().devicePixelRatio*100)/100),[t]);return e.map(r=>d.jsxs(C.Fragment,{children:[d.jsx(hE,{...r,dprMultiple:n}),d.jsx(uX,{id:r.id})]},r.id+"_fragment"))}function iX(){const t=G(),e=C.useRef(new Set);return Jo("reflow for culled shapes",()=>{const n=t.getCulledShapes();if(e.current.size===n.size&&[...n].every(s=>e.current.has(s)))return;e.current=n;const r=document.getElementsByClassName("tl-canvas");r.length!==0&&r[0].offsetHeight},[t]),null}function oX(){const t=G(),e=J("rendering shapes",()=>t.getRenderingShapes(),[t]),n=J("dpr multiple",()=>lE(Math.floor(t.getInstanceState().devicePixelRatio*100)/100),[t]);return d.jsxs(d.Fragment,{children:[e.map(r=>d.jsx(hE,{...r,dprMultiple:n},r.id+"_shape")),t.environment.isSafari&&d.jsx(iX,{})]})}function aX(){const t=G(),{ShapeIndicator:e}=_t(),n=J("hinting shape ids",()=>c4(t.getHintingShapeIds()),[t]);return!n.length||!e?null:n.map(r=>d.jsx(e,{className:"tl-user-indicator__hint",shapeId:r},r+"_hinting"))}function lX(){return d.jsxs("g",{id:"cursor",children:[d.jsxs("g",{fill:"rgba(0,0,0,.2)",transform:"translate(-11,-11)",children:[d.jsx("path",{d:"m12 24.4219v-16.015l11.591 11.619h-6.781l-.411.124z"}),d.jsx("path",{d:"m21.0845 25.0962-3.605 1.535-4.682-11.089 3.686-1.553z"})]}),d.jsxs("g",{fill:"white",transform:"translate(-12,-12)",children:[d.jsx("path",{d:"m12 24.4219v-16.015l11.591 11.619h-6.781l-.411.124z"}),d.jsx("path",{d:"m21.0845 25.0962-3.605 1.535-4.682-11.089 3.686-1.553z"})]}),d.jsxs("g",{fill:"currentColor",transform:"translate(-12,-12)",children:[d.jsx("path",{d:"m19.751 24.4155-1.844.774-3.1-7.374 1.841-.775z"}),d.jsx("path",{d:"m13 10.814v11.188l2.969-2.866.428-.139h4.768z"})]})]})}function cX(){return d.jsx("path",{id:"cursor_hint",fill:"currentColor",d:"M -2,-5 2,0 -2,5 Z"})}function uX({id:t}){const e=G(),[n,r]=C.useState(null),s=J("is in root",()=>{const i=e.getShape(t);return(i==null?void 0:i.parentId)===e.getCurrentPageId()},[e,t]);return C.useEffect(()=>{if(!s)return;let i=null;const o=ba("shape to svg",async()=>{const a=Math.random();i=a;const c=e.isShapeOfType(t,"frame")?0:10;let u=e.getShapePageBounds(t);if(!u)return;u=u.clone().expandBy(c);const h=await e.getSvgString([t],{padding:c,background:e.getInstanceState().exportBackground});if(i!==a||!h)return;const p=`data:image/svg+xml;utf8,${encodeURIComponent(h.svg)}`;r({src:p,bounds:u})});return()=>{i=null,o()}},[e,t,s]),!s||!n?null:d.jsx("img",{src:n.src,width:n.bounds.width,height:n.bounds.height,referrerPolicy:"no-referrer",style:{position:"absolute",top:0,left:0,transform:`translate(${n.bounds.x}px, ${n.bounds.maxY+12}px)`,outline:"1px solid black",maxWidth:"none"}})}function dX(){const t=G(),e=J("selection rotation",()=>t.getSelectionRotation(),[t]),n=J("selection bounds",()=>t.getSelectionRotatedPageBounds(),[t]),{SelectionForeground:r}=_t();return!n||!r?null:d.jsx(r,{bounds:n,rotation:e})}function hX(){const t=G(),e=J("selection rotation",()=>t.getSelectionRotation(),[t]),n=J("selection bounds",()=>t.getSelectionRotatedPageBounds(),[t]),{SelectionBackground:r}=_t();return!n||!r?null:d.jsx(r,{bounds:n,rotation:e})}function pX(){const{OnTheCanvas:t}=_t();return t?d.jsx(t,{}):null}function fX(){const t=G(),e=J("camera state",()=>t.getCameraState(),[t]);return d.jsx("div",{className:be("tl-hit-test-blocker",{"tl-hit-test-blocker__hidden":e==="idle"})})}function gX({className:t,zoom:e,point:n,color:r,viewport:s,opacity:i=1}){const o=C.useRef(null);return Jc(o,cn(n.x,s.minX+5/e,s.maxX-5/e),cn(n.y,s.minY+5/e,s.maxY-5/e),1/e,b.Angle(s.center,n)),d.jsxs("svg",{ref:o,className:be("tl-overlays__item",t),children:[d.jsx("use",{href:"#cursor_hint",color:r,strokeWidth:3,stroke:"var(--color-background)"}),d.jsx("use",{href:"#cursor_hint",color:r,opacity:i})]})}const B6=C.memo(function({className:e,zoom:n,point:r,color:s,name:i,chatMessage:o}){const a=C.useRef(null);return Jc(a,r==null?void 0:r.x,r==null?void 0:r.y,1/n),r?d.jsxs("div",{ref:a,className:be("tl-overlays__item",e),children:[d.jsx("svg",{className:"tl-cursor",children:d.jsx("use",{href:"#cursor",color:s})}),o?d.jsxs(d.Fragment,{children:[i&&d.jsx("div",{className:"tl-nametag-title",style:{color:s},children:i}),d.jsx("div",{className:"tl-nametag-chat",style:{backgroundColor:s},children:o})]}):i&&d.jsx("div",{className:"tl-nametag",style:{backgroundColor:s},children:i})]}):null});function pE(){return C.useId().replace(/:/g,"_")}function mX({x:t,y:e,z:n,size:r}){const s=`grid_${pE()}`,i=G(),{gridSteps:o}=i.options;return d.jsxs("svg",{className:"tl-grid",version:"1.1",xmlns:"http://www.w3.org/2000/svg",children:[d.jsx("defs",{children:o.map(({min:a,mid:l,step:c},u)=>{const h=c*r*n,p=.5+t*n,f=.5+e*n,v=p>0?p%h:h+p%h,m=f>0?f%h:h+f%h,x=n<l?Dc(n,[a,l],[0,1]):1;return d.jsx("pattern",{id:`${s}_${c}`,width:h,height:h,patternUnits:"userSpaceOnUse",children:d.jsx("circle",{className:"tl-grid-dot",cx:v,cy:m,r:1,opacity:x})},u)})}),o.map(({step:a},l)=>d.jsx("rect",{width:"100%",height:"100%",fill:`url(#${s}_${a})`},l))]})}function yX({handle:t,isCoarse:e,className:n,zoom:r}){const s=G(),i=(e?s.options.coarseHandleRadius:s.options.handleRadius)/r;if(t.type==="clone"){const a=3/r,l=`M0,${-a} A${a},${a} 0 0,1 0,${a}`,c=Cq.indexOf(t.id);return d.jsxs("g",{className:be(`tl-handle tl-handle__${t.type}`,n),children:[d.jsx("circle",{className:"tl-handle__bg",r:i}),d.jsx("path",{className:"tl-handle__fg",d:l,transform:`rotate(${-90+90*c})`})]})}const o=(t.type==="create"&&e?3:4)/Math.max(r,.25);return d.jsxs("g",{className:be(`tl-handle tl-handle__${t.type}`,n),children:[d.jsx("circle",{className:"tl-handle__bg",r:i}),d.jsx("circle",{className:"tl-handle__fg",r:o})]})}const vX=({children:t})=>d.jsx("svg",{className:"tl-user-handles tl-overlays__item",children:t}),SX=()=>{const{Spinner:t}=_t();return d.jsx(W4,{children:t?d.jsx(t,{}):null})};function _4(t,e=!0){const n=t.length;if(n<2)return"";let r=t[0],s=t[1];if(n===2)return`M${Xe(r)}L${Xe(s)}`;let i="";for(let o=2,a=n-1;o<a;o++)r=t[o],s=t[o+1],i+=yr(r,s);return e?`M${yr(t[0],t[1])}Q${Xe(t[1])}${yr(t[1],t[2])}T${i}${yr(t[n-1],t[0])}${yr(t[0],t[1])}Z`:`M${Xe(t[0])}Q${Xe(t[1])}${yr(t[1],t[2])}${t.length>3?"T":""}${i}L${Xe(t[n-1])}`}function U6({scribble:t,zoom:e,color:n,opacity:r,className:s}){return t.points.length?d.jsx("svg",{className:s&&be("tl-overlays__item",s),children:d.jsx("path",{className:"tl-scribble",d:_4(t.points,!1),stroke:n??`var(--color-${t.color})`,fill:"none",strokeWidth:8/e,opacity:r??t.opacity})}):null}function fE({bounds:t,rotation:e}){const n=C.useRef(null);return Jc(n,t.x,t.y,1,e),C.useLayoutEffect(()=>{const r=n.current;r&&(r.style.width=K(Math.max(1,t.width))+"px",r.style.height=K(Math.max(1,t.height))+"px")},[t.width,t.height]),d.jsx("div",{ref:n,className:"tl-selection__bg",draggable:!1})}function xX({bounds:t,rotation:e}){const n=G(),r=C.useRef(null),s=J("only selected shape",()=>n.getOnlySelectedShape(),[n]),i=s?n.getShapeUtil(s).expandSelectionOutlinePx(s):0;return Jc(r,t==null?void 0:t.x,t==null?void 0:t.y,1,e,{x:-i,y:-i}),t=t.clone().expandBy(i).zeroFix(),d.jsx("svg",{ref:r,className:"tl-overlays__item tl-selection__fg","data-testid":"selection-foreground",children:d.jsx("rect",{className:be("tl-selection__fg__outline"),width:K(t.width),height:K(t.height)})})}const wX=()=>d.jsx("div",{className:"tl-shape-error-boundary"}),bX=({shape:t,util:e})=>am("Indicator: "+t.type,()=>e.indicator(e.editor.store.unsafeGetWithoutCapture(t.id))),CX=({editor:t,id:e})=>{const n=J("shape for indicator",()=>t.store.get(e),[t,e]),{ShapeIndicatorErrorFallback:r}=_t();return!n||n.isLocked?null:d.jsx(Qd,{fallback:r,onError:s=>t.annotateError(s,{origin:"react.shapeIndicator",willCrashApp:!1}),children:d.jsx(bX,{shape:n,util:t.getShapeUtil(n)},n.id)})},H6=C.memo(function({shapeId:e,className:n,color:r,hidden:s,opacity:i}){const o=G(),a=C.useRef(null);return Jo("indicator transform",()=>{const l=a.current;if(!l)return;const c=o.getShapePageTransform(e);c&&l.style.setProperty("transform",c.toCssString())},[o,e]),C.useLayoutEffect(()=>{const l=a.current;l&&l.style.setProperty("display",s?"none":"block")},[s]),d.jsx("svg",{ref:a,className:be("tl-overlays__item",n),children:d.jsx("g",{className:"tl-shape-indicator",stroke:r??"var(--color-selected)",opacity:i,children:d.jsx(CX,{editor:o,id:e})})})}),PX=()=>d.jsx("circle",{cx:4,cy:4,r:8,strokeWidth:"1",stroke:"red"}),gE=C.memo(function(){const e=G(),n=C.useRef(new Set),r=J("should display selected ids",()=>{const o=n.current,a=new Set;if(e.isInAny("select.idle","select.brushing","select.scribble_brushing","select.editing_shape","select.pointing_shape","select.pointing_selection","select.pointing_handle")&&!e.getInstanceState().isChangingStyle){const l=e.getSelectedShapeIds();for(const c of l)a.add(c);if(e.isInAny("select.idle","select.editing_shape")){const c=e.getInstanceState();if(c.isHoveringCanvas&&!c.isCoarsePointer){const u=e.getHoveredShapeId();u&&a.add(u)}}}if(o.size!==a.size)return n.current=a,a;for(const l of a)if(!o.has(l))return n.current=a,a;return o},[e]),s=J("rendering shapes",()=>e.getRenderingShapes(),[e]),{ShapeIndicator:i}=_t();return i?s.map(({id:o})=>d.jsx(i,{shapeId:o,hidden:!r.has(o)},o+"_indicator")):null});function kX({points:t,zoom:e}){const n=2.5/e,r=t.reduce((p,f)=>Math.min(p,f.x),1/0),s=t.reduce((p,f)=>Math.max(p,f.x),-1/0),i=t.reduce((p,f)=>Math.min(p,f.y),1/0),o=t.reduce((p,f)=>Math.max(p,f.y),-1/0),a=t.some(p=>p.x===r&&p.y===i);let l,c,u,h;return a?(l=r,c=i,u=s,h=o):(l=r,c=o,u=s,h=i),d.jsxs("g",{className:"tl-snap-indicator",stroke:"lime",children:[d.jsx("line",{x1:l,y1:c,x2:u,y2:h}),t.map((p,f)=>d.jsx("g",{transform:`translate(${p.x},${p.y})`,children:d.jsx("path",{className:"tl-snap-point",d:`M ${-n},${-n} L ${n},${n} M ${-n},${n} L ${n},${-n}`})},f))]})}function IX({gaps:t,direction:e,zoom:n}){const r=3.5/n;let s=[-1/0,1/0],i=null;const o=e==="horizontal";for(const l of t){if(i=Ms(s[0],s[1],o?l.startEdge[0].y:l.startEdge[0].x,o?l.startEdge[1].y:l.startEdge[1].x),i)s=i;else continue;if(i=Ms(s[0],s[1],o?l.endEdge[0].y:l.endEdge[0].x,o?l.endEdge[1].y:l.endEdge[1].x),i)s=i;else continue}if(s===null)return null;const a=(s[0]+s[1])/2;return d.jsx("g",{className:"tl-snap-indicator",stroke:"cyan",children:t.map(({startEdge:l,endEdge:c},u)=>d.jsx(C.Fragment,{children:o?d.jsxs(d.Fragment,{children:[d.jsx("line",{x1:l[0].x,y1:a-2*r,x2:l[1].x,y2:a+2*r}),d.jsx("line",{x1:c[0].x,y1:a-2*r,x2:c[1].x,y2:a+2*r}),d.jsx("line",{x1:l[0].x,y1:a,x2:c[0].x,y2:a}),d.jsx("line",{x1:(l[0].x+c[0].x)/2,y1:a-r,x2:(l[0].x+c[0].x)/2,y2:a+r})]}):d.jsxs(d.Fragment,{children:[d.jsx("line",{x1:a-2*r,y1:l[0].y,x2:a+2*r,y2:l[1].y}),d.jsx("line",{x1:a-2*r,y1:c[0].y,x2:a+2*r,y2:c[1].y}),d.jsx("line",{x1:a,y1:l[0].y,x2:a,y2:c[0].y}),d.jsx("line",{x1:a-r,y1:(l[0].y+c[0].y)/2,x2:a+r,y2:(l[0].y+c[0].y)/2})]})},u))})}function EX({className:t,line:e,zoom:n}){return d.jsx("svg",{className:be("tl-overlays__item",t),children:e.type==="points"?d.jsx(kX,{...e,zoom:n}):e.type==="gaps"?d.jsx(IX,{...e,zoom:n}):null})}function A4(){return d.jsx("svg",{width:16,height:16,viewBox:"0 0 16 16",children:d.jsxs("g",{strokeWidth:2,fill:"none",fillRule:"evenodd",children:[d.jsx("circle",{strokeOpacity:.25,cx:8,cy:8,r:7,stroke:"currentColor"}),d.jsx("path",{strokeLinecap:"round",d:"M15 8c0-4.5-4.5-7-7-7",stroke:"currentColor",children:d.jsx("animateTransform",{attributeName:"transform",type:"rotate",from:"0 8 8",to:"360 8 8",dur:"1s",repeatCount:"indefinite"})})]})})}const TX=()=>null;function mE(t,e){const n=C.useRef(t);return e(t,n.current)?n.current:(n.current=t,t)}function Sd(t){return mE(t,gG)}const MX=(t,e)=>(t??(t=null),e??(e=null),t===e?!0:!t||!e?!1:h4(t,e));function Mh(t){return mE(t,MX)}const yE=C.createContext(null);function _X({overrides:t={},children:e}){const n=Mh(t),r=C.useMemo(()=>({Background:mq,SvgDefs:TX,Brush:iy,ZoomBrush:iy,CollaboratorBrush:iy,Cursor:B6,CollaboratorCursor:B6,CollaboratorHint:gX,CollaboratorShapeIndicator:H6,Grid:mX,Scribble:U6,SnapIndicator:EX,Handles:vX,Handle:yX,CollaboratorScribble:U6,ErrorFallback:SE,ShapeErrorFallback:wX,ShapeIndicatorErrorFallback:PX,Spinner:A4,SelectionBackground:fE,SelectionForeground:xX,ShapeIndicators:gE,ShapeIndicator:H6,OnTheCanvas:null,InFrontOfTheCanvas:null,Canvas:qY,LoadingScreen:SX,...n}),[n]);return d.jsx(yE.Provider,{value:r,children:e})}function _t(){const t=C.useContext(yE);if(!t)throw new Error("useEditorComponents must be used inside of <EditorComponentsProvider />");return t}const D4={openWindow:(t,e)=>window.open(t,e,"noopener noreferrer"),refreshPage:()=>window.location.reload(),hardReset:async()=>{var t;return await((t=window.__tldraw__hardReset)==null?void 0:t.call(window))}};function vE(){D4.hardReset()}function AX(){D4.refreshPage()}const DX="https://github.com/tldraw/tldraw/issues/new",SE=({error:t,editor:e})=>{const n=C.useRef(null),[r,s]=C.useState(!1),[i,o]=C.useState(!1),[a,l]=C.useState(!1);let c=null;try{c=_t().Canvas??null}catch{}const u=t instanceof Error?t.message:String(t),h=t instanceof Error?t.stack:null,p=J("isDarkMode",()=>{try{if(e)return e.user.getIsDarkMode()}catch{}return null},[e]),[f,v]=C.useState(null);C.useLayoutEffect(()=>{var E;p!==null&&v(p);let w=(E=n.current)==null?void 0:E.parentElement,P=!1;for(;w;){if(w.classList.contains("tl-theme__dark")||w.classList.contains("tl-theme__light")){P=!0;break}w=w.parentElement}if(P){v(null);return}typeof window<"u"&&"matchMedia"in window&&v(window.matchMedia("(prefers-color-scheme: dark)").matches)},[p]),C.useEffect(()=>{if(i){const w=e==null?void 0:e.timers.setTimeout(()=>{o(!1)},2e3);return()=>clearTimeout(w)}},[i,e]);const m=()=>{const w=document.createElement("textarea");w.value=h??u,document.body.appendChild(w),w.select(),document.execCommand("copy"),w.remove(),o(!0)},x=()=>{AX()},y=async()=>{vE()},S=new URL(DX);return S.searchParams.set("title",u),S.searchParams.set("labels","bug"),S.searchParams.set("body",`Hey, I ran into an error while using tldraw:

\`\`\`js
${h??u}
\`\`\`

My browser: ${navigator.userAgent}`),d.jsxs("div",{ref:n,className:be("tl-container tl-error-boundary",f===null?"":f?"tl-theme__dark":"tl-theme__light"),children:[d.jsx("div",{className:"tl-error-boundary__overlay"}),e&&d.jsx(GI,{onError:Kd,fallback:()=>null,children:d.jsx(lm.Provider,{value:e,children:d.jsx("div",{className:"tl-overlay tl-error-boundary__canvas",children:c?d.jsx(c,{}):null})})}),d.jsx("div",{className:be("tl-modal","tl-error-boundary__content",{"tl-error-boundary__content__expanded":r&&!a}),children:a?d.jsxs(d.Fragment,{children:[d.jsx("h2",{children:"Are you sure?"}),d.jsx("p",{children:"Resetting your data will delete your drawing and cannot be undone."}),d.jsxs("div",{className:"tl-error-boundary__content__actions",children:[d.jsx("button",{onClick:()=>l(!1),children:"Cancel"}),d.jsx("button",{className:"tl-error-boundary__reset",onClick:y,children:"Reset data"})]})]}):d.jsxs(d.Fragment,{children:[d.jsx("h2",{children:"Something's gone wrong."}),d.jsxs("p",{children:["Sorry, we encountered an error. Please refresh the page to continue. If you keep seeing this error, you can ",d.jsx("a",{href:S.toString(),children:"create a GitHub issue"})," or"," ",d.jsx("a",{href:"https://discord.gg/Cq6cPsTfNy",children:"ask for help on Discord"}),"."]}),r&&d.jsxs(d.Fragment,{children:["Message:",d.jsx("h4",{children:d.jsx("code",{children:u})}),"Stack trace:",d.jsxs("div",{className:"tl-error-boundary__content__error",children:[d.jsx("pre",{children:d.jsx("code",{children:h??u})}),d.jsx("button",{onClick:m,children:i?"Copied!":"Copy"})]})]}),d.jsxs("div",{className:"tl-error-boundary__content__actions",children:[d.jsx("button",{onClick:()=>s(!r),children:r?"Hide details":"Show details"}),d.jsxs("div",{className:"tl-error-boundary__content__actions__group",children:[d.jsx("button",{className:"tl-error-boundary__reset",onClick:()=>l(!0),children:"Reset data"}),d.jsx("button",{className:"tl-error-boundary__refresh",onClick:x,children:"Refresh Page"})]})]})]})})]})};let jX=(t=21)=>crypto.getRandomValues(new Uint8Array(t)).reduce((e,n)=>(n&=63,n<36?e+=n.toString(36):n<62?e+=(n-26).toString(36).toUpperCase():n>62?e+="-":e+="_",e),"");function dt(){return jX()}const xE="TLDRAW_USER_DATA_v3",wE=$e({id:De,name:De.nullable().optional(),locale:De.nullable().optional(),color:De.nullable().optional(),colorScheme:im("light","dark","system").optional(),animationSpeed:ke.nullable().optional(),edgeScrollSpeed:ke.nullable().optional(),isSnapMode:ze.nullable().optional(),isWrapMode:ze.nullable().optional(),isDynamicSizeMode:ze.nullable().optional(),isPasteAtCursorMode:ze.nullable().optional()}),Oi={AddAnimationSpeed:1,AddIsSnapMode:2,MakeFieldsNullable:3,AddEdgeScrollSpeed:4,AddExcalidrawSelectMode:5,AddDynamicSizeMode:6,AllowSystemColorScheme:7,AddPasteAtCursor:8},j4=Math.max(...Object.values(Oi));function RX(t){t.version<Oi.AddAnimationSpeed&&(t.user.animationSpeed=1),t.version<Oi.AddIsSnapMode&&(t.user.isSnapMode=!1),t.version<Oi.MakeFieldsNullable,t.version<Oi.AddEdgeScrollSpeed&&(t.user.edgeScrollSpeed=1),t.version<Oi.AddExcalidrawSelectMode&&(t.user.isWrapMode=!1),t.version<Oi.AllowSystemColorScheme&&(t.user.isDarkMode===!0?t.user.colorScheme="dark":t.user.isDarkMode===!1&&(t.user.colorScheme="light"),delete t.user.isDarkMode),t.version<Oi.AddDynamicSizeMode&&(t.user.isDynamicSizeMode=!1),t.version<Oi.AddPasteAtCursor&&(t.user.isPasteAtCursorMode=!1),t.version=j4}const G2=["#FF802B","#EC5E41","#F2555A","#F04F88","#E34BA9","#BD54C6","#9D5BD2","#7B66DC","#02B1CC","#11B3A3","#39B178","#55B467"];function bE(){return G2[Math.floor(Math.random()*G2.length)]}function OX(){var t,e;return typeof window<"u"&&"matchMedia"in window?((e=(t=window.matchMedia)==null?void 0:t.call(window,"(prefers-reduced-motion: reduce)"))==null?void 0:e.matches)??!1:!1}const Is=Object.freeze({name:"New User",locale:aq(),color:bE(),edgeScrollSpeed:1,animationSpeed:OX()?0:1,isSnapMode:!1,isWrapMode:!1,isDynamicSizeMode:!1,isPasteAtCursorMode:!1,colorScheme:"system"});function ly(){return{id:dt(),color:bE()}}function CE(t){if(t===null||typeof t!="object"||!("version"in t)||!("user"in t)||typeof t.version!="number")return ly();const e=yt(t);RX(e);try{return wE.validate(e.user)}catch{return ly()}}function LX(){const t=JSON.parse(p4(xE)||"null")??null;return CE(t)}const um=Qt("globalUserData",null);function NX(){f4(xE,JSON.stringify({version:j4,user:um.get()}))}function PE(t){wE.validate(t),um.set(t),NX(),FX()}const zX=typeof process<"u"&&!1,vc=typeof BroadcastChannel<"u"&&!zX?new BroadcastChannel("tldraw-user-sync"):null;vc==null||vc.addEventListener("message",t=>{const e=t.data;(e==null?void 0:e.type)===IE&&(e==null?void 0:e.origin)!==kE()&&um.set(CE(e.data))});let cy=null;function kE(){return cy===null&&(cy=dt()),cy}const IE="tldraw-user-preferences-change";function FX(){vc==null||vc.postMessage({type:IE,origin:kE(),data:{user:R4(),version:j4}})}function R4(){let t=um.get();return t||(t=LX(),PE(t)),t}const $X=ee("defaultLocalStorageUserPrefs",()=>R4());function EE(t={}){return{userPreferences:t.userPreferences??$X,setUserPreferences:t.setUserPreferences??PE}}var TE={exports:{}};(function(t){var e=Object.prototype.hasOwnProperty,n="~";function r(){}Object.create&&(r.prototype=Object.create(null),new r().__proto__||(n=!1));function s(l,c,u){this.fn=l,this.context=c,this.once=u||!1}function i(l,c,u,h,p){if(typeof u!="function")throw new TypeError("The listener must be a function");var f=new s(u,h||l,p),v=n?n+c:c;return l._events[v]?l._events[v].fn?l._events[v]=[l._events[v],f]:l._events[v].push(f):(l._events[v]=f,l._eventsCount++),l}function o(l,c){--l._eventsCount===0?l._events=new r:delete l._events[c]}function a(){this._events=new r,this._eventsCount=0}a.prototype.eventNames=function(){var c=[],u,h;if(this._eventsCount===0)return c;for(h in u=this._events)e.call(u,h)&&c.push(n?h.slice(1):h);return Object.getOwnPropertySymbols?c.concat(Object.getOwnPropertySymbols(u)):c},a.prototype.listeners=function(c){var u=n?n+c:c,h=this._events[u];if(!h)return[];if(h.fn)return[h.fn];for(var p=0,f=h.length,v=new Array(f);p<f;p++)v[p]=h[p].fn;return v},a.prototype.listenerCount=function(c){var u=n?n+c:c,h=this._events[u];return h?h.fn?1:h.length:0},a.prototype.emit=function(c,u,h,p,f,v){var m=n?n+c:c;if(!this._events[m])return!1;var x=this._events[m],y=arguments.length,S,w;if(x.fn){switch(x.once&&this.removeListener(c,x.fn,void 0,!0),y){case 1:return x.fn.call(x.context),!0;case 2:return x.fn.call(x.context,u),!0;case 3:return x.fn.call(x.context,u,h),!0;case 4:return x.fn.call(x.context,u,h,p),!0;case 5:return x.fn.call(x.context,u,h,p,f),!0;case 6:return x.fn.call(x.context,u,h,p,f,v),!0}for(w=1,S=new Array(y-1);w<y;w++)S[w-1]=arguments[w];x.fn.apply(x.context,S)}else{var P=x.length,E;for(w=0;w<P;w++)switch(x[w].once&&this.removeListener(c,x[w].fn,void 0,!0),y){case 1:x[w].fn.call(x[w].context);break;case 2:x[w].fn.call(x[w].context,u);break;case 3:x[w].fn.call(x[w].context,u,h);break;case 4:x[w].fn.call(x[w].context,u,h,p);break;default:if(!S)for(E=1,S=new Array(y-1);E<y;E++)S[E-1]=arguments[E];x[w].fn.apply(x[w].context,S)}}return!0},a.prototype.on=function(c,u,h){return i(this,c,u,h,!1)},a.prototype.once=function(c,u,h){return i(this,c,u,h,!0)},a.prototype.removeListener=function(c,u,h,p){var f=n?n+c:c;if(!this._events[f])return this;if(!u)return o(this,f),this;var v=this._events[f];if(v.fn)v.fn===u&&(!p||v.once)&&(!h||v.context===h)&&o(this,f);else{for(var m=0,x=[],y=v.length;m<y;m++)(v[m].fn!==u||p&&!v[m].once||h&&v[m].context!==h)&&x.push(v[m]);x.length?this._events[f]=x.length===1?x[0]:x:o(this,f)}return this},a.prototype.removeAllListeners=function(c){var u;return c?(u=n?n+c:c,this._events[u]&&o(this,u)):(this._events=new r,this._eventsCount=0),this},a.prototype.off=a.prototype.removeListener,a.prototype.addListener=a.prototype.on,a.prefixed=n,a.EventEmitter=a,t.exports=a})(TE);var BX=TE.exports;const UX=ga(BX),Sc="TLDRAW_TAB_ID_v2",gi=globalThis.window;function HX(){return gi?["iPad Simulator","iPhone Simulator","iPod Simulator","iPad","iPhone","iPod"].includes(gi.navigator.platform)||gi.navigator.userAgent.includes("Mac")&&"ontouchend"in document:!1}const Jd=gi?gi[Sc]??Gk(Sc)??"TLDRAW_INSTANCE_STATE_V1_"+dt():"<error>";gi&&(gi[Sc]=Jd,HX()?g4(Sc,Jd):Vk(Sc));gi==null||gi.addEventListener("beforeunload",()=>{g4(Sc,Jd)});const ME={Initial:0},dm=Math.max(...Object.values(ME));function WX(t){t.version<ME.Initial,t.version=dm}const _E=$e({version:ke,currentPageId:Yd,isFocusMode:ze,exportBackground:ze,isDebugMode:ze,isToolLocked:ze,isGridMode:ze,pageStates:wn($e({pageId:Yd,camera:$e({x:ke,y:ke,z:ke}),selectedShapeIds:wn(rs),focusedGroupId:rs.nullable()}))});function KX(t){if(!t||typeof t!="object")return console.warn("Invalid instance state"),null;if(!("version"in t)||typeof t.version!="number")return console.warn("No version in instance state"),null;t.version!==dm&&(t=yt(t),WX(t));try{return _E.validate(t)}catch(e){return console.warn(e),null}}function AE(t){const e=t.query.ids("page");return ee("sessionStateSnapshot",()=>{const n=t.get(Fn);if(!n)return null;const r=[...e.get()];return{version:dm,currentPageId:n.currentPageId,exportBackground:n.exportBackground,isFocusMode:n.isFocusMode,isDebugMode:n.isDebugMode,isToolLocked:n.isToolLocked,isGridMode:n.isGridMode,pageStates:r.map(s=>{const i=t.get(us.createId(s)),o=t.get(Rs.createId(s));return{pageId:s,camera:{x:(o==null?void 0:o.x)??0,y:(o==null?void 0:o.y)??0,z:(o==null?void 0:o.z)??1},selectedShapeIds:(i==null?void 0:i.selectedShapeIds)??[],focusedGroupId:(i==null?void 0:i.focusedGroupId)??null}})}})}function DE(t,e){const n=KX(e);if(!n)return;const r=t.schema.types.instance.create({id:Fn,...vI(t.get(Fn)),currentPageId:n.currentPageId,isDebugMode:n.isDebugMode,isFocusMode:n.isFocusMode,isToolLocked:n.isToolLocked,isGridMode:n.isGridMode,exportBackground:n.exportBackground}),s=t.allRecords().filter(i=>i.typeName==="instance_page_state"||i.typeName==="camera");t.atomic(()=>{t.remove(s.map(i=>i.id));for(const i of n.pageStates)t.put([Rs.create({id:Rs.createId(i.pageId),x:i.camera.x,y:i.camera.y,z:i.camera.z}),us.create({id:us.createId(i.pageId),pageId:i.pageId,selectedShapeIds:i.selectedShapeIds,focusedGroupId:i.focusedGroupId})]);t.put([r]),t.ensureStoreIsUsable()})}function GX(t){var s;const e=[];for(const i of Object.values(t))(s=i.typeName)!=null&&s.match(/^(instance.*|pointer|camera)$/)&&e.push(i);const n=e.filter(i=>i.typeName==="instance"&&i.id!==Fn)[0];if(!n)return null;const r={version:dm,currentPageId:n.currentPageId,exportBackground:!!n.exportBackground,isFocusMode:!!n.isFocusMode,isDebugMode:!!n.isDebugMode,isToolLocked:!!n.isToolLocked,isGridMode:!1,pageStates:e.filter(i=>i.typeName==="instance_page_state"&&i.instanceId===n.id).map(i=>{const o=t[i.cameraId]??{x:0,y:0,z:1};return{pageId:i.pageId,camera:{x:o.x,y:o.y,z:o.z},selectedShapeIds:i.selectedShapeIds,focusedGroupId:i.focusedGroupId}})};try{return _E.validate(r),r}catch{return null}}function jE(t,e){let n={};if("store"in e){const s=t.schema.migrateStoreSnapshot(e);if(s.type!=="success")throw new Error("Failed to migrate store snapshot: "+s.reason);n.document={schema:t.schema.serialize(),store:gd(s.value,(i,{typeName:o})=>t.scopedTypes.document.has(o))}}else n=e;const r=vI(t.get(Fn));t.atomic(()=>{n.document&&t.loadStoreSnapshot(n.document),r&&t.update(Fn,s=>({...s,...r})),n.session&&DE(t,n.session)})}const VX=new so;function qX(t){const n=VX.get(t,AE).get();if(!n)throw new Error("Session state is not ready yet");return{document:t.getStoreSnapshot(),session:n}}function RE(t){const e=[],n=new Set;for(const r of t){if(n.has(r.type))throw new Error(`Binding type "${r.type}" is defined more than once`);e.push(r),n.add(r.type)}return e}function oa({children:t,className:e="",...n}){return d.jsx("svg",{...n,className:be("tl-svg-container",e),children:t})}function O4(t,e,n,r){const s=t.x-n.x,i=t.y-n.y,o=r.x-n.x,a=r.y-n.y,l=e.x-t.x,c=e.y-t.y,u=o*i-a*s,h=l*i-c*s,p=a*l-o*c;if(u===0||h===0||p===0)return null;if(p!==0){const f=u/p,v=h/p;if(0<=f&&f<=1&&0<=v&&v<=1)return b.AddXY(t,f*l,f*c)}return null}function _h(t,e,n,r){const s=(e.x-t.x)*(e.x-t.x)+(e.y-t.y)*(e.y-t.y),i=2*((e.x-t.x)*(t.x-n.x)+(e.y-t.y)*(t.y-n.y)),o=n.x*n.x+n.y*n.y+t.x*t.x+t.y*t.y-2*(n.x*t.x+n.y*t.y)-r*r,a=i*i-4*s*o;if(a<0||a===0)return null;const l=Math.sqrt(a),c=(-i+l)/(2*s),u=(-i-l)/(2*s);if((c<0||c>1)&&(u<0||u>1))return null;const h=[];return 0<=c&&c<=1&&h.push(b.Lrp(t,e,c)),0<=u&&u<=1&&h.push(b.Lrp(t,e,u)),h.length===0?null:h}function YX(t,e,n){const r=[];let s;for(let i=0,o=n.length-1;i<o;i++)s=O4(t,e,n[i],n[i+1]),s&&r.push(s);return r.length===0?null:r}function L4(t,e,n){const r=[];let s;for(let i=1,o=n.length;i<o+1;i++)s=O4(t,e,n[i-1],n[i%n.length]),s&&r.push(s);return r.length===0?null:r}function XX(t,e,n,r){let s=n.x-t.x,i=n.y-t.y;const o=Math.sqrt(s*s+i*i),a=(o*o-r*r+e*e)/(2*o),l=Math.sqrt(e*e-a*a);return s/=o,i/=o,[new b(t.x+s*a-i*l,t.y+i*a+s*l),new b(t.x+s*a+i*l,t.y+i*a-s*l)]}function V2(t,e,n){const r=[];let s,i,o;for(let a=0,l=n.length;a<l;a++)s=n[a],i=n[(a+1)%n.length],o=_h(s,i,t,e),o&&r.push(...o);return r.length===0?null:r}function W6(t,e,n){const r=[];let s,i,o;for(let a=1,l=n.length;a<l;a++)s=n[a-1],i=n[a],o=_h(s,i,t,e),o&&r.push(...o);return r.length===0?null:r}function _0(t,e,n){return(n.y-t.y)*(e.x-t.x)>(e.y-t.y)*(n.x-t.x)}function N4(t,e,n,r){return _0(t,n,r)!==_0(e,n,r)&&_0(t,e,n)!==_0(t,e,r)}function K6(t,e){const n=new Map;let r,s,i,o;for(let a=0,l=t.length;a<l;a++)if(r=t[a],Wr(r,e)){const c=uy(r);n.has(c)||n.set(c,r)}for(let a=0,l=e.length;a<l;a++)if(r=e[a],Wr(r,t)){const c=uy(r);n.has(c)||n.set(c,r)}for(let a=0,l=t.length;a<l;a++){r=t[a],s=t[(a+1)%t.length];for(let c=0,u=e.length;c<u;c++){i=e[c],o=e[(c+1)%e.length];const h=O4(r,s,i,o);if(h!==null){const p=uy(h);n.has(p)||n.set(p,h)}}}return n.size===0?null:ZX([...n.values()])}function uy(t){return`${t.x},${t.y}`}function ZX(t){const e=b.Average(t);return t.sort((n,r)=>b.Angle(e,n)-b.Angle(e,r))}function OE(t,e){let n,r,s,i;for(let o=0,a=t.length;o<a;o++){n=t[o],r=t[(o+1)%a];for(let l=0,c=e.length;l<c;l++)if(s=e[l],i=e[(l+1)%c],N4(n,r,s,i))return!0}return!1}function QX(t,e){let n,r,s,i;for(let o=0,a=t.length;o<a;o++){n=t[o],r=t[(o+1)%a];for(let l=1,c=e.length;l<c;l++)if(s=e[l-1],i=e[l],N4(n,r,s,i))return!0}return!1}class Ki extends Ca{constructor(n){super({...n,isClosed:!1,isFilled:!1});g(this,"start");g(this,"end");g(this,"d");g(this,"u");g(this,"ul");const{start:r,end:s}=n;this.start=r,this.end=s,this.d=r.clone().sub(s),this.u=this.d.clone().uni(),this.ul=this.u.len()}getLength(){return this.d.len()}midPoint(){return this.start.lrp(this.end,.5)}getVertices(){return[this.start,this.end]}nearestPoint(n){const{start:r,end:s,u:i,ul:o}=this;if(o===0)return r;const a=b.Sub(n,r).dpr(i)/o,l=r.x+i.x*a;if(l<Math.min(r.x,s.x))return r.x<s.x?r:s;if(l>Math.max(r.x,s.x))return r.x>s.x?r:s;const c=r.y+i.y*a;return c<Math.min(r.y,s.y)?r.y<s.y?r:s:c>Math.max(r.y,s.y)?r.y>s.y?r:s:new b(l,c)}hitTestLineSegment(n,r,s=0){return N4(n,r,this.start,this.end)||this.distanceToLineSegment(n,r)<=s}getSvgPathData(n=!0){const{start:r,end:s}=this;return`${n?`M${r.toFixed()}`:""} L${s.toFixed()}`}}class eu extends Ca{constructor(n){super({isClosed:!1,isFilled:!1,...n});g(this,"points");g(this,"_segments");const{points:r}=n;this.points=r}get segments(){if(!this._segments){this._segments=[];const{vertices:n}=this;for(let r=0,s=n.length-1;r<s;r++){const i=n[r],o=n[r+1];this._segments.push(new Ki({start:i,end:o}))}this.isClosed&&this._segments.push(new Ki({start:n[n.length-1],end:n[0]}))}return this._segments}getLength(){return this.segments.reduce((n,r)=>n+r.length,0)}getVertices(){return this.points}nearestPoint(n){const{segments:r}=this;let s=this.points[0],i=1/0,o,a;for(let l=0;l<r.length;l++)o=r[l].nearestPoint(n),a=b.Dist2(o,n),a<i&&(s=o,i=a);if(!s)throw Error("nearest point not found");return s}hitTestLineSegment(n,r,s=0){const{segments:i}=this;for(let o=0,a=i.length;o<a;o++)if(i[o].hitTestLineSegment(n,r,s))return!0;return!1}getSvgPathData(){const{vertices:n}=this;return n.length<2?"":n.reduce((r,s,i)=>i===0?`M ${s.x} ${s.y}`:`${r} L ${s.x} ${s.y}`,"")}}class Kt extends eu{constructor(e){super({...e}),this.isClosed=!0}}class xi extends Kt{constructor(n){const{x:r=0,y:s=0,width:i,height:o}=n;super({...n,points:[new b(r,s),new b(r+i,s),new b(r+i,s+o),new b(r,s+o)]});g(this,"x");g(this,"y");g(this,"w");g(this,"h");this.x=r,this.y=s,this.w=i,this.h=o}getBounds(){return new fe(this.x,this.y,this.w,this.h)}getSvgPathData(){const{x:n,y:r,w:s,h:i}=this;return`M${n},${r} h${s} v${i} h-${s}z`}}class fs{constructor(e){g(this,"canSnap",()=>!0);g(this,"canScroll",()=>!1);g(this,"canEdit",()=>!1);g(this,"canResize",()=>!0);g(this,"canEditInReadOnly",()=>!1);g(this,"canCrop",()=>!1);g(this,"canBeLaidOut",()=>!0);g(this,"hideResizeHandles",()=>!1);g(this,"hideRotateHandle",()=>!1);g(this,"hideSelectionBoundsBg",()=>!1);g(this,"hideSelectionBoundsFg",()=>!1);g(this,"isAspectRatioLocked",()=>!1);g(this,"onBeforeCreate");g(this,"onBeforeUpdate");g(this,"onDragShapesOver");g(this,"onDragShapesOut");g(this,"onDropShapesOver");g(this,"onResizeStart");g(this,"onResize");g(this,"onResizeEnd");g(this,"onTranslateStart");g(this,"onTranslate");g(this,"onTranslateEnd");g(this,"onHandleDrag");g(this,"onRotateStart");g(this,"onRotate");g(this,"onRotateEnd");g(this,"onBindingChange");g(this,"onChildrenChange");g(this,"onDoubleClickHandle");g(this,"onDoubleClickEdge");g(this,"onDoubleClick");g(this,"onClick");g(this,"onEditEnd");this.editor=e}canBind(e){return!0}providesBackgroundForChildren(e){return!1}canReceiveNewChildrenOfType(e,n){return!1}canDropShapes(e,n){return!1}expandSelectionOutlinePx(e){return 0}getCanvasSvgDefs(){return[]}getBoundsSnapGeometry(e){return{}}getHandleSnapGeometry(e){return{}}}g(fs,"props"),g(fs,"migrations"),g(fs,"type");function JX(t,e,n={}){const{closed:r=!1,snap:s=1,start:i="outset",end:o="outset",lengthRatio:a=2,style:l="dashed"}=n;let c=0,u=0,h=1,p=0,f=0;switch(l){case"dashed":{h=1,c=Math.min(e*a,t/4);break}case"dotted":{h=100,c=e/h;break}default:return{strokeDasharray:"none",strokeDashoffset:"none"}}return r||(i==="outset"?(t+=c/2,f+=c/2):i==="skip"&&(t-=c,f-=c),o==="outset"?t+=c/2:o==="skip"&&(t-=c)),u=Math.floor(t/c/(2*h)),u-=u%s,u<3&&l==="dashed"?t/e<5?(c=t,u=1,p=0):(c=t*.333,p=t*.333):(u=Math.max(u,3),c=t/u/(2*h),r?(f=c/2,p=(t-u*c)/u):p=(t-u*c)/Math.max(1,u-1)),{strokeDasharray:[c,p].join(" "),strokeDashoffset:f.toString()}}function G6({bounds:t,className:e}){const n=G(),r=J("zoom level",()=>n.getZoomLevel(),[n]);return d.jsx("g",{className:e,pointerEvents:"none",strokeLinecap:"round",strokeLinejoin:"round",children:t.sides.map((s,i)=>{const{strokeDasharray:o,strokeDashoffset:a}=JX(s[0].dist(s[1]),1/r,{style:"dashed",lengthRatio:4});return d.jsx("line",{x1:s[0].x,y1:s[0].y,x2:s[1].x,y2:s[1].y,strokeDasharray:o,strokeDashoffset:a},i)})})}class jp extends fs{constructor(){super(...arguments);g(this,"hideSelectionBoundsFg",()=>!0);g(this,"canBind",()=>!1);g(this,"onChildrenChange",n=>{const r=this.editor.getSortedChildIdsForParent(n.id);if(r.length===0){this.editor.getCurrentPageState().focusedGroupId===n.id&&this.editor.popFocusedGroupId(),this.editor.deleteShapes([n.id]);return}else if(r.length===1){this.editor.getCurrentPageState().focusedGroupId===n.id&&this.editor.popFocusedGroupId(),this.editor.reparentShapes(r,n.parentId),this.editor.deleteShapes([n.id]);return}})}getDefaultProps(){return{}}getGeometry(n){const r=this.editor.getSortedChildIdsForParent(n.id);return r.length===0?new xi({width:1,height:1,isFilled:!1}):new $s({children:r.map(s=>{const i=this.editor.getShape(s),o=this.editor.getShapeGeometry(s),a=this.editor.getShapeLocalTransform(i).applyToPoints(o.vertices);return o.isClosed?new Kt({points:a,isFilled:!0}):new eu({points:a})})})}component(n){const r=this.editor.getErasingShapeIds().includes(n.id),{hintingShapeIds:s}=this.editor.getCurrentPageState(),i=s.length>0&&s.some(l=>l!==n.id&&this.editor.isShapeOfType(this.editor.getShape(l),"group")),o=this.editor.getCurrentPageState().focusedGroupId!==n.id;if(!r&&(o||i))return null;const a=this.editor.getShapeGeometry(n).bounds;return d.jsx(oa,{id:n.id,children:d.jsx(G6,{className:"tl-group",bounds:a})})}indicator(n){const r=this.editor.getShapeGeometry(n).bounds;return d.jsx(G6,{className:"",bounds:r})}}g(jp,"type","group"),g(jp,"props",_I),g(jp,"migrations",AI);const LE=[jp],eZ=new Set(LE.map(t=>t.type));function NE(t){const e=[...LE],n=new Set;for(const r of t){if(eZ.has(r.type))throw new Error(`Shape type "${r.type}" is a core shapes type and cannot be overridden`);if(n.has(r.type))throw new Error(`Shape type "${r.type}" is defined more than once`);e.push(r),n.add(r.type)}return e}const tZ={maxShapesPerPage:4e3,maxPages:40,animationMediumMs:320,followChaseViewportSnap:2,doubleClickDurationMs:450,multiClickDurationMs:200,coarseDragDistanceSquared:36,dragDistanceSquared:16,defaultSvgPadding:32,cameraSlideFriction:.09,maxPointsPerDrawShape:500,gridSteps:[{min:-1,mid:.15,step:64},{min:.05,mid:.375,step:16},{min:.15,mid:1,step:4},{min:.7,mid:2.5,step:1}],collaboratorInactiveTimeoutMs:6e4,collaboratorIdleTimeoutMs:3e3,collaboratorCheckIntervalMs:1200,cameraMovingTimeoutMs:64,hitTestMargin:8,edgeScrollDelay:200,edgeScrollEaseDuration:200,edgeScrollSpeed:25,edgeScrollDistance:8,coarsePointerWidth:12,coarseHandleRadius:20,handleRadius:12,longPressDurationMs:500,textShadowLod:.35,adjacentShapeMargin:10,flattenImageBoundsExpand:64,flattenImageBoundsPadding:16};function V6(t,e){if(!e)return!1;switch(t.type){case"mixed":return e.type==="mixed";case"shared":return e.type==="shared"&&t.value===e.value;default:throw Cn(t)}}class nZ{constructor(e){g(this,"map");this.map=new Map(e)}get(e){return this.map.get(e)}getAsKnownValue(e){const n=this.get(e);if(n&&n.type!=="mixed")return n.value}get size(){return this.map.size}equals(e){if(this.size!==e.size)return!1;const n=new Set;for(const[r,s]of this){if(!V6(s,e.get(r)))return!1;n.add(r)}for(const[r,s]of e)if(!n.has(r)&&!V6(s,this.get(r)))return!1;return!0}keys(){return this.map.keys()}values(){return this.map.values()}entries(){return this.map.entries()}[Symbol.iterator](){return this.map[Symbol.iterator]()}}class q2 extends nZ{set(e,n){this.map.set(e,n)}applyValue(e,n){const r=this.get(e);if(!r){this.set(e,{type:"shared",value:n});return}switch(r.type){case"mixed":return;case"shared":r.value!==n&&this.set(e,{type:"mixed"});return;default:Cn(r,"type")}}}function rZ(t,e,n){return yi(t).then(function(r){return r.arrayBuffer()}).then(function(r){return new File([r],e,{type:n})})}const sZ="https://cdn.tldraw.com";function $o(){return`${sZ}/${KI}`}function iZ(t,e){var s;let n=t;const r=new Set(e);for(;r.has(n);)n=(s=/^.*(\d+)$/.exec(n))!=null&&s[1]?n.replace(/(\d+)(?=\D?)$/,i=>(+i+1).toString()):`${n} 1`;return n}function A0(t,e,n){if(n.length===0)return[];const r=new Map;for(const i of Le(n.map(o=>t.getShape(o)))){const{parentId:o}=i;r.has(o)||r.set(o,{children:Le(t.getSortedChildIdsForParent(o).map(a=>t.getShape(a))),moving:new Set}),r.get(o).moving.add(i)}const s=[];switch(e){case"toBack":{r.forEach(({moving:i,children:o})=>oZ(i,o,s));break}case"toFront":{r.forEach(({moving:i,children:o})=>aZ(i,o,s));break}case"forward":{r.forEach(({moving:i,children:o})=>lZ(i,o,s));break}case"backward":{r.forEach(({moving:i,children:o})=>cZ(i,o,s));break}}return s}function oZ(t,e,n){const r=e.length;if(t.size===r)return;let s,i;for(let o=0;o<r;o++){const a=e[o];if(t.has(a))s=a.index,t.delete(a);else{i=a.index;break}}if(t.size!==0){const o=jc(s,i,t.size);n.push(...Array.from(t.values()).sort(Un).map((a,l)=>({...a,index:o[l]})))}}function aZ(t,e,n){const r=e.length;if(t.size===r)return;let s,i;for(let o=r-1;o>-1;o--){const a=e[o];if(t.has(a))i=a.index,t.delete(a);else{s=a.index;break}}if(t.size!==0){const o=jc(s,i,t.size);n.push(...Array.from(t.values()).sort(Un).map((a,l)=>({...a,index:o[l]})))}}function lZ(t,e,n){var i;const r=e.length;if(t.size===r)return;let s={name:"skipping"};for(let o=0;o<r;o++){const a=t.has(e[o]);switch(s.name){case"skipping":{if(!a)continue;s={name:"selecting",selectIndex:o};break}case"selecting":{if(a)continue;const{selectIndex:l}=s;jc(e[o].index,(i=e[o+1])==null?void 0:i.index,o-l).forEach((c,u)=>n.push({...e[l+u],index:c})),s={name:"skipping"};break}}}}function cZ(t,e,n){var i;const r=e.length;if(t.size===r)return;let s={name:"skipping"};for(let o=r-1;o>-1;o--){const a=t.has(e[o]);switch(s.name){case"skipping":{if(!a)continue;s={name:"selecting",selectIndex:o};break}case"selecting":{if(a)continue;jc((i=e[o-1])==null?void 0:i.index,e[o].index,s.selectIndex-o).forEach((l,c)=>{n.push({...e[o+c+1],index:l})}),s={name:"skipping"};break}}}}function zE({editor:t}){const e=t.getSelectedShapes(),n=t.getSelectionRotation(),r=t.getSelectionRotatedPageBounds(),{inputs:{originPagePoint:s}}=t;if(!r)return null;const i=r.center.clone().rotWith(r.point,n);return{selectionPageCenter:i,initialCursorAngle:i.angle(s),initialSelectionRotation:n,shapeSnapshots:e.map(o=>({shape:yt(o),initialPagePoint:t.getShapePageTransform(o.id).point()}))}}function Rp({delta:t,editor:e,snapshot:n,stage:r}){const{selectionPageCenter:s,shapeSnapshots:i}=n;e.updateShapes(i.map(({shape:a,initialPagePoint:l})=>{const c=fr(a.parentId)?e.getShapePageTransform(a.parentId):xe.Identity(),u=b.RotWith(l,s,t),h=xe.applyToPoint(xe.Inverse(c),u),p=ta(a.rotation+t);return{id:a.id,type:a.type,x:h.x,y:h.y,rotation:p}}));const o=[];i.forEach(({shape:a})=>{var h,p,f;const l=e.getShape(a.id);if(!l)return;const c=e.getShapeUtil(a);if(r==="start"||r==="one-off"){const v=(h=c.onRotateStart)==null?void 0:h.call(c,a);v&&o.push(v)}const u=(p=c.onRotate)==null?void 0:p.call(c,a,l);if(u&&o.push(u),r==="end"||r==="one-off"){const v=(f=c.onRotateEnd)==null?void 0:f.call(c,a,l);v&&o.push(v)}}),o.length>0&&e.updateShapes(o)}const uZ=t=>{const{store:e}=t,n=e.query.filterHistory("binding"),r=e.query.records("binding");function s(){const i=r.get(),o=new Map;for(const a of i){const{fromId:l,toId:c}=a,u=o.get(l);u?u.push(a):o.set(l,[a]);const h=o.get(c);h?h.push(a):o.set(c,[a])}return o}return ee("arrowBindingsIndex",(i,o)=>{if(Xa(i))return s();const a=i,l=n.getDiffSince(o);if(l===Ur)return s();let c;function u(f){c??(c=new Map(a));const v=c.get(f.fromId),m=v==null?void 0:v.filter(S=>S.id!==f.id);m!=null&&m.length?c.set(f.fromId,m):c.delete(f.fromId);const x=c.get(f.toId),y=x==null?void 0:x.filter(S=>S.id!==f.id);y!=null&&y.length?c.set(f.toId,y):c.delete(f.toId)}function h(f){c??(c=new Map(a));let v=c.get(f);return v?v===a.get(f)&&(v=v.slice(0),c.set(f,v)):(v=[],c.set(f,v)),v}function p(f){h(f.fromId).push(f),h(f.toId).push(f)}for(const f of l){for(const v of Rt(f.added))p(v);for(const[v,m]of Rt(f.updated))u(v),p(m);for(const v of Rt(f.removed))u(v)}return c??a})};function dZ(t,e,n){const r=t.getShapeMaskedPageBounds(e);return r===void 0?!0:!n.includes(r)}const hZ=t=>{function e(n){const r=n.getCurrentPageShapeIds(),s=n.getViewportPageBounds(),i=new Set;return r.forEach(o=>{dZ(n,o,s)&&i.add(o)}),i}return ee("getCulledShapes",n=>{if(Xa(n))return e(t);const r=e(t);if(n.size!==r.size)return r;for(const s of n)if(!r.has(s))return r;return n})},pZ=t=>{const e=t.query.ids("shape"),n=t.query.filterHistory("shape");function r(){const s={},i=e.get(),o=Array(i.size);return i.forEach(a=>o.push(t.get(a))),o.sort(Un),o.forEach(a=>{s[a.parentId]||(s[a.parentId]=[]),s[a.parentId].push(a.id)}),s}return ee("parentsToChildrenWithIndexes",(s,i)=>{if(Xa(s))return r();const o=n.getDiffSince(i);if(o===Ur)return r();if(o.length===0)return s;let a=null;const l=h=>{a||(a={...s}),a[h]?a[h]===s[h]&&(a[h]=[...a[h]]):a[h]=[]},c=new Set;let u;for(let h=0,p=o.length;h<p;h++){u=o[h];for(const f of Object.values(u.added))ic(f)&&(l(f.parentId),a[f.parentId].push(f.id),c.add(a[f.parentId]));for(const[f,v]of Object.values(u.updated))if(ic(v)&&ic(f)){if(f.parentId!==v.parentId)l(f.parentId),l(v.parentId),a[f.parentId].splice(a[f.parentId].indexOf(v.id),1),a[v.parentId].push(v.id),c.add(a[v.parentId]);else if(f.index!==v.index){l(v.parentId);const m=a[v.parentId].indexOf(v.id);a[v.parentId][m]=v.id,c.add(a[v.parentId])}}for(const f of Object.values(u.removed))ic(f)&&(l(f.parentId),a[f.parentId].splice(a[f.parentId].indexOf(f.id),1))}for(const h of c){const p=Le(h.map(f=>t.get(f)));p.sort(Un),h.splice(0,h.length,...p.map(f=>f.id))}return a??s})},dy=(t,e,n)=>{for(;!dr(n.parentId);){const r=t.get(n.parentId);if(!r)return!1;n=r}return n.parentId===e},fZ=(t,e)=>{const n=t.query.ids("shape");let r=null;function s(){const i=e();return r=i,new Set([...n.get()].filter(o=>dy(t,i,t.get(o))))}return ee("_shapeIdsInCurrentPage",(i,o)=>{if(Xa(i))return s();const a=e();if(a!==r)return s();const l=t.history.getDiffSince(o);if(l===Ur)return s();const c=new Mp(i);for(const h of l){for(const p of Object.values(h.added))ic(p)&&dy(t,a,p)&&c.add(p.id);for(const[p,f]of Object.values(h.updated))ic(f)&&(dy(t,a,f)?c.add(f.id):c.remove(f.id));for(const p of Object.keys(h.removed))fr(p)&&c.remove(p)}const u=c.get();return u?Uu(u.value,u.diff):i})},FE=C.createContext(null);function gZ({context:t,editor:e,children:n}){return d.jsx(lm.Provider,{value:e,children:d.jsx(FE.Provider,{value:t,children:n})})}function $E(){const t=C.useContext(FE);return t?{isDarkMode:t.isDarkMode}:null}async function mZ(t,e,n={}){var E,M;const r=typeof e[0]=="string"?e:e.map(I=>I.id);if(r.length===0)return;if(!window.document)throw Error("No document");const{scale:s=1,background:i=!1,padding:o=t.options.defaultSvgPadding,preserveAspectRatio:a=!1}=n,l=n.darkMode??t.user.getIsDarkMode(),c=go({isDarkMode:l}),u=t.getShapeAndDescendantIds(r),h=t.getUnorderedRenderingShapes(!1).filter(({id:I})=>u.has(I));let p=null;if(n.bounds)p=n.bounds;else for(const{id:I}of h){const _=t.getShapeMaskedPageBounds(I);_&&(p?p.union(_):p=_.clone())}if(!p)return;const f=r.length===1&&t.isShapeOfType(t.getShape(r[0]),"frame")?r[0]:null;f||p.expandBy(o);const v=p.width*s,m=p.height*s;try{(M=(E=document.body).focus)==null||M.call(E)}catch{}const x=[],y=new Map,S={isDarkMode:l,addExportDef:I=>{if(y.has(I.key))return;const _=(async()=>{const D=await I.getElement();D&&x.push(d.jsx(C.Fragment,{children:D},x.length))})();y.set(I.key,_)}},w=(await Promise.all(h.map(async({id:I,opacity:_,index:D,backgroundIndex:R})=>{var V,Q;if(I===f)return[];const $=t.getShape(I);if(t.isShapeOfType($,"group"))return[];const U=t.getShapeUtil($);let O=await((V=U.toSvg)==null?void 0:V.call(U,$,S)),N=await((Q=U.toBackgroundSvg)==null?void 0:Q.call(U,$,S));if(!O&&!N){const ne=t.getShapePageBounds($);O=d.jsx("rect",{width:ne.w,height:ne.h,fill:c.solid,stroke:c.grey.pattern,strokeWidth:1})}let H=t.getShapePageTransform($).toCssString();"scale"in $.props&&$.props.scale!==1&&(H=`${H} scale(${$.props.scale}, ${$.props.scale})`),O&&(O=d.jsx("g",{transform:H,opacity:_,children:O},$.id)),N&&(N=d.jsx("g",{transform:H,opacity:_,children:N},`bg_${$.id}`));const Z=t.getShapeMask($.id);if(Z){const ne=`mask_${$.id.replace(":","_")}`;x.push(d.jsx("clipPath",{id:ne,children:d.jsx("path",{d:`M${Z.map(({x:le,y:de})=>`${le},${de}`).join("L")}Z`})},x.length)),O&&(O=d.jsx("g",{clipPath:`url(#${ne})`,children:O},$.id)),N&&(N=d.jsx("g",{clipPath:`url(#${ne})`,children:N},`bg_${$.id}`))}const q=[];return O&&q.push({zIndex:D,element:O}),N&&q.push({zIndex:R,element:N}),q}))).flat();return await Promise.all(y.values()),{jsx:d.jsx(gZ,{editor:t,context:S,children:d.jsxs("svg",{preserveAspectRatio:a||void 0,direction:"ltr",width:v,height:m,viewBox:`${p.minX} ${p.minY} ${p.width} ${p.height}`,strokeLinecap:"round",strokeLinejoin:"round",style:{backgroundColor:i?f?c.solid:c.background:"transparent"},children:[d.jsx("defs",{children:x}),w.sort((I,_)=>I.zIndex-_.zIndex).map(({element:I})=>I)]})}),width:v,height:m}}const yZ=40;class vZ{constructor(e){g(this,"_clickId","");g(this,"_clickTimeout");g(this,"_clickScreenPoint");g(this,"_previousScreenPoint");g(this,"_getClickTimeout",(e,n=dt())=>{this._clickId=n,clearTimeout(this._clickTimeout),this._clickTimeout=this.editor.timers.setTimeout(()=>{if(this._clickState===e&&this._clickId===n){switch(this._clickState){case"pendingTriple":{this.editor.dispatch({...this.lastPointerInfo,type:"click",name:"double_click",phase:"settle"});break}case"pendingQuadruple":{this.editor.dispatch({...this.lastPointerInfo,type:"click",name:"triple_click",phase:"settle"});break}case"pendingOverflow":{this.editor.dispatch({...this.lastPointerInfo,type:"click",name:"quadruple_click",phase:"settle"});break}}this._clickState="idle"}},e==="idle"||e==="pendingDouble"?this.editor.options.doubleClickDurationMs:this.editor.options.multiClickDurationMs)});g(this,"_clickState","idle");g(this,"lastPointerInfo",{});g(this,"handlePointerEvent",e=>{switch(e.name){case"pointer_down":{if(!this._clickState)return e;switch(this._clickScreenPoint=b.From(e.point),this._previousScreenPoint&&b.Dist2(this._previousScreenPoint,this._clickScreenPoint)>yZ**2&&(this._clickState="idle"),this._previousScreenPoint=this._clickScreenPoint,this.lastPointerInfo=e,this._clickState){case"pendingDouble":return this._clickState="pendingTriple",this._clickTimeout=this._getClickTimeout(this._clickState),{...e,type:"click",name:"double_click",phase:"down"};case"pendingTriple":return this._clickState="pendingQuadruple",this._clickTimeout=this._getClickTimeout(this._clickState),{...e,type:"click",name:"triple_click",phase:"down"};case"pendingQuadruple":return this._clickState="pendingOverflow",this._clickTimeout=this._getClickTimeout(this._clickState),{...e,type:"click",name:"quadruple_click",phase:"down"};case"idle":{this._clickState="pendingDouble";break}case"pendingOverflow":{this._clickState="overflow";break}}return this._clickTimeout=this._getClickTimeout(this._clickState),e}case"pointer_up":{if(!this._clickState)return e;switch(this._clickScreenPoint=b.From(e.point),this._clickState){case"pendingTriple":return{...this.lastPointerInfo,type:"click",name:"double_click",phase:"up"};case"pendingQuadruple":return{...this.lastPointerInfo,type:"click",name:"triple_click",phase:"up"};case"pendingOverflow":return{...this.lastPointerInfo,type:"click",name:"quadruple_click",phase:"up"}}return e}case"pointer_move":return this._clickState!=="idle"&&this._clickScreenPoint&&b.Dist2(this._clickScreenPoint,this.editor.inputs.currentScreenPoint)>(this.editor.getInstanceState().isCoarsePointer?this.editor.options.coarseDragDistanceSquared:this.editor.options.dragDistanceSquared)&&this.cancelDoubleClickTimeout(),e}return e});g(this,"cancelDoubleClickTimeout",()=>{this._clickTimeout=clearTimeout(this._clickTimeout),this._clickState="idle"});this.editor=e}get clickState(){return this._clickState}}class SZ{constructor(e){g(this,"_isEdgeScrolling",!1);g(this,"_edgeScrollDuration",-1);this.editor=e}updateEdgeScrolling(e){const{editor:n}=this,r=this.getEdgeScroll();if(r.x===0&&r.y===0)this._isEdgeScrolling&&(this._isEdgeScrolling=!1,this._edgeScrollDuration=0);else if(this._isEdgeScrolling||(this._isEdgeScrolling=!0,this._edgeScrollDuration=0),this._edgeScrollDuration+=e,this._edgeScrollDuration>n.options.edgeScrollDelay){const s=n.options.edgeScrollEaseDuration>0?dn.easeInCubic(Math.min(1,this._edgeScrollDuration/(n.options.edgeScrollDelay+n.options.edgeScrollEaseDuration))):1;this.moveCameraWhenCloseToEdge({x:r.x*s,y:r.y*s})}}getEdgeProximityFactors(e,n,r,s,i){const{editor:o}=this,a=o.options.edgeScrollDistance,l=r?o.options.coarsePointerWidth:0,c=e-l,u=e+l,h=s?0:a,p=i?n:n-a;return c<h?Math.min(1,(h-c)/a):u>p?-Math.min(1,(u-p)/a):0}getEdgeScroll(){const{editor:e}=this,{inputs:{currentScreenPoint:{x:n,y:r}}}=e,s=e.getViewportScreenBounds(),{isCoarsePointer:i,insets:[o,a,l,c]}=e.getInstanceState(),u=this.getEdgeProximityFactors(n,s.w,i,c,a),h=this.getEdgeProximityFactors(r,s.h,i,o,l);return{x:u,y:h}}moveCameraWhenCloseToEdge(e){const{editor:n}=this;if(!n.inputs.isDragging||n.inputs.isPanning||n.getCameraOptions().isLocked||e.x===0&&e.y===0)return;const r=n.getViewportScreenBounds(),s=r.w<1e3?.612:1,i=r.h<1e3?.612:1,o=n.getZoomLevel(),a=n.user.getEdgeScrollSpeed()*n.options.edgeScrollSpeed,l=a*e.x*s/o,c=a*e.y*i/o,{x:u,y:h,z:p}=n.getCamera();n.setCamera(new b(u+l,h+c,p))}}class xZ{constructor(e){g(this,"isSafari");g(this,"isIos");g(this,"isChromeForIos");g(this,"isFirefox");g(this,"isAndroid");this.editor=e,typeof window<"u"&&"navigator"in window?(this.isSafari=/^((?!chrome|android).)*safari/i.test(navigator.userAgent),this.isIos=!!navigator.userAgent.match(/iPad/i)||!!navigator.userAgent.match(/iPhone/i),this.isChromeForIos=/crios.*safari/i.test(navigator.userAgent),this.isFirefox=/firefox/i.test(navigator.userAgent),this.isAndroid=/android/i.test(navigator.userAgent)):(this.isSafari=!1,this.isIos=!1,this.isChromeForIos=!1,this.isFirefox=!1,this.isAndroid=!1)}}class wZ{constructor(e,n){g(this,"disposeSideEffectListener");this.editor=e,this.disposeSideEffectListener=e.sideEffects.registerAfterChangeHandler("instance",(s,i)=>{s.isFocused!==i.isFocused&&(i.isFocused?this.focus():this.blur(),this.updateContainerClass())});const r=e.getInstanceState().isFocused;n!==r&&e.updateInstanceState({isFocused:!!n}),this.updateContainerClass()}updateContainerClass(){const e=this.editor.getContainer();this.editor.getInstanceState().isFocused?e.classList.add("tl-container__focused"):e.classList.remove("tl-container__focused")}focus(){this.editor.getContainer().focus()}blur(){this.editor.complete(),this.editor.getContainer().blur()}dispose(){var e;(e=this.disposeSideEffectListener)==null||e.call(this)}}function Tu(t){return CZ}class bZ{constructor(){g(this,"length",0);g(this,"head",null);g(this,"tail",this)}push(e){return new z4(e,this)}toArray(){return qi}[Symbol.iterator](){return{next(){return{value:void 0,done:!0}}}}}const CZ=new bZ;class z4{constructor(e,n){g(this,"length");this.head=e,this.tail=n,this.length=n.length+1}push(e){return new z4(e,this)}toArray(){return Array.from(this)}[Symbol.iterator](){let e=this;return{next(){if(e.length){const n=e.head;return e=e.tail,{value:n,done:!1}}else return{value:void 0,done:!0}}}}}class PZ{constructor(e){g(this,"store");g(this,"dispose");g(this,"state","recording");g(this,"pendingDiff",new IZ);g(this,"stacks",Qt("HistoryManager.stacks",{undos:Tu(),redos:Tu()},{isEqual:(e,n)=>e.undos===n.undos&&e.redos===n.redos}));g(this,"annotateError");g(this,"_isInBatch",!1);g(this,"batch",(e,n)=>{const r=this.state;r!=="paused"&&(n!=null&&n.history)&&(this.state=kZ[n.history]);try{if(this._isInBatch)return zs(e),this;this._isInBatch=!0;try{zs(e)}catch(s){throw this.annotateError(s),s}finally{this._isInBatch=!1}return this}finally{this.state=r}});g(this,"_undo",({pushToRedoStack:e,toMark:n=void 0})=>{var s;const r=this.state;this.state="paused";try{let{undos:i,redos:o}=this.stacks.get();const a=this.pendingDiff.clear(),l=eI(a),c=qd(a);e&&!l&&(o=o.push({type:"diff",diff:a}));let u=!1;if(l)for(;((s=i.head)==null?void 0:s.type)==="stop";){const h=i.head;if(i=i.tail,e&&(o=o.push(h)),h.id===n){u=!0;break}}if(!u)e:for(;i.head;){const h=i.head;switch(i=i.tail,e&&(o=o.push(h)),h.type){case"diff":yd(c,[qd(h.diff)]);break;case"stop":if(!n||h.id===n)break e;break;default:Cn(h)}}this.store.applyDiff(c,{ignoreEphemeralKeys:!0}),this.store.ensureStoreIsUsable(),this.stacks.set({undos:i,redos:o})}finally{this.state=r}return this});g(this,"undo",()=>(this._undo({pushToRedoStack:!0}),this));g(this,"redo",()=>{var n;const e=this.state;this.state="paused";try{this.flushPendingDiff();let{undos:r,redos:s}=this.stacks.get();if(s.length===0)return this;for(;((n=s.head)==null?void 0:n.type)==="stop";)r=r.push(s.head),s=s.tail;const i=Gf();for(;s.head;){const o=s.head;if(r=r.push(o),s=s.tail,o.type==="diff")yd(i,[o.diff]);else break}this.store.applyDiff(i,{ignoreEphemeralKeys:!0}),this.store.ensureStoreIsUsable(),this.stacks.set({undos:r,redos:s})}finally{this.state=e}return this});g(this,"bail",()=>(this._undo({pushToRedoStack:!1}),this));g(this,"bailToMark",e=>(this._undo({pushToRedoStack:!1,toMark:e}),this));g(this,"squashToMark",e=>{var i;let n=this.stacks.get().undos;const r=[];for(;n.head&&!(n.head.type==="stop"&&n.head.id===e);)n.head.type==="diff"&&r.push(n.head.diff),n=n.tail;if(!n.head||((i=n.head)==null?void 0:i.id)!==e)return console.error("Could not find mark to squash to: ",e),this;if(r.length===0)return this;const s=Gf();return yd(s,r.reverse()),this.stacks.update(({redos:o})=>({undos:n.push({type:"diff",diff:s}),redos:o})),this});g(this,"mark",(e=dt())=>(zs(()=>{this.flushPendingDiff(),this.stacks.update(({undos:n,redos:r})=>({undos:n.push({type:"stop",id:e}),redos:r}))}),e));this.store=e.store,this.annotateError=e.annotateError??Kd,this.dispose=this.store.addHistoryInterceptor((n,r)=>{if(r==="user")switch(this.state){case"recording":this.pendingDiff.apply(n.changes),this.stacks.update(({undos:s})=>({undos:s,redos:Tu()}));break;case"recordingPreserveRedoStack":this.pendingDiff.apply(n.changes);break;case"paused":break;default:Cn(this.state)}})}flushPendingDiff(){if(this.pendingDiff.isEmpty())return;const e=this.pendingDiff.clear();this.stacks.update(({undos:n,redos:r})=>({undos:n.push({type:"diff",diff:e}),redos:r}))}getNumUndos(){return this.stacks.get().undos.length+(this.pendingDiff.isEmpty()?0:1)}getNumRedos(){return this.stacks.get().redos.length}clear(){this.stacks.set({undos:Tu(),redos:Tu()}),this.pendingDiff.clear()}debug(){const{undos:e,redos:n}=this.stacks.get();return{undos:e.toArray(),redos:n.toArray(),pendingDiff:this.pendingDiff.debug(),state:this.state}}}const kZ={record:"recording","record-preserveRedoStack":"recordingPreserveRedoStack",ignore:"paused"};class IZ{constructor(){g(this,"diff",Gf());g(this,"isEmptyAtom",Qt("PendingDiff.isEmpty",!0))}clear(){const e=this.diff;return this.diff=Gf(),this.isEmptyAtom.set(!0),e}isEmpty(){return this.isEmptyAtom.get()}apply(e){yd(this.diff,[e]),this.isEmptyAtom.set(eI(this.diff))}debug(){return{diff:this.diff,isEmpty:this.isEmpty()}}}class EZ{constructor(e){g(this,"scribbleItems",new Map);g(this,"state","paused");g(this,"addScribble",(e,n=dt())=>{const r={id:n,scribble:{id:n,size:20,color:"accent",opacity:.8,delay:0,points:[],shrink:.1,taper:!0,...e,state:"starting"},timeoutMs:0,delayRemaining:e.delay??0,prev:null,next:null};return this.scribbleItems.set(n,r),r});g(this,"stop",e=>{const n=this.scribbleItems.get(e);if(!n)throw Error(`Scribble with id ${e} not found`);return n.delayRemaining=Math.min(n.delayRemaining,200),n.scribble.state="stopping",n});g(this,"addPoint",(e,n,r)=>{const s=this.scribbleItems.get(e);if(!s)throw Error(`Scribble with id ${e} not found`);const{prev:i}=s,o={x:n,y:r,z:.5};return(!i||b.Dist(i,o)>=1)&&(s.next=o),s});g(this,"tick",e=>{this.scribbleItems.size!==0&&this.editor.run(()=>{this.scribbleItems.forEach(n=>{if(n.scribble.state==="starting"){const{next:l,prev:c}=n;l&&l!==c&&(n.prev=l,n.scribble.points.push(l)),n.scribble.points.length>8&&(n.scribble.state="active");return}n.delayRemaining>0&&(n.delayRemaining=Math.max(0,n.delayRemaining-e)),n.timeoutMs+=e,n.timeoutMs>=16&&(n.timeoutMs=0);const{delayRemaining:r,timeoutMs:s,prev:i,next:o,scribble:a}=n;switch(a.state){case"active":{o&&o!==i?(n.prev=o,a.points.push(o),r===0&&a.points.length>8&&a.points.shift()):s===0&&(a.points.length>1?a.points.shift():n.delayRemaining=a.delay);break}case"stopping":{if(n.delayRemaining===0&&s===0){if(a.points.length===1){this.scribbleItems.delete(n.id);return}a.shrink&&(a.size=Math.max(1,a.size*(1-a.shrink))),a.points.shift()}break}}}),this.editor.updateInstanceState({scribbles:Array.from(this.scribbleItems.values()).map(({scribble:n})=>({...n,points:[...n.points]})).slice(-5)})})});this.editor=e}reset(){this.editor.updateInstanceState({scribbles:[]}),this.scribbleItems.clear()}}var TZ=Object.defineProperty,MZ=Object.getOwnPropertyDescriptor,hm=(t,e,n,r)=>{for(var s=MZ(e,n),i=t.length-1,o;i>=0;i--)(o=t[i])&&(s=o(e,n,s)||s);return s&&TZ(e,n,s),s};const Ie=t=>Math.round(t*10**8)/10**8;function Li(t,e,n,r,s){const i=t.filter(a=>(r==="forward"?a.startNode.id===e:a.endNode.id===e)&&Ie(a.length)===Ie(n)&&Ms(a.breadthIntersection[0],a.breadthIntersection[1],s[0],s[1]));if(i.length===0)return[];const o=new Set;return i.forEach(a=>{const l=r==="forward"?a.endNode.id:a.startNode.id;if(!o.has(l)){o.add(l);const c=Li(t,l,n,r,Ms(a.breadthIntersection[0],a.breadthIntersection[1],s[0],s[1]));i.push(...c)}}),i}function _Z(t){t.sort((e,n)=>n.gaps.length-e.gaps.length);for(let e=t.length-1;e>0;e--){const n=t[e];for(let r=e-1;r>=0;r--){const s=t[r];if(s.direction===n.direction&&n.gaps.every(i=>s.gaps.some(o=>Ie(i.startEdge[0].x)===Ie(o.startEdge[0].x)&&Ie(i.startEdge[0].y)===Ie(o.startEdge[0].y)&&Ie(i.startEdge[1].x)===Ie(o.startEdge[1].x)&&Ie(i.startEdge[1].y)===Ie(o.startEdge[1].y))&&s.gaps.some(o=>Ie(i.endEdge[0].x)===Ie(o.endEdge[0].x)&&Ie(i.endEdge[0].y)===Ie(o.endEdge[0].y)&&Ie(i.endEdge[1].x)===Ie(o.endEdge[1].x)&&Ie(i.endEdge[1].y)===Ie(o.endEdge[1].y)))){t.splice(e,1);break}}}}class Ah{constructor(e){g(this,"editor");this.manager=e,this.editor=e.editor}getSnapPointsCache(){const{editor:e}=this;return e.store.createComputedCache("snapPoints",n=>{const r=e.getShapePageTransform(n.id);if(!r)return;const i=e.getShapeUtil(n).getBoundsSnapGeometry(n).points??e.getShapeGeometry(n).bounds.cornersAndCenter;if(!(!r||!i))return i.map((o,a)=>{const{x:l,y:c}=xe.applyToPoint(r,o);return{x:l,y:c,id:`${n.id}:${a}`}})})}getSnapPoints(e){return this.getSnapPointsCache().get(e)??[]}getSnappablePoints(){const e=this.getSnapPointsCache(),n=this.manager.getSnappableShapes(),r=[];for(const s of n){const i=e.get(s);i&&r.push(...i)}return r}getSnappableGapNodes(){return Array.from(this.manager.getSnappableShapes(),e=>({id:e,pageBounds:as(this.editor.getShapePageBounds(e))}))}getVisibleGaps(){const e=[],n=[];let r,s;const i=this.getSnappableGapNodes().sort((a,l)=>a.pageBounds.minX-l.pageBounds.minX);for(let a=0;a<i.length;a++){r=i[a];for(let l=a+1;l<i.length;l++)s=i[l],r.pageBounds.maxX<s.pageBounds.minX&&Eu(r.pageBounds.minY,r.pageBounds.maxY,s.pageBounds.minY,s.pageBounds.maxY)&&e.push({startNode:r,endNode:s,startEdge:[new b(r.pageBounds.maxX,r.pageBounds.minY),new b(r.pageBounds.maxX,r.pageBounds.maxY)],endEdge:[new b(s.pageBounds.minX,s.pageBounds.minY),new b(s.pageBounds.minX,s.pageBounds.maxY)],length:s.pageBounds.minX-r.pageBounds.maxX,breadthIntersection:Ms(r.pageBounds.minY,r.pageBounds.maxY,s.pageBounds.minY,s.pageBounds.maxY)})}const o=i.sort((a,l)=>a.pageBounds.minY-l.pageBounds.minY);for(let a=0;a<o.length;a++){r=o[a];for(let l=a+1;l<o.length;l++)s=o[l],r.pageBounds.maxY<s.pageBounds.minY&&Eu(r.pageBounds.minX,r.pageBounds.maxX,s.pageBounds.minX,s.pageBounds.maxX)&&n.push({startNode:r,endNode:s,startEdge:[new b(r.pageBounds.minX,r.pageBounds.maxY),new b(r.pageBounds.maxX,r.pageBounds.maxY)],endEdge:[new b(s.pageBounds.minX,s.pageBounds.minY),new b(s.pageBounds.maxX,s.pageBounds.minY)],length:s.pageBounds.minY-r.pageBounds.maxY,breadthIntersection:Ms(r.pageBounds.minX,r.pageBounds.maxX,s.pageBounds.minX,s.pageBounds.maxX)})}return{horizontal:e,vertical:n}}snapTranslateShapes({lockedAxis:e,initialSelectionPageBounds:n,initialSelectionSnapPoints:r,dragDelta:s}){var x,y;const i=this.manager.getSnapThreshold(),o=this.getSnappablePoints(),a=n.clone().translate(s),l=r.map(({x:S,y:w},P)=>({id:"selection:"+P,x:S+s.x,y:w+s.y})),c=o,u=[],h=[],p=new b(i,i);this.collectPointSnaps({minOffset:p,nearestSnapsX:u,nearestSnapsY:h,otherNodeSnapPoints:c,selectionSnapPoints:l}),this.collectGapSnaps({selectionPageBounds:a,nearestSnapsX:u,nearestSnapsY:h,minOffset:p});const f=new b(e==="x"?0:((x=u[0])==null?void 0:x.nudge)??0,e==="y"?0:((y=h[0])==null?void 0:y.nudge)??0);p.x=0,p.y=0,u.length=0,h.length=0,l.forEach(S=>{S.x+=f.x,S.y+=f.y}),a.translate(f),this.collectPointSnaps({minOffset:p,nearestSnapsX:u,nearestSnapsY:h,otherNodeSnapPoints:c,selectionSnapPoints:l}),this.collectGapSnaps({selectionPageBounds:a,nearestSnapsX:u,nearestSnapsY:h,minOffset:p});const v=this.getPointSnapLines({nearestSnapsX:u,nearestSnapsY:h}),m=this.getGapSnapLines({selectionPageBounds:a,nearestSnapsX:u,nearestSnapsY:h});return this.manager.setIndicators([...m,...v]),{nudge:f}}snapResizeShapes({initialSelectionPageBounds:e,dragDelta:n,handle:r,isAspectRatioLocked:s,isResizingFromCenter:i}){var I,_;const o=this.manager.getSnapThreshold(),{box:a,scaleX:l,scaleY:c}=fe.Resize(e,r,i?n.x*2:n.x,i?n.y*2:n.y,s);let u=r;l<0&&(u=LY(u)),c<0&&(u=OY(u)),i&&(a.center=e.center);const h=u==="top"||u==="bottom",p=u==="left"||u==="right",f=q6(u,a),v=this.getSnappablePoints(),m=[],x=[],y=new b(o,o);this.collectPointSnaps({minOffset:y,nearestSnapsX:m,nearestSnapsY:x,otherNodeSnapPoints:v,selectionSnapPoints:f});const S=new b(h?0:((I=m[0])==null?void 0:I.nudge)??0,p?0:((_=x[0])==null?void 0:_.nudge)??0);if(s&&NY(u)&&S.len()!==0){const D=m.length&&x.length?Math.abs(S.x)<Math.abs(S.y)?"x":"y":m.length?"x":"y",R=e.aspectRatio;D==="x"?(x.length=0,S.y=S.x/R,(u==="bottom_left"||u==="top_right")&&(S.y=-S.y)):(m.length=0,S.x=S.y*R,(u==="bottom_left"||u==="top_right")&&(S.x=-S.x))}const w=b.Add(n,S),{box:P}=fe.Resize(e,r,i?w.x*2:w.x,i?w.y*2:w.y,s);i&&(P.center=e.center);const E=q6("any",P);m.length=0,x.length=0,y.x=0,y.y=0,this.collectPointSnaps({minOffset:y,nearestSnapsX:m,nearestSnapsY:x,otherNodeSnapPoints:v,selectionSnapPoints:E});const M=this.getPointSnapLines({nearestSnapsX:m,nearestSnapsY:x});return this.manager.setIndicators([...M]),{nudge:S}}collectPointSnaps({selectionSnapPoints:e,otherNodeSnapPoints:n,minOffset:r,nearestSnapsX:s,nearestSnapsY:i}){for(const o of e)for(const a of n){const l=b.Sub(o,a),c=Math.abs(l.x),u=Math.abs(l.y);Ie(c)<=Ie(r.x)&&(Ie(c)<Ie(r.x)&&(s.length=0),s.push({type:"points",points:{thisPoint:o,otherPoint:a},nudge:a.x-o.x}),r.x=c),Ie(u)<=Ie(r.y)&&(Ie(u)<Ie(r.y)&&(i.length=0),i.push({type:"points",points:{thisPoint:o,otherPoint:a},nudge:a.y-o.y}),r.y=u)}}collectGapSnaps({selectionPageBounds:e,minOffset:n,nearestSnapsX:r,nearestSnapsY:s}){const{horizontal:i,vertical:o}=this.getVisibleGaps();for(const a of i){if(!Eu(a.breadthIntersection[0],a.breadthIntersection[1],e.minY,e.maxY))continue;const c=a.startEdge[0].x+a.length/2-e.center.x;if(a.length>e.width&&Ie(Math.abs(c))<=Ie(n.x)){Ie(Math.abs(c))<Ie(n.x)&&(r.length=0),n.x=Math.abs(c);const y={type:"gap_center",gap:a,nudge:c},S=r.find(({type:P})=>P==="gap_center"),w=S&&Ms(a.breadthIntersection[0],a.breadthIntersection[1],S.gap.breadthIntersection[0],S.gap.breadthIntersection[1]);S&&S.gap.length>a.length&&w?r[r.indexOf(S)]=y:(!S||!w)&&r.push(y)}const h=a.startNode.pageBounds.minX-a.length,p=e.maxX,f=h-p;Ie(Math.abs(f))<=Ie(n.x)&&(Ie(Math.abs(f))<Ie(n.x)&&(r.length=0),n.x=Math.abs(f),r.push({type:"gap_duplicate",gap:a,protrusionDirection:"left",nudge:f}));const v=a.endNode.pageBounds.maxX+a.length,m=e.minX,x=v-m;Ie(Math.abs(x))<=Ie(n.x)&&(Ie(Math.abs(x))<Ie(n.x)&&(r.length=0),n.x=Math.abs(x),r.push({type:"gap_duplicate",gap:a,protrusionDirection:"right",nudge:x}))}for(const a of o){if(!Eu(a.breadthIntersection[0],a.breadthIntersection[1],e.minX,e.maxX))continue;const c=a.startEdge[0].y+a.length/2-e.center.y;if(a.length>e.height&&Ie(Math.abs(c))<=Ie(n.y)){Ie(Math.abs(c))<Ie(n.y)&&(s.length=0),n.y=Math.abs(c);const y={type:"gap_center",gap:a,nudge:c},S=s.find(({type:P})=>P==="gap_center"),w=S&&Eu(S.gap.breadthIntersection[0],S.gap.breadthIntersection[1],a.breadthIntersection[0],a.breadthIntersection[1]);S&&S.gap.length>a.length&&w?s[s.indexOf(S)]=y:(!S||!w)&&s.push(y);continue}const h=a.startNode.pageBounds.minY-a.length,p=e.maxY,f=h-p;Ie(Math.abs(f))<=Ie(n.y)&&(Ie(Math.abs(f))<Ie(n.y)&&(s.length=0),n.y=Math.abs(f),s.push({type:"gap_duplicate",gap:a,protrusionDirection:"top",nudge:f}));const v=a.endNode.pageBounds.maxY+a.length,m=e.minY,x=v-m;Ie(Math.abs(x))<=Ie(n.y)&&(Ie(Math.abs(x))<Ie(n.y)&&(s.length=0),n.y=Math.abs(x),s.push({type:"gap_duplicate",gap:a,protrusionDirection:"bottom",nudge:x}))}}getPointSnapLines({nearestSnapsX:e,nearestSnapsY:n}){const r={},s={};if(e.length>0){for(const i of e)if(i.type==="points"){const o=Ie(i.points.otherPoint.x);r[o]||(r[o]=[]),r[o].push(i.points)}}if(n.length>0){for(const i of n)if(i.type==="points"){const o=Ie(i.points.otherPoint.y);s[o]||(s[o]=[]),s[o].push(i.points)}}return Object.values(r).concat(Object.values(s)).map(i=>({id:dt(),type:"points",points:c4(i.map(o=>b.From(o.otherPoint)).concat(i.map(o=>b.From(o.thisPoint))),(o,a)=>o.equals(a))}))}getGapSnapLines({selectionPageBounds:e,nearestSnapsX:n,nearestSnapsY:r}){const{vertical:s,horizontal:i}=this.getVisibleGaps(),o={top:e.sides[0],right:e.sides[1],bottom:[e.corners[3],e.corners[2]],left:[e.corners[0],e.corners[3]]},a=[];if(n.length>0)for(const l of n){if(l.type==="points")continue;const{gap:{breadthIntersection:c,startEdge:u,startNode:h,endNode:p,length:f,endEdge:v}}=l;switch(l.type){case"gap_center":{const m=(f-e.width)/2,x=Ms(c[0],c[1],e.minY,e.maxY);a.push({type:"gaps",direction:"horizontal",id:dt(),gaps:[...Li(i,h.id,m,"backward",x),{startEdge:u,endEdge:o.left},{startEdge:o.right,endEdge:v},...Li(i,p.id,m,"forward",x)]});break}case"gap_duplicate":{const m=Ms(c[0],c[1],e.minY,e.maxY);a.push({type:"gaps",direction:"horizontal",id:dt(),gaps:l.protrusionDirection==="left"?[{startEdge:o.right,endEdge:u.map(x=>x.clone().addXY(-h.pageBounds.width,0))},{startEdge:u,endEdge:v},...Li(i,p.id,f,"forward",m)]:[...Li(i,h.id,f,"backward",m),{startEdge:u,endEdge:v},{startEdge:v.map(x=>x.clone().addXY(l.gap.endNode.pageBounds.width,0)),endEdge:o.left}]});break}}}if(r.length>0)for(const l of r){if(l.type==="points")continue;const{gap:{breadthIntersection:c,startEdge:u,startNode:h,endNode:p,length:f,endEdge:v}}=l;switch(l.type){case"gap_center":{const m=(f-e.height)/2,x=Ms(c[0],c[1],e.minX,e.maxX);a.push({type:"gaps",direction:"vertical",id:dt(),gaps:[...Li(s,h.id,m,"backward",x),{startEdge:u,endEdge:o.top},{startEdge:o.bottom,endEdge:v},...Li(s,l.gap.endNode.id,m,"forward",x)]});break}case"gap_duplicate":{const m=Ms(c[0],c[1],e.minX,e.maxX);a.push({type:"gaps",direction:"vertical",id:dt(),gaps:l.protrusionDirection==="top"?[{startEdge:o.bottom,endEdge:u.map(x=>x.clone().addXY(0,-h.pageBounds.height))},{startEdge:u,endEdge:v},...Li(s,p.id,f,"forward",m)]:[...Li(s,h.id,f,"backward",m),{startEdge:u,endEdge:v},{startEdge:v.map(x=>x.clone().addXY(0,p.pageBounds.height)),endEdge:o.top}]})}break}}return _Z(a),a}}hm([ee],Ah.prototype,"getSnapPointsCache");hm([ee],Ah.prototype,"getSnappablePoints");hm([ee],Ah.prototype,"getSnappableGapNodes");hm([ee],Ah.prototype,"getVisibleGaps");function q6(t,e){const{minX:n,maxX:r,minY:s,maxY:i}=e,o=[];switch(t){case"top":case"left":case"top_left":case"any":o.push({id:"top_left",handle:"top_left",x:n,y:s})}switch(t){case"top":case"right":case"top_right":case"any":o.push({id:"top_right",handle:"top_right",x:r,y:s})}switch(t){case"bottom":case"right":case"bottom_right":case"any":o.push({id:"bottom_right",handle:"bottom_right",x:r,y:i})}switch(t){case"bottom":case"left":case"bottom_left":case"any":o.push({id:"bottom_left",handle:"bottom_left",x:n,y:i})}return o}var AZ=Object.defineProperty,DZ=Object.getOwnPropertyDescriptor,jZ=(t,e,n,r)=>{for(var s=DZ(e,n),i=t.length-1,o;i>=0;i--)(o=t[i])&&(s=o(e,n,s)||s);return s&&AZ(e,n,s),s};const RZ=()=>null,OZ=()=>[];class BE{constructor(e){g(this,"editor");this.manager=e,this.editor=e.editor}getSnapGeometryCache(){const{editor:e}=this;return e.store.createComputedCache("handle snap geometry",n=>{const r=e.getShapeUtil(n).getHandleSnapGeometry(n);return{outline:r.outline===void 0?e.getShapeGeometry(n):r.outline,points:r.points??[],getSelfSnapOutline:r.getSelfSnapOutline??RZ,getSelfSnapPoints:r.getSelfSnapPoints??OZ}})}*iterateSnapPointsInPageSpace(e,n){var s,i;const r=(s=this.getSnapGeometryCache().get(e))==null?void 0:s.getSelfSnapPoints(n);if(r&&r.length){const o=as(this.editor.getShapePageTransform(e));for(const a of r)yield o.applyToPoint(a)}for(const o of this.manager.getSnappableShapes()){if(o===e)continue;const a=(i=this.getSnapGeometryCache().get(o))==null?void 0:i.points;if(!a||!a.length)continue;const l=as(this.editor.getShapePageTransform(o));for(const c of a)yield l.applyToPoint(c)}}*iterateSnapOutlines(e,n){var s,i;const r=(s=this.getSnapGeometryCache().get(e))==null?void 0:s.getSelfSnapOutline(n);r&&(yield{shapeId:e,outline:r});for(const o of this.manager.getSnappableShapes()){if(o===e)continue;const a=(i=this.getSnapGeometryCache().get(o))==null?void 0:i.outline;a&&(yield{shapeId:o,outline:a})}}getHandleSnapPosition({currentShapeId:e,handle:n,handleInPageSpace:r}){const s=this.manager.getSnapThreshold();let i=s,o=null;for(const c of this.iterateSnapPointsInPageSpace(e,n))b.DistMin(r,c,i)&&(i=b.Dist(r,c),o=c);if(o)return o;let a=s,l=null;for(const{shapeId:c,outline:u}of this.iterateSnapOutlines(e,n)){const h=as(this.editor.getShapePageTransform(c)),p=this.editor.getPointInShapeSpace(c,r),f=u.nearestPoint(p),v=h.applyToPoint(f);b.DistMin(r,v,a)&&(a=b.Dist(r,v),l=v)}return l||null}snapHandle({currentShapeId:e,handle:n}){const s=as(this.editor.getShapePageTransform(e)).applyToPoint(n),i=this.getHandleSnapPosition({currentShapeId:e,handle:n,handleInPageSpace:s});return i?(this.manager.setIndicators([{id:dt(),type:"points",points:[i]}]),{nudge:b.Sub(i,s)}):null}}jZ([ee],BE.prototype,"getSnapGeometryCache");var LZ=Object.defineProperty,NZ=Object.getOwnPropertyDescriptor,F4=(t,e,n,r)=>{for(var s=NZ(e,n),i=t.length-1,o;i>=0;i--)(o=t[i])&&(s=o(e,n,s)||s);return s&&LZ(e,n,s),s};class pm{constructor(e){g(this,"shapeBounds");g(this,"handles");g(this,"_snapIndicators",Qt("snapLines",void 0));this.editor=e,this.shapeBounds=new Ah(this),this.handles=new BE(this)}getIndicators(){return this._snapIndicators.get()??qi}clearIndicators(){this.getIndicators().length&&this._snapIndicators.set(void 0)}setIndicators(e){this._snapIndicators.set(e)}getSnapThreshold(){return 8/this.editor.getZoomLevel()}getSnappableShapes(){const{editor:e}=this,n=e.getViewportPageBounds(),r=e.getSelectedShapeIds(),s=new Set,i=o=>{if(fr(o)){const l=e.getShape(o);l&&e.isShapeOfType(l,"frame")&&s.add(o)}const a=e.getSortedChildIdsForParent(o);for(const l of a){if(r.includes(l))continue;const c=e.getShape(l);if(!c||!e.getShapeUtil(c).canSnap(c))continue;const h=e.getShapePageBounds(l);if(h&&n.includes(h)){if(e.isShapeOfType(c,"group")){i(l);continue}s.add(l)}}};return i(this.getCurrentCommonAncestor()??e.getCurrentPageId()),s}getCurrentCommonAncestor(){return this.editor.findCommonAncestor(this.editor.getSelectedShapes())}}F4([ee],pm.prototype,"getSnapThreshold");F4([ee],pm.prototype,"getSnappableShapes");F4([ee],pm.prototype,"getCurrentCommonAncestor");const zZ=/\r?\n|\r/g;function Y6(t){return t.replace(zZ,`
`).split(`
`).map(e=>e||" ").join(`
`)}const FZ={start:"left","start-legacy":"left",middle:"center","middle-legacy":"center",end:"right","end-legacy":"right"},$Z=/\s/;class BZ{constructor(e){g(this,"baseElm");g(this,"measureText",(e,n)=>{var o;const r=(o=this.baseElm)==null?void 0:o.cloneNode();this.baseElm.insertAdjacentElement("afterend",r),r.setAttribute("dir","auto"),r.style.setProperty("unicode-bidi","plaintext"),r.style.setProperty("font-family",n.fontFamily),r.style.setProperty("font-style",n.fontStyle),r.style.setProperty("font-weight",n.fontWeight),r.style.setProperty("font-size",n.fontSize+"px"),r.style.setProperty("line-height",n.lineHeight*n.fontSize+"px"),r.style.setProperty("max-width",n.maxWidth===null?null:n.maxWidth+"px"),r.style.setProperty("min-width",n.minWidth===null?null:n.minWidth+"px"),r.style.setProperty("padding",n.padding),r.style.setProperty("overflow-wrap",n.disableOverflowWrapBreaking?"normal":"break-word"),r.textContent=Y6(e);const s=r.scrollWidth,i=r.getBoundingClientRect();return r.remove(),{x:0,y:0,w:i.width,h:i.height,scrollWidth:s}});this.editor=e;const n=this.editor.getContainer(),r=document.createElement("div");r.classList.add("tl-text"),r.classList.add("tl-text-measure"),r.tabIndex=-1,n.appendChild(r),this.baseElm=r,e.disposables.add(()=>{r.remove()})}measureElementTextNodeSpans(e,{shouldTruncateToFirstLine:n=!1}={}){const r=[],s=e.getBoundingClientRect(),i=-s.left,o=-s.top,a=new Range,l=e.childNodes[0];let c=0,u=null,h=null,p=0,f=0,v=!1;for(const m of e.childNodes)if(m.nodeType===Node.TEXT_NODE)for(const x of m.textContent??""){a.setStart(l,c),a.setEnd(l,c+x.length);const y=a.getClientRects(),S=y[y.length-1],w=S.top+o,P=S.left+i,E=S.right+i,M=P<f,I=$Z.test(x);if(I!==h||w!==p||!u){if(u){if(n&&w!==p){v=!0;break}r.push(u)}u={box:{x:P,y:w,w:S.width,h:S.height},text:x},f=P}else M&&(u.box.x=P),u.box.w=M?u.box.w+S.width:E-u.box.x,u.text+=x;x===`
`&&(f=0),h=I,p=w,c+=x.length}return u&&r.push(u),{spans:r,didTruncate:v}}measureTextSpans(e,n){var c;if(e==="")return[];const r=(c=this.baseElm)==null?void 0:c.cloneNode();this.baseElm.insertAdjacentElement("afterend",r);const s=Math.ceil(n.width-n.padding*2);r.setAttribute("dir","auto"),r.style.setProperty("unicode-bidi","plaintext"),r.style.setProperty("width",`${s}px`),r.style.setProperty("height","min-content"),r.style.setProperty("font-size",`${n.fontSize}px`),r.style.setProperty("font-family",n.fontFamily),r.style.setProperty("font-weight",n.fontWeight),r.style.setProperty("line-height",`${n.lineHeight*n.fontSize}px`),r.style.setProperty("text-align",FZ[n.textAlign]);const i=n.overflow==="truncate-ellipsis"||n.overflow==="truncate-clip";i&&(r.style.setProperty("overflow-wrap","anywhere"),r.style.setProperty("word-break","break-all"));const o=Y6(e);r.textContent=o;const{spans:a,didTruncate:l}=this.measureElementTextNodeSpans(r,{shouldTruncateToFirstLine:i});if(n.overflow==="truncate-ellipsis"&&l){r.textContent="…";const u=Math.ceil(this.measureElementTextNodeSpans(r).spans[0].box.w);r.style.setProperty("width",`${s-u}px`),r.textContent=o;const h=this.measureElementTextNodeSpans(r,{shouldTruncateToFirstLine:!0}).spans,p=h[h.length-1];return h.push({text:"…",box:{x:Math.min(p.box.x+p.box.w,n.width-n.padding-u),y:p.box.y,w:u,h:p.box.h}}),h}return r.remove(),a}}const X6=(typeof process<"u",Yk);class UZ{constructor(e){g(this,"cancelRaf");g(this,"isPaused",!0);g(this,"now",0);g(this,"start",()=>{var e;this.isPaused=!1,(e=this.cancelRaf)==null||e.call(this),this.cancelRaf=X6(this.tick),this.now=Date.now()});g(this,"tick",()=>{if(this.isPaused)return;const e=Date.now(),n=e-this.now;this.now=e,this.updatePointerVelocity(n),this.editor.emit("frame",n),this.editor.emit("tick",n),this.cancelRaf=X6(this.tick)});g(this,"dispose",()=>{var e;this.isPaused=!0,(e=this.cancelRaf)==null||e.call(this)});g(this,"prevPoint",new b);g(this,"updatePointerVelocity",e=>{const{prevPoint:n,editor:{inputs:{currentScreenPoint:r,pointerVelocity:s}}}=this;if(e===0)return;const i=b.Sub(r,n);this.prevPoint=r.clone();const o=i.len(),a=o?i.div(o):new b(0,0),l=s.clone().lrp(a.mul(o/e),.5);Math.abs(l.x)<.01&&(l.x=0),Math.abs(l.y)<.01&&(l.y=0),s.equals(l)||(this.editor.inputs.pointerVelocity=l)});this.editor=e,this.editor.disposables.add(this.dispose),this.start()}}var HZ=Object.defineProperty,WZ=Object.getOwnPropertyDescriptor,bs=(t,e,n,r)=>{for(var s=WZ(e,n),i=t.length-1,o;i>=0;i--)(o=t[i])&&(s=o(e,n,s)||s);return s&&HZ(e,n,s),s};class Qr{constructor(e,n){g(this,"systemColorScheme",Qt("systemColorScheme","light"));g(this,"updateUserPreferences",e=>{this.user.setUserPreferences({...this.user.userPreferences.get(),...e})});if(this.user=e,this.inferDarkMode=n,typeof window>"u"||!("matchMedia"in window))return;const r=window.matchMedia("(prefers-color-scheme: dark)");r!=null&&r.matches&&this.systemColorScheme.set("dark"),r==null||r.addEventListener("change",s=>{s.matches?this.systemColorScheme.set("dark"):this.systemColorScheme.set("light")})}getUserPreferences(){return{id:this.getId(),name:this.getName(),locale:this.getLocale(),color:this.getColor(),animationSpeed:this.getAnimationSpeed(),isSnapMode:this.getIsSnapMode(),colorScheme:this.user.userPreferences.get().colorScheme,isDarkMode:this.getIsDarkMode(),isWrapMode:this.getIsWrapMode(),isDynamicResizeMode:this.getIsDynamicResizeMode()}}getIsDarkMode(){switch(this.user.userPreferences.get().colorScheme){case"dark":return!0;case"light":return!1;case"system":return this.systemColorScheme.get()==="dark";default:return this.inferDarkMode?this.systemColorScheme.get()==="dark":!1}}getEdgeScrollSpeed(){return this.user.userPreferences.get().edgeScrollSpeed??Is.edgeScrollSpeed}getAnimationSpeed(){return this.user.userPreferences.get().animationSpeed??Is.animationSpeed}getId(){return this.user.userPreferences.get().id}getName(){return this.user.userPreferences.get().name??Is.name}getLocale(){return this.user.userPreferences.get().locale??Is.locale}getColor(){return this.user.userPreferences.get().color??Is.color}getIsSnapMode(){return this.user.userPreferences.get().isSnapMode??Is.isSnapMode}getIsWrapMode(){return this.user.userPreferences.get().isWrapMode??Is.isWrapMode}getIsDynamicResizeMode(){return this.user.userPreferences.get().isDynamicSizeMode??Is.isDynamicSizeMode}getIsPasteAtCursorMode(){return this.user.userPreferences.get().isPasteAtCursorMode??Is.isPasteAtCursorMode}}bs([ee],Qr.prototype,"getUserPreferences");bs([ee],Qr.prototype,"getIsDarkMode");bs([ee],Qr.prototype,"getEdgeScrollSpeed");bs([ee],Qr.prototype,"getAnimationSpeed");bs([ee],Qr.prototype,"getId");bs([ee],Qr.prototype,"getName");bs([ee],Qr.prototype,"getLocale");bs([ee],Qr.prototype,"getColor");bs([ee],Qr.prototype,"getIsSnapMode");bs([ee],Qr.prototype,"getIsWrapMode");bs([ee],Qr.prototype,"getIsDynamicResizeMode");bs([ee],Qr.prototype,"getIsPasteAtCursorMode");const KZ={wheel:"onWheel",pointer_down:"onPointerDown",pointer_move:"onPointerMove",long_press:"onLongPress",pointer_up:"onPointerUp",right_click:"onRightClick",middle_click:"onMiddleClick",key_down:"onKeyDown",key_up:"onKeyUp",key_repeat:"onKeyRepeat",cancel:"onCancel",complete:"onComplete",interrupt:"onInterrupt",double_click:"onDoubleClick",triple_click:"onTripleClick",quadruple_click:"onQuadrupleClick",tick:"onTick"},GZ=["brushing","cropping","dragging","dragging_handle","drawing","erasing","lasering","resizing","rotating","scribble_brushing","translating"];class Se{constructor(e,n){g(this,"performanceTracker");g(this,"id");g(this,"type");g(this,"shapeType");g(this,"initial");g(this,"children");g(this,"isLockable");g(this,"parent");g(this,"_path");g(this,"_current");g(this,"_isActive");g(this,"transition",(e,n={})=>{var i;const r=e.split(".");let s=this;for(let o=0;o<r.length;o++){const a=r[o],l=s.getCurrent(),c=(i=s.children)==null?void 0:i[a];if(!c)throw Error(`${s.id} - no child state exists with the id ${a}.`);if((l==null?void 0:l.id)!==c.id&&(l==null||l.exit(n,a),s._current.set(c),c.enter(n,(l==null?void 0:l.id)||"initial"),!c.getIsActive()))break;s=c}return this});g(this,"handleEvent",e=>{var s;const n=KZ[e.name],r=this._current.__unsafe__getWithoutCapture();(s=this[n])==null||s.call(this,e),this._isActive.__unsafe__getWithoutCapture()&&r&&r===this._current.__unsafe__getWithoutCapture()&&r.handleEvent(e)});g(this,"enter",(e,n)=>{var r;if(Vt.measurePerformance.get()&&GZ.includes(this.id)&&this.performanceTracker.start(this.id),this._isActive.set(!0),(r=this.onEnter)==null||r.call(this,e,n),this.children&&this.initial&&this.getIsActive()){const s=this.children[this.initial];this._current.set(s),s.enter(e,n)}});g(this,"exit",(e,n)=>{var r,s;Vt.measurePerformance.get()&&this.performanceTracker.isStarted()&&this.performanceTracker.stop(),this._isActive.set(!1),(r=this.onExit)==null||r.call(this,e,n),this.getIsActive()||(s=this.getCurrent())==null||s.exit(e,n)});g(this,"_currentToolIdMask",Qt("curent tool id mask",void 0));g(this,"onWheel");g(this,"onPointerDown");g(this,"onPointerMove");g(this,"onLongPress");g(this,"onPointerUp");g(this,"onDoubleClick");g(this,"onTripleClick");g(this,"onQuadrupleClick");g(this,"onRightClick");g(this,"onMiddleClick");g(this,"onKeyDown");g(this,"onKeyUp");g(this,"onKeyRepeat");g(this,"onCancel");g(this,"onComplete");g(this,"onInterrupt");g(this,"onTick");g(this,"onEnter");g(this,"onExit");this.editor=e;const{id:r,children:s,initial:i,isLockable:o}=this.constructor;this.id=r,this._isActive=Qt("toolIsActive"+this.id,!1),this._current=Qt("toolState"+this.id,void 0),this._path=ee("toolPath"+this.id,()=>{const a=this.getCurrent();return this.id+(a?`.${a.getPath()}`:"")}),this.parent=n??{},this.parent?s&&i?(this.type="branch",this.initial=i,this.children=Object.fromEntries(s().map(a=>[a.id,new a(this.editor,this)])),this._current.set(this.children[this.initial])):this.type="leaf":(this.type="root",s&&i&&(this.initial=i,this.children=Object.fromEntries(s().map(a=>[a.id,new a(this.editor,this)])),this._current.set(this.children[this.initial]))),this.isLockable=o,this.performanceTracker=new jk}getPath(){return this._path.get()}getCurrent(){return this._current.get()}getIsActive(){return this._isActive.get()}getCurrentToolIdMask(){return this._currentToolIdMask.get()}setCurrentToolIdMask(e){this._currentToolIdMask.set(e)}}g(Se,"id"),g(Se,"initial"),g(Se,"children"),g(Se,"isLockable",!0);class Op extends Se{constructor(){super(...arguments);g(this,"onKeyDown",n=>{var r;switch(n.code){case"KeyZ":{if(!(n.shiftKey||n.ctrlKey)){const s=this.getCurrent();s&&((r=s.getCurrent())==null?void 0:r.id)==="idle"&&this.children.zoom&&this.editor.setCurrentTool("zoom",{...n,onInteractionEnd:s.id})}break}}})}}g(Op,"id","root"),g(Op,"initial",""),g(Op,"children",()=>[]);var VZ=Object.defineProperty,qZ=Object.getOwnPropertyDescriptor,ye=(t,e,n,r)=>{for(var s=qZ(e,n),i=t.length-1,o;i>=0;i--)(o=t[i])&&(s=o(e,n,s)||s);return s&&VZ(e,n,s),s};class he extends UX{constructor({store:n,user:r,shapeUtils:s,bindingUtils:i,tools:o,getContainer:a,cameraOptions:l,initialState:c,autoFocus:u,inferDarkMode:h,options:p}){super();g(this,"options");g(this,"store");g(this,"root");g(this,"disposables",new Set);g(this,"isDisposed",!1);g(this,"_tickManager");g(this,"snaps");g(this,"timers");g(this,"user");g(this,"textMeasure");g(this,"environment");g(this,"scribbles");g(this,"sideEffects");g(this,"edgeScrollManager");g(this,"focusManager");g(this,"getContainer");g(this,"shapeUtils");g(this,"styleProps");g(this,"bindingUtils");g(this,"history");g(this,"_shouldIgnoreShapeLock",!1);g(this,"_crashingError",null);g(this,"_updateInstanceState",(n,r)=>{this.run(()=>{this.store.put([{...this.getInstanceState(),...n}])},r)});g(this,"_isChangingStyleTimeout",-1);g(this,"setCursor",n=>(this.updateInstanceState({cursor:{...this.getInstanceState().cursor,...n}}),this));g(this,"_updateCurrentPageState",n=>{this.store.update(n.id??this.getCurrentPageState().id,r=>({...r,...n}))});g(this,"_cameraOptions",Qt("camera options",P6));g(this,"_viewportAnimation",null);g(this,"_willSetInitialBounds",!0);g(this,"_isLockedOnFollowingUser",Qt("isLockedOnFollowingUser",!1));g(this,"_cameraState",Qt("camera state","idle"));g(this,"_cameraStateTimeoutRemaining",0);g(this,"_decayCameraStateTimeout",n=>{this._cameraStateTimeoutRemaining-=n,!(this._cameraStateTimeoutRemaining>0)&&(this.off("tick",this._decayCameraStateTimeout),this._cameraState.set("idle"))});g(this,"_tickCameraState",()=>{this._cameraStateTimeoutRemaining=this.options.cameraMovingTimeoutMs,this._cameraState.__unsafe__getWithoutCapture()==="idle"&&(this._cameraState.set("moving"),this.on("tick",this._decayCameraStateTimeout))});g(this,"_currentPageShapeIds");g(this,"_parentIdsToChildIds");g(this,"animatingShapes",new Map);g(this,"_updateShapes",n=>{this.getInstanceState().isReadonly||this.run(()=>{var o,a;const r=[];let s,i;for(let l=0,c=n.length;l<c;l++){const u=n[l];u&&(s=this.getShape(u.id),s&&(i=Qs(s,u),i!==s&&(i=((a=(o=this.getShapeUtil(s)).onBeforeUpdate)==null?void 0:a.call(o,s,i))??i,r.push(i))))}this.store.put(r)})});g(this,"externalAssetContentHandlers",{file:null,url:null});g(this,"externalContentHandlers",{text:null,files:null,embed:null,"svg-text":null,url:null});g(this,"inputs",{originPagePoint:new b,originScreenPoint:new b,previousPagePoint:new b,previousScreenPoint:new b,currentPagePoint:new b,currentScreenPoint:new b,keys:new Set,buttons:new Set,isPen:!1,shiftKey:!1,ctrlKey:!1,altKey:!1,isDragging:!1,isPointing:!1,isPinching:!1,isEditing:!1,isPanning:!1,pointerVelocity:new b});g(this,"_clickManager",new vZ(this));g(this,"_prevCursor","default");g(this,"_shiftKeyTimeout",-1);g(this,"_setShiftKeyTimeout",()=>{this.inputs.shiftKey=!1,this.dispatch({type:"keyboard",name:"key_up",key:"Shift",shiftKey:this.inputs.shiftKey,ctrlKey:this.inputs.ctrlKey,altKey:this.inputs.altKey,code:"ShiftLeft"})});g(this,"_altKeyTimeout",-1);g(this,"_setAltKeyTimeout",()=>{this.inputs.altKey=!1,this.dispatch({type:"keyboard",name:"key_up",key:"Alt",shiftKey:this.inputs.shiftKey,ctrlKey:this.inputs.ctrlKey,altKey:this.inputs.altKey,code:"AltLeft"})});g(this,"_ctrlKeyTimeout",-1);g(this,"_setCtrlKeyTimeout",()=>{this.inputs.ctrlKey=!1,this.dispatch({type:"keyboard",name:"key_up",key:"Ctrl",shiftKey:this.inputs.shiftKey,ctrlKey:this.inputs.ctrlKey,altKey:this.inputs.altKey,code:"ControlLeft"})});g(this,"_restoreToolId","select");g(this,"_pinchStart",1);g(this,"_didPinch",!1);g(this,"_selectedShapeIdsAtPointerDown",[]);g(this,"_longPressTimeout",-1);g(this,"capturedPointerId",null);g(this,"performanceTracker");g(this,"performanceTrackerTimeout",-1);g(this,"dispatch",n=>(this._pendingEventsForNextTick.push(n),n.type==="pointer"&&n.name==="pointer_move"||n.type==="wheel"||n.type==="pinch"||this._flushEventsForTick(0),this));g(this,"_pendingEventsForNextTick",[]);g(this,"_flushEventForTick",n=>{if(this.getCrashingError())return this;const{inputs:r}=this,{type:s}=n;if(n.type==="misc"){(n.name==="cancel"||n.name==="complete")&&(this.inputs.isDragging=!1,this.inputs.isPanning&&(this.inputs.isPanning=!1,this.setCursor({type:this._prevCursor,rotation:0}))),this.root.handleEvent(n);return}n.shiftKey?(clearTimeout(this._shiftKeyTimeout),this._shiftKeyTimeout=-1,r.shiftKey=!0):!n.shiftKey&&r.shiftKey&&this._shiftKeyTimeout===-1&&(this._shiftKeyTimeout=this.timers.setTimeout(this._setShiftKeyTimeout,150)),n.altKey?(clearTimeout(this._altKeyTimeout),this._altKeyTimeout=-1,r.altKey=!0):!n.altKey&&r.altKey&&this._altKeyTimeout===-1&&(this._altKeyTimeout=this.timers.setTimeout(this._setAltKeyTimeout,150)),n.ctrlKey?(clearTimeout(this._ctrlKeyTimeout),this._ctrlKeyTimeout=-1,r.ctrlKey=!0):!n.ctrlKey&&r.ctrlKey&&this._ctrlKeyTimeout===-1&&(this._ctrlKeyTimeout=this.timers.setTimeout(this._setCtrlKeyTimeout,150));const{originPagePoint:i,currentPagePoint:o}=r;r.isPointing||(r.isDragging=!1);const a=this.store.unsafeGetWithoutCapture(Fn),l=this.store.get(this._getCurrentPageStateId()),c=this._cameraOptions.__unsafe__getWithoutCapture();switch(s){case"pinch":{if(c.isLocked)return;switch(clearTimeout(this._longPressTimeout),this._updateInputsFromEvent(n),n.name){case"pinch_start":{if(r.isPinching)return;r.isEditing||(this._pinchStart=this.getCamera().z,this._selectedShapeIdsAtPointerDown.length||(this._selectedShapeIdsAtPointerDown=[...l.selectedShapeIds]),this._didPinch=!0,r.isPinching=!0,this.interrupt());return}case"pinch":{if(!r.isPinching)return;const{point:{z:u=1},delta:{x:h,y:p}}=n,{x:f,y:v}=b.SubXY(n.point,a.screenBounds.x,a.screenBounds.y);this.stopCameraAnimation(),a.followingUserId&&this.stopFollowingUser();const{x:m,y:x,z:y}=w0(()=>this.getCamera()),{panSpeed:S,zoomSpeed:w}=c;this._setCamera(new b(m+h*S/y-f/y+f/(u*w),x+p*S/y-v/y+v/(u*w),u*w),{immediate:!0});return}case"pinch_end":{if(!r.isPinching)return this;r.isPinching=!1;const{_selectedShapeIdsAtPointerDown:u}=this;this.setSelectedShapes(this._selectedShapeIdsAtPointerDown),this._selectedShapeIdsAtPointerDown=[],this._didPinch&&(this._didPinch=!1,u.length>0&&this.once("tick",()=>{this._didPinch||this.setSelectedShapes(u)}));return}}}case"wheel":{if(c.isLocked)return;if(this._updateInputsFromEvent(n),!this.getIsMenuOpen()){const{panSpeed:u,zoomSpeed:h,wheelBehavior:p}=c;if(p!=="none"){this.stopCameraAnimation(),a.followingUserId&&this.stopFollowingUser();const{x:f,y:v,z:m}=w0(()=>this.getCamera()),{x,y,z:S=0}=n.delta;let w=p;switch(r.ctrlKey&&(w=p==="pan"?"zoom":"pan"),w){case"zoom":{const{x:P,y:E}=this.inputs.currentScreenPoint;let M=S;p==="zoom"&&(Math.abs(y)>10?M=10*Math.sign(y)/100:M=y/100);const I=m+(M??0)*h*m;this._setCamera(new b(f+(P/I-P)-(P/m-P),v+(E/I-E)-(E/m-E),I),{immediate:!0}),this.maybeTrackPerformance("Zooming");return}case"pan":{this._setCamera(new b(f+x*u/m,v+y*u/m,m),{immediate:!0}),this.maybeTrackPerformance("Panning");return}}}}break}case"pointer":{if(r.isPinching)return;this._updateInputsFromEvent(n);const{isPen:u}=n,{isPenMode:h}=a;switch(n.name){case"pointer_down":{if(h&&!u)return;if(this.clearOpenMenus(),this.inputs.isPanning||(this._longPressTimeout=this.timers.setTimeout(()=>{this.dispatch({...n,point:this.inputs.currentScreenPoint,name:"long_press"})},this.options.longPressDurationMs)),this._selectedShapeIdsAtPointerDown=this.getSelectedShapeIds(),n.button===I6&&(this.capturedPointerId=n.pointerId),r.buttons.add(n.button),r.isPointing=!0,r.isDragging=!1,!h&&u&&this.updateInstanceState({isPenMode:!0}),n.button===E6?(this._restoreToolId=this.getCurrentToolId(),this.complete(),this.setCurrentTool("eraser")):n.button===T0&&(this.inputs.isPanning||(this._prevCursor=this.getInstanceState().cursor.type),this.inputs.isPanning=!0,clearTimeout(this._longPressTimeout)),this.inputs.isPanning)return this.stopCameraAnimation(),this.setCursor({type:"grabbing",rotation:0}),this;break}case"pointer_move":{if(!u&&h)return;const{x:p,y:f,z:v}=w0(()=>this.getCamera());if(this.inputs.isPanning&&this.inputs.isPointing){const{currentScreenPoint:m,previousScreenPoint:x}=this.inputs,{panSpeed:y}=c,S=b.Sub(m,x);this.setCamera(new b(p+S.x*y/v,f+S.y*y/v,v),{immediate:!0}),this.maybeTrackPerformance("Panning");return}r.isPointing&&!r.isDragging&&b.Dist2(i,o)*this.getZoomLevel()>(a.isCoarsePointer?this.options.coarseDragDistanceSquared:this.options.dragDistanceSquared)/v&&(r.isDragging=!0,clearTimeout(this._longPressTimeout));break}case"pointer_up":{if(r.isDragging=!1,r.isPointing=!1,clearTimeout(this._longPressTimeout),r.buttons.delete(n.button),this.getIsMenuOpen()||a.isPenMode&&!u)return;if(this.capturedPointerId===n.pointerId&&(this.capturedPointerId=null,n.button=0),r.isPanning){r.keys.has("Space")||(r.isPanning=!1);const p=this.inputs.pointerVelocity,f=Math.min(2,p.len());switch(n.button){case I6:{this.setCursor({type:"grab",rotation:0});break}case T0:this.inputs.keys.has(" ")?this.setCursor({type:"grab",rotation:0}):this.setCursor({type:this._prevCursor,rotation:0})}f>0&&this.slideCamera({speed:f,direction:p})}else n.button===E6&&(this.complete(),this.setCurrentTool(this._restoreToolId));break}}break}case"keyboard":{switch(n.key==="ShiftRight"&&(n.key="ShiftLeft"),n.key==="AltRight"&&(n.key="AltLeft"),n.code==="ControlRight"&&(n.code="ControlLeft"),n.name){case"key_down":{r.keys.add(n.code),n.code==="Space"&&!n.ctrlKey&&(this.inputs.isPanning||(this._prevCursor=a.cursor.type),this.inputs.isPanning=!0,clearTimeout(this._longPressTimeout),this.setCursor({type:this.inputs.isPointing?"grabbing":"grab",rotation:0}));break}case"key_up":{r.keys.delete(n.code),n.code==="Space"&&(this.inputs.buttons.has(T0)||(this.inputs.isPanning=!1,this.setCursor({type:this._prevCursor,rotation:0})));break}}break}}if(n.type==="pointer"){n.button===T0?n.name="middle_click":n.button===T4&&(n.name="right_click");const{isPenMode:u}=this.store.unsafeGetWithoutCapture(Fn);if(n.isPen===u){const h=this._clickManager.handlePointerEvent(n);if(n.name!==h.name){this.root.handleEvent(n),this.emit("event",n),this.root.handleEvent(h),this.emit("event",h);return}}}return this.root.handleEvent(n),this.emit("event",n),this});this.options={...tZ,...p},this.store=n,this.disposables.add(this.store.dispose.bind(this.store)),this.history=new PZ({store:n,annotateError:D=>{this.annotateError(D,{origin:"history.batch",willCrashApp:!0}),this.crash(D)}}),this.snaps=new pm(this),this.timers=new jG,this.disposables.add(this.timers.dispose.bind(this.timers)),this._cameraOptions.set({...P6,...l}),this.user=new Qr(r??EE(),h??!1),this.getContainer=a??(()=>document.body),this.textMeasure=new BZ(this),this._tickManager=new UZ(this);class f extends Op{}g(f,"initial",c??""),this.root=new f(this),this.root.children={};const v=NE(s),m={},x={},y=new Map;for(const D of v){const R=new D(this);m[D.type]=R;const $=oI(D.props??{});x[D.type]=$;for(const U of $.keys())if(!y.has(U.id))y.set(U.id,U);else if(y.get(U.id)!==U)throw Error(`Multiple style props with id "${U.id}" in use. Style prop IDs must be unique.`)}this.shapeUtils=m,this.styleProps=x;const S=RE(i),w={};for(const D of S){const R=new D(this);w[D.type]=R}this.bindingUtils=w;for(const D of[...o]){if(fi(this.root.children,D.id))throw Error(`Can't override tool with id "${D.id}"`);this.root.children[D.id]=new D(this,this.root)}this.environment=new xZ(this),this.scribbles=new EZ(this);const P=(D,R)=>{let $=null;const U=D.selectedShapeIds.filter(H=>!R.has(H));U.length!==D.selectedShapeIds.length&&($||($={...D}),$.selectedShapeIds=U);const O=D.erasingShapeIds.filter(H=>!R.has(H));O.length!==D.erasingShapeIds.length&&($||($={...D}),$.erasingShapeIds=O),D.hoveredShapeId&&R.has(D.hoveredShapeId)&&($||($={...D}),$.hoveredShapeId=null),D.editingShapeId&&R.has(D.editingShapeId)&&($||($={...D}),$.editingShapeId=null);const N=D.hintingShapeIds.filter(H=>!R.has(H));return N.length!==D.hintingShapeIds.length&&($||($={...D}),$.hintingShapeIds=N),D.focusedGroupId&&R.has(D.focusedGroupId)&&($||($={...D}),$.focusedGroupId=null),$};this.sideEffects=this.store.sideEffects;let E=new Map;const M=new Set,I=new Set;let _=new Set;if(this.disposables.add(this.sideEffects.registerOperationCompleteHandler(()=>{var D,R,$,U;M.clear();for(const O of I){I.delete(O);const N=this.getShape(O);if(!N)continue;const H=this.getShapeUtil(N),Z=(D=H.onChildrenChange)==null?void 0:D.call(H,N);Z!=null&&Z.length&&this.updateShapes(Z)}if(_.size){const O=_;_=new Set;for(const N of O){const H=this.getBindingUtil(N);(R=H.onOperationComplete)==null||R.call(H)}}if(E.size){const O=E;E=new Map;for(const N of O.values())(U=($=this.getBindingUtil(N.binding)).onAfterDelete)==null||U.call($,N)}this.emit("update")})),this.disposables.add(this.sideEffects.register({shape:{afterChange:(D,R)=>{var $,U,O,N;for(const H of this.getBindingsInvolvingShape(R))_.add(H.type),H.fromId===R.id&&((U=($=this.getBindingUtil(H)).onAfterChangeFromShape)==null||U.call($,{binding:H,shapeBefore:D,shapeAfter:R})),H.toId===R.id&&((N=(O=this.getBindingUtil(H)).onAfterChangeToShape)==null||N.call(O,{binding:H,shapeBefore:D,shapeAfter:R}));if(D.parentId!==R.parentId){const H=Z=>{var V,Q,ne,le;const q=this.getShape(Z);if(q)for(const de of this.getBindingsInvolvingShape(q))_.add(de.type),de.fromId===q.id&&((Q=(V=this.getBindingUtil(de)).onAfterChangeFromShape)==null||Q.call(V,{binding:de,shapeBefore:q,shapeAfter:q})),de.toId===q.id&&((le=(ne=this.getBindingUtil(de)).onAfterChangeToShape)==null||le.call(ne,{binding:de,shapeBefore:q,shapeAfter:q}))};H(R.id),this.visitDescendants(R.id,H)}if(D.parentId!==R.parentId&&dr(R.parentId)){const H=new Set([D.id]);this.visitDescendants(D.id,Z=>{H.add(Z)});for(const Z of this.getPageStates()){if(Z.pageId===R.parentId)continue;const q=P(Z,H);q&&this.store.put([q])}}D.parentId&&fr(D.parentId)&&I.add(D.parentId),R.parentId!==D.parentId&&fr(R.parentId)&&I.add(R.parentId)},beforeDelete:D=>{var O,N,H,Z;if(M.has(D.id))return;D.parentId&&fr(D.parentId)&&I.add(D.parentId),M.add(D.id);const R=[];for(const q of this.getBindingsInvolvingShape(D)){_.add(q.type),R.push(q.id);const V=this.getBindingUtil(q);q.fromId===D.id?((O=V.onBeforeIsolateToShape)==null||O.call(V,{binding:q,removedShape:D}),(N=V.onBeforeDeleteFromShape)==null||N.call(V,{binding:q,shape:D})):((H=V.onBeforeIsolateFromShape)==null||H.call(V,{binding:q,removedShape:D}),(Z=V.onBeforeDeleteToShape)==null||Z.call(V,{binding:q,shape:D}))}R.length&&this.deleteBindings(R);const $=new Set([D.id]),U=Le(this.getPageStates().map(q=>P(q,$)));U.length&&this.store.put(U)}},binding:{beforeCreate:D=>{var $,U;const R=(U=($=this.getBindingUtil(D)).onBeforeCreate)==null?void 0:U.call($,{binding:D});return R||D},afterCreate:D=>{var R,$;_.add(D.type),($=(R=this.getBindingUtil(D)).onAfterCreate)==null||$.call(R,{binding:D})},beforeChange:(D,R)=>{var U,O;const $=(O=(U=this.getBindingUtil(R)).onBeforeChange)==null?void 0:O.call(U,{bindingBefore:D,bindingAfter:R});return $||R},afterChange:(D,R)=>{var $,U;_.add(R.type),(U=($=this.getBindingUtil(R)).onAfterChange)==null||U.call($,{bindingBefore:D,bindingAfter:R})},beforeDelete:D=>{var R,$;($=(R=this.getBindingUtil(D)).onBeforeDelete)==null||$.call(R,{binding:D})},afterDelete:D=>{var R,$;($=(R=this.getBindingUtil(D)).onAfterDelete)==null||$.call(R,{binding:D}),_.add(D.type)}},page:{afterCreate:D=>{const R=Rs.createId(D.id),$=us.createId(D.id);this.store.has(R)||this.store.put([Rs.create({id:R})]),this.store.has($)||this.store.put([us.create({id:$,pageId:D.id})])},afterDelete:(D,R)=>{var O,N;if(((O=this.getInstanceState())==null?void 0:O.currentPageId)===D.id){const H=(N=this.getPages().find(Z=>Z.id!==D.id))==null?void 0:N.id;H?this.store.put([{...this.getInstanceState(),currentPageId:H}]):R==="user"&&this.store.ensureStoreIsUsable()}const $=Rs.createId(D.id),U=us.createId(D.id);this.store.remove([$,U])}},instance:{afterChange:(D,R,$)=>{var U;if(!this.store.has(R.currentPageId)){const O=this.store.has(D.currentPageId)?D.currentPageId:(U=this.getPages()[0])==null?void 0:U.id;O?this.store.update(R.id,N=>({...N,currentPageId:O})):$==="user"&&this.store.ensureStoreIsUsable()}}},instance_page_state:{afterChange:(D,R)=>{if((D==null?void 0:D.selectedShapeIds)!==(R==null?void 0:R.selectedShapeIds)){const $=R.selectedShapeIds.filter(O=>{var H,Z;let N=(H=this.getShape(O))==null?void 0:H.parentId;for(;fr(N);){if(R.selectedShapeIds.includes(N))return!1;N=(Z=this.getShape(N))==null?void 0:Z.parentId}return!0});let U=null;if($.length>0){const O=this.findCommonAncestor(Le($.map(N=>this.getShape(N))),N=>this.isShapeOfType(N,"group"));O&&(U=O)}else R!=null&&R.focusedGroupId&&(U=R.focusedGroupId);($.length!==R.selectedShapeIds.length||U!==R.focusedGroupId)&&this.store.put([{...R,selectedShapeIds:$,focusedGroupId:U??null}])}}}})),this._currentPageShapeIds=fZ(this.store,()=>this.getCurrentPageId()),this._parentIdsToChildIds=pZ(this.store),this.disposables.add(this.store.listen(D=>{this.emit("change",D)})),this.disposables.add(this.history.dispose),this.run(()=>{this.store.ensureStoreIsUsable(),this._updateCurrentPageState({editingShapeId:null,hoveredShapeId:null,erasingShapeIds:[]})},{history:"ignore"}),c&&this.root.children[c]===void 0)throw Error(`No state found for initialState "${c}".`);this.root.enter(void 0,"initial"),this.edgeScrollManager=new SZ(this),this.focusManager=new wZ(this,u),this.disposables.add(this.focusManager.dispose.bind(this.focusManager)),this.getInstanceState().followingUserId&&this.stopFollowingUser(),this.on("tick",this._flushEventsForTick),this.timers.requestAnimationFrame(()=>{this._tickManager.start()}),this.performanceTracker=new jk}dispose(){this.disposables.forEach(n=>n()),this.disposables.clear(),this.isDisposed=!0}getShapeUtil(n){const r=typeof n=="string"?n:n.type,s=xr(this.shapeUtils,r);return We(s,`No shape util found for type "${r}"`),s}getBindingUtil(n){const r=typeof n=="string"?n:n.type,s=xr(this.bindingUtils,r);return We(s,`No binding util found for type "${r}"`),s}undo(){return this._flushEventsForTick(0),this.complete(),this.history.undo(),this}getCanUndo(){return this.history.getNumUndos()>0}redo(){return this._flushEventsForTick(0),this.complete(),this.history.redo(),this}clearHistory(){return this.history.clear(),this}getCanRedo(){return this.history.getNumRedos()>0}mark(n){return this.history.mark(n),this}squashToMark(n){return this.history.squashToMark(n),this}bail(){return this.history.bail(),this}bailToMark(n){return this.history.bailToMark(n),this}run(n,r){const s=this._shouldIgnoreShapeLock;this._shouldIgnoreShapeLock=(r==null?void 0:r.ignoreShapeLock)??s;try{this.history.batch(n,r)}finally{this._shouldIgnoreShapeLock=s}return this}batch(n,r){return this.run(n,r)}annotateError(n,{origin:r,willCrashApp:s,tags:i,extras:o}){const a=this.createErrorAnnotations(r,s);return u4(n,{tags:{...a.tags,...i},extras:{...a.extras,...o}}),s&&this.store.markAsPossiblyCorrupted(),this}createErrorAnnotations(n,r){try{const s=this.getEditingShapeId();return{tags:{origin:n,willCrashApp:r},extras:{activeStateNode:this.root.getPath(),selectedShapes:this.getSelectedShapes(),editingShape:s?this.getShape(s):void 0,inputs:this.inputs}}}catch{return{tags:{origin:n,willCrashApp:r},extras:{}}}}getCrashingError(){return this._crashingError}crash(n){return this._crashingError=n,this.store.markAsPossiblyCorrupted(),this.emit("crash",{error:n}),this}getPath(){return this.root.getPath().split("root.")[1]}isIn(n){const r=n.split(".").reverse();let s=this.root;for(;r.length>0;){const i=r.pop();if(!i)return!0;const o=s.getCurrent();if((o==null?void 0:o.id)===i){if(r.length===0)return!0;s=o;continue}else return!1}return!1}isInAny(...n){return n.some(r=>this.isIn(r))}setCurrentTool(n,r={}){return this.root.transition(n,r),this}getCurrentTool(){return this.root.getCurrent()}getCurrentToolId(){const n=this.getCurrentTool();return n?n.getCurrentToolIdMask()??n.id:""}getStateDescendant(n){var i;const r=n.split(".").reverse();let s=this.root;for(;r.length>0;){const o=r.pop();if(!o)return s;const a=(i=s.children)==null?void 0:i[o];if(!a)return;s=a}return s}getDocumentSettings(){return this.store.get($2)}updateDocumentSettings(n){return this.run(()=>{this.store.put([{...this.getDocumentSettings(),...n}])},{history:"ignore"}),this}getInstanceState(){return this.store.get(Fn)}updateInstanceState(n,r){return this._updateInstanceState(n,{history:"ignore",...r}),n.isChangingStyle!==void 0&&(clearTimeout(this._isChangingStyleTimeout),n.isChangingStyle===!0&&(this._isChangingStyleTimeout=this.timers.setTimeout(()=>{this._updateInstanceState({isChangingStyle:!1},{history:"ignore"})},2e3))),this}getOpenMenus(){return this.getInstanceState().openMenus}addOpenMenu(n){const r=new Set(this.getOpenMenus());return r.has(n)||(r.add(n),this.updateInstanceState({openMenus:[...r]})),this}deleteOpenMenu(n){const r=new Set(this.getOpenMenus());return r.has(n)&&(r.delete(n),this.updateInstanceState({openMenus:[...r]})),this}clearOpenMenus(){return this.getOpenMenus().length&&this.updateInstanceState({openMenus:[]}),this}getIsMenuOpen(){return this.getOpenMenus().length>0}getPageStates(){return this._getPageStatesQuery().get()}_getPageStatesQuery(){return this.store.query.records("instance_page_state")}getCurrentPageState(){return this.store.get(this._getCurrentPageStateId())}_getCurrentPageStateId(){return us.createId(this.getCurrentPageId())}updateCurrentPageState(n){return this._updateCurrentPageState(n),this}getSelectedShapeIds(){return this.getCurrentPageState().selectedShapeIds}getSelectedShapes(){const{selectedShapeIds:n}=this.getCurrentPageState();return Le(n.map(r=>this.store.get(r)))}setSelectedShapes(n){return this.run(()=>{const r=n.map(o=>typeof o=="string"?o:o.id),{selectedShapeIds:s}=this.getCurrentPageState(),i=new Set(s);if(r.length===i.size&&r.every(o=>i.has(o)))return null;this.store.put([{...this.getCurrentPageState(),selectedShapeIds:r}])},{history:"record-preserveRedoStack"})}isAncestorSelected(n){const r=typeof n=="string"?n:(n==null?void 0:n.id)??null,s=this.getShape(r);if(!s)return!1;const i=this.getSelectedShapeIds();return!!this.findShapeAncestor(s,o=>i.includes(o.id))}select(...n){const r=typeof n[0]=="string"?n:n.map(s=>s.id);return this.setSelectedShapes(r),this}deselect(...n){const r=typeof n[0]=="string"?n:n.map(i=>i.id),s=this.getSelectedShapeIds();return s.length>0&&r.length>0&&this.setSelectedShapes(s.filter(i=>!r.includes(i))),this}selectAll(){const n=this.getSortedChildIdsForParent(this.getCurrentPageId());return n.length<=0?this:(this.setSelectedShapes(this._getUnlockedShapeIds(n)),this)}selectNone(){return this.getSelectedShapeIds().length>0&&this.setSelectedShapes([]),this}getOnlySelectedShapeId(){var n;return((n=this.getOnlySelectedShape())==null?void 0:n.id)??null}getOnlySelectedShape(){const n=this.getSelectedShapes();return n.length===1?n[0]:null}getSelectionPageBounds(){const n=this.getCurrentPageState().selectedShapeIds;return n.length===0?null:fe.Common(Le(n.map(r=>this.getShapePageBounds(r))))}getSelectionRotation(){const n=this.getSelectedShapeIds();let r=!1,s=0;for(let i=0,o=n.length;i<o;i++){const a=this.getShapePageTransform(n[i]);if(a)if(r){if(a.rotation()!==s)return 0}else r=!0,s=a.rotation()}return s}getSelectionRotatedPageBounds(){const n=this.getSelectedShapeIds();if(n.length===0)return;const r=this.getSelectionRotation();if(r===0)return this.getSelectionPageBounds();if(n.length===1){const i=this.getShapeGeometry(n[0]).bounds.clone(),o=this.getShapePageTransform(n[0]);return i.point=o.applyToPoint(i.point),i}const s=fe.FromPoints(this.getSelectedShapeIds().flatMap(i=>{const o=this.getShapePageTransform(i);return o?o.applyToPoints(this.getShapeGeometry(i).bounds.corners):[]}).map(i=>i.rot(-r)));return s.point=s.point.rot(r),s}getSelectionRotatedScreenBounds(){const n=this.getSelectionRotatedPageBounds();if(!n)return;const{x:r,y:s}=this.pageToScreen(n.point),i=this.getZoomLevel();return new fe(r,s,n.width*i,n.height*i)}getFocusedGroupId(){return this.getCurrentPageState().focusedGroupId??this.getCurrentPageId()}getFocusedGroup(){const n=this.getFocusedGroupId();return n?this.getShape(n):void 0}setFocusedGroup(n){const r=typeof n=="string"?n:(n==null?void 0:n.id)??null;if(r!==null){const s=this.getShape(r);if(!s)throw Error(`Editor.setFocusedGroup: Shape with id ${r} does not exist`);if(!this.isShapeOfType(s,"group"))throw Error(`Editor.setFocusedGroup: Cannot set focused group to shape of type ${s.type}`)}return r===this.getFocusedGroupId()?this:this.run(()=>{this.store.update(this.getCurrentPageState().id,s=>({...s,focusedGroupId:r}))},{history:"record-preserveRedoStack"})}popFocusedGroupId(){const n=this.getFocusedGroup();if(n){const r=this.findShapeAncestor(n,s=>this.isShapeOfType(s,"group"));this.setFocusedGroup((r==null?void 0:r.id)??null),this.select(n.id)}else this.setFocusedGroup(null),this.selectNone();return this}getEditingShapeId(){return this.getCurrentPageState().editingShapeId}getEditingShape(){const n=this.getEditingShapeId();return n?this.getShape(n):void 0}setEditingShape(n){const r=typeof n=="string"?n:(n==null?void 0:n.id)??null;if(r!==this.getEditingShapeId()){if(r){const s=this.getShape(r);if(s&&this.getShapeUtil(s).canEdit(s))return this.run(()=>{this._updateCurrentPageState({editingShapeId:r})},{history:"ignore"}),this}this.run(()=>{this._updateCurrentPageState({editingShapeId:null})},{history:"ignore"})}return this}getHoveredShapeId(){return this.getCurrentPageState().hoveredShapeId}getHoveredShape(){const n=this.getHoveredShapeId();return n?this.getShape(n):void 0}setHoveredShape(n){const r=typeof n=="string"?n:(n==null?void 0:n.id)??null;return r===this.getHoveredShapeId()?this:(this.run(()=>{this.updateCurrentPageState({hoveredShapeId:r})},{history:"ignore"}),this)}getHintingShapeIds(){return this.getCurrentPageState().hintingShapeIds}getHintingShape(){const n=this.getHintingShapeIds();return Le(n.map(r=>this.getShape(r)))}setHintingShapes(n){const r=typeof n[0]=="string"?n:n.map(s=>s.id);return this.run(()=>{this._updateCurrentPageState({hintingShapeIds:c4(r)})},{history:"ignore"}),this}getErasingShapeIds(){return this.getCurrentPageState().erasingShapeIds}getErasingShapes(){const n=this.getErasingShapeIds();return Le(n.map(r=>this.getShape(r)))}setErasingShapes(n){const r=typeof n[0]=="string"?n:n.map(i=>i.id);r.sort();const s=this.getErasingShapeIds();return this.run(()=>{if(r.length===s.length){for(let i=0;i<r.length;i++)if(r[i]!==s[i]){this._updateCurrentPageState({erasingShapeIds:r});break}}else this._updateCurrentPageState({erasingShapeIds:r})},{history:"ignore"}),this}getCroppingShapeId(){return this.getCurrentPageState().croppingShapeId}setCroppingShape(n){const r=typeof n=="string"?n:(n==null?void 0:n.id)??null;return r!==this.getCroppingShapeId()&&this.run(()=>{if(!r)this.updateCurrentPageState({croppingShapeId:null});else{const s=this.getShape(r),i=this.getShapeUtil(s);s&&i.canCrop(s)&&this.updateCurrentPageState({croppingShapeId:r})}},{history:"ignore"}),this}_unsafe_getCameraId(){return Rs.createId(this.getCurrentPageId())}getCamera(){const n=this.store.get(this._unsafe_getCameraId());if(this._isLockedOnFollowingUser.get()){const r=this.getCameraForFollowing();if(r)return{...n,...r}}return n}getViewportPageBoundsForFollowing(){const n=this.getInstanceState().followingUserId;if(!n)return null;const r=this.getCollaborators().find(p=>p.userId===n);if(!r)return null;const{w:s,h:i}=r.screenBounds,{x:o,y:a,z:l}=r.camera,c=new fe(-o,-a,s/l,i/l),u=this.getViewportScreenBounds().clone(),h=u.width/u.height;return u.width=c.width,u.height=u.width/h,u.height<c.height&&(u.height=c.height,u.width=u.height*h),u.center=c.center,u}getCameraForFollowing(){const n=this.getViewportPageBoundsForFollowing();return n?{x:-n.x,y:-n.y,z:this.getViewportScreenBounds().w/n.width}:null}getZoomLevel(){return this.getCamera().z}getInitialZoom(){const n=this.getCameraOptions();if(!n.constraints||n.constraints.initialZoom==="default")return 1;const{zx:r,zy:s}=Q6(this,n);switch(n.constraints.initialZoom){case"fit-min":return Math.max(r,s);case"fit-max":return Math.min(r,s);case"fit-x":return r;case"fit-y":return s;case"fit-min-100":return Math.min(1,Math.max(r,s));case"fit-max-100":return Math.min(1,Math.min(r,s));case"fit-x-100":return Math.min(1,r);case"fit-y-100":return Math.min(1,s);default:throw Cn(n.constraints.initialZoom)}}getBaseZoom(){const n=this.getCameraOptions();if(!n.constraints||n.constraints.baseZoom==="default")return 1;const{zx:r,zy:s}=Q6(this,n);switch(n.constraints.baseZoom){case"fit-min":return Math.max(r,s);case"fit-max":return Math.min(r,s);case"fit-x":return r;case"fit-y":return s;case"fit-min-100":return Math.min(1,Math.max(r,s));case"fit-max-100":return Math.min(1,Math.min(r,s));case"fit-x-100":return Math.min(1,r);case"fit-y-100":return Math.min(1,s);default:throw Cn(n.constraints.baseZoom)}}getCameraOptions(){return this._cameraOptions.get()}setCameraOptions(n){var s;const r=yt({...this._cameraOptions.__unsafe__getWithoutCapture(),...n});return((s=r.zoomSteps)==null?void 0:s.length)<1&&(r.zoomSteps=[1]),this._cameraOptions.set(r),this}getConstrainedCamera(n,r){const s=this.getCamera();let{x:i,y:o,z:a=s.z}=n;if(!(r!=null&&r.force)){const l=this.getCameraOptions(),c=l.zoomSteps[0],u=xn(l.zoomSteps),h=this.getViewportScreenBounds();if(l.constraints){const{constraints:p}=l,f=Math.min(p.padding.y,h.w/2),v=Math.min(p.padding.x,h.h/2),m=fe.From(l.constraints.bounds),x=(h.w-v*2)/m.w,y=(h.h-f*2)/m.h,S=this.getBaseZoom(),w=u*S,P=c*S;if(r!=null&&r.reset&&(a=this.getInitialZoom()),a<P||a>w){const{x:O,y:N,z:H}=s,Z=-O+h.w/H/2,q=-N+h.h/H/2;a=cn(a,P,w);const V=-O+h.w/a/2,Q=-N+h.h/a/2;i=O+V-Z,o=N+Q-q}const E=v/a-m.x,M=f/a-m.y,I=(h.w-v*2)/a-m.w,_=(h.h-f*2)/a-m.h,D=E+I*p.origin.x,R=M+_*p.origin.y,$=typeof p.behavior=="string"?p.behavior:p.behavior.x,U=typeof p.behavior=="string"?p.behavior:p.behavior.y;if(r!=null&&r.reset)i=D,o=R;else{switch($){case"fixed":{i=D;break}case"contain":{a<x?i=D:i=cn(i,E+I,E);break}case"inside":{a<x?i=cn(i,E,(h.w-v)/a-m.w):i=cn(i,E+I,E);break}case"outside":{i=cn(i,v/a-m.w,(h.w-v)/a);break}case"free":break;default:throw Cn($)}switch(U){case"fixed":{o=R;break}case"contain":{a<y?o=R:o=cn(o,M+_,M);break}case"inside":{a<y?o=cn(o,M,(h.h-f)/a-m.h):o=cn(o,M+_,M);break}case"outside":{o=cn(o,f/a-m.h,(h.h-f)/a);break}case"free":break;default:throw Cn(U)}}}else if(a>u||a<c){const{x:p,y:f,z:v}=s;a=cn(a,c,u),i=p+(-p+h.w/a/2)-(-p+h.w/v/2),o=f+(-f+h.h/a/2)-(-f+h.h/v/2)}}return{x:i,y:o,z:a}}_setCamera(n,r){const s=this.getCamera(),{x:i,y:o,z:a}=this.getConstrainedCamera(n,r);return s.x===i&&s.y===o&&s.z===a?this:(zs(()=>{const l={...s,x:i,y:o,z:a};this.run(()=>{this.store.put([l])},{history:"ignore"});const{currentScreenPoint:c,currentPagePoint:u}=this.inputs,{screenBounds:h}=this.store.unsafeGetWithoutCapture(Fn);if(c.x/a-i!==u.x||c.y/a-o!==u.y){const p={type:"pointer",target:"canvas",name:"pointer_move",point:b.AddXY(c,h.x,h.y),pointerId:k6.CAMERA_MOVE,ctrlKey:this.inputs.ctrlKey,altKey:this.inputs.altKey,shiftKey:this.inputs.shiftKey,button:0,isPen:this.getInstanceState().isPenMode??!1};r!=null&&r.immediate?this._flushEventForTick(p):this.dispatch(p)}this._tickCameraState()}),this)}setCamera(n,r){const{isLocked:s}=this._cameraOptions.__unsafe__getWithoutCapture();if(s&&!(r!=null&&r.force))return this;this.stopCameraAnimation(),this.getInstanceState().followingUserId&&this.stopFollowingUser();const i=b.Cast(n);Number.isFinite(i.x)||(i.x=0),Number.isFinite(i.y)||(i.y=0),(i.z===void 0||!Number.isFinite(i.z))&&(n.z=this.getZoomLevel());const o=this.getConstrainedCamera(i,r);if(r!=null&&r.animation){const{width:a,height:l}=this.getViewportScreenBounds();this._animateToViewport(new fe(-o.x,-o.y,a/o.z,l/o.z),r)}else this._setCamera(o,{...r,force:!0});return this}centerOnPoint(n,r){const{isLocked:s}=this.getCameraOptions();if(s&&!(r!=null&&r.force))return this;const{width:i,height:o}=this.getViewportPageBounds();return this.setCamera(new b(-(n.x-i/2),-(n.y-o/2),this.getCamera().z),r),this}zoomToFit(n){const r=[...this.getCurrentPageShapeIds()];if(r.length<=0)return this;const s=fe.Common(Le(r.map(i=>this.getShapePageBounds(i))));return this.zoomToBounds(s,n),this}resetZoom(n=this.getViewportScreenCenter(),r){const{isLocked:s,constraints:i}=this.getCameraOptions();if(s&&!(r!=null&&r.force))return this;const o=this.getCamera(),{x:a,y:l,z:c}=o,{x:u,y:h}=n;let p=1;if(i){const f=this.getInitialZoom();c!==f&&(p=f)}return this.setCamera(new b(a+(u/p-u)-(u/c-u),l+(h/p-h)-(h/c-h),p),r),this}zoomIn(n=this.getViewportScreenCenter(),r){const{isLocked:s}=this.getCameraOptions();if(s&&!(r!=null&&r.force))return this;const{x:i,y:o,z:a}=this.getCamera(),{zoomSteps:l}=this.getCameraOptions();if(l!==null&&l.length>1){const c=this.getBaseZoom();let u=xn(l)*c;for(let h=1;h<l.length;h++){const p=l[h-1]*c,f=l[h]*c;if(!(f-a<=(f-p)/2)){u=f;break}}this.setCamera(new b(i+(n.x/u-n.x)-(n.x/a-n.x),o+(n.y/u-n.y)-(n.y/a-n.y),u),r)}return this}zoomOut(n=this.getViewportScreenCenter(),r){const{isLocked:s}=this.getCameraOptions();if(s&&!(r!=null&&r.force))return this;const{zoomSteps:i}=this.getCameraOptions();if(i!==null&&i.length>1){const o=this.getBaseZoom(),{x:a,y:l,z:c}=this.getCamera();let u=i[0]*o;for(let h=i.length-1;h>0;h--){const p=i[h-1]*o,f=i[h]*o;if(!(f-c>=(f-p)/2)){u=p;break}}this.setCamera(new b(a+(n.x/u-n.x)-(n.x/c-n.x),l+(n.y/u-n.y)-(n.y/c-n.y),u),r)}return this}zoomToSelection(n){const{isLocked:r}=this.getCameraOptions();if(r&&!(n!=null&&n.force))return this;const s=this.getSelectionPageBounds();return s&&this.zoomToBounds(s,{targetZoom:Math.max(1,this.getZoomLevel()),...n}),this}zoomToBounds(n,r){const s=this._cameraOptions.__unsafe__getWithoutCapture();if(s.isLocked&&!(r!=null&&r.force))return this;const i=this.getViewportScreenBounds(),o=(r==null?void 0:r.inset)??Math.min(Pq,i.width*.28),a=this.getBaseZoom(),l=s.zoomSteps[0],c=xn(s.zoomSteps);let u=cn(Math.min((i.width-o)/n.w,(i.height-o)/n.h),l*a,c*a);return(r==null?void 0:r.targetZoom)!==void 0&&(u=Math.min(r.targetZoom,u)),this.setCamera(new b(-n.x+(i.width-n.w*u)/2/u,-n.y+(i.height-n.h*u)/2/u,u),r),this}stopCameraAnimation(){return this.emit("stop-camera-animation"),this}_animateViewport(n){if(!this._viewportAnimation)return;this._viewportAnimation.elapsed+=n;const{elapsed:r,easing:s,duration:i,start:o,end:a}=this._viewportAnimation;if(r>i){this.off("tick",this._animateViewport),this._viewportAnimation=null,this._setCamera(new b(-a.x,-a.y,this.getViewportScreenBounds().width/a.width));return}const l=i-r,c=s(1-l/i),u=o.minX+(a.minX-o.minX)*c,h=o.minY+(a.minY-o.minY)*c,p=o.maxX+(a.maxX-o.maxX)*c;this._setCamera(new b(-u,-h,this.getViewportScreenBounds().width/(p-u)),{force:!0})}_animateToViewport(n,r={animation:oy}){const{animation:s,...i}=r;if(!s)return;const{duration:o=0,easing:a=dn.easeInOutCubic}=s,l=this.user.getAnimationSpeed(),c=this.getViewportPageBounds();return this.stopCameraAnimation(),this.getInstanceState().followingUserId&&this.stopFollowingUser(),o===0||l===0?this._setCamera(new b(-n.x,-n.y,this.getViewportScreenBounds().width/n.width),{...i}):(this._viewportAnimation={elapsed:0,duration:o/l,easing:a,start:c.clone(),end:n.clone()},this.once("stop-camera-animation",()=>{this.off("tick",this._animateViewport),this._viewportAnimation=null}),this.on("tick",this._animateViewport),this)}slideCamera(n={}){const{isLocked:r}=this.getCameraOptions();if(r&&!(n!=null&&n.force))return this;if(this.user.getAnimationSpeed()===0)return this;this.stopCameraAnimation();const{speed:i,friction:o=this.options.cameraSlideFriction,direction:a,speedThreshold:l=.01}=n;let c=Math.min(i,1);const u=()=>{this.off("tick",h),this.off("stop-camera-animation",u)};this.once("stop-camera-animation",u);const h=p=>{const{x:f,y:v,z:m}=this.getCamera(),x=b.Mul(a,c*p/m);c*=1-o,c<l?u():this._setCamera(new b(f+x.x,v+x.y,m))};return this.on("tick",h),this}zoomToUser(n,r={animation:{duration:500}}){const s=this.getCollaborators().find(i=>i.userId===n);return s?(this.run(()=>{this.getInstanceState().followingUserId!==null&&this.stopFollowingUser();const i=s.currentPageId===this.getCurrentPageId();i||this.setCurrentPage(s.currentPageId),r&&r.animation&&!i&&(r.animation=void 0),this.centerOnPoint(s.cursor,r);const{highlightedUserIds:o}=this.getInstanceState();this.updateInstanceState({highlightedUserIds:[...o,n]}),this.timers.setTimeout(()=>{const a=[...this.getInstanceState().highlightedUserIds],l=a.indexOf(n);l<0||(a.splice(l,1),this.updateInstanceState({highlightedUserIds:a}))},this.options.collaboratorIdleTimeoutMs)}),this):this}updateViewportScreenBounds(n,r=!1){n.width=Math.max(n.width,1),n.height=Math.max(n.height,1);const s=[n.minY!==0,!ea(document.body.scrollWidth,n.maxX,1),!ea(document.body.scrollHeight,n.maxY,1),n.minX!==0],{screenBounds:i,insets:o}=this.getInstanceState();if(n.equals(i)&&s.every((l,c)=>l===o[c]))return this;const{_willSetInitialBounds:a}=this;if(this._willSetInitialBounds=!1,a)this.updateInstanceState({screenBounds:n.toJson(),insets:s}),this.setCamera(this.getCamera());else if(r&&!this.getInstanceState().followingUserId){const l=this.getViewportPageBounds().center;this.updateInstanceState({screenBounds:n.toJson(),insets:s}),this.centerOnPoint(l)}else this.updateInstanceState({screenBounds:n.toJson(),insets:s}),this._setCamera(b.From({...this.getCamera()}));return this._tickCameraState(),this}getViewportScreenBounds(){const{x:n,y:r,w:s,h:i}=this.getInstanceState().screenBounds;return new fe(n,r,s,i)}getViewportScreenCenter(){const n=this.getViewportScreenBounds();return new b(n.midX-n.minX,n.midY-n.minY)}getViewportPageBounds(){const{w:n,h:r}=this.getViewportScreenBounds(),{x:s,y:i,z:o}=this.getCamera();return new fe(-s,-i,n/o,r/o)}screenToPage(n){const{screenBounds:r}=this.store.unsafeGetWithoutCapture(Fn),{x:s,y:i,z:o=1}=this.getCamera();return new b((n.x-r.x)/o-s,(n.y-r.y)/o-i,n.z??.5)}pageToScreen(n){const{screenBounds:r}=this.store.unsafeGetWithoutCapture(Fn),{x:s,y:i,z:o=1}=this.getCamera();return new b((n.x+s)*o+r.x,(n.y+i)*o+r.y,n.z??.5)}pageToViewport(n){const{x:r,y:s,z:i=1}=this.getCamera();return new b((n.x+r)*i,(n.y+s)*i,n.z??.5)}_getCollaboratorsQuery(){return this.store.query.records("instance_presence",()=>({userId:{neq:this.user.getId()}}))}getCollaborators(){const n=this._getCollaboratorsQuery().get();return n.length?[...new Set(n.map(s=>s.userId))].sort().map(s=>n.filter(o=>o.userId===s).sort((o,a)=>a.lastActivityTimestamp-o.lastActivityTimestamp)[0]):qi}getCollaboratorsOnCurrentPage(){const n=this.getCurrentPageId();return this.getCollaborators().filter(r=>r.currentPageId===n)}startFollowingUser(n){this.stopFollowingUser();const r=this._getCollaboratorsQuery().get().filter(o=>o.userId===n);if(!r.length)return console.warn("User not found"),this;const s=this.user.getId();if(s||console.warn("You should set the userId for the current instance before following a user"),r.some(o=>o.followingUserId===s))return this;const i=ee("latestLeaderPresence",()=>this.getCollaborators().find(o=>o.userId===n));return zs(()=>{this.updateInstanceState({followingUserId:n},{history:"ignore"});const o=ba("update current page",()=>{const c=i.get();if(!c){this.stopFollowingUser();return}c.currentPageId!==this.getCurrentPageId()&&this.getPage(c.currentPageId)&&this.run(()=>{this.store.put([{...this.getInstanceState(),currentPageId:c.currentPageId}]),this._isLockedOnFollowingUser.set(!0)},{history:"ignore"})}),a=()=>{o(),this._isLockedOnFollowingUser.set(!1),this.off("frame",l),this.off("stop-following",a)},l=()=>{if(!i.get()){this.stopFollowingUser();return}if(this._isLockedOnFollowingUser.get())return;const u=this.user.getAnimationSpeed();if(u===0){this._isLockedOnFollowingUser.set(!0);return}const h=this.getViewportPageBoundsForFollowing();if(!h){this.stopFollowingUser();return}const p=this.getViewportPageBounds(),f=Math.abs(h.minX-p.minX)+Math.abs(h.maxX-p.maxX),v=Math.abs(h.minY-p.minY)+Math.abs(h.maxY-p.maxY);if(f<this.options.followChaseViewportSnap&&v<this.options.followChaseViewportSnap){this._isLockedOnFollowingUser.set(!0);return}const m=cn(u*.5,.1,.8),x=new fe(mr(p.minX,h.minX,m),mr(p.minY,h.minY,m),mr(p.width,h.width,m),mr(p.height,h.height,m)),y=new b(-x.x,-x.y,this.getViewportScreenBounds().width/x.width);this.stopCameraAnimation(),this._setCamera(y)};this.once("stop-following",a),this.addListener("frame",l),l()}),this}stopFollowingUser(){return this.run(()=>{this.store.put([this.getCamera()]),this._isLockedOnFollowingUser.set(!1),this.updateInstanceState({followingUserId:null}),this.emit("stop-following")},{history:"ignore"}),this}getUnorderedRenderingShapes(n){const r=[];let s=this.options.maxShapesPerPage*2,i=this.options.maxShapesPerPage;const o=this.getErasingShapeIds(),a=(c,u,h)=>{const p=this.getShape(c);if(!p)return;u*=p.opacity;let f=!1;const v=this.getShapeUtil(p);n&&(f=!h&&o.includes(c),f&&(u*=.32)),r.push({id:c,shape:p,util:v,index:s,backgroundIndex:i,opacity:u}),s+=1,i+=1;const m=this.getSortedChildIdsForParent(c);if(!m.length)return;let x=null;v.providesBackgroundForChildren(p)&&(x=i,i=s,s+=this.options.maxShapesPerPage);for(const y of m)a(y,u,h||f);x!==null&&(i=x)},l=n?[this.getCurrentPage()]:this.getPages();for(const c of l)for(const u of this.getSortedChildIdsForParent(c.id))a(u,1,!1);return r}getCameraState(){return this._cameraState.get()}getRenderingShapes(){return this.getUnorderedRenderingShapes(!0).sort(TG)}_getAllPagesQuery(){return this.store.query.records("page")}getPages(){return this._getAllPagesQuery().get().sort(Un)}getCurrentPage(){return this.getPage(this.getCurrentPageId())}getCurrentPageId(){return this.getInstanceState().currentPageId}getPage(n){return this.store.get(typeof n=="string"?n:n.id)}getCurrentPageShapeIds(){return this._currentPageShapeIds.get()}getCurrentPageShapeIdsSorted(){return Array.from(this.getCurrentPageShapeIds()).sort()}getPageShapeIds(n){const r=typeof n=="string"?n:n.id,s=this.store.query.exec("shape",{parentId:{eq:r}});return this.getShapeAndDescendantIds(s.map(i=>i.id))}setCurrentPage(n){const r=typeof n=="string"?n:n.id;return this.store.has(r)?(this.stopFollowingUser(),this.complete(),this.run(()=>{this.store.put([{...this.getInstanceState(),currentPageId:r}])},{history:"record-preserveRedoStack"})):(console.error("Tried to set the current page id to a page that doesn't exist."),this)}updatePage(n){return this.getInstanceState().isReadonly?this:this.getPage(n.id)?this.run(()=>this.store.update(n.id,s=>({...s,...n}))):this}createPage(n){return this.run(()=>{if(this.getInstanceState().isReadonly||this.getPages().length>=this.options.maxPages)return;const r=this.getPages(),s=iZ(n.name??"Page 1",r.map(a=>a.name));let i=n.index;(!i||r.some(a=>a.index===i))&&(i=js(r[r.length-1].index));const o=io.create({meta:{},...n,name:s,index:i});this.store.put([o])}),this}deletePage(n){const r=typeof n=="string"?n:n.id;return this.run(()=>{if(this.getInstanceState().isReadonly)return;const s=this.getPages();if(s.length===1)return;const i=this.getPage(r);if(i){if(r===this.getCurrentPageId()){const o=s.findIndex(l=>l.id===r),a=s[o-1]??s[o+1];this.setCurrentPage(a.id)}this.store.remove([i.id])}}),this}duplicatePage(n,r=io.createId()){if(this.getPages().length>=this.options.maxPages)return this;const s=typeof n=="string"?n:n.id,i=this.getPage(s);if(!i)return this;const o={...this.getCamera()},a=this.getContentFromCurrentPage(this.getSortedChildIdsForParent(i.id));return this.run(()=>{var u;const l=this.getPages(),c=Gd(i.index,(u=l[l.indexOf(i)+1])==null?void 0:u.index);if(this.createPage({name:i.name+" Copy",id:r,index:c}),this.setCurrentPage(r),this.setCamera(o),a)return this.putContentOntoCurrentPage(a)}),this}renamePage(n,r){const s=typeof n=="string"?n:n.id;return this.getInstanceState().isReadonly?this:(this.updatePage({id:s,name:r}),this)}_getAllAssetsQuery(){return this.store.query.records("asset")}getAssets(){return this._getAllAssetsQuery().get()}createAssets(n){return this.getInstanceState().isReadonly?this:n.length<=0?this:(this.run(()=>this.store.put(n),{history:"ignore"}),this)}updateAssets(n){return this.getInstanceState().isReadonly?this:n.length<=0?this:(this.run(()=>{this.store.put(n.map(r=>({...this.store.get(r.id),...r})))},{history:"ignore"}),this)}deleteAssets(n){if(this.getInstanceState().isReadonly)return this;const r=typeof n[0]=="string"?n:n.map(s=>s.id);return r.length<=0?this:(this.run(()=>this.store.remove(r),{history:"ignore"}),this)}getAsset(n){return this.store.get(typeof n=="string"?n:n.id)}async resolveAssetUrl(n,r){if(!n)return null;const s=this.getAsset(n);if(!s)return null;const{screenScale:i=1,shouldResolveToOriginal:o=!1}=r,l=Math.max(.125,(h=>Math.pow(2,Math.ceil(Math.log2(h))))(i)),c="connection"in navigator?navigator.connection.effectiveType:null,u=this.getInstanceState().devicePixelRatio;return await this.store.props.assets.resolve(s,{screenScale:i||1,steppedScreenScale:l,dpr:u,networkEffectiveType:c,shouldResolveToOriginal:o})}async uploadAsset(n,r){return await this.store.props.assets.upload(n,r)}_getShapeGeometryCache(){return this.store.createComputedCache("bounds",n=>this.getShapeUtil(n).getGeometry(n),(n,r)=>n.props===r.props)}getShapeGeometry(n){return this._getShapeGeometryCache().get(typeof n=="string"?n:n.id)}_getShapeHandlesCache(){return this.store.createComputedCache("handles",n=>{var r,s;return(s=(r=this.getShapeUtil(n)).getHandles)==null?void 0:s.call(r,n)})}getShapeHandles(n){return this._getShapeHandlesCache().get(typeof n=="string"?n:n.id)}getShapeLocalTransform(n){const r=typeof n=="string"?n:n.id,s=this.getShape(r);if(!s)throw Error("Editor.getTransform: shape not found");return xe.Identity().translate(s.x,s.y).rotate(s.rotation)}_getShapePageTransformCache(){return this.store.createComputedCache("pageTransformCache",n=>{if(dr(n.parentId))return this.getShapeLocalTransform(n);const r=this._getShapePageTransformCache().get(n.parentId)??xe.Identity();return xe.Compose(r,this.getShapeLocalTransform(n))})}getShapeParentTransform(n){const r=typeof n=="string"?n:n.id,s=this.getShape(r);return!s||dr(s.parentId)?xe.Identity():this._getShapePageTransformCache().get(s.parentId)??xe.Identity()}getShapePageTransform(n){const r=typeof n=="string"?n:n.id;return this._getShapePageTransformCache().get(r)??xe.Identity()}_getShapePageBoundsCache(){return this.store.createComputedCache("pageBoundsCache",n=>{const r=this._getShapePageTransformCache().get(n.id);return r?fe.FromPoints(xe.applyToPoints(r,this.getShapeGeometry(n).vertices)):new fe})}getShapePageBounds(n){return this._getShapePageBoundsCache().get(typeof n=="string"?n:n.id)}_getShapeClipPathCache(){return this.store.createComputedCache("clipPathCache",n=>{const r=this._getShapeMaskCache().get(n.id);if(!r)return;if(r.length===0)return"polygon(0px 0px, 0px 0px, 0px 0px)";const s=this._getShapePageTransformCache().get(n.id);return s?`polygon(${xe.applyToPoints(xe.Inverse(s),r).map(o=>`${o.x}px ${o.y}px`).join(",")})`:void 0})}getShapeClipPath(n){return this._getShapeClipPathCache().get(typeof n=="string"?n:n.id)}_getShapeMaskCache(){return this.store.createComputedCache("pageMaskCache",n=>{if(dr(n.parentId))return;const r=this.getShapeAncestors(n.id).filter(i=>this.isShapeOfType(i,"frame"));return r.length===0?void 0:r.map(i=>this._getShapePageTransformCache().get(i.id).applyToPoints(this.getShapeGeometry(i).vertices)).reduce((i,o)=>{if(!(o&&i))return;const a=K6(i,o);return a?a.map(b.Cast):[]})})}getShapeMask(n){return this._getShapeMaskCache().get(typeof n=="string"?n:n.id)}getShapeMaskedPageBounds(n){return typeof n!="string"&&(n=n.id),this._getShapeMaskedPageBoundsCache().get(n)}_getShapeMaskedPageBoundsCache(){return this.store.createComputedCache("shapeMaskedPageBoundsCache",n=>{const r=this._getShapePageBoundsCache().get(n.id);if(!r)return;const s=this._getShapeMaskCache().get(n.id);if(s){if(s.length===0)return;const{corners:i}=r;if(i.every((a,l)=>a&&b.Equals(a,s[l])))return r.clone();const o=K6(s,i);return o?fe.FromPoints(o):void 0}return r})}getShapeAncestors(n,r=[]){const s=typeof n=="string"?n:n.id,i=this.getShape(s);if(!i)return r;const o=i.parentId;if(dr(o))return r.reverse(),r;const a=this.store.get(o);return a?(r.push(a),this.getShapeAncestors(a,r)):r}findShapeAncestor(n,r){const s=typeof n=="string"?n:n.id,i=this.getShape(s);if(!i)return;const o=i.parentId;if(dr(o))return;const a=this.getShape(o);if(a)return r(a)?a:this.findShapeAncestor(a,r)}hasAncestor(n,r){const s=typeof n=="string"?n:n==null?void 0:n.id,i=s&&this.getShape(s);return i?i.parentId===r?!0:this.hasAncestor(this.getShapeParent(i),r):!1}findCommonAncestor(n,r){var c;if(n.length===0)return;const s=typeof n[0]=="string"?n:n.map(u=>u.id),i=Le(s.map(u=>this.getShape(u)));if(i.length===1){const u=i[0].parentId;return dr(u)?void 0:r?(c=this.findShapeAncestor(i[0],r))==null?void 0:c.id:u}const[o,...a]=i;let l=this.getShapeParent(o);for(;l;){if(r&&!r(l)){l=this.getShapeParent(l);continue}if(a.every(u=>this.hasAncestor(u,l.id)))return l.id;l=this.getShapeParent(l)}}isShapeOrAncestorLocked(n){const r=typeof n=="string"?this.getShape(n):n;return r===void 0?!1:r.isLocked?!0:this.isShapeOrAncestorLocked(this.getShapeParent(r))}_notVisibleShapes(){return hZ(this)}getCulledShapes(){const n=this._notVisibleShapes().get(),r=this.getSelectedShapeIds(),s=this.getEditingShapeId(),i=new Set(n);return s&&i.delete(s),r.forEach(o=>{i.delete(o)}),i}getCurrentPageBounds(){let n;return this.getCurrentPageShapeIdsSorted().forEach(r=>{const s=this.getShapeMaskedPageBounds(r);s&&(n?n=n.expand(s):n=s.clone())}),n}getSelectedShapeAtPoint(n){const r=this.getSelectedShapeIds();return this.getCurrentPageShapesSorted().filter(s=>s.type!=="group"&&r.includes(s.id)).reverse().find(s=>this.isPointInShape(s,n,{hitInside:!0,margin:0}))}getShapeAtPoint(n,r={}){const s=this.getZoomLevel(),i=this.getViewportPageBounds(),{filter:o,margin:a=0,hitLocked:l=!1,hitLabels:c=!1,hitInside:u=!1,hitFrameInside:h=!1}=r;let p=1/0,f=null,v=1/0,m=null;const x=(r.renderingOnly?this.getCurrentPageRenderingShapesSorted():this.getCurrentPageShapesSorted()).filter(y=>{if(y.isLocked&&!l||this.isShapeOfType(y,"group"))return!1;const S=this.getShapeMask(y);return S&&!Wr(n,S)?!1:o?o(y):!0});for(let y=x.length-1;y>=0;y--){const S=x[y],w=this.getShapeGeometry(S),P=w instanceof $s,E=this.getPointInShapeSpace(S,n);if((this.isShapeOfType(S,"arrow")||this.isShapeOfType(S,"geo")&&S.props.fill==="none")&&S.props.text.trim()){for(const I of w.children)if(I.isLabel&&I.isPointInBounds(E))return S}if(this.isShapeOfType(S,"frame")){const I=w.distanceToPoint(E,u);if(Math.abs(I)<=a)return m||S;if(w.hitTestPoint(E,0,!0))return m||f||(h?S:void 0);continue}let M;if(P){let I=1/0;for(const _ of w.children){if(_.isLabel&&!c)continue;const D=_.distanceToPoint(E,u);D<I&&(I=D)}M=I}else a===0&&(w.bounds.w<1||w.bounds.h<1)||w.bounds.containsPoint(E,a)?M=w.distanceToPoint(E,u):M=1/0;if(w.isClosed){if(M<=a){if(w.isFilled||P&&w.children[0].isFilled)return m||S;if(this.getShapePageBounds(S).contains(i))continue;if(Math.abs(M)<a)Math.abs(M)<v&&(v=Math.abs(M),m=S);else if(!m){const{area:I}=w;I<p&&(p=I,f=S)}}}else if(M<this.options.hitTestMargin/s)return S}return m||f||void 0}getShapesAtPoint(n,r={}){return this.getCurrentPageShapes().filter(s=>this.isPointInShape(s,n,r))}isPointInShape(n,r,s={}){const{hitInside:i=!1,margin:o=0}=s,a=typeof n=="string"?n:n.id,l=this.getShapeMask(a);return l&&!Wr(r,l)?!1:this.getShapeGeometry(a).hitTestPoint(this.getPointInShapeSpace(n,r),o,i)}getPointInShapeSpace(n,r){const s=typeof n=="string"?n:n.id;return this._getShapePageTransformCache().get(s).clone().invert().applyToPoint(r)}getPointInParentSpace(n,r){const s=typeof n=="string"?n:n.id,i=this.getShape(s);if(!i)return new b(0,0);if(dr(i.parentId))return b.From(r);const o=this.getShapePageTransform(i.parentId);return o?o.clone().invert().applyToPoint(r):b.From(r)}getCurrentPageShapes(){return Array.from(this.getCurrentPageShapeIds(),n=>this.store.get(n))}getCurrentPageShapesSorted(){const n=[],r=this.getSortedChildIdsForParent(this.getCurrentPageId());for(let s=0,i=r.length;s<i;s++)UE(this,r[s],n);return n}getCurrentPageRenderingShapesSorted(){const n=this.getCulledShapes();return this.getCurrentPageShapesSorted().filter(({id:r})=>!n.has(r))}isShapeOfType(n,r){const s=typeof n=="string"?this.getShape(n):n;return s?s.type===r:!1}getShape(n){const r=typeof n=="string"?n:n.id;if(fr(r))return this.store.get(r)}getShapeParent(n){const r=typeof n=="string"?n:n==null?void 0:n.id;if(!r)return;const s=this.getShape(r);if(!(s===void 0||!fr(s.parentId)))return this.store.get(s.parentId)}getShapeNearestSibling(n,r){return r?r.parentId===n.parentId?r:this.findShapeAncestor(r,i=>i.parentId===n.parentId):void 0}isShapeInPage(n,r=this.getCurrentPageId()){const s=typeof n=="string"?n:n.id,i=this.getShape(s);if(!i)return!1;let o=!1;if(i.parentId===r)o=!0;else{let a=this.getShape(i.parentId);e:for(;a;){if(a.parentId===r){o=!0;break e}a=this.getShape(a.parentId)}}return o}getAncestorPageId(n){const r=typeof n=="string"?n:n==null?void 0:n.id,s=r&&this.getShape(r);if(s)return dr(s.parentId)?s.parentId:this.getAncestorPageId(this.getShape(s.parentId))}reparentShapes(n,r,s){const i=typeof n[0]=="string"?n:n.map(f=>f.id);if(i.length===0)return this;const o=[],a=dr(r)?xe.Identity():this.getShapePageTransform(r),l=a.rotation();let c=[];const u=Le(this.getSortedChildIdsForParent(r).map(f=>this.getShape(f)));if(s){const f=u.find(v=>v.index===s);if(f){const v=u[u.indexOf(f)+1];v?c=jc(s,v.index,i.length):c=ey(s,i.length)}else{const v=u.sort(Un).find(m=>m.index>s);v?c=jc(s,v.index,i.length):c=ey(s,i.length)}}else{const f=u.length&&u[u.length-1];c=f?ey(f.index,i.length):Vd(i.length)}const h=a.clone().invert(),p=Le(i.map(f=>this.getShape(f)));return this.run(()=>{for(let f=0;f<p.length;f++){const v=p[f],m=this.getShapePageTransform(v);if(!m)continue;const x=m.point();if(!x)continue;const y=h.applyToPoint(x),S=m.rotation()-l;o.push({id:v.id,type:v.type,parentId:r,x:y.x,y:y.y,rotation:S,index:c[f]})}this.updateShapes(o)},{ignoreShapeLock:!0}),this}getHighestIndexForParent(n){const r=typeof n=="string"?n:n.id,s=this._parentIdsToChildIds.get()[r];if(!s||s.length===0)return"a1";const i=this.getShape(s[s.length-1]);return js(i.index)}getSortedChildIdsForParent(n){const r=typeof n=="string"?n:n.id,s=this._parentIdsToChildIds.get()[r];return s||qi}visitDescendants(n,r){const s=typeof n=="string"?n:n.id,i=this.getSortedChildIdsForParent(s);for(const o of i)r(o)!==!1&&this.visitDescendants(o,r);return this}getShapeAndDescendantIds(n){const r=new Set;for(const s of n.map(i=>this.getShape(i)).sort(Un))r.add(s.id),this.visitDescendants(s,i=>{r.add(i)});return r}getDroppingOverShape(n,r=[]){const s=this.getCurrentPageShapesSorted();for(let i=s.length-1;i>=0;i--){const o=s[i];if(this.getSelectedShapeIds().includes(o.id)||!this.getShapeUtil(o).canDropShapes(o,r)||r.find(l=>l.id===o.id||this.hasAncestor(o,l.id)))continue;const a=this.getShapeMaskedPageBounds(o.id);if(a&&a.containsPoint(n)&&this.getShapeGeometry(o).hitTestPoint(this.getPointInShapeSpace(o,n),0,!0))return o}}getOutermostSelectableShape(n,r){const s=typeof n=="string"?n:n.id,i=this.getShape(s);let o=i,a=i;const l=this.getFocusedGroup();for(;a;){if(this.isShapeOfType(a,"group")&&(l==null?void 0:l.id)!==a.id&&!this.hasAncestor(l,a.id)&&((r==null?void 0:r(a))??!0))o=a;else if((l==null?void 0:l.id)===a.id)break;a=this.getShapeParent(a)}return o}_getBindingsIndexCache(){const n=uZ(this);return this.store.createComputedCache("bindingsIndex",r=>n.get().get(r.id))}getBinding(n){return this.store.get(n)}getBindingsFromShape(n,r){const s=typeof n=="string"?n:n.id;return this.getBindingsInvolvingShape(s).filter(i=>i.fromId===s&&i.type===r)}getBindingsToShape(n,r){const s=typeof n=="string"?n:n.id;return this.getBindingsInvolvingShape(s).filter(i=>i.toId===s&&i.type===r)}getBindingsInvolvingShape(n,r){const s=typeof n=="string"?n:n.id,i=this._getBindingsIndexCache().get(s)??qi;return r?i.filter(o=>o.type===r):i}createBindings(n){const r=[];for(const s of n){const i=this.getShape(s.fromId),o=this.getShape(s.toId);if(!i||!o||!this.canBindShapes({fromShape:i,toShape:o,binding:s}))continue;const l=this.getBindingUtil(s.type).getDefaultProps(),c=this.store.schema.types.binding.create({...s,id:s.id??Qa(),props:{...l,...s.props}});r.push(c)}return this.store.put(r),this}createBinding(n){return this.createBindings([n])}updateBindings(n){const r=[];for(const s of n){if(!s)continue;const i=this.getBinding(s.id);if(!i)continue;const o=Qs(i,s);if(o===i)continue;const a=this.getShape(o.fromId),l=this.getShape(o.toId);!a||!l||this.canBindShapes({fromShape:a,toShape:l,binding:o})&&r.push(o)}return this.store.put(r),this}updateBinding(n){return this.updateBindings([n])}deleteBindings(n,{isolateShapes:r=!1}={}){const s=n.map(i=>typeof i=="string"?i:i.id);return r?this.store.atomic(()=>{var i,o;for(const a of s){const l=this.getBinding(a);if(!l)continue;const c=this.getBindingUtil(l);(i=c.onBeforeIsolateFromShape)==null||i.call(c,{binding:l,removedShape:this.getShape(l.toId)}),(o=c.onBeforeIsolateToShape)==null||o.call(c,{binding:l,removedShape:this.getShape(l.fromId)}),this.store.remove([a])}}):this.store.remove(s),this}deleteBinding(n,r){return this.deleteBindings([n],r)}canBindShapes({fromShape:n,toShape:r,binding:s}){const i=typeof n=="string"?n:n.type,o=typeof r=="string"?r:r.type,a=typeof s=="string"?s:s.type,l={fromShapeType:i,toShapeType:o,bindingType:a};return i===o?this.getShapeUtil(i).canBind(l):this.getShapeUtil(i).canBind(l)&&this.getShapeUtil(o).canBind(l)}rotateShapesBy(n,r){if((typeof n[0]=="string"?n:n.map(o=>o.id)).length<=0)return this;const i=zE({editor:this});return i?(Rp({delta:r,snapshot:i,editor:this,stage:"one-off"}),this):this}getChangesToTranslateShape(n,r){var o,a,l;let s=n;const i=this.getShapeUtil(n);return s=Qs(s,((o=i.onTranslateStart)==null?void 0:o.call(i,s))??void 0),s=Qs(s,{id:n.id,type:n.type,x:r.x,y:r.y}),s=Qs(s,((a=i.onTranslate)==null?void 0:a.call(i,n,s))??void 0),s=Qs(s,((l=i.onTranslateEnd)==null?void 0:l.call(i,n,s))??void 0),s}nudgeShapes(n,r){const s=typeof n[0]=="string"?n:n.map(o=>o.id);if(s.length<=0)return this;const i=[];for(const o of s){const a=this.getShape(o),l=b.From(r),c=this.getShapeParentTransform(a);c&&l.rot(-c.rotation()),i.push(this.getChangesToTranslateShape(a,l.add(a)))}return this.updateShapes(i),this}duplicateShapes(n,r){return this.run(()=>{const s=typeof n[0]=="string"?n:n.map(p=>p.id);if(s.length<=0)return this;const i=new Set(s),o=this.getShapeAndDescendantIds(s),a=[...o].reverse(),l=new Map;for(const p of o)l.set(p,ot());const{shapesToCreate:c,bindingsToCreate:u}=Z6(this,o,p=>{const f=[];for(const m of p){const x=this.getBinding(m);if(!x)continue;const y=Qa();f.push({...x,id:y,fromId:as(l.get(x.fromId)),toId:as(l.get(x.toId))})}const v=[];for(const m of a){const x=as(l.get(m)),y=this.getShape(m);if(!y)continue;let S=0,w=0;if(r&&i.has(m)){const R=this.getShapeParentTransform(y),$=new b(r.x,r.y).rot(-R.rotation());S=$.x,w=$.y}const P=y.parentId,E=this.getSortedChildIdsForParent(P),M=E.indexOf(y.id),I=E[M+1],_=I?this.getShape(I):null,D=_?Gd(y.index,_.index):js(y.index);v.push({...y,id:x,x:y.x+S,y:y.y+w,index:D,parentId:l.get(y.parentId)??y.parentId})}return{shapesToCreate:v,bindingsToCreate:f}});if(c.length+this.getCurrentPageShapeIds().size>this.options.maxShapesPerPage){D0(this);return}if(this.createShapes(c),this.createBindings(u),this.setSelectedShapes(Le(s.map(p=>l.get(p)))),r!==void 0){const p=this.getSelectionPageBounds(),f=this.getViewportPageBounds();p&&!f.contains(p)&&this.centerOnPoint(p.center,{animation:{duration:this.options.animationMediumMs}})}}),this}moveShapesToPage(n,r){const s=typeof n[0]=="string"?n:n.map(l=>l.id);if(s.length===0)return this;if(this.getInstanceState().isReadonly)return this;const i=this.getCurrentPageId();if(r===i)return this;if(!this.store.has(r))return this;const o=this.getContentFromCurrentPage(s);if(!o)return this;if(this.getPageShapeIds(r).size+o.shapes.length>this.options.maxShapesPerPage)return D0(this,r),this;const a=this.getCamera().z;return this.run(()=>{this.deleteShapes(s),this.setCurrentPage(r),this.setFocusedGroup(null),this.selectNone(),this.putContentOntoCurrentPage(o,{select:!0,preserveIds:!0,preservePosition:!0}),this.setCamera({...this.getCamera(),z:a}),this.centerOnPoint(this.getSelectionRotatedPageBounds().center)}),this}toggleLock(n){const r=typeof n[0]=="string"?n:n.map(a=>a.id);if(this.getInstanceState().isReadonly||r.length===0)return this;let s=!0,i=!0;const o=[];for(const a of r){const l=this.getShape(a);l&&(o.push(l),l.isLocked?i=!1:s=!1)}return this.run(()=>{i?(this.updateShapes(o.map(a=>({id:a.id,type:a.type,isLocked:!0}))),this.setSelectedShapes([])):s?this.updateShapes(o.map(a=>({id:a.id,type:a.type,isLocked:!1}))):this.updateShapes(o.map(a=>({id:a.id,type:a.type,isLocked:!0})))}),this}sendToBack(n){const r=typeof n[0]=="string"?n:n.map(i=>i.id),s=A0(this,"toBack",r);return s&&this.updateShapes(s),this}sendBackward(n){const r=typeof n[0]=="string"?n:n.map(i=>i.id),s=A0(this,"backward",r);return s&&this.updateShapes(s),this}bringForward(n){const r=typeof n[0]=="string"?n:n.map(i=>i.id),s=A0(this,"forward",r);return s&&this.updateShapes(s),this}bringToFront(n){const r=typeof n[0]=="string"?n:n.map(i=>i.id),s=A0(this,"toFront",r);return s&&this.updateShapes(s),this}flipShapes(n,r){const s=typeof n[0]=="string"?n:n.map(a=>a.id);if(this.getInstanceState().isReadonly)return this;let i=Le(s.map(a=>this.getShape(a)));if(!i.length)return this;i=Le(i.map(a=>this.isShapeOfType(a,"group")?this.getSortedChildIdsForParent(a.id).map(l=>this.getShape(l)):a).flat());const o=fe.Common(Le(i.map(a=>this.getShapePageBounds(a)))).center;return this.run(()=>{for(const a of i){const l=this.getShapeGeometry(a).bounds,c=this.getShapePageTransform(a.id);c&&this.resizeShape(a.id,{x:r==="horizontal"?-1:1,y:r==="vertical"?-1:1},{initialBounds:l,initialPageTransform:c,initialShape:a,mode:"scale_shape",isAspectRatioLocked:this.getShapeUtil(a).isAspectRatioLocked(a),scaleOrigin:o,scaleAxisRotation:0})}}),this}stackShapes(n,r,s){const i=typeof n[0]=="string"?n:n.map(x=>x.id);if(this.getInstanceState().isReadonly)return this;const o=i.map(x=>this.getShape(x)).filter(x=>x?this.getShapeUtil(x).canBeLaidOut(x):!1),a=o.length;if(s===0&&a<3||a<2)return this;const l=Object.fromEntries(o.map(x=>[x.id,this.getShapePageBounds(x)]));let c,u,h,p;r==="horizontal"?(c="x",u="minX",h="maxX",p="width"):(c="y",u="minY",h="maxY",p="height");let f;if(s===0){const x=[];o.sort((S,w)=>l[S.id][u]-l[w.id][u]);for(let S=0;S<a-1;S++){const w=o[S],P=o[S+1],E=l[w.id],I=l[P.id][u]-E[h],_=x.find(D=>D.gap===I);_?_.count++:x.push({gap:I,count:1})}let y=0;x.forEach(S=>{S.count>y&&(y=S.count,f=S.gap)}),y===1&&(f=Math.max(0,x.reduce((S,w)=>S+w.gap*w.count,0)/(a-1)))}else f=s;const v=[];let m=l[o[0].id][h];return o.forEach((x,y)=>{var M,I;if(y===0)return;const S={x:0,y:0};S[c]=m+f-l[x.id][c];const w=this.getShapeParent(x),P=w?b.Rot(S,-this.getShapePageTransform(w).decompose().rotation):S,E=(I=(M=this.getShapeUtil(x)).onTranslateStart)==null?void 0:I.call(M,x);v.push(E?{...E,[c]:x[c]+P[c]}:{id:x.id,type:x.type,[c]:x[c]+P[c]}),m+=l[x.id][p]+f}),this.updateShapes(v),this}packShapes(n,r){var I,_;const s=typeof n[0]=="string"?n:n.map(D=>D.id);if(this.getInstanceState().isReadonly)return this;if(s.length<2)return this;const i=s.map(D=>this.getShape(D)).filter(D=>D?this.getShapeUtil(D).canBeLaidOut(D):!1),o={},a={};let l,c,u=0;for(let D=0;D<i.length;D++)l=i[D],c=this.getShapePageBounds(l),o[l.id]=c,a[l.id]=c.clone(),u+=c.width*c.height;const h=fe.Common(Le(Object.values(o))),p=h.width;i.sort((D,R)=>o[R.id].height-o[D.id].height);const f=Math.max(Math.ceil(Math.sqrt(u/.95)),p),v=[new fe(h.x,h.y,f,1/0)];let m=0,x=0,y,S;for(let D=0;D<i.length;D++){l=i[D],c=a[l.id];for(let R=v.length-1;R>=0;R--)if(y=v[R],!(c.width>y.width||c.height>y.height)){c.x=y.x,c.y=y.y,x=Math.max(x,c.maxY),m=Math.max(m,c.maxX),c.width===y.width&&c.height===y.height?(S=v.pop(),R<v.length&&(v[R]=S)):c.height===y.height?(y.x+=c.width+r,y.width-=c.width+r):c.width===y.width?(y.y+=c.height+r,y.height-=c.height+r):(v.push(new fe(y.x+(c.width+r),y.y,y.width-(c.width+r),c.height)),y.y+=c.height+r,y.height-=c.height+r);break}}const w=fe.Common(Object.values(a)),P=b.Sub(h.center,w.center);let E;const M=[];for(let D=0;D<i.length;D++){l=i[D],c=o[l.id],E=a[l.id];const R=b.Sub(E.point,c.point).add(P),$=this.getShapeParentTransform(l);$&&R.rot(-$.rotation());const U={id:l.id,type:l.type,x:l.x+R.x,y:l.y+R.y},O=(_=(I=this.getShapeUtil(l)).onTranslateStart)==null?void 0:_.call(I,{...l,...U});O?M.push({...U,...O}):M.push(U)}return M.length&&this.updateShapes(M),this}alignShapes(n,r){const s=typeof n[0]=="string"?n:n.map(c=>c.id);if(this.getInstanceState().isReadonly)return this;if(s.length<2)return this;const i=Le(s.map(c=>this.getShape(c))),o=Object.fromEntries(i.map(c=>[c.id,this.getShapePageBounds(c)])),a=fe.Common(Le(Object.values(o))),l=[];return i.forEach(c=>{const u=o[c.id];if(!u)return;const h={x:0,y:0};switch(r){case"top":{h.y=a.minY-u.minY;break}case"center-vertical":{h.y=a.midY-u.minY-u.height/2;break}case"bottom":{h.y=a.maxY-u.minY-u.height;break}case"left":{h.x=a.minX-u.minX;break}case"center-horizontal":{h.x=a.midX-u.minX-u.width/2;break}case"right":{h.x=a.maxX-u.minX-u.width;break}}const p=this.getShapeParent(c),f=p?b.Rot(h,-this.getShapePageTransform(p).decompose().rotation):h;l.push(this.getChangesToTranslateShape(c,b.Add(c,f)))}),this.updateShapes(l),this}distributeShapes(n,r){const s=typeof n[0]=="string"?n:n.map(w=>w.id);if(this.getInstanceState().isReadonly)return this;if(s.length<3)return this;const i=s.length,o=Le(s.map(w=>this.getShape(w))),a=Object.fromEntries(o.map(w=>[w.id,this.getShapePageBounds(w)]));let l,c,u,h,p;r==="horizontal"?(l="x",c="minX",u="maxX",h="midX",p="width"):(l="y",c="minY",u="maxY",h="midY",p="height");const f=[],v=o.sort((w,P)=>a[w.id][c]-a[P.id][c])[0],m=o.sort((w,P)=>a[P.id][u]-a[w.id][u])[0],x=a[v.id][h],y=(a[m.id][h]-x)/(i-1),S=x+y;return o.filter(w=>w!==v&&w!==m).sort((w,P)=>a[w.id][h]-a[P.id][h]).forEach((w,P)=>{const E={x:0,y:0};E[l]=S+y*P-a[w.id][p]/2-a[w.id][l];const M=this.getShapeParent(w),I=M?b.Rot(E,-this.getShapePageTransform(M).rotation()):E;f.push(this.getChangesToTranslateShape(w,b.Add(w,I)))}),this.updateShapes(f),this}stretchShapes(n,r){const s=typeof n[0]=="string"?n:n.map(c=>c.id);if(this.getInstanceState().isReadonly)return this;if(s.length<2)return this;const i=Le(s.map(c=>this.getShape(c))),o=Object.fromEntries(s.map(c=>[c,this.getShapeGeometry(c).bounds])),a=Object.fromEntries(s.map(c=>[c,this.getShapePageBounds(c)])),l=fe.Common(Le(Object.values(a)));switch(r){case"vertical":{this.run(()=>{for(const c of i){if(this.getShapePageTransform(c).rotation()%it)continue;const h=o[c.id],p=a[c.id],f=new b(0,l.minY-p.minY),v=this.getShapeParentTransform(c);v&&f.rot(-v.rotation());const{x:m,y:x}=b.Add(f,c);this.updateShapes([{id:c.id,type:c.type,x:m,y:x}]);const y=new b(1,l.height/p.height);this.resizeShape(c.id,y,{initialBounds:h,scaleOrigin:new b(p.center.x,l.minY),isAspectRatioLocked:this.getShapeUtil(c).isAspectRatioLocked(c),scaleAxisRotation:0})}});break}case"horizontal":{this.run(()=>{for(const c of i){const u=o[c.id],h=a[c.id];if(this.getShapePageTransform(c).rotation()%it)continue;const f=new b(l.minX-h.minX,0),v=this.getShapeParentTransform(c);v&&f.rot(-v.rotation());const{x:m,y:x}=b.Add(f,c);this.updateShapes([{id:c.id,type:c.type,x:m,y:x}]);const y=new b(l.width/h.width,1);this.resizeShape(c.id,y,{initialBounds:u,scaleOrigin:new b(l.minX,h.center.y),isAspectRatioLocked:this.getShapeUtil(c).isAspectRatioLocked(c),scaleAxisRotation:0})}});break}}return this}resizeShape(n,r,s={}){var v,m,x;const i=typeof n=="string"?n:n.id;if(this.getInstanceState().isReadonly)return this;Number.isFinite(r.x)||(r=new b(1,r.y)),Number.isFinite(r.y)||(r=new b(r.x,1));const o=s.initialShape??this.getShape(i);if(!o)return this;const a=s.scaleOrigin??((v=this.getShapePageBounds(i))==null?void 0:v.center);if(!a)return this;const l=s.initialPageTransform?xe.Cast(s.initialPageTransform):this.getShapePageTransform(i);if(!l)return this;const c=l.rotation();if(c==null)return this;const u=s.scaleAxisRotation??c,h=s.initialBounds??this.getShapeGeometry(i).bounds;if(!h)return this;const p=s.isAspectRatioLocked??this.getShapeUtil(o).isAspectRatioLocked(o);if(!YI(c,u))return this._resizeUnalignedShape(i,r,{...s,initialBounds:h,scaleOrigin:a,scaleAxisRotation:u,initialPageTransform:l,isAspectRatioLocked:p,initialShape:o});const f=this.getShapeUtil(o);if(p&&(Math.abs(r.x)>Math.abs(r.y)?r=new b(r.x,Math.sign(r.y)*Math.abs(r.x)):r=new b(Math.sign(r.x)*Math.abs(r.y),r.y)),f.onResize&&f.canResize(o)){const y=this._scalePagePoint(xe.applyToPoint(l,new b(0,0)),a,r,u),S=this.getPointInParentSpace(o.id,y),w=new b(r.x,r.y),P=ea((c-u)%Math.PI,0);w.x=P?r.x:r.y,w.y=P?r.y:r.x;const E=xe.applyToPoint(l,new b),{x:M,y:I}=this.getPointInParentSpace(o.id,E);let _=o;s.skipStartAndEndCallbacks||(_=Qs(o,((m=f.onResizeStart)==null?void 0:m.call(f,o))??void 0)),_=Qs(_,{id:i,type:o.type,x:S.x,y:S.y,...f.onResize({...o,x:M,y:I},{newPoint:S,handle:s.dragHandle??"bottom_right",mode:s.mode??"scale_shape",scaleX:w.x,scaleY:w.y,initialBounds:h,initialShape:o})}),s.skipStartAndEndCallbacks||(_=Qs(_,((x=f.onResizeEnd)==null?void 0:x.call(f,o,_))??void 0)),this.updateShapes([_])}else{const y=xe.applyToPoint(l,h.center),S=this._scalePagePoint(y,a,r,u),w=this.getPointInParentSpace(o.id,y),P=this.getPointInParentSpace(o.id,S),E=b.Sub(P,w);this.updateShapes([{id:i,type:o.type,x:o.x+E.x,y:o.y+E.y}])}return this}_scalePagePoint(n,r,s,i){const o=b.RotWith(n,r,-i).sub(r),a=b.MulV(o,s);return b.Add(a,r).rotWith(r,i)}_resizeUnalignedShape(n,r,s){const{type:i}=s.initialShape,o=new b(r.x,r.y);if(Math.abs(r.x)>Math.abs(r.y)?o.x=Math.sign(r.x)*Math.abs(r.y):o.y=Math.sign(r.y)*Math.abs(r.x),this.resizeShape(n,o,{initialShape:s.initialShape,initialBounds:s.initialBounds,isAspectRatioLocked:s.isAspectRatioLocked}),Math.sign(r.x)*Math.sign(r.y)<0){let{rotation:y}=xe.Decompose(s.initialPageTransform);y-=2*y,this.updateShapes([{id:n,type:i,rotation:y}])}const a=xe.applyToPoint(s.initialPageTransform,s.initialBounds.center),l=this._scalePagePoint(a,s.scaleOrigin,r,s.scaleAxisRotation),c=this.getShapePageBounds(n),u=this.getShapePageTransform(n),h=c.center,p=u.point();if(!h||!p)return this;const f=b.Sub(l,h),v=b.Add(p,f),{x:m,y:x}=this.getPointInParentSpace(n,v);return this.updateShapes([{id:n,type:i,x:m,y:x}]),this}getInitialMetaForShape(n){return{}}createShape(n){return this.createShapes([n]),this}createShapes(n){if(!Array.isArray(n))throw Error("Editor.createShapes: must provide an array of shapes or shape partials");if(this.getInstanceState().isReadonly)return this;if(n.length<=0)return this;const r=this.getCurrentPageShapeIds();if(n.length+r.size>this.options.maxShapesPerPage)return D0(this),this;const i=this.getFocusedGroupId();return this.run(()=>{var h,p;const o=this.getCurrentPageShapesSorted(),a=n.map(f=>{if(f.id||(f={id:ot(),...f}),!f.parentId||!(this.store.has(f.parentId)||n.some(v=>v.id===f.parentId))){let v=this.getFocusedGroupId();for(let x=o.length-1;x>=0;x--){const y=o[x];if(this.getShapeUtil(y).canReceiveNewChildrenOfType(y,f.type)&&this.isPointInShape(y,{x:f.x??0,y:f.y??0},{margin:0,hitInside:!0})){v=y.id;break}}const m=f.parentId;if(v===f.id&&(v=i),v!==m&&(f={...f},f.parentId=v,fr(v))){const x=this.getPointInShapeSpace(this.getShape(v),{x:f.x??0,y:f.y??0});f.x=x.x,f.y=x.y,f.rotation=-this.getShapePageTransform(v).rotation()+(f.rotation??0)}}return f}),l=new Map,c=[],{opacityForNextShape:u}=this.getInstanceState();for(const f of a){const v=this.getShapeUtil(f);let m=f.index;if(!m){const w=f.parentId??i;l.has(w)||l.set(w,this.getHighestIndexForParent(w)),m=l.get(w),l.set(w,js(m))}const x=v.getDefaultProps();for(const[w,P]of this.styleProps[f.type])x[P]=this.getStyleForNextShape(w);let y=this.store.schema.types.shape.create({...f,index:m,opacity:f.opacity??u,parentId:f.parentId??i,props:"props"in f?{...x,...f.props}:x});if(y.index===void 0)throw Error("no index!");const S=(p=(h=this.getShapeUtil(y)).onBeforeCreate)==null?void 0:p.call(h,y);S&&(y=S),c.push(y)}c.forEach(f=>{f.meta={...this.getInitialMetaForShape(f),...f.meta}}),this.store.put(c)}),this}animateShape(n,r={animation:oy}){return this.animateShapes([n],r)}animateShapes(n,r={animation:oy}){if(!r.animation)return this;const{duration:s=500,easing:i=dn.linear}=r.animation,o=dt();let a=s,l;const c=[];let u,h;for(let f=0,v=n.length;f<v;f++){if(u=n[f],!u)continue;const m=this.getShape(u.id);m&&(h={start:yt(m),end:Qs(yt(m),u)},c.push(h),this.animatingShapes.set(m.id,o))}const p=f=>{var y,S;if(a-=f,a<0){const{animatingShapes:w}=this,P=n.filter(E=>E&&w.get(E.id)===o);P.length&&this.updateShapes(P),this.off("tick",p);return}l=i(1-a/s);const{animatingShapes:v}=this,m=[];let x;for(let w=0,P=c.length;w<P;w++){const{start:E,end:M}=c[w];x=v.get(E.id),x===o&&m.push({...M,x:E.x+(M.x-E.x)*l,y:E.y+(M.y-E.y)*l,opacity:E.opacity+(M.opacity-E.opacity)*l,rotation:E.rotation+(M.rotation-E.rotation)*l,props:((S=(y=this.getShapeUtil(M)).getInterpolatedProps)==null?void 0:S.call(y,E,M,l))??M.props})}this._updateShapes(m)};return this.on("tick",p),this}groupShapes(n,r={}){var m;const{groupId:s=ot(),select:i=!0}=r;if(!Array.isArray(n))throw Error("Editor.groupShapes: must provide an array of shapes or shape ids");if(this.getInstanceState().isReadonly)return this;const o=typeof n[0]=="string"?n:n.map(x=>x.id);if(o.length<=1)return this;const a=Le((this._shouldIgnoreShapeLock?o:this._getUnlockedShapeIds(o)).map(x=>this.getShape(x))),l=a.sort(Un).map(x=>x.id),c=fe.Common(Le(a.map(x=>this.getShapePageBounds(x)))),{x:u,y:h}=c.point,p=this.findCommonAncestor(a)??this.getCurrentPageId();if(this.getCurrentToolId()!=="select")return this;this.isIn("select.idle")||this.cancel();const f=a.filter(x=>x.parentId===p).sort(Un),v=(m=f[f.length-1])==null?void 0:m.index;return this.run(()=>{this.createShapes([{id:s,type:"group",parentId:p,index:v,x:u,y:h,opacity:1,props:{}}]),this.reparentShapes(l,s),i&&this.select(s)}),this}ungroupShapes(n,r={}){if(this.getInstanceState().isReadonly)return this;const{select:s=!0}=r,i=typeof n[0]=="string"?n:n.map(c=>c.id),o=Le((this._shouldIgnoreShapeLock?i:this._getUnlockedShapeIds(i)).map(c=>this.getShape(c)));if(o.length===0)return this;if(this.getCurrentToolId()!=="select")return this;this.isIn("select.idle")||this.cancel();const a=new Set,l=[];return o.forEach(c=>{this.isShapeOfType(c,"group")?l.push(c):a.add(c.id)}),l.length===0?this:(this.run(()=>{let c;for(let u=0,h=l.length;u<h;u++){c=l[u];const p=this.getSortedChildIdsForParent(c.id);for(let f=0,v=p.length;f<v;f++)a.add(p[f]);this.reparentShapes(p,c.parentId,c.index)}this.deleteShapes(l.map(u=>u.id)),s&&this.select(...a)}),this)}updateShape(n){return this.updateShapes([n]),this}updateShapes(n){const r=Array(n.length);for(let s=0,i=n.length;s<i;s++){const o=n[s];if(!o)continue;const a=this.getShape(o.id);if(a){if(!this._shouldIgnoreShapeLock){if(a.isLocked){if(!(Object.hasOwn(o,"isLocked")&&!o.isLocked))continue}else if(this.isShapeOrAncestorLocked(a))continue}this.animatingShapes.delete(o.id),r.push(o)}}return this._updateShapes(r),this}_getUnlockedShapeIds(n){return n.filter(r=>{var s;return!((s=this.getShape(r))!=null&&s.isLocked)})}deleteShapes(n){if(this.getInstanceState().isReadonly)return this;if(!Array.isArray(n))throw Error("Editor.deleteShapes: must provide an array of shapes or shapeIds");const r=typeof n[0]=="string"?n:n.map(o=>o.id),s=this._shouldIgnoreShapeLock?r:this._getUnlockedShapeIds(r);if(s.length===0)return this;const i=new Set(s);for(const o of s)this.visitDescendants(o,a=>{i.add(a)});return this.run(()=>this.store.remove([...i]))}deleteShape(n){return this.deleteShapes([typeof n=="string"?n:n.id]),this}_extractSharedStyles(n,r){if(this.isShapeOfType(n,"group")){const s=this._parentIdsToChildIds.get()[n.id];if(!s)return;for(let i=0,o=s.length;i<o;i++)this._extractSharedStyles(this.getShape(s[i]),r)}else for(const[s,i]of this.styleProps[n.type])r.applyValue(s,xr(n.props,i))}_getSelectionSharedStyles(){const n=this.getSelectedShapes(),r=new q2;for(const s of n)this._extractSharedStyles(s,r);return r}getStyleForNextShape(n){const r=this.getInstanceState().stylesForNextShape[n.id];return r===void 0?n.defaultValue:r}getShapeStyleIfExists(n,r){const s=this.styleProps[n.type].get(r);if(s!==void 0)return xr(n.props,s)}getSharedStyles(){if(this.isIn("select")&&this.getSelectedShapeIds().length>0)return this._getSelectionSharedStyles();const n=this.root.getCurrent(),r=new q2;if(!n)return r;if(n.shapeType)for(const s of this.styleProps[n.shapeType].keys())r.applyValue(s,this.getStyleForNextShape(s));return r}getSharedOpacity(){if(this.isIn("select")&&this.getSelectedShapeIds().length>0){const n=[],r=i=>{const o=this.getShape(i);if(o)if(this.isShapeOfType(o,"group"))for(const a of this.getSortedChildIdsForParent(o.id))r(a);else n.push(o)};for(const i of this.getSelectedShapeIds())r(i);let s=null;for(const i of n)if(s===null)s=i.opacity;else if(s!==i.opacity)return{type:"mixed"};if(s!==null)return{type:"shared",value:s}}return{type:"shared",value:this.getInstanceState().opacityForNextShape}}setOpacityForNextShapes(n,r){return this.updateInstanceState({opacityForNextShape:n},r),this}setOpacityForSelectedShapes(n){const r=this.getSelectedShapes();if(r.length>0){const s=[],i=o=>{if(this.isShapeOfType(o,"group")){const a=this.getSortedChildIdsForParent(o);for(const l of a)i(this.getShape(l))}else s.push(o)};for(const o of r)i(o);this.updateShapes(s.map(o=>({id:o.id,type:o.type,opacity:n})))}return this}setStyleForNextShapes(n,r,s){const i=this.getInstanceState().stylesForNextShape;return this.updateInstanceState({stylesForNextShape:{...i,[n.id]:r}},s),this}setStyleForSelectedShapes(n,r){const s=this.getSelectedShapes();if(s.length>0){const i=[],o=a=>{if(this.isShapeOfType(a,"group")){const l=this.getSortedChildIdsForParent(a.id);for(const c of l)o(this.getShape(c))}else{const l=this.getShapeUtil(a),c=this.styleProps[a.type].get(n);if(c){const u={id:a.id,type:a.type,props:{[c]:r}};i.push({util:l,originalShape:a,updatePartial:u})}}};for(const a of s)o(a);this.updateShapes(i.map(({updatePartial:a})=>a))}return this}registerExternalAssetHandler(n,r){return this.externalAssetContentHandlers[n]=r,this}async getAssetForExternalContent(n){var r,s;return await((s=(r=this.externalAssetContentHandlers)[n.type])==null?void 0:s.call(r,n))}hasExternalAssetHandler(n){return!!this.externalAssetContentHandlers[n]}registerExternalContentHandler(n,r){return this.externalContentHandlers[n]=r,this}async putExternalContent(n){var r,s;return(s=(r=this.externalContentHandlers)[n.type])==null?void 0:s.call(r,n)}getContentFromCurrentPage(n){const r=typeof n[0]=="string"?n:n.map(i=>i.id);if(!r||r.length===0)return;const s=this.getShapeAndDescendantIds(r);return Z6(this,s,i=>{const o=[];for(const h of i){const p=this.getBinding(h);p&&o.push(p)}const a=[],l=[];for(const h of s){const p=this.getShape(h);if(!p)continue;if(!s.has(p.parentId)){const v=this.getShapePageTransform(p.id),m=v.point();l.push({...p,x:m.x,y:m.y,rotation:v.rotation(),parentId:this.getCurrentPageId()}),a.push(p.id)}else l.push(p)}const c=[],u=new Set;for(const h of l){if(!("assetId"in h.props))continue;const p=h.props.assetId;if(!p||u.has(p))continue;u.add(p);const f=this.getAsset(p);f&&c.push(f)}return{schema:this.store.schema.serialize(),shapes:l,rootShapeIds:a,bindings:o,assets:c}})}async resolveAssetsInContent(n){if(!n)return;const r=[];return await Promise.allSettled(n.assets.map(async s=>{var i,o;if((s.type==="image"||s.type==="video")&&!((i=s.props.src)!=null&&i.startsWith("data:image"))&&!((o=s.props.src)!=null&&o.startsWith("http"))){const a=yt(s),l=await this.store.props.assets.resolve(s,{screenScale:1,steppedScreenScale:1,dpr:1,networkEffectiveType:null,shouldResolveToOriginal:!0});a.props.src=await Za.blobToDataUrl(await yi(l).then(c=>c.blob())),r.push(a)}else r.push(s)})),n.assets=r,n}putContentOntoCurrentPage(n,r={}){var $,U;if(this.getInstanceState().isReadonly)return this;if(!n.schema)throw Error(`Could not put content:
content is missing a schema.`);const{select:s=!1,preserveIds:i=!1,preservePosition:o=!1}=r;let{point:a=void 0}=r;const l=this.getCurrentPageId(),{rootShapeIds:c}=n,u=[],h=[],p=[],f={store:{...Object.fromEntries(n.assets.map(O=>[O.id,O])),...Object.fromEntries(n.shapes.map(O=>[O.id,O])),...Object.fromEntries((($=n.bindings)==null?void 0:$.map(O=>[O.id,O]))??[])},schema:n.schema},v=this.store.schema.migrateStoreSnapshot(f);if(v.type==="error")throw Error("Could not put content: could not migrate content");for(const O of Object.values(v.value))switch(O.typeName){case"asset":{u.push(O);break}case"shape":{h.push(O);break}case"binding":{p.push(O);break}}const m=new Map(i?h.map(O=>[O.id,O.id]):h.map(O=>[O.id,ot()])),x=new Map(i?p.map(O=>[O.id,O.id]):p.map(O=>[O.id,Qa()]));let y=this.getCurrentPageId(),S=1/0,w=[];for(const O of this.getSelectedShapes()){if(S===0)break;const N=this.isShapeOfType(O,"frame"),H=this.getShapeAncestors(O);N&&H.push(O);const Z=N?H.length+1:H.length;if(Z<S)S=Z,w=H,y=N?O.id:O.parentId;else if(Z===S){if(w.length!==H.length)throw Error(`Ancestors: ${w.length} !== ${H.length}`);if(w.length===0){y=l;break}else{y=l;for(let q=0;q<w.length&&H[q]===w[q];q++)y=H[q].id}}}let P=!1;if(!dr(y)){const O=this.getShape(y);if(O){if(!this.getViewportPageBounds().includes(this.getShapePageBounds(O)))y=l;else if(c.length===1){const N=h.find(H=>H.id===c[0]);this.isShapeOfType(O,"frame")&&this.isShapeOfType(N,"frame")&&N.props.w===(O==null?void 0:O.props.w)&&N.props.h===(O==null?void 0:O.props.h)&&(P=!0)}}else y=l}P||(P=m.has(y)),P&&(y=this.getShape(y).parentId);let E=this.getHighestIndexForParent(y);const M=[],I=h.map(O=>{const N=m.get(O.id),H={...O,id:N};return c.includes(O.id)&&(H.parentId=l,M.push(H)),m.has(H.parentId)?H.parentId=m.get(O.parentId):(c.push(H.id),H.index=E,E=js(E)),H});if(I.length+this.getCurrentPageShapeIds().size>this.options.maxShapesPerPage)return D0(this),this;const _=p.map(O=>({...O,id:as(x.get(O.id)),fromId:as(m.get(O.fromId)),toId:as(m.get(O.toId))})),D=[],R=[];for(const O of u)this.store.has(O.id)||((O.type==="image"||O.type==="video")&&((U=O.props.src)!=null&&U.startsWith("data:image"))&&(R.push(yt(O)),O.props.src=null),D.push(O));return Promise.allSettled(R.map(async O=>{const N=await rZ(O.props.src,O.props.name,O.props.mimeType??"image/png"),H=await this.getAssetForExternalContent({type:"file",file:N});if(!H){this.deleteAssets([O.id]);return}this.updateAssets([{...H,id:O.id}])})),this.run(()=>{D.length>0&&this.createAssets(D),this.createShapes(I),this.createBindings(_),s&&this.select(...M.map(q=>q.id)),y!==l&&this.reparentShapes(M.map(q=>q.id),y);const O=I.map(q=>this.getShape(q.id)),N=fe.Common(O.map(q=>this.getShapePageBounds(q)));if(a===void 0)if(dr(y)){const q=this.getViewportPageBounds();o||q.includes(fe.From(N))?a=N.center:a=q.center}else{const q=this.getShape(y);a=xe.applyToPoint(this.getShapePageTransform(q),this.getShapeGeometry(q).bounds.center)}if(M.length===1){const q=M[0];if(this.isShapeOfType(q,"frame"))for(;this.getShapesAtPoint(a).some(V=>this.isShapeOfType(V,"frame")&&V.props.w===q.props.w&&V.props.h===q.props.h);)a.x+=N.w+16}const H=fe.Common(Le(M.map(({id:q})=>this.getShapePageBounds(q)))).center,Z=b.Sub(a,H);this.updateShapes(M.map(({id:q})=>{const V=this.getShape(q),Q=this.getShapeParentTransform(q).decompose().rotation,ne=b.Rot(Z,-Q);return{id:V.id,type:V.type,x:V.x+ne.x,y:V.y+ne.y}}))}),this}async getSvgElement(n,r={}){const s=await mZ(this,n,r);if(!s)return;const i=document.createDocumentFragment(),o=bP(i);xl.flushSync(()=>{o.render(s.jsx)});const a=i.firstElementChild;return We(a instanceof SVGSVGElement,"Expected an SVG element"),o.unmount(),{svg:a,width:s.width,height:s.height}}async getSvgString(n,r={}){const s=await this.getSvgElement(n,r);return s?{svg:new XMLSerializer().serializeToString(s.svg),width:s.width,height:s.height}:void 0}async getSvg(n,r={}){const s=await this.getSvgElement(n,r);if(s)return s.svg}_updateInputsFromEvent(n){const{pointerVelocity:r,previousScreenPoint:s,previousPagePoint:i,currentScreenPoint:o,currentPagePoint:a}=this.inputs,{screenBounds:l}=this.store.unsafeGetWithoutCapture(Fn),{x:c,y:u,z:h}=w0(()=>this.getCamera()),p=n.point.x-l.x,f=n.point.y-l.y,v=n.point.z??.5;s.setTo(o),i.setTo(a),o.set(p,f);const m=p/h-c,x=f/h-u;isFinite(m)&&isFinite(x)&&a.set(m,x,v),this.inputs.isPen=n.type==="pointer"&&n.isPen,(n.name==="pointer_down"||this.inputs.isPinching)&&(r.set(0,0),this.inputs.originScreenPoint.setTo(o),this.inputs.originPagePoint.setTo(a)),this.run(()=>{var y;this.store.put([{id:Xd,typeName:"pointer",x:a.x,y:a.y,lastActivityTimestamp:n.type==="pointer"&&n.pointerId===k6.CAMERA_MOVE?((y=this.store.unsafeGetWithoutCapture(Xd))==null?void 0:y.lastActivityTimestamp)??this._tickManager.now:this._tickManager.now,meta:{}}])},{history:"ignore"})}cancel(){return this.dispatch({type:"misc",name:"cancel"}),this}interrupt(){return this.dispatch({type:"misc",name:"interrupt"}),this}complete(){return this.dispatch({type:"misc",name:"complete"}),this}focus({focusContainer:n=!0}={}){return this.getIsFocused()?this:(n&&this.focusManager.focus(),this.updateInstanceState({isFocused:!0}),this)}blur({blurContainer:n=!0}={}){return this.getIsFocused()?(n?this.focusManager.blur():this.complete(),this.updateInstanceState({isFocused:!1}),this):this}getIsFocused(){return this.getInstanceState().isFocused}getSnapshot(){return qX(this.store)}loadSnapshot(n){return jE(this.store,n),this}cancelDoubleClick(){this._clickManager.cancelDoubleClickTimeout()}_flushEventsForTick(n){this.run(()=>{if(this._pendingEventsForNextTick.length>0){const r=[...this._pendingEventsForNextTick];this._pendingEventsForNextTick.length=0;for(const s of r)this._flushEventForTick(s)}n>0&&this.root.handleEvent({type:"misc",name:"tick",elapsed:n}),this.scribbles.tick(n)})}maybeTrackPerformance(n){Vt.measurePerformance.get()&&(this.performanceTracker.isStarted()?clearTimeout(this.performanceTrackerTimeout):this.performanceTracker.start(n),this.performanceTrackerTimeout=this.timers.setTimeout(()=>{this.performanceTracker.stop()},50))}}ye([ee],he.prototype,"getCanUndo");ye([ee],he.prototype,"getCanRedo");ye([ee],he.prototype,"getPath");ye([ee],he.prototype,"getCurrentTool");ye([ee],he.prototype,"getCurrentToolId");ye([ee],he.prototype,"getDocumentSettings");ye([ee],he.prototype,"getInstanceState");ye([ee],he.prototype,"getOpenMenus");ye([ee],he.prototype,"getIsMenuOpen");ye([ee],he.prototype,"getPageStates");ye([ee],he.prototype,"_getPageStatesQuery");ye([ee],he.prototype,"getCurrentPageState");ye([ee],he.prototype,"_getCurrentPageStateId");ye([ee],he.prototype,"getSelectedShapeIds");ye([ee],he.prototype,"getSelectedShapes");ye([ee],he.prototype,"getOnlySelectedShapeId");ye([ee],he.prototype,"getOnlySelectedShape");ye([ee],he.prototype,"getSelectionPageBounds");ye([ee],he.prototype,"getSelectionRotation");ye([ee],he.prototype,"getSelectionRotatedPageBounds");ye([ee],he.prototype,"getSelectionRotatedScreenBounds");ye([ee],he.prototype,"getFocusedGroupId");ye([ee],he.prototype,"getFocusedGroup");ye([ee],he.prototype,"getEditingShapeId");ye([ee],he.prototype,"getEditingShape");ye([ee],he.prototype,"getHoveredShapeId");ye([ee],he.prototype,"getHoveredShape");ye([ee],he.prototype,"getHintingShapeIds");ye([ee],he.prototype,"getHintingShape");ye([ee],he.prototype,"getErasingShapeIds");ye([ee],he.prototype,"getErasingShapes");ye([ee],he.prototype,"_unsafe_getCameraId");ye([ee],he.prototype,"getCamera");ye([ee],he.prototype,"getViewportPageBoundsForFollowing");ye([ee],he.prototype,"getCameraForFollowing");ye([ee],he.prototype,"getZoomLevel");ye([ee],he.prototype,"getViewportScreenBounds");ye([ee],he.prototype,"getViewportScreenCenter");ye([ee],he.prototype,"getViewportPageBounds");ye([ee],he.prototype,"_getCollaboratorsQuery");ye([ee],he.prototype,"getCollaborators");ye([ee],he.prototype,"getCollaboratorsOnCurrentPage");ye([ee],he.prototype,"getRenderingShapes");ye([ee],he.prototype,"_getAllPagesQuery");ye([ee],he.prototype,"getPages");ye([ee],he.prototype,"getCurrentPageId");ye([ee],he.prototype,"getCurrentPageShapeIdsSorted");ye([ee],he.prototype,"_getAllAssetsQuery");ye([ee],he.prototype,"_getShapeGeometryCache");ye([ee],he.prototype,"_getShapeHandlesCache");ye([ee],he.prototype,"_getShapePageTransformCache");ye([ee],he.prototype,"_getShapePageBoundsCache");ye([ee],he.prototype,"_getShapeClipPathCache");ye([ee],he.prototype,"_getShapeMaskCache");ye([ee],he.prototype,"_getShapeMaskedPageBoundsCache");ye([ee],he.prototype,"_notVisibleShapes");ye([ee],he.prototype,"getCulledShapes");ye([ee],he.prototype,"getCurrentPageBounds");ye([ee],he.prototype,"getCurrentPageShapes");ye([ee],he.prototype,"getCurrentPageShapesSorted");ye([ee],he.prototype,"getCurrentPageRenderingShapesSorted");ye([ee],he.prototype,"_getBindingsIndexCache");ye([ee],he.prototype,"_getSelectionSharedStyles");ye([ee({isEqual:(t,e)=>t.equals(e)})],he.prototype,"getSharedStyles");ye([ee],he.prototype,"getSharedOpacity");ye([ee],he.prototype,"getIsFocused");function D0(t,e=t.getCurrentPageId()){const n=t.getPage(e).name;t.emit("max-shapes",{name:n,pageId:e,count:t.options.maxShapesPerPage})}function Qs(t,e){if(!e)return t;let n=null;const r=Object.entries(e);for(let s=0,i=r.length;s<i;s++){const[o,a]=r[s];if(a!==void 0&&!(o==="id"||o==="type"||o==="typeName")&&a!==t[o]){if(n||(n={...t}),o==="props"||o==="meta"){n[o]={...t[o]};for(const[l,c]of Object.entries(a))c!==void 0&&(n[o][l]=c);continue}n[o]=a}}return n||t}function UE(t,e,n){const r=t.getShape(e);if(!r)return;n.push(r);const s=t.getSortedChildIdsForParent(e);for(let i=0,o=s.length;i<o;i++)UE(t,s[i],n)}function Z6(t,e,n){let r;if(t.run(()=>{const s=t.store.extractingChanges(()=>{const i=new Set,o=new Set;for(const a of e)if(t.getShape(a))for(const c of t.getBindingsInvolvingShape(a)){const u=e.has(c.fromId),h=e.has(c.toId);if(u&&h){i.add(c.id);continue}(!u||!h)&&o.add(c.id)}t.deleteBindings([...o],{isolateShapes:!0});try{r=Qo.ok(n(i))}catch(a){r=Qo.err(a)}});t.store.applyDiff(qd(s))},{history:"ignore"}),r.ok)return r.value;throw r.error}function Q6(t,e){if(!e.constraints)throw Error("Should have constraints here");const{padding:{x:n,y:r}}=e.constraints,s=t.getViewportScreenBounds(),i=fe.From(e.constraints.bounds),o=(s.w-n*2)/i.w,a=(s.h-r*2)/i.h;return{zx:o,zy:a}}function Dh(){const t=G(),e=$E();return J("isDarkMode",()=>(e==null?void 0:e.isDarkMode)??t.user.getIsDarkMode(),[e,t])}const J6="<path d='m19.7432 17.0869-4.072 4.068 2.829 2.828-8.473-.013-.013-8.47 2.841 2.842 4.075-4.068 1.414-1.415-2.844-2.842h8.486v8.484l-2.83-2.827z' fill='%23fff'/><path d='m18.6826 16.7334-4.427 4.424 1.828 1.828-5.056-.016-.014-5.054 1.842 1.841 4.428-4.422 2.474-2.475-1.844-1.843h5.073v5.071l-1.83-1.828z' fill='%23000'/>",e7="<path d='m9 17.9907v.005l5.997 5.996.001-3.999h1.999 2.02v4l5.98-6.001-5.98-5.999.001 4.019-2.021.002h-2l.001-4.022zm1.411.003 3.587-3.588-.001 2.587h3.5 2.521v-2.585l3.565 3.586-3.564 3.585-.001-2.585h-2.521l-3.499-.001-.001 2.586z' fill='%23fff'/><path d='m17.4971 18.9932h2.521v2.586l3.565-3.586-3.565-3.585v2.605h-2.521-3.5v-2.607l-3.586 3.587 3.586 3.586v-2.587z' fill='%23000'/>",j0='<path d="M22.4789 9.45728L25.9935 12.9942L22.4789 16.5283V14.1032C18.126 14.1502 14.6071 17.6737 14.5675 22.0283H17.05L13.513 25.543L9.97889 22.0283H12.5674C12.6071 16.5691 17.0214 12.1503 22.4789 12.1031L22.4789 9.45728Z" fill="black"/><path fill-rule="evenodd" clip-rule="evenodd" d="M21.4789 7.03223L27.4035 12.9945L21.4789 18.9521V15.1868C18.4798 15.6549 16.1113 18.0273 15.649 21.0284H19.475L13.5128 26.953L7.55519 21.0284H11.6189C12.1243 15.8155 16.2679 11.6677 21.4789 11.1559L21.4789 7.03223ZM22.4789 12.1031C17.0214 12.1503 12.6071 16.5691 12.5674 22.0284H9.97889L13.513 25.543L17.05 22.0284H14.5675C14.5705 21.6896 14.5947 21.3558 14.6386 21.0284C15.1157 17.4741 17.9266 14.6592 21.4789 14.1761C21.8063 14.1316 22.1401 14.1069 22.4789 14.1032V16.5284L25.9935 12.9942L22.4789 9.45729L22.4789 12.1031Z" fill="white"/>';function Io(t,e,n,r,s,i=16,o=16){const a=(-n-e)*(Qe/180),l=Math.sin(a),c=Math.cos(a),u=1*c-1*l,h=1*l+1*c;return`url("data:image/svg+xml,<svg height='32' width='32' viewBox='0 0 32 32' xmlns='http://www.w3.org/2000/svg' style='color: ${s};'><defs><filter id='shadow' y='-40%' x='-40%' width='180px' height='180%' color-interpolation-filters='sRGB'><feDropShadow dx='${u}' dy='${h}' stdDeviation='1.2' flood-opacity='.5'/></filter></defs><g fill='none' transform='rotate(${e+n} 16 16)${r?" scale(-1,-1) translate(0, -32)":""}' filter='url(%23shadow)'>`+t.replaceAll('"',"'")+`</g></svg>") ${i} ${o}, pointer`}const YZ=["default","pointer","cross","move","grab","grabbing","text","zoom-in","zoom-out"],XZ={none:()=>"none","ew-resize":(t,e,n)=>Io(e7,t,0,e,n),"ns-resize":(t,e,n)=>Io(e7,t,90,e,n),"nesw-resize":(t,e,n)=>Io(J6,t,0,e,n),"nwse-resize":(t,e,n)=>Io(J6,t,90,e,n),"nwse-rotate":(t,e,n)=>Io(j0,t,0,e,n),"nesw-rotate":(t,e,n)=>Io(j0,t,90,e,n),"senw-rotate":(t,e,n)=>Io(j0,t,180,e,n),"swne-rotate":(t,e,n)=>Io(j0,t,270,e,n)};function jr(t,e=0,n="black"){return XZ[t](xq(e),!1,n)}function ZZ(){const t=G(),e=mn(),n=Dh();Jo("useCursor",()=>{const{type:r,rotation:s}=t.getInstanceState().cursor;if(YZ.includes(r)){e.style.setProperty("--tl-cursor",`var(--tl-cursor-${r})`);return}e.style.setProperty("--tl-cursor",jr(r,s,n?"white":"black"))},[t,e,n])}function QZ(){const t=G(),e=mn(),n=Dh(),r=J(Vt.forceSrgb);Ne.useEffect(()=>{n?(e.setAttribute("data-color-mode","dark"),e.classList.remove("tl-theme__light"),e.classList.add("tl-theme__dark")):(e.setAttribute("data-color-mode","light"),e.classList.remove("tl-theme__dark"),e.classList.add("tl-theme__light")),r?e.classList.add("tl-theme__force-sRGB"):e.classList.remove("tl-theme__force-sRGB")},[t,e,r,n])}function HE(t){const e=C.useRef();return C.useLayoutEffect(()=>{e.current=t}),C.useDebugValue(t),C.useCallback((...n)=>{const r=e.current;return We(r,"fn does not exist"),r(...n)},[])}function JZ(){const[t,e]=C.useState(0);C.useEffect(()=>e(n=>n+1),[])}const eQ=t=>t.props.src,tQ={upload:(t,e)=>Za.blobToDataUrl(e)};function Y2(t){return"schema"in t&&t.schema?t.schema:oq({shapes:"shapeUtils"in t&&t.shapeUtils?t7(NE(t.shapeUtils)):void 0,bindings:"bindingUtils"in t&&t.bindingUtils?t7(RE(t.bindingUtils)):void 0,migrations:"migrations"in t?t.migrations:void 0})}function eh({initialData:t,defaultName:e="",id:n,assets:r=tQ,onMount:s,collaboration:i,...o}={}){const a=Y2(o),l=new v4({id:n,schema:a,initialData:t,props:{defaultName:e,assets:{upload:r.upload,resolve:r.resolve??eQ},onMount:c=>{We(c instanceof he),s==null||s(c)},collaboration:i}});if(o.snapshot){if(t)throw new Error("Cannot provide both initialData and snapshot");jE(l,o.snapshot)}return l}function t7(t){return Object.fromEntries(t.map(e=>[e.type,{props:e.props,migrations:e.migrations}]))}const nQ=(t,e)=>e.some(n=>t instanceof n);let n7,r7;function rQ(){return n7||(n7=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function sQ(){return r7||(r7=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const WE=new WeakMap,X2=new WeakMap,KE=new WeakMap,hy=new WeakMap,$4=new WeakMap;function iQ(t){const e=new Promise((n,r)=>{const s=()=>{t.removeEventListener("success",i),t.removeEventListener("error",o)},i=()=>{n(Yi(t.result)),s()},o=()=>{r(t.error),s()};t.addEventListener("success",i),t.addEventListener("error",o)});return e.then(n=>{n instanceof IDBCursor&&WE.set(n,t)}).catch(()=>{}),$4.set(e,t),e}function oQ(t){if(X2.has(t))return;const e=new Promise((n,r)=>{const s=()=>{t.removeEventListener("complete",i),t.removeEventListener("error",o),t.removeEventListener("abort",o)},i=()=>{n(),s()},o=()=>{r(t.error||new DOMException("AbortError","AbortError")),s()};t.addEventListener("complete",i),t.addEventListener("error",o),t.addEventListener("abort",o)});X2.set(t,e)}let Z2={get(t,e,n){if(t instanceof IDBTransaction){if(e==="done")return X2.get(t);if(e==="objectStoreNames")return t.objectStoreNames||KE.get(t);if(e==="store")return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return Yi(t[e])},set(t,e,n){return t[e]=n,!0},has(t,e){return t instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in t}};function aQ(t){Z2=t(Z2)}function lQ(t){return t===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...n){const r=t.call(py(this),e,...n);return KE.set(r,e.sort?e.sort():[e]),Yi(r)}:sQ().includes(t)?function(...e){return t.apply(py(this),e),Yi(WE.get(this))}:function(...e){return Yi(t.apply(py(this),e))}}function cQ(t){return typeof t=="function"?lQ(t):(t instanceof IDBTransaction&&oQ(t),nQ(t,rQ())?new Proxy(t,Z2):t)}function Yi(t){if(t instanceof IDBRequest)return iQ(t);if(hy.has(t))return hy.get(t);const e=cQ(t);return e!==t&&(hy.set(t,e),$4.set(e,t)),e}const py=t=>$4.get(t);function GE(t,e,{blocked:n,upgrade:r,blocking:s,terminated:i}={}){const o=indexedDB.open(t,e),a=Yi(o);return r&&o.addEventListener("upgradeneeded",l=>{r(Yi(o.result),l.oldVersion,l.newVersion,Yi(o.transaction),l)}),n&&o.addEventListener("blocked",l=>n(l.oldVersion,l.newVersion,l)),a.then(l=>{i&&l.addEventListener("close",()=>i()),s&&l.addEventListener("versionchange",c=>s(c.oldVersion,c.newVersion,c))}).catch(()=>{}),a}function VE(t,{blocked:e}={}){const n=indexedDB.deleteDatabase(t);return e&&n.addEventListener("blocked",r=>e(r.oldVersion,r)),Yi(n).then(()=>{})}const uQ=["get","getKey","getAll","getAllKeys","count"],dQ=["put","add","delete","clear"],fy=new Map;function s7(t,e){if(!(t instanceof IDBDatabase&&!(e in t)&&typeof e=="string"))return;if(fy.get(e))return fy.get(e);const n=e.replace(/FromIndex$/,""),r=e!==n,s=dQ.includes(n);if(!(n in(r?IDBIndex:IDBObjectStore).prototype)||!(s||uQ.includes(n)))return;const i=async function(o,...a){const l=this.transaction(o,s?"readwrite":"readonly");let c=l.store;return r&&(c=c.index(a.shift())),(await Promise.all([c[n](...a),s&&l.done]))[0]};return fy.set(e,i),i}aQ(t=>({...t,get:(e,n,r)=>s7(e,n)||t.get(e,n,r),has:(e,n)=>!!s7(e,n)||t.has(e,n)}));const hQ="TLDRAW_DOCUMENT_v2",pQ="TLDRAW_ASSET_STORE_v1",qE="TLDRAW_DB_NAME_INDEX_v2",He={Records:"records",Schema:"schema",SessionState:"session_state",Assets:"assets"};async function YE(t){const e=hQ+t;return gQ(e),await GE(e,4,{upgrade(n){n.objectStoreNames.contains(He.Records)||n.createObjectStore(He.Records),n.objectStoreNames.contains(He.Schema)||n.createObjectStore(He.Schema),n.objectStoreNames.contains(He.SessionState)||n.createObjectStore(He.SessionState),n.objectStoreNames.contains(He.Assets)||n.createObjectStore(He.Assets)}})}async function fQ(t){const e=window.indexedDB.databases?(await window.indexedDB.databases()).map(p=>p.name):B4(),n=pQ+t;if(!e.find(p=>p===n))return;const s=await GE(n,1,{upgrade(p){p.objectStoreNames.contains("assets")||p.createObjectStore("assets")}}),i=s.transaction(["assets"],"readonly"),o=i.objectStore("assets"),a=await o.getAllKeys(),l=await Promise.all(a.map(async p=>[p,await o.get(p)]));await i.done;const c=await YE(t),u=c.transaction([He.Assets],"readwrite"),h=u.objectStore(He.Assets);for(const[p,f]of l)h.put(f,p);await u.done,s.close(),c.close(),await VE(n)}const kd=class kd{constructor(e){g(this,"getDbPromise");g(this,"isClosed",!1);g(this,"pendingTransactionSet",new Set);kd.connectedInstances.add(this),this.getDbPromise=(async()=>(await fQ(e),await YE(e)))()}getDb(){return this.getDbPromise}pending(){return Promise.allSettled([this.getDbPromise,...this.pendingTransactionSet]).then(Kd)}async close(){this.isClosed||(this.isClosed=!0,await this.pending(),(await this.getDb()).close(),kd.connectedInstances.delete(this))}tx(e,n,r){const s=(async()=>{We(!this.isClosed,"db is closed");const o=(await this.getDb()).transaction(n,e);try{return await r(o)}finally{this.isClosed?o.abort():await o.done}})();return this.pendingTransactionSet.add(s),s.finally(()=>this.pendingTransactionSet.delete(s)),s}async load({sessionId:e}={}){return await this.tx("readonly",[He.Records,He.Schema,He.SessionState],async n=>{var l,c;const r=n.objectStore(He.Records),s=n.objectStore(He.Schema),i=n.objectStore(He.SessionState);let o=e?(l=await i.get(e))==null?void 0:l.snapshot:null;return o||(o=(c=(await i.getAll()).sort((h,p)=>h.updatedAt-p.updatedAt).pop())==null?void 0:c.snapshot),{records:await r.getAll(),schema:await s.get(He.Schema),sessionStateSnapshot:o}})}async storeChanges({schema:e,changes:n,sessionId:r,sessionStateSnapshot:s}){await this.tx("readwrite",[He.Records,He.Schema,He.SessionState],async i=>{const o=i.objectStore(He.Records),a=i.objectStore(He.Schema),l=i.objectStore(He.SessionState);for(const[c,u]of Object.entries(n.added))await o.put(u,c);for(const[c,u]of Object.values(n.updated))await o.put(u,u.id);for(const c of Object.keys(n.removed))await o.delete(c);a.put(e.serialize(),He.Schema),s&&r?l.put({snapshot:s,updatedAt:Date.now(),id:r},r):(s||r)&&console.error("sessionStateSnapshot and instanceId must be provided together")})}async storeSnapshot({schema:e,snapshot:n,sessionId:r,sessionStateSnapshot:s}){await this.tx("readwrite",[He.Records,He.Schema,He.SessionState],async i=>{const o=i.objectStore(He.Records),a=i.objectStore(He.Schema),l=i.objectStore(He.SessionState);await o.clear();for(const[c,u]of Object.entries(n))await o.put(u,c);a.put(e.serialize(),He.Schema),s&&r?l.put({snapshot:s,updatedAt:Date.now(),id:r},r):(s||r)&&console.error("sessionStateSnapshot and instanceId must be provided together")})}async pruneSessions(){await this.tx("readwrite",[He.SessionState],async e=>{const n=e.objectStore(He.SessionState),r=(await n.getAll()).sort((i,o)=>i.updatedAt-o.updatedAt);if(r.length<10){await e.done;return}const s=r.slice(0,r.length-10);for(const{id:i}of s)await n.delete(i)})}async getAsset(e){return await this.tx("readonly",[He.Assets],async n=>await n.objectStore(He.Assets).get(e))}async storeAsset(e,n){await this.tx("readwrite",[He.Assets],async r=>{await r.objectStore(He.Assets).put(n,e)})}};g(kd,"connectedInstances",new Set);let ag=kd;function B4(){const t=JSON.parse(p4(qE)||"[]")??[];return Array.isArray(t)?t:[]}function gQ(t){const e=new Set(B4());e.add(t),f4(qE,JSON.stringify([...e]))}function mQ(){window.alert(`Oops! We could not save changes to your browser's storage. We now need to reload the page and try again.

Keep seeing this message?
• If you're using tldraw in a private or "incognito" window, try loading tldraw in a regular window or in a different browser.
• If your hard disk is full, try clearing up some space and then reload the page.`)}function yQ(){window.alert(`Oops! We could not access your browser's storage—and the app won't work correctly without that. We now need to reload the page and try again.

Keep seeing this message?
• If you're using tldraw in a private or "incognito" window, try loading tldraw in a regular window or in a different browser.`)}const vQ=350,SQ=1e4,i7=Symbol("UPDATE_INSTANCE_STATE"),xQ=t=>t;class wQ{constructor(e){g(this,"onmessage")}postMessage(e){}close(){}}const bQ=typeof BroadcastChannel>"u"?wQ:BroadcastChannel;class CQ{constructor(e,{persistenceKey:n,sessionId:r=Jd,onLoad:s,onLoadError:i},o=new bQ(`tldraw-tab-sync-${n}`)){g(this,"disposables",new Set);g(this,"diffQueue",[]);g(this,"didDispose",!1);g(this,"shouldDoFullDBWrite",!0);g(this,"isReloading",!1);g(this,"persistenceKey");g(this,"sessionId");g(this,"serializedSchema");g(this,"isDebugging",!1);g(this,"documentTypes");g(this,"$sessionStateSnapshot");g(this,"db");g(this,"initTime",Date.now());g(this,"isPersisting",!1);g(this,"didLastWriteError",!1);g(this,"scheduledPersistTimeout",null);this.store=e,this.channel=o,typeof window<"u"&&(window.tlsync=this),this.persistenceKey=n,this.sessionId=r,this.db=new ag(n),this.disposables.add(()=>this.db.close()),this.serializedSchema=this.store.schema.serialize(),this.$sessionStateSnapshot=AE(this.store),this.disposables.add(e.listen(({changes:a})=>{this.diffQueue.push(a),this.channel.postMessage(xQ({type:"diff",storeId:this.store.id,changes:a,schema:this.serializedSchema})),this.schedulePersist()},{source:"user",scope:"document"})),this.disposables.add(e.listen(()=>{this.diffQueue.push(i7),this.schedulePersist()},{scope:"session"})),this.connect(s,i),this.documentTypes=new Set(Object.values(this.store.schema.types).filter(a=>a.scope==="document").map(a=>a.typeName))}debug(...e){this.isDebugging&&console.debug(...e)}async connect(e,n){this.debug("connecting");let r;try{r=await this.db.load({sessionId:this.sessionId})}catch(s){n(s),yQ();return}if(this.debug("loaded data from store",r,"didDispose",this.didDispose),!this.didDispose)try{if(r){const s=Object.fromEntries(r.records.map(a=>[a.id,a])),i=r.sessionStateSnapshot??GX(s),o=this.store.schema.migrateStoreSnapshot({store:s,schema:r.schema??this.store.schema.serializeEarliestVersion()});if(o.type==="error"){console.error("failed to migrate store",o),n(new Error(`Failed to migrate store: ${o.reason}`));return}this.store.mergeRemoteChanges(()=>{this.store.put(Object.values(o.value).filter(a=>this.documentTypes.has(a.typeName)),"initialize")}),i&&DE(this.store,i)}this.channel.onmessage=({data:s})=>{var a,l;this.debug("got message",s);const i=s,o=this.store.schema.getMigrationsSince(i.schema);if(o.ok){if(o.value.length>0){this.debug("telling them to reload"),this.channel.postMessage({type:"announce",schema:this.serializedSchema}),this.shouldDoFullDBWrite=!0,this.persistIfNeeded();return}}else{if(Date.now()-this.initTime<5e3){n(new Error("Schema mismatch, please close other tabs and reload the page"));return}this.debug("reloading"),this.isReloading=!0,(l=(a=window==null?void 0:window.location)==null?void 0:a.reload)==null||l.call(a);return}i.type==="diff"&&(this.debug("applying diff"),zs(()=>{this.store.mergeRemoteChanges(()=>{this.store.applyDiff(i.changes),this.store.ensureStoreIsUsable()})}))},this.channel.postMessage({type:"announce",schema:this.serializedSchema}),this.disposables.add(()=>{this.channel.close()}),e(this)}catch(s){if(this.debug("error loading data from store",s),this.didDispose)return;n(s);return}}close(){this.debug("closing"),this.didDispose=!0,this.disposables.forEach(e=>e())}schedulePersist(){this.debug("schedulePersist",this.scheduledPersistTimeout),!this.scheduledPersistTimeout&&(this.scheduledPersistTimeout=setTimeout(()=>{this.scheduledPersistTimeout=null,this.persistIfNeeded()},this.didLastWriteError?SQ:vQ))}persistIfNeeded(){this.debug("persistIfNeeded",{isPersisting:this.isPersisting,isReloading:this.isReloading,shouldDoFullDBWrite:this.shouldDoFullDBWrite,diffQueueLength:this.diffQueue.length,storeIsPossiblyCorrupt:this.store.isPossiblyCorrupted()}),this.scheduledPersistTimeout&&(clearTimeout(this.scheduledPersistTimeout),this.scheduledPersistTimeout=null),!this.isPersisting&&(this.isReloading||this.store.isPossiblyCorrupted()||(this.shouldDoFullDBWrite||this.diffQueue.length>0)&&this.doPersist())}async doPersist(){if(We(!this.isPersisting,"persist already in progress"),this.didDispose)return;this.isPersisting=!0,this.debug("doPersist start");const e=this.diffQueue;this.diffQueue=[];try{if(this.shouldDoFullDBWrite)this.shouldDoFullDBWrite=!1,await this.db.storeSnapshot({schema:this.store.schema,snapshot:this.store.serialize(),sessionId:this.sessionId,sessionStateSnapshot:this.$sessionStateSnapshot.get()});else{const n=nm(e.filter(r=>r!==i7));await this.db.storeChanges({changes:n,schema:this.store.schema,sessionId:this.sessionId,sessionStateSnapshot:this.$sessionStateSnapshot.get()})}this.didLastWriteError=!1}catch(n){this.shouldDoFullDBWrite=!0,this.didLastWriteError=!0,console.error("failed to store changes in indexed db",n),mQ(),typeof window<"u"&&window.location.reload()}this.isPersisting=!1,this.debug("doPersist end"),this.schedulePersist()}}function U4(t){const e=C.useRef(t),[n,r]=C.useState(t);n!==e.current&&r(e.current);const s=C.useCallback(i=>{typeof i=="function"?e.current=i(e.current):e.current=i,r(e.current)},[]);return[n,s]}function PQ(t){const[e,n]=U4({status:"loading"});return t=Mh(t),C.useEffect(()=>{const{persistenceKey:r,sessionId:s,...i}=t;if(!r){n({status:"not-synced",store:eh(i)});return}n({status:"loading"});const o=new so,a={upload:async(h,p)=>(await u.db.storeAsset(h.id,p),h.id),resolve:async h=>h.props.src?h.props.src.startsWith("asset:")?await o.get(h,async()=>{const p=await u.db.getAsset(h.id);return p?URL.createObjectURL(p):null}):h.props.src:null,...i.assets},l=eh({...i,assets:a});let c=!1;const u=new CQ(l,{sessionId:s,persistenceKey:r,onLoad(){c||n({store:l,status:"synced-local"})},onLoadError(h){c||n({status:"error",error:h})}});return()=>{c=!0,u.close()}},[t,n]),e}function kQ(){const t=G(),e=mn();C.useEffect(()=>{const n=i=>e.style.setProperty("--tl-zoom",i.toString()),r=Ok(n,100),s=new Xc("useZoomCss",()=>{t.getCurrentPageShapeIds().size<300?n(t.getZoomLevel()):r(t.getZoomLevel())});return s.attach(),s.execute(),()=>{s.detach(),r.cancel()}},[t,e])}function Q2(t){const e=new ArrayBuffer(t.length),n=new Uint8Array(e);for(let r=0,s=t.length;r<s;r++)n[r]=t.charCodeAt(r);return e}function IQ(t){const e=atob(t),n=Q2(e);return crypto.subtle.importKey("spki",new Uint8Array(n),{name:"ECDSA",namedCurve:"P-256"},!0,["verify"])}const EQ=5,Lp={ANNUAL_LICENSE:1,PERPETUAL_LICENSE:2,INTERNAL_LICENSE:4},TQ=Math.max(...Object.values(Lp)),Ku={ID:0,HOSTS:1,FLAGS:2,EXPIRY_DATE:3},MQ=Object.keys(Ku).length,R0="sales@tldraw.com";class H4{constructor(e,n,r){g(this,"publicKey","MFkwEwYHKoZIzj0CAQYIKoZIzj0DAQcDQgAEHJh0uUfxHtCGyerXmmatE368Hd9rI6LH9oPDQihnaCryRFWEVeOvf9U/SPbyxX74LFyJs5tYeAHq5Nc0Ax25LQ");g(this,"isDevelopment");g(this,"isTest");g(this,"isCryptoAvailable");g(this,"state",Qt("license state","pending"));this.isTest=!1,this.isDevelopment=this.getIsDevelopment(r),this.publicKey=n||this.publicKey,this.isCryptoAvailable=!!crypto.subtle,y4.enableLicensing.get()?this.getLicenseFromKey(e).then(s=>{const i=_Q(s);this.state.set(i?"unlicensed":"licensed")}):this.state.set("licensed")}getIsDevelopment(e){return e==="development"?!0:e==="production"?!1:window.location.protocol!=="https:"}async extractLicenseKey(e){const[n,r]=e.split("."),[s,i]=n.split("/");if(!s.startsWith("tldraw-"))throw new Error(`Unsupported prefix '${s}'`);const o=await IQ(this.publicKey);let a;try{a=await crypto.subtle.verify({name:"ECDSA",hash:{name:"SHA-256"}},o,new Uint8Array(Q2(atob(r))),new Uint8Array(Q2(atob(i))))}catch(c){throw console.error(c),new Error("Could not perform signature validation")}if(!a)throw new Error("Invalid signature");let l;try{l=JSON.parse(atob(i))}catch{throw new Error("Could not parse object")}return l.length>MQ&&this.outputMessages(["License key contains some unknown properties.","You may want to update tldraw packages to a newer version to get access to new functionality."]),{id:l[Ku.ID],hosts:l[Ku.HOSTS],flags:l[Ku.FLAGS],expiryDate:l[Ku.EXPIRY_DATE]}}async getLicenseFromKey(e){if(!e)return this.isDevelopment||this.outputNoLicenseKeyProvided(),{isLicenseParseable:!1,reason:"no-key-provided"};if(this.isDevelopment&&!this.isCryptoAvailable)return console.log("tldraw: you seem to be in a development environment that does not support crypto. License not verified."),console.log("You should check that this works in production separately."),{isLicenseParseable:!1,reason:"has-key-development-mode"};let n=e.replace(/[\u200B-\u200D\uFEFF]/g,"");n=n.replace(/\r?\n|\r/g,"");try{const r=await this.extractLicenseKey(n),s=new Date(r.expiryDate),i=this.isFlagEnabled(r.flags,Lp.ANNUAL_LICENSE),o=this.isFlagEnabled(r.flags,Lp.PERPETUAL_LICENSE),a={license:r,isLicenseParseable:!0,isDevelopment:this.isDevelopment,isDomainValid:this.isDomainValid(r),expiryDate:s,isAnnualLicense:i,isAnnualLicenseExpired:i&&this.isAnnualLicenseExpired(s),isPerpetualLicense:o,isPerpetualLicenseExpired:o&&this.isPerpetualLicenseExpired(s),isInternalLicense:this.isFlagEnabled(r.flags,Lp.INTERNAL_LICENSE)};return this.outputLicenseInfoIfNeeded(a),a}catch(r){return this.outputInvalidLicenseKey(r.message),{isLicenseParseable:!1,reason:"invalid-license-key"}}}isDomainValid(e){const n=window.location.hostname.toLowerCase();return e.hosts.some(r=>{const s=r.toLowerCase().trim();return s===n||`www.${s}`===n||s===`www.${n}`||r==="*"?!0:r.includes("*")?new RegExp(r.replace(/\*/g,".*?")).test(n):!1})}getExpirationDateWithoutGracePeriod(e){return new Date(e.getFullYear(),e.getMonth(),e.getDate())}getExpirationDateWithGracePeriod(e){return new Date(e.getFullYear(),e.getMonth(),e.getDate()+EQ+1)}isAnnualLicenseExpired(e){const n=this.getExpirationDateWithGracePeriod(e),r=new Date>=n;return!r&&new Date>=this.getExpirationDateWithoutGracePeriod(e)&&this.outputMessages(["tldraw license is about to expire, you are in a grace period.",`Please reach out to ${R0} if you would like to renew your license.`]),r}isPerpetualLicenseExpired(e){const n=this.getExpirationDateWithGracePeriod(e),r={major:new Date(w6.major),minor:new Date(w6.minor)};return r.major>=n||r.minor>=n}isFlagEnabled(e,n){return(e&n)===n}outputNoLicenseKeyProvided(){this.outputMessages(["No tldraw license key provided!",`Please reach out to ${R0} if you would like to license tldraw or if you'd like a trial.`])}outputInvalidLicenseKey(e){this.outputMessages(["Invalid tldraw license key",`Reason: ${e}`])}outputLicenseInfoIfNeeded(e){e.isAnnualLicenseExpired&&this.outputMessages(["Your tldraw license has expired!",`Please reach out to ${R0} to renew.`]),!e.isDomainValid&&!e.isDevelopment&&this.outputMessages(["This tldraw license key is not valid for this domain!",`Please reach out to ${R0} if you would like to use tldraw on other domains.`]),e.license.flags>=TQ*2&&this.outputMessages(["This tldraw license contains some unknown flags.","You may want to update tldraw packages to a newer version to get access to new functionality."])}outputMessages(e){if(!this.isTest){this.outputDelimiter();for(const n of e)console.log(`%c${n}`,"color: white; background: crimson; padding: 2px; border-radius: 3px;");this.outputDelimiter()}}outputDelimiter(){console.log("%c-------------------------------------------------------------------","color: white; background: crimson; padding: 2px; border-radius: 3px;")}}g(H4,"className","tl-watermark_SEE-LICENSE");function _Q(t){if(!t.isLicenseParseable||!t.isDomainValid&&!t.isDevelopment)return!0;if(t.isPerpetualLicenseExpired||t.isAnnualLicenseExpired){if(t.isInternalLicense)throw new Error("License: Internal license expired.");return!0}return!1}const XE=C.createContext({}),AQ=()=>C.useContext(XE);function DQ({licenseKey:t,children:e}){const[n]=C.useState(()=>new H4(t));return d.jsx(XE.Provider,{value:n,children:e})}const jQ='<svg xmlns="http://www.w3.org/2000/svg" width="3001" height="1000" fill="none"><path fill="#000" d="M590.656 300.449c0 49.706-40.294 90-90 90-49.705 0-90-40.294-90-90 0-49.705 40.295-90 90-90 49.706 0 90 40.295 90 90M569.431 719.011c-15.247 32.821-56.006 91.589-98.338 91.438-32.004-.115-38.642-30.904-17.414-50.856 17.381-16.337 28.246-48.075 31.995-72.719.415-2.728-1.556-5.197-4.272-5.679-39.666-7.04-70.746-40.877-70.746-83.417 0-48.23 38.983-87.329 87.07-87.329 39.936 0 70.172 22.237 83.369 52.397 18.839 43.055 7.117 115.733-11.664 156.165M2613.29 385.681V239.319c0-11.363 9.22-20.569 20.59-20.569h8.26c11.37 0 20.59 9.206 20.59 20.569v36.911c0 8.629 7 15.625 15.63 15.625h35.25c8.63 0 15.63-6.996 15.63-15.625v-36.911c0-11.363 9.22-20.569 20.59-20.569h8.17c11.37 0 20.59 9.206 20.59 20.569v146.362c0 11.363-9.22 20.569-20.59 20.569h-8.17c-11.37 0-20.59-9.206-20.59-20.569v-36.999c0-8.63-7-15.625-15.63-15.625h-35.25c-8.63 0-15.63 6.995-15.63 15.625v36.999c0 11.363-9.22 20.569-20.59 20.569h-8.26c-11.37 0-20.59-9.206-20.59-20.569M2391.97 239.319v146.362c0 11.348-9.16 20.569-20.49 20.569h-8.2c-11.33 0-20.49-9.221-20.49-20.569V239.319c0-11.348 9.16-20.569 20.49-20.569h8.2c11.33 0 20.49 9.221 20.49 20.569M2098.23 391.43l-42.69-146.361c-3.85-13.171 6.06-26.319 19.79-26.319h10.6c9.59 0 17.93 6.611 20.08 15.952l17.01 73.045c1.48 6.348 10.47 6.478 12.14.176l19.47-73.838c2.38-9.04 10.57-15.335 19.93-15.335h12.1c9.37 0 17.56 6.3 19.94 15.346l19.49 74.067c1.66 6.305 10.65 6.178 12.13-.171l17.09-73.294c2.15-9.339 10.49-15.948 20.08-15.948h10.53c13.72 0 23.63 13.141 19.79 26.31l-42.63 146.361c-2.56 8.789-10.63 14.829-19.79 14.829h-15.68c-9.12 0-17.16-5.98-19.76-14.709l-21.17-71.059c-1.77-5.948-10.19-5.957-11.97-.012l-21.33 71.071c-2.6 8.729-10.64 14.709-19.76 14.709h-15.59c-9.17 0-17.23-6.035-19.8-14.82M2443.23 218.75h118.59c11.38 0 20.62 9.195 20.62 20.557s-9.24 20.556-20.62 20.556h-24.79c-5.53 0-10 4.477-10 10v115.818c0 11.368-9.25 20.569-20.63 20.569h-7.65c-11.39 0-20.63-9.201-20.63-20.569V269.863c0-5.523-4.48-10-10-10h-24.89c-11.37 0-20.61-9.195-20.61-20.556s9.24-20.557 20.61-20.557M1174.15 218.75h24.64c8.35 0 15.88 5.042 19.04 12.764l34.61 83.942c2.13 5.161 9.44 5.155 11.56-.01l34.43-83.932a20.58 20.58 0 0 1 19.04-12.764h24.64c11.37 0 20.58 9.208 20.58 20.569v146.362c0 11.361-9.21 20.569-20.58 20.569h-7.09c-11.36 0-20.58-9.208-20.58-20.569l-.12-50.645c-.01-6.888-9.53-8.688-12.06-2.283l-23.46 59.332a20.57 20.57 0 0 1-19.14 13.009h-3.03a20.57 20.57 0 0 1-19.15-13.046l-23.47-59.68c-2.52-6.416-12.05-4.623-12.06 2.271l-.13 51.042c0 11.361-9.21 20.569-20.57 20.569h-7.1c-11.36 0-20.57-9.208-20.57-20.569V239.319c0-11.361 9.21-20.569 20.57-20.569"/><path fill="#000" fill-rule="evenodd" d="m1449.94 391.836 6.12-19.392a6.255 6.255 0 0 1 5.96-4.369l50.22-.061a6.24 6.24 0 0 1 5.96 4.348l6.23 19.486c2.71 8.581 10.71 14.402 19.74 14.402h9.34c14.13 0 24.15-13.791 19.61-27.151l-49.74-146.361c-2.85-8.37-10.74-13.988-19.61-13.988h-33.16c-8.87 0-16.77 5.618-19.61 13.988l-49.74 146.361c-4.54 13.36 5.48 27.151 19.61 27.151h9.32c9.04 0 17.04-5.827 19.75-14.414m31.1-98.858c1.85-5.807 10.08-5.796 11.91.016l8.83 27.916c1.28 4.028-1.73 8.134-5.96 8.134h-17.74c-4.23 0-7.24-4.119-5.95-8.151zM1681.81 406.25c18.91 0 35.39-3.686 49.36-11.168 13.97-7.544 24.73-18.394 32.24-32.489 7.56-14.105 11.29-30.866 11.29-50.182 0-19.256-3.73-35.957-11.29-50.004-7.57-14.094-18.35-24.912-32.32-32.397-13.91-7.545-30.4-11.26-49.37-11.26h-49.5c-11.38 0-20.63 9.201-20.63 20.569v146.362c0 11.368 9.25 20.569 20.63 20.569zm23.13-47.701c-6.62 3.215-14.85 4.886-24.79 4.886-10.49 0-19-8.507-19-19v-64.34c0-10.149 8.23-18.376 18.38-18.376 10.18 0 18.56 1.703 25.23 4.974 6.59 3.149 11.63 8.315 15.08 15.633 3.45 7.269 5.28 17.268 5.28 30.162 0 12.891-1.82 22.951-5.28 30.347-3.39 7.319-8.36 12.509-14.9 15.714" clip-rule="evenodd"/><path fill="#000" d="M1804.21 385.681V239.319c0-11.361 9.21-20.569 20.58-20.569h91.28c11.36 0 20.57 9.202 20.57 20.557s-9.21 20.556-20.57 20.556h-54.64a7.807 7.807 0 0 0-7.81 7.813v16.366a7.806 7.806 0 0 0 7.81 7.812h48.13c11.37 0 20.58 9.246 20.58 20.602s-9.21 20.601-20.58 20.601h-48.13a7.806 7.806 0 0 0-7.81 7.812v16.455a7.807 7.807 0 0 0 7.81 7.813h54.64c11.36 0 20.57 9.202 20.57 20.556s-9.21 20.557-20.57 20.557h-91.28c-11.37 0-20.58-9.208-20.58-20.569"/><path fill="#000" fill-rule="evenodd" d="M2875.5 68.75h-2750c-31.066 0-56.25 25.184-56.25 56.25v750c0 31.066 25.184 56.25 56.25 56.25h2750c31.07 0 56.25-25.184 56.25-56.25V125c0-31.066-25.18-56.25-56.25-56.25M125.5 0C56.464 0 .5 55.964.5 125v750c0 69.036 55.965 125 125 125h2750c69.04 0 125-55.964 125-125V125c0-69.036-55.96-125-125-125z" clip-rule="evenodd"/><path fill="#000" d="M2476.06 804.813c-10.54 0-19.82-6.947-22.81-17.068L2390.79 575.7c-4.49-15.248 6.92-30.534 22.8-30.534h27.75c11.1 0 20.72 7.686 23.18 18.52L2489 671.402c2.07 9.093 14.93 9.321 17.32.308l28.83-108.844c2.76-10.435 12.19-17.7 22.98-17.7h25.17c10.8 0 20.25 7.293 22.99 17.755l28.27 107.739c2.36 9.001 15.18 8.829 17.3-.232l25.01-106.888c2.51-10.763 12.1-18.374 23.14-18.374h27.87c15.88 0 27.29 15.286 22.8 30.534l-62.46 212.045a23.78 23.78 0 0 1-22.81 17.068h-32.12c-10.39 0-19.58-6.763-22.69-16.696l-32.08-102.694c-2.62-8.397-14.51-8.331-17.04.095l-30.74 102.346c-3.02 10.061-12.27 16.949-22.76 16.949zM1742.44 804.813h-75.81c-13.09 0-23.71-10.656-23.71-23.801V568.967c0-13.145 10.62-23.801 23.71-23.801h74.8c26.6 0 49.59 5.198 68.95 15.594 19.45 10.312 34.44 25.187 44.96 44.627 10.61 19.355 15.91 42.556 15.91 69.602q0 40.57-15.78 69.73c-10.53 19.355-25.43 34.231-44.71 44.627-19.28 10.311-42.05 15.467-68.32 15.467m-29.3-83.642c0 13.145 10.61 23.801 23.71 23.801h3.06c12.8 0 23.7-2.07 32.71-6.212 9.09-4.141 16-11.283 20.71-21.426q7.2-15.213 7.2-42.345 0-27.13-7.32-42.344c-4.8-10.143-11.87-17.285-21.22-21.426-9.26-4.142-20.63-6.212-34.1-6.212h-1.04c-13.1 0-23.71 10.656-23.71 23.801zM1460.86 804.813c-13.12 0-23.76-10.656-23.76-23.801V568.967c0-13.145 10.64-23.801 23.76-23.801h22.84c13.13 0 23.76 10.656 23.76 23.801v155.247c0 13.145 10.64 23.801 23.76 23.801h57.27c13.12 0 23.76 10.656 23.76 23.801v9.196c0 13.145-10.64 23.801-23.76 23.801zM1204.45 601.964c-13.13 0-23.77-10.656-23.77-23.801v-9.196c0-13.145 10.64-23.801 23.77-23.801h177.89c13.13 0 23.78 10.656 23.78 23.801v9.196c0 13.145-10.65 23.801-23.78 23.801h-39.38c-8.21 0-14.86 6.66-14.86 14.875v164.173c0 13.145-10.64 23.801-23.78 23.801h-21.85c-13.13 0-23.78-10.656-23.78-23.801V616.839c0-8.215-6.65-14.875-14.86-14.875z"/><path fill="#000" fill-rule="evenodd" d="M2223.05 787.891c-3.02 10.047-12.27 16.922-22.74 16.922h-25.43c-16.19 0-27.64-15.862-22.57-31.261l69.88-212.045c3.21-9.753 12.31-16.341 22.56-16.341h61.84c10.25 0 19.35 6.588 22.56 16.341l69.87 212.045c5.08 15.399-6.37 31.261-22.56 31.261h-25.43c-10.48 0-19.72-6.875-22.74-16.922l-6.7-22.2a14.84 14.84 0 0 0-14.21-10.576h-63.42c-6.55 0-12.32 4.296-14.22 10.576zm76.13-96.945-14.13-48.436c-2.46-8.451-14.36-8.602-17.04-.217l-15.46 48.436c-1.84 5.759 2.45 11.645 8.48 11.645h29.6c5.94 0 10.22-5.715 8.55-11.428" clip-rule="evenodd"/><path fill="#000" d="M1939.6 804.813c-13.13 0-23.77-10.656-23.77-23.801V568.967c0-13.145 10.64-23.801 23.77-23.801h88.13c19.24 0 36.08 3.508 50.51 10.523s25.65 17.115 33.67 30.3q12.03 19.779 12.03 47.416c0 18.595-4.14 34.273-12.41 47.036-7.64 11.913-18.18 21.101-31.63 27.564-16.98 8.159-36 11.104-54.7 11.104h-43.07c-76.56 0 4.08-135.84 4.08-84.706v7.996c0 12.117 9.81 21.941 21.91 21.941 8.12 0 16.3-.345 24.04-3.043 5.91-2.113 10.43-5.451 13.55-10.015 3.2-4.565 4.81-10.523 4.81-17.877 0-7.437-1.61-13.481-4.81-18.129-3.12-4.733-7.64-8.199-13.55-10.396-7.05-2.766-14.67-3.423-22.18-3.423-13.13 0-23.77 10.656-23.77 23.801v47.71c0 11.825 11.14 16.003 19.91 20.752 12.31 6.671 7.58 25.389-6.42 25.389-7.45 0-13.49 6.048-13.49 13.508v48.395c0 13.145-10.63 23.801-23.76 23.801zm134.89-106.758 5.41 9.95 33.51 61.622c8.62 15.86-2.84 35.186-20.87 35.186h-22.27c-8.74 0-16.77-4.798-20.92-12.496l-35.05-65.04a15.52 15.52 0 0 0-13.66-8.168c-42.24 0 40.62-82.154 73.85-21.054M931.652 0h68.748v1000h-68.748z"/></svg>',RQ=`${$o()}/watermarks/watermark-desktop.svg`,O0=`data:image/svg+xml;utf8,${encodeURIComponent(jQ)}`;let gy=null;async function OQ(t){return t?O0:(gy||(gy=Promise.race([(async()=>{try{const e=await yi(RQ);if(!e.ok)return O0;const n=await e.blob();return URL.createObjectURL(n)}catch{return O0}})(),new Promise(e=>{setTimeout(()=>{e(O0)},3e3)})])),gy)}const LQ=Ne.memo(function({forceLocal:e=!1}){const n=XI(),r=G(),s=AQ(),i=J("show watermark",()=>y4.enableLicensing.get()&&r.getViewportScreenBounds().width>760&&s.state.get()==="unlicensed",[r,s]),o=J("debug mode",()=>r.getInstanceState().isDebugMode,[r]),a=J("is menu open",()=>r.getIsMenuOpen(),[r]),[l,c]=C.useState(null),u=e||s.isDevelopment;if(C.useEffect(()=>{if(!i)return;let f=!1;return(async()=>{const v=await OQ(u);f||c(v)})(),()=>{f=!0}},[u,i]),!i||!l)return null;const h=H4.className,p=`url('${l}') center 100% / 100% no-repeat`;return d.jsxs(d.Fragment,{children:[d.jsx("style",{children:`
/* ------------------- SEE LICENSE -------------------
The tldraw watermark is part of tldraw's license. It is shown for unlicensed
users. By using this library, you agree to keep the watermark's behavior, 
keeping it visible, unobscured, and available to user-interaction.

To remove the watermark, please purchase a license at tldraw.dev.
*/

.${h} {
	position: absolute;
	bottom: var(--space-2);
	right: var(--space-2);
	width: 96px;
	height: 32px;
	z-index: 2147483647 !important;
	pointer-events: ${a?"none":"all"};
	background-color: color-mix(in srgb, var(--color-background) 62%, transparent);
	border-radius: 5px;
	padding: 2px;
	box-sizing: content-box;
}

.${h}[data-debug='true'] {
	bottom: 46px;
}

.${h} > a {
	position: absolute;
	width: 96px;
	height: 32px;
	pointer-events: none;
	cursor: inherit;
	color: var(--color-text);
	background-color: currentColor;
	opacity: .28;
}

@media (hover: hover) {
	.${h}:hover {
		background-color: var(--color-background);
		transition: background-color 0.2s ease-in-out;
		transition-delay: 0.32s;
	}
	.${h}:hover > a {
		animation: delayed_link 0.2s forwards ease-in-out;
		animation-delay: 0.32s;
	}
}

@keyframes delayed_link {
	0% {
		cursor: inherit;
		opacity: .38;
		pointer-events: none;
	}
	100% {
		cursor: pointer;
		opacity: 1;
		pointer-events: all;
	}
}
`}),d.jsx("div",{className:h,"data-debug":o,draggable:!1,...n,children:d.jsx("a",{href:"https://tldraw.dev",target:"_blank",rel:"noreferrer",draggable:!1,onPointerDown:sn,style:{mask:p,WebkitMask:p}})})]})}),NQ=[],zQ=[],FQ=[],$Q="tl-container",BQ=C.memo(function({store:e,components:n,className:r,user:s,...i}){const[o,a]=Ne.useState(null),l=C.useMemo(()=>s??EE(),[s]),c=(n==null?void 0:n.ErrorFallback)===void 0?SE:n==null?void 0:n.ErrorFallback,u={...i,shapeUtils:i.shapeUtils??NQ,bindingUtils:i.bindingUtils??zQ,tools:i.tools??FQ,components:n};return d.jsx("div",{ref:a,"data-tldraw":KI,draggable:!1,className:be(`${$Q} tl-theme__light`,r),onPointerDown:sn,tabIndex:-1,children:d.jsx(Qd,{fallback:c,onError:h=>u4(h,{tags:{origin:"react.tldraw-before-app"}}),children:o&&d.jsx(DQ,{licenseKey:i.licenseKey,children:d.jsx(Iq,{container:o,children:d.jsx(_X,{overrides:n,children:e?e instanceof v4?d.jsx(QE,{...u,store:e,user:l}):d.jsx(ZE,{...u,store:e,user:l}):d.jsx(UQ,{...u,store:e,user:l})})})})})})});function UQ(t){const{defaultName:e,snapshot:n,initialData:r,shapeUtils:s,bindingUtils:i,persistenceKey:o,sessionId:a,user:l,assets:c}=t,u=PQ({shapeUtils:s,bindingUtils:i,initialData:r,persistenceKey:o,sessionId:a,defaultName:e,snapshot:n,assets:c});return d.jsx(ZE,{...t,store:u,user:l})}const ZE=C.memo(function({store:e,user:n,...r}){const s=mn();C.useLayoutEffect(()=>{n.userPreferences.get().colorScheme==="dark"&&(s.classList.remove("tl-theme__light"),s.classList.add("tl-theme__dark"))},[s,n]);const{LoadingScreen:i}=_t();switch(e.status){case"error":throw e.error;case"loading":return i?d.jsx(i,{}):null}return d.jsx(QE,{...r,store:e.store,user:n})}),my=()=>document.location.search.includes("tldraw_preserve_focus");function QE({onMount:t,children:e,store:n,tools:r,shapeUtils:s,bindingUtils:i,user:o,initialState:a,autoFocus:l=!0,inferDarkMode:c,cameraOptions:u,options:h,licenseKey:p}){const{ErrorFallback:f}=_t(),v=mn(),[m,x]=U4(null),y=C.useRef({autoFocus:l&&!my(),inferDarkMode:c,initialState:a,cameraOptions:u});C.useLayoutEffect(()=>{y.current={autoFocus:l&&!my(),inferDarkMode:c,initialState:a,cameraOptions:u}},[l,c,a,u]),C.useLayoutEffect(()=>{const{autoFocus:P,inferDarkMode:E,initialState:M,cameraOptions:I}=y.current,_=new he({store:n,shapeUtils:s,bindingUtils:i,tools:r,getContainer:()=>v,user:o,initialState:M,autoFocus:P,inferDarkMode:E,cameraOptions:I,options:h,licenseKey:p});return x(_),()=>{_.dispose()}},[i,v,h,s,n,r,o,x,p]),C.useLayoutEffect(()=>{m&&u&&m.setCameraOptions(u)},[m,u]);const S=C.useSyncExternalStore(C.useCallback(P=>m?(m.on("crash",P),()=>m.off("crash",P)):()=>{},[m]),()=>(m==null?void 0:m.getCrashingError())??null);C.useEffect(function(){if(!m)return;function E(){m&&m.focus()}function M(){m&&m.blur()}if(l&&my())return m.getContainer().addEventListener("pointerdown",E),document.body.addEventListener("pointerdown",M),()=>{var I;(I=m.getContainer())==null||I.removeEventListener("pointerdown",E),document.body.removeEventListener("pointerdown",M)}},[m,l]);const{Canvas:w}=_t();return m?d.jsx(Qd,{fallback:f,onError:P=>m.annotateError(P,{origin:"react.tldraw",willCrashApp:!0}),children:S?d.jsx(WQ,{crashingError:S}):d.jsx(lm.Provider,{value:m,children:d.jsxs(HQ,{onMount:t,children:[e??(w?d.jsx(w,{}):null),d.jsx(LQ,{})]})})}):null}function HQ({children:t,onMount:e}){return kQ(),ZZ(),QZ(),JZ(),eT(n=>{const r=n.store.props.onMount(n),s=e==null?void 0:e(n);return()=>{r==null||r(),s==null||s()}}),t}function WQ({crashingError:t}){throw t}function W4({children:t}){return d.jsx("div",{className:"tl-loading",children:t})}function JE({children:t}){return d.jsx("div",{className:"tl-loading",children:t})}function eT(t){const e=G(),n=HE(r=>{let s;return r.run(()=>{s=t==null?void 0:t(r),r.emit("mount")},{history:"ignore"}),window.tldrawReady=!0,s});Ne.useLayoutEffect(()=>{if(e)return n==null?void 0:n(e)},[e,n])}function aa({children:t,className:e="",...n}){return d.jsx("div",{...n,className:be("tl-html-container",e),children:t})}class Np{constructor(e){this.editor=e}}g(Np,"props"),g(Np,"migrations"),g(Np,"type");function fm(t,e,n={}){const{newPoint:r,handle:s,scaleX:i,scaleY:o}=e,{minWidth:a=1,maxWidth:l=1/0,minHeight:c=1,maxHeight:u=1/0}=n;let h=t.props.w*i,p=t.props.h*o;const f=new b(0,0);if(h>0){if(h<a){switch(s){case"top_left":case"left":case"bottom_left":{f.x=h-a;break}case"top":case"bottom":{f.x=(h-a)/2;break}default:f.x=0}h=a}}else if(f.x=h,h=-h,h<a){switch(s){case"top_left":case"left":case"bottom_left":{f.x=-h;break}default:f.x=-a}h=a}if(p>0){if(p<c){switch(s){case"top_left":case"top":case"top_right":{f.y=p-c;break}case"right":case"left":{f.y=(p-c)/2;break}default:f.y=0}p=c}}else if(f.y=p,p=-p,p<c){switch(s){case"top_left":case"top":case"top_right":{f.y=-p;break}default:f.y=-c}p=c}const{x:v,y:m}=f.rot(t.rotation).add(r);return{...t,x:v,y:m,props:{w:Math.min(l,h),h:Math.min(u,p)}}}class tu extends fs{constructor(){super(...arguments);g(this,"onResize",(n,r)=>fm(n,r))}getGeometry(n){return new xi({width:n.props.w,height:n.props.h,isFilled:!0})}getHandleSnapGeometry(n){return{points:this.getGeometry(n).bounds.cornersAndCenter}}getInterpolatedProps(n,r,s){return{...r.props,w:mr(n.props.w,r.props.w,s),h:mr(n.props.h,r.props.h,s)}}}var ov;let KQ=(ov=class extends Se{constructor(){super(...arguments);g(this,"onPointerDown",n=>{this.parent.transition("pointing",n)});g(this,"onEnter",()=>{this.editor.setCursor({type:"cross",rotation:0})});g(this,"onCancel",()=>{this.editor.setCurrentTool("select")})}},g(ov,"id","idle"),ov);var av;let GQ=(av=class extends Se{constructor(){super(...arguments);g(this,"markId","");g(this,"wasFocusedOnEnter",!1);g(this,"onEnter",()=>{this.wasFocusedOnEnter=!this.editor.getIsMenuOpen()});g(this,"onPointerMove",n=>{if(this.editor.inputs.isDragging){const{originPagePoint:r}=this.editor.inputs,s=this.parent.shapeType,i=ot();this.markId=`creating:${i}`,this.editor.mark(this.markId),this.editor.createShapes([{id:i,type:s,x:r.x,y:r.y,props:{w:1,h:1}}]).select(i),this.editor.setCurrentTool("select.resizing",{...n,target:"selection",handle:"bottom_right",isCreating:!0,creationCursorOffset:{x:1,y:1},onInteractionEnd:this.parent.id,onCreate:this.parent.onCreate})}});g(this,"onPointerUp",()=>{this.complete()});g(this,"onCancel",()=>{this.cancel()});g(this,"onComplete",()=>{this.complete()});g(this,"onInterrupt",()=>{this.cancel()})}complete(){const{originPagePoint:n}=this.editor.inputs;if(!this.wasFocusedOnEnter)return;this.editor.mark(this.markId);const r=this.parent.shapeType,s=ot();this.editor.mark(this.markId),this.editor.createShapes([{id:s,type:r,x:n.x,y:n.y}]);const i=this.editor.getShape(s);if(!i){this.cancel();return}let{w:o,h:a}=i.props;const l=new b(o/2,a/2),c=this.editor.getShapeParentTransform(i);c&&l.rot(-c.rotation());let u=1;this.editor.user.getIsDynamicResizeMode()&&(u=1/this.editor.getZoomLevel(),o*=u,a*=u,l.mul(u));const h=yt(i);h.x=i.x-l.x,h.y=i.y-l.y,h.props.w=o,h.props.h=a,"scale"in i.props&&(h.props.scale=u),this.editor.updateShape(h),this.editor.setSelectedShapes([s]),this.editor.getInstanceState().isToolLocked?this.parent.transition("idle"):this.editor.setCurrentTool("select.idle")}cancel(){this.parent.transition("idle")}},g(av,"id","pointing"),av);class xd extends Se{constructor(){super(...arguments);g(this,"onCreate")}}g(xd,"id","box"),g(xd,"initial","idle"),g(xd,"children",()=>[KQ,GQ]);function gm(t){const e=G();return J("isEditing",()=>e.getEditingShapeId()===t,[e,t])}function ei(t){const e=G();return C.useMemo(function(){const s=c=>{if(c.isKilled)return;if(c.button===T4){e.dispatch({type:"pointer",target:"selection",handle:t,name:"right_click",...wr(c)});return}if(c.button!==0)return;const u=ig(c.currentTarget);function h(){u.removeEventListener("pointerup",h),Ih(u,c)}kh(u,c),u.addEventListener("pointerup",h),e.dispatch({name:"pointer_down",type:"pointer",target:"selection",handle:t,...wr(c)}),sn(c)};let i,o;function a(c){c.isKilled||c.button===0&&(c.clientX===i&&c.clientY===o||(i=c.clientX,o=c.clientY,e.dispatch({name:"pointer_move",type:"pointer",target:"selection",handle:t,...wr(c)})))}return{onPointerDown:s,onPointerMove:a,onPointerUp:c=>{c.isKilled||c.button===0&&e.dispatch({name:"pointer_up",type:"pointer",target:"selection",handle:t,...wr(c)})}}},[e,t])}function VQ(t){const[e,n]=C.useState(()=>({store:eh(t),opts:t}));if(!h4(e.opts,t)){const r={store:eh(t),opts:t};return n(r),r.store}return e.store}function qQ(t){const[e,n]=C.useState(()=>({opts:t,schema:Y2(t)}));if(!h4(e.opts,t)){const r=Y2(t);return n({opts:t,schema:r}),r}return e.schema}const YQ=20,XQ=8;function K4(t,e=YQ){return Math.max(XQ,Math.ceil(t/e))}class oc extends Ca{constructor(n){super({...n,isFilled:!1,isClosed:!1});g(this,"_center");g(this,"radius");g(this,"start");g(this,"end");g(this,"largeArcFlag");g(this,"sweepFlag");g(this,"measure");g(this,"angleStart");g(this,"angleEnd");const{center:r,sweepFlag:s,largeArcFlag:i,start:o,end:a}=n;if(o.equals(a))throw Error("Arc must have different start and end points.");this.angleStart=b.Angle(r,o),this.angleEnd=b.Angle(r,a),this.radius=b.Dist(r,o),this.measure=wq(this.angleStart,this.angleEnd,s,i),this.start=o,this.end=a,this.sweepFlag=s,this.largeArcFlag=i,this._center=r}nearestPoint(n){const{_center:r,measure:s,radius:i,angleEnd:o,angleStart:a,start:l,end:c}=this,u=H2(s,a,o,r.angle(n));if(u<=0)return l;if(u>=1)return c;const h=r.clone().add(n.clone().sub(r).uni().mul(i));let p,f=1/0,v;for(const m of[l,c,h])v=b.Dist2(n,m),v<f&&(p=m,f=v);if(!p)throw Error("nearest point not found");return p}hitTestLineSegment(n,r){const{_center:s,radius:i,measure:o,angleStart:a,angleEnd:l}=this,c=_h(n,r,s,i);return c===null?!1:c.some(u=>{const h=H2(o,a,l,s.angle(u));return h>=0&&h<=1})}getVertices(){const{_center:n,measure:r,length:s,radius:i,angleStart:o}=this,a=[];for(let l=0,c=K4(Math.abs(s));l<c+1;l++){const u=l/c*r,h=o+u;a.push(ul(n,i,h))}return a}getSvgPathData(n=!0){const{start:r,end:s,radius:i,largeArcFlag:o,sweepFlag:a}=this;return`${n?`M${r.toFixed()}`:""} A${i} ${i} 0 ${o} ${a} ${s.toFixed()}`}getLength(){return this.measure*this.radius}}class G4 extends Ca{constructor(n){super({isClosed:!0,...n});g(this,"_center");g(this,"radius");g(this,"x");g(this,"y");this.config=n;const{x:r=0,y:s=0,radius:i}=n;this.x=r,this.y=s,this._center=new b(i+r,i+s),this.radius=i}getBounds(){return new fe(this.x,this.y,this.radius*2,this.radius*2)}getVertices(){const{_center:n,radius:r}=this,s=it*r,i=[];for(let o=0,a=K4(s);o<a;o++){const l=o/a*it;i.push(ul(n,r,l))}return i}nearestPoint(n){const{_center:r,radius:s}=this;return r.equals(n)?b.AddXY(r,s,0):r.clone().add(n.clone().sub(r).uni().mul(s))}hitTestLineSegment(n,r,s=0){const{_center:i,radius:o}=this;return _h(n,r,i,o+s)!==null}getSvgPathData(){const{_center:n,radius:r}=this;return`M${n.x+r},${n.y} a${r},${r} 0 1,0 ${r*2},0a${r},${r} 0 1,0 -${r*2},0`}}class zn extends eu{constructor(n){const{start:r,cp1:s,cp2:i,end:o}=n;super({...n,points:[r,o]});g(this,"a");g(this,"b");g(this,"c");g(this,"d");this.a=r,this.b=s,this.c=i,this.d=o}getVertices(){const n=[],{a:r,b:s,c:i,d:o}=this;for(let a=0,l=10;a<=l;a++){const c=a/l;n.push(new b((1-c)*(1-c)*(1-c)*r.x+3*((1-c)*(1-c))*c*s.x+3*(1-c)*(c*c)*i.x+c*c*c*o.x,(1-c)*(1-c)*(1-c)*r.y+3*((1-c)*(1-c))*c*s.y+3*(1-c)*(c*c)*i.y+c*c*c*o.y))}return n}midPoint(){return zn.GetAtT(this,.5)}nearestPoint(n){let r,s=1/0,i,o;for(const a of this.segments)o=a.nearestPoint(n),i=b.Dist2(o,n),i<s&&(r=o,s=i);if(!r)throw Error("nearest point not found");return r}getSvgPathData(n=!0){const{a:r,b:s,c:i,d:o}=this;return`${n?`M ${r.toFixed()} `:""} C${s.toFixed()} ${i.toFixed()} ${o.toFixed()}`}static GetAtT(n,r){const{a:s,b:i,c:o,d:a}=n;return new b((1-r)*(1-r)*(1-r)*s.x+3*((1-r)*(1-r))*r*i.x+3*(1-r)*(r*r)*o.x+r*r*r*a.x,(1-r)*(1-r)*(1-r)*s.y+3*((1-r)*(1-r))*r*i.y+3*(1-r)*(r*r)*o.y+r*r*r*a.y)}getLength(n=32){let r,s=this.a,i=0;for(let o=1;o<=n;o++)r=zn.GetAtT(this,o/n),i+=b.Dist(s,r),s=r;return i}}class ZQ extends Ca{constructor(n){super({...n,isClosed:!1,isFilled:!1});g(this,"points");g(this,"_segments");const{points:r}=n;this.points=r}get segments(){if(!this._segments){this._segments=[];const{points:n}=this,r=n.length,s=r-2,i=1.25;for(let o=0;o<r-1;o++){const a=o===0?n[0]:n[o-1],l=n[o],c=n[o+1],u=o===s?c:n[o+2],h=l,p=o===0?a:new b(l.x+(c.x-a.x)/6*i,l.y+(c.y-a.y)/6*i),f=o===s?c:new b(c.x-(u.x-l.x)/6*i,c.y-(u.y-l.y)/6*i),v=c;this._segments.push(new zn({start:h,cp1:p,cp2:f,end:v}))}}return this._segments}getLength(){return this.segments.reduce((n,r)=>n+r.length,0)}getVertices(){const n=this.segments.reduce((r,s)=>r.concat(s.vertices),[]);return n.push(this.points[this.points.length-1]),n}nearestPoint(n){let r,s=1/0,i,o;for(const a of this.segments)o=a.nearestPoint(n),i=b.Dist2(o,n),i<s&&(r=o,s=i);if(!r)throw Error("nearest point not found");return r}hitTestLineSegment(n,r){return this.segments.some(s=>s.hitTestLineSegment(n,r))}getSvgPathData(){let n=this.segments.reduce((r,s,i)=>r+s.getSvgPathData(i===0),"");return this.isClosed&&(n+="Z"),n}}class QQ extends Ca{constructor(n){super({...n,isClosed:!0});g(this,"w");g(this,"h");g(this,"_edges");this.config=n;const{width:r,height:s}=n;this.w=r,this.h=s}get edges(){if(!this._edges){const{vertices:n}=this;this._edges=[];for(let r=0,s=n.length;r<s;r++){const i=n[r],o=n[(r+1)%s];this._edges.push(new Ki({start:i,end:o}))}}return this._edges}getVertices(){const n=Math.max(1,this.w),r=Math.max(1,this.h),s=n/2,i=r/2,o=Math.pow(s-i,2)/Math.pow(s+i,2),a=Qe*(s+i)*(1+3*o/(10+Math.sqrt(4-3*o))),l=K4(a),c=it/l,u=Math.cos(c),h=Math.sin(c);let p=0,f=1,v=0,m=1;const x=Array(l);for(let y=0;y<l;y++)x[y]=new b(s+s*f,i+i*p),v=h*f+u*p,m=u*f-h*p,p=v,f=m;return x}nearestPoint(n){let r,s=1/0,i,o;for(const a of this.edges)o=a.nearestPoint(n),i=b.Dist2(o,n),i<s&&(r=o,s=i);if(!r)throw Error("nearest point not found");return r}hitTestLineSegment(n,r){return this.edges.some(s=>s.hitTestLineSegment(n,r))}getBounds(){return new fe(0,0,this.w,this.h)}getLength(){const{w:n,h:r}=this,s=n/2,i=r/2,o=Math.max(0,s),a=Math.max(0,i);return VI(o,a)}getSvgPathData(n=!1){const{w:r,h:s}=this,i=r/2,o=s/2,a=Math.max(0,i),l=Math.max(0,o);return`${n?`M${i-a},${o}`:""} a${a},${l},0,1,1,${a*2},0a${a},${l},0,1,1,-${a*2},0`}}class JQ extends Ca{constructor(n){super({...n,isClosed:!0});g(this,"w");g(this,"h");g(this,"a");g(this,"b");g(this,"c");g(this,"d");this.config=n;const{width:r,height:s}=n;if(this.w=r,this.h=s,s>r){const i=r/2;this.a=new oc({start:new b(0,i),end:new b(r,i),center:new b(r/2,i),sweepFlag:1,largeArcFlag:1}),this.b=new Ki({start:new b(r,i),end:new b(r,s-i)}),this.c=new oc({start:new b(r,s-i),end:new b(0,s-i),center:new b(r/2,s-i),sweepFlag:1,largeArcFlag:1}),this.d=new Ki({start:new b(0,s-i),end:new b(0,i)})}else{const i=s/2;this.a=new oc({start:new b(i,s),end:new b(i,0),center:new b(i,i),sweepFlag:1,largeArcFlag:1}),this.b=new Ki({start:new b(i,0),end:new b(r-i,0)}),this.c=new oc({start:new b(r-i,0),end:new b(r-i,s),center:new b(r-i,i),sweepFlag:1,largeArcFlag:1}),this.d=new Ki({start:new b(r-i,s),end:new b(i,s)})}}nearestPoint(n){let r,s=1/0,i,o;const{a,b:l,c,d:u}=this;for(const h of[a,l,c,u])o=h.nearestPoint(n),i=b.Dist2(o,n),i<s&&(r=o,s=i);if(!r)throw Error("nearest point not found");return r}hitTestLineSegment(n,r){const{a:s,b:i,c:o,d:a}=this;return[s,i,o,a].some(l=>l.hitTestLineSegment(n,r))}getVertices(){const{a:n,b:r,c:s,d:i}=this;return[n,r,s,i].reduce((o,a)=>(o.push(...a.vertices),o),[])}getBounds(){return new fe(0,0,this.w,this.h)}getLength(){const{h:n,w:r}=this;return n>r?(Qe*(r/2)+(n-r))*2:(Qe*(n/2)+(r-n))*2}getSvgPathData(){const{a:n,b:r,c:s,d:i}=this;return[n,r,s,i].map((o,a)=>o.getSvgPathData(a===0)).join(" ")+" Z"}}async function eJ({shouldReload:t=!0}={}){_G();for(const e of ag.connectedInstances)await e.close();await Promise.all(B4().map(e=>VE(e))),MG(),t&&window.location.reload()}typeof window<"u"&&(window.__tldraw__hardReset=eJ);function tJ(t,e="_blank"){D4.openWindow(t,e)}function nJ({children:t}){const e=G();return J("shouldDisplayHandles",()=>{if(e.isInAny("select.idle","select.pointing_handle","select.pointing_shape"))return!0;if(e.isInAny("select.editing_shape")){const r=e.getOnlySelectedShape();return r&&e.isShapeOfType(r,"note")}return!1},[e])?d.jsx("svg",{className:"tl-user-handles tl-overlays__item",children:t}):null}const{PI:rJ}=Math,xc=rJ+1e-4;function tT(t,e={}){const{size:n=16,smoothing:r=.5}=e;if(t.length===0||n<=0)return{left:[],right:[]};const s=t[0],i=t[t.length-1],o=i.runningLength,a=Math.pow(n*r,2),l=[],c=[];let u=t[0].vector,h=t[0].point,p=h,f=h,v=p,m=!1,x;for(let y=0;y<t.length;y++){x=t[y];const{point:S,vector:w}=t[y],P=x.vector.dpr(u),E=(y<t.length-1?t[y+1]:t[y]).vector,M=y<t.length-1?E.dpr(x.vector):1,I=P<0&&!m,_=M!==null&&M<.2;if(I||_){if(M>-.62&&o-x.runningLength>x.radius){const R=u.clone().mul(x.radius);u.clone().cpr(E)<0?(f=b.Add(S,R),v=b.Sub(S,R)):(f=b.Sub(S,R),v=b.Add(S,R)),l.push(f),c.push(v)}else{const R=u.clone().mul(x.radius).per(),$=b.Sub(x.input,R);for(let U=1/13,O=0;O<1;O+=U)f=b.RotWith($,x.input,xc*O),l.push(f),v=b.RotWith($,x.input,xc+xc*-O),c.push(v)}h=f,p=v,_&&(m=!0);continue}if(m=!1,x===s||x===i){const R=b.Per(w).mul(x.radius);l.push(b.Sub(S,R)),c.push(b.Add(S,R));continue}const D=b.Lrp(E,w,M).per().mul(x.radius);f=b.Sub(S,D),(y<=1||b.Dist2(h,f)>a)&&(l.push(f),h=f),v=b.Add(S,D),(y<=1||b.Dist2(p,v)>a)&&(c.push(v),p=v),u=w}return{left:l,right:c}}function V4(t,e={}){const{size:n=16,start:r={},end:s={},last:i=!1}=e,{cap:o=!0}=r,{cap:a=!0}=s;if(t.length===0||n<=0)return[];const l=t[0],c=t[t.length-1],u=c.runningLength,h=r.taper===!1?0:r.taper===!0?Math.max(n,u):r.taper,p=s.taper===!1?0:s.taper===!0?Math.max(n,u):s.taper,{left:f,right:v}=tT(t,e),m=l.point,x=t.length>1?t[t.length-1].point:b.AddXY(l.point,1,1);if(t.length===1&&(!(h||p)||i)){const P=b.Add(m,b.Sub(m,x).uni().per().mul(-l.radius)),E=[];for(let M=1/13,I=M;I<=1;I+=M)E.push(b.RotWith(P,m,xc*2*I));return E}const y=[];if(!(h||p&&t.length===1))if(o)for(let P=1/8,E=P;E<=1;E+=P){const M=b.RotWith(v[0],m,xc*E);y.push(M)}else{const P=b.Sub(f[0],v[0]),E=b.Mul(P,.5),M=b.Mul(P,.51);y.push(b.Sub(m,E),b.Sub(m,M),b.Add(m,M),b.Add(m,E))}const S=[],w=c.vector.clone().per().neg();if(p||h&&t.length===1)S.push(x);else if(a){const P=b.Add(x,b.Mul(w,c.radius));for(let E=1/29,M=E;M<1;M+=E)S.push(b.RotWith(P,x,xc*3*M))}else S.push(b.Add(x,b.Mul(w,c.radius)),b.Add(x,b.Mul(w,c.radius*.99)),b.Sub(x,b.Mul(w,c.radius*.99)),b.Sub(x,b.Mul(w,c.radius)));return f.concat(S,v.reverse(),y)}const sJ=.025,iJ=.01;function wi(t,e={}){var x;const{streamline:n=.5,size:r=16,simulatePressure:s=!1}=e;if(t.length===0)return[];const i=.15+(1-n)*.85;let o=t.map(b.From),a=0;if(!s){let y=o[0];for(;y&&!(y.z>=sJ);)o.shift(),y=o[0]}if(!s){let y=o[o.length-1];for(;y&&!(y.z>=iJ);)o.pop(),y=o[o.length-1]}if(o.length===0)return[{point:b.From(t[0]),input:b.From(t[0]),pressure:s?.5:.15,vector:new b(1,1),distance:0,runningLength:0,radius:1}];let l=o[1];for(;l&&!(b.Dist2(l,o[0])>(r/3)**2);)o[0].z=Math.max(o[0].z,l.z),o.splice(1,1),l=o[1];const c=o.pop();for(l=o[o.length-1];l&&!(b.Dist2(l,c)>(r/3)**2);)o.pop(),l=o[o.length-1],a++;o.push(c);const u=e.last||!e.simulatePressure||o.length>1&&b.Dist2(o[o.length-1],o[o.length-2])<r**2||a>0;if(o.length===2&&e.simulatePressure){const y=o[1];o=o.slice(0,-1);for(let S=1;S<5;S++){const w=b.Lrp(o[0],y,S/4);w.z=(o[0].z+(y.z-o[0].z))*S/4,o.push(w)}}const h=[{point:o[0],input:o[0],pressure:s?.5:o[0].z,vector:new b(1,1),distance:0,runningLength:0,radius:1}];let p=0,f=h[0],v,m;u&&n>0&&o.push(o[o.length-1].clone());for(let y=1,S=o.length;y<S;y++)v=!i||e.last&&y===S-1?o[y].clone():o[y].clone().lrp(f.point,1-i),!f.point.equals(v)&&(m=b.Dist(v,f.point),p+=m,!(y<4&&p<r)&&(f={input:o[y],point:v,pressure:s?.5:o[y].z,vector:b.Sub(f.point,v).uni(),distance:m,runningLength:p,radius:1},h.push(f)));if((x=h[1])!=null&&x.vector&&(h[0].vector=h[1].vector.clone()),p<1){const y=Math.max(.5,...h.map(S=>S.pressure));h.forEach(S=>S.pressure=y)}return h}const{min:Eo}=Math,yy=.275;function mm(t,e){const{size:n=16,thinning:r=.5,simulatePressure:s=!0,easing:i=x=>x,start:o={},end:a={}}=e,{easing:l=dn.easeOutQuad}=o,{easing:c=dn.easeOutCubic}=a,u=t[t.length-1].runningLength;let h,p=t[0].pressure,f;if(!s&&u<n){const x=t.reduce((y,S)=>Math.max(y,S.pressure),.5);return t.forEach(y=>{y.pressure=x,y.radius=n*i(.5-r*(.5-y.pressure))}),t}else{let x;for(let y=0,S=t.length;y<S&&(f=t[y],!(f.runningLength>n*5));y++){const w=Eo(1,f.distance/n);if(s){const P=Eo(1,1-w);x=Eo(1,p+(P-p)*(w*yy))}else x=Eo(1,p+(f.pressure-p)*.5);p=p+(x-p)*.5}for(let y=0;y<t.length;y++){if(f=t[y],r){let{pressure:S}=f;const w=Eo(1,f.distance/n);if(s){const P=Eo(1,1-w);S=Eo(1,p+(P-p)*(w*yy))}else S=Eo(1,p+(S-p)*(w*yy));f.radius=n*i(.5-r*(.5-S)),p=S}else f.radius=n/2;h===void 0&&(h=f.radius)}}const v=o.taper===!1?0:o.taper===!0?Math.max(n,u):o.taper,m=a.taper===!1?0:a.taper===!0?Math.max(n,u):a.taper;if(v||m)for(let x=0;x<t.length;x++){f=t[x];const{runningLength:y}=f,S=y<v?l(y/v):1,w=u-y<m?c((u-y)/m):1;f.radius=Math.max(.01,f.radius*Math.min(S,w))}return t}function oJ(t,e={}){return V4(mm(wi(t,e),e),e)}function o7({scribble:t,zoom:e,color:n,opacity:r,className:s}){if(!t.points.length)return null;const i=oJ(t.points,{size:t.size/e,start:{taper:t.taper,easing:dn.linear},last:t.state==="stopping",simulatePressure:!1,streamline:.32});let o;if(i.length<4){const a=t.size/e/2,{x:l,y:c}=t.points[t.points.length-1];o=`M ${l-a},${c} a ${a},${a} 0 1,0 ${a*2},0 a ${a},${a} 0 1,0 ${-a*2},0`}else o=_4(i);return d.jsx("svg",{className:s&&be("tl-overlays__item",s),children:d.jsx("path",{className:"tl-scribble",d:o,fill:n??`var(--color-${t.color})`,opacity:r??t.opacity})})}const aJ=({bounds:t,rotation:e})=>{const n=G();return J("should display",()=>n.isInAny("select.idle","select.brushing","select.scribble_brushing","select.pointing_shape","select.pointing_selection","text.resizing"),[n])?d.jsx(fE,{bounds:t,rotation:e}):null};function mo(){const t=G();return J("isReadonlyMode",()=>t.getInstanceState().isReadonly,[t])}function lJ({size:t,width:e,height:n,hideAlternateHandles:r}){const s=K(t/3),i=s/2;return d.jsxs("svg",{className:"tl-overlays__item",children:[d.jsx("polyline",{className:"tl-corner-crop-handle",points:`
						${K(0-i)},${K(t)} 
						${K(0-i)},${K(0-i)} 
						${K(t)},${K(0-i)}`,strokeWidth:s,"data-testid":"selection.crop.top_left","aria-label":"top_left handle"}),d.jsx("line",{className:be("tl-corner-crop-edge-handle",{"tl-hidden":r}),x1:K(e/2-t),y1:K(0-i),x2:K(e/2+t),y2:K(0-i),strokeWidth:s,"data-testid":"selection.crop.top","aria-label":"top handle"}),d.jsx("polyline",{className:be("tl-corner-crop-handle",{"tl-hidden":r}),points:`
						${K(e-t)},${K(0-i)} 
						${K(e+i)},${K(0-i)} 
						${K(e+i)},${K(t)}`,strokeWidth:s,"data-testid":"selection.crop.top_right","aria-label":"top_right handle"}),d.jsx("line",{className:be("tl-corner-crop-edge-handle",{"tl-hidden":r}),x1:K(e+i),y1:K(n/2-t),x2:K(e+i),y2:K(n/2+t),strokeWidth:s,"data-testid":"selection.crop.right","aria-label":"right handle"}),d.jsx("polyline",{className:"tl-corner-crop-handle",points:`
						${K(e+i)},${K(n-t)} 
						${K(e+i)},${K(n+i)}
						${K(e-t)},${K(n+i)}`,strokeWidth:s,"data-testid":"selection.crop.bottom_right","aria-label":"bottom_right handle"}),d.jsx("line",{className:be("tl-corner-crop-edge-handle",{"tl-hidden":r}),x1:K(e/2-t),y1:K(n+i),x2:K(e/2+t),y2:K(n+i),strokeWidth:s,"data-testid":"selection.crop.bottom","aria-label":"bottom handle"}),d.jsx("polyline",{className:be("tl-corner-crop-handle",{"tl-hidden":r}),points:`
						${K(0+t)},${K(n+i)} 
						${K(0-i)},${K(n+i)}
						${K(0-i)},${K(n-t)}`,strokeWidth:s,"data-testid":"selection.crop.bottom_left","aria-label":"bottom_left handle"}),d.jsx("line",{className:be("tl-corner-crop-edge-handle",{"tl-hidden":r}),x1:K(0-i),y1:K(n/2-t),x2:K(0-i),y2:K(n/2+t),strokeWidth:s,"data-testid":"selection.crop.left","aria-label":"left handle"})]})}const cJ=gn(function({bounds:e,rotation:n}){const r=G(),s=C.useRef(null),i=mo(),o=ei("top"),a=ei("right"),l=ei("bottom"),c=ei("left"),u=ei("top_left"),h=ei("top_right"),p=ei("bottom_right"),f=ei("bottom_left"),v=!r.getIsMenuOpen()&&r.getInstanceState().cursor.type==="default",m=r.getInstanceState().isCoarsePointer,x=r.getOnlySelectedShape(),y=x&&r.isShapeOrAncestorLocked(x),S=x?r.getShapeUtil(x).expandSelectionOutlinePx(x):0;if(Jc(s,e==null?void 0:e.x,e==null?void 0:e.y,1,r.getSelectionRotation(),{x:-S,y:-S}),!e)return null;e=e.clone().expandBy(S).zeroFix();const w=r.getZoomLevel(),P=r.getInstanceState().isChangingStyle,E=e.width,M=e.height,I=8/w,_=E<I*2,D=M<I*2,R=E<I*4,$=M<I*4,U=E<I*5,O=M<I*5,N=m?1.75:1,H=6/w*N,Z=(R?H/2:H)*(N*.75),q=($?H/2:H)*(N*.75),V=(x?!r.getShapeUtil(x).hideSelectionBoundsFg(x):!0)&&!P;let Q=V&&r.isInAny("select.idle","select.brushing","select.scribble_brushing","select.pointing_canvas","select.pointing_selection","select.pointing_shape","select.crop.idle","select.crop.pointing_crop","select.crop.pointing_crop_handle","select.pointing_resize_handle")||V&&r.isIn("select.resizing")&&x&&r.isShapeOfType(x,"text");x&&Q&&r.environment.isFirefox&&r.isShapeOfType(x,"embed")&&(Q=!1);const ne=r.isInAny("select.crop.idle","select.crop.pointing_crop","select.crop.pointing_crop_handle")&&!P&&!i,le=r.isInAny("select.idle","select.pointing_selection","select.pointing_shape","select.crop.idle")&&!P&&!i,de=!m&&!(_||D)&&(le||ne)&&(x?!r.getShapeUtil(x).hideRotateHandle(x):!0)&&!y,_e=m&&(!R||!$)&&(le||ne)&&(x?!r.getShapeUtil(x).hideRotateHandle(x):!0)&&!y,je=le&&(x?r.getShapeUtil(x).canResize(x)&&!r.getShapeUtil(x).hideResizeHandles(x):!0)&&!ne&&!y,ce=_||D,tt=_&&D,Ue=U||O,et=je||ne,Ge=!de,lt=!le||!_e,nt=!le||!et,qn=!le||!et||ce,en=!le||!et||ce,an=!le||!et||tt&&!ne;let Et=!0,tn=!0;if(ne)Et=Ue,tn=Ue;else if(je){Et=ce||tt||m;const Ar=m&&x&&x.type==="text";tn=Et&&!Ar}const _r=Math.min(24/w,M-q*3),qs=le&&m&&x&&r.isShapeOfType(x,"text")&&_r*w>=4;return d.jsx("svg",{className:"tl-overlays__item tl-selection__fg","data-testid":"selection-foreground",children:d.jsxs("g",{ref:s,children:[Q&&d.jsx("rect",{className:"tl-selection__fg__outline",width:K(E),height:K(M)}),d.jsx(L0,{"data-testid":"selection.rotate.top-left",cx:0,cy:0,targetSize:H,corner:"top_left_rotate",cursor:v?jr("nwse-rotate",n):void 0,isHidden:Ge}),d.jsx(L0,{"data-testid":"selection.rotate.top-right",cx:E+H*3,cy:0,targetSize:H,corner:"top_right_rotate",cursor:v?jr("nesw-rotate",n):void 0,isHidden:Ge}),d.jsx(L0,{"data-testid":"selection.rotate.bottom-left",cx:0,cy:M+H*3,targetSize:H,corner:"bottom_left_rotate",cursor:v?jr("swne-rotate",n):void 0,isHidden:Ge}),d.jsx(L0,{"data-testid":"selection.rotate.bottom-right",cx:E+H*3,cy:M+H*3,targetSize:H,corner:"bottom_right_rotate",cursor:v?jr("senw-rotate",n):void 0,isHidden:Ge}),d.jsx(dJ,{"data-testid":"selection.rotate.mobile",cx:R?-H*1.5:E/2,cy:R?M/2:-H*1.5,size:I,isHidden:lt}),d.jsx("rect",{className:be("tl-transparent",{"tl-hidden":Et}),"data-testid":"selection.resize.top","aria-label":"top target",pointerEvents:"all",x:0,y:K(0-($?q*2:q)),width:K(E),height:K(Math.max(1,q*2)),style:v?{cursor:jr("ns-resize",n)}:void 0,...o}),d.jsx("rect",{className:be("tl-transparent",{"tl-hidden":tn}),"data-testid":"selection.resize.right","aria-label":"right target",pointerEvents:"all",x:K(E-(R?0:Z)),y:0,height:K(M),width:K(Math.max(1,Z*2)),style:v?{cursor:jr("ew-resize",n)}:void 0,...a}),d.jsx("rect",{className:be("tl-transparent",{"tl-hidden":Et}),"data-testid":"selection.resize.bottom","aria-label":"bottom target",pointerEvents:"all",x:0,y:K(M-($?0:q)),width:K(E),height:K(Math.max(1,q*2)),style:v?{cursor:jr("ns-resize",n)}:void 0,...l}),d.jsx("rect",{className:be("tl-transparent",{"tl-hidden":tn}),"data-testid":"selection.resize.left","aria-label":"left target",pointerEvents:"all",x:K(0-(R?Z*2:Z)),y:0,height:K(M),width:K(Math.max(1,Z*2)),style:v?{cursor:jr("ew-resize",n)}:void 0,...c}),d.jsx("rect",{className:be("tl-transparent",{"tl-hidden":nt}),"data-testid":"selection.target.top-left","aria-label":"top-left target",pointerEvents:"all",x:K(0-(R?Z*2:Z*1.5)),y:K(0-($?q*2:q*1.5)),width:K(Z*3),height:K(q*3),style:v?{cursor:jr("nwse-resize",n)}:void 0,...u}),d.jsx("rect",{className:be("tl-transparent",{"tl-hidden":qn}),"data-testid":"selection.target.top-right","aria-label":"top-right target",pointerEvents:"all",x:K(E-(R?0:Z*1.5)),y:K(0-($?q*2:q*1.5)),width:K(Z*3),height:K(q*3),style:v?{cursor:jr("nesw-resize",n)}:void 0,...h}),d.jsx("rect",{className:be("tl-transparent",{"tl-hidden":an}),"data-testid":"selection.target.bottom-right","aria-label":"bottom-right target",pointerEvents:"all",x:K(E-(R?Z:Z*1.5)),y:K(M-($?q:q*1.5)),width:K(Z*3),height:K(q*3),style:v?{cursor:jr("nwse-resize",n)}:void 0,...p}),d.jsx("rect",{className:be("tl-transparent",{"tl-hidden":en}),"data-testid":"selection.target.bottom-left","aria-label":"bottom-left target",pointerEvents:"all",x:K(0-(R?Z*3:Z*1.5)),y:K(M-($?0:q*1.5)),width:K(Z*3),height:K(q*3),style:v?{cursor:jr("nesw-resize",n)}:void 0,...f}),je&&d.jsxs(d.Fragment,{children:[d.jsx("rect",{"data-testid":"selection.resize.top-left",className:be("tl-corner-handle",{"tl-hidden":nt}),"aria-label":"top_left handle",x:K(0-I/2),y:K(0-I/2),width:K(I),height:K(I)}),d.jsx("rect",{"data-testid":"selection.resize.top-right",className:be("tl-corner-handle",{"tl-hidden":qn}),"aria-label":"top_right handle",x:K(E-I/2),y:K(0-I/2),width:K(I),height:K(I)}),d.jsx("rect",{"data-testid":"selection.resize.bottom-right",className:be("tl-corner-handle",{"tl-hidden":an}),"aria-label":"bottom_right handle",x:K(E-I/2),y:K(M-I/2),width:K(I),height:K(I)}),d.jsx("rect",{"data-testid":"selection.resize.bottom-left",className:be("tl-corner-handle",{"tl-hidden":en}),"aria-label":"bottom_left handle",x:K(0-I/2),y:K(M-I/2),width:K(I),height:K(I)})]}),qs&&d.jsxs(d.Fragment,{children:[d.jsx("rect",{"data-testid":"selection.text-resize.left.handle",className:"tl-text-handle","aria-label":"bottom_left handle",x:K(0-I/4),y:K(M/2-_r/2),rx:I/4,width:K(I/2),height:K(_r)}),d.jsx("rect",{"data-testid":"selection.text-resize.right.handle",className:"tl-text-handle","aria-label":"bottom_left handle",rx:I/4,x:K(E-I/4),y:K(M/2-_r/2),width:K(I/2),height:K(_r)})]}),ne&&d.jsx(lJ,{size:I,width:E,height:M,hideAlternateHandles:Ue})]})})}),L0=function({cx:e,cy:n,targetSize:r,corner:s,cursor:i,isHidden:o,"data-testid":a}){const l=ei(s);return d.jsx("rect",{className:be("tl-transparent","tl-rotate-corner",{"tl-hidden":o}),"data-testid":a,"aria-label":`${s} target`,pointerEvents:"all",x:K(e-r*3),y:K(n-r*3),width:K(Math.max(1,r*3)),height:K(Math.max(1,r*3)),cursor:i,...l})},uJ=Math.sqrt(Math.PI),dJ=function({cx:e,cy:n,size:r,isHidden:s,"data-testid":i}){const o=ei("mobile_rotate"),a=G(),l=J("zoom level",()=>a.getZoomLevel(),[a]),c=Math.max(14*(1/l),20/Math.max(1,l));return d.jsxs("g",{children:[d.jsx("circle",{"data-testid":i,pointerEvents:"all",className:be("tl-transparent","tl-mobile-rotate__bg",{"tl-hidden":s}),cx:e,cy:n,r:c,...o}),d.jsx("circle",{className:be("tl-mobile-rotate__fg",{"tl-hidden":s}),cx:e,cy:n,r:r/uJ})]})};function hJ(){const t=G();return J("is in a valid select state",()=>t.isInAny("select.idle","select.brushing","select.scribble_brushing","select.editing_shape","select.pointing_shape","select.pointing_selection","select.pointing_handle"),[t])?d.jsx(gE,{}):null}function J2(t,e,n){const{arrowheadStart:r,arrowheadEnd:s}=e.props,i=ac(t,e,n),o=i.start.clone(),a=i.end.clone(),l=b.Med(o,a);if(b.Equals(o,a))return{bindings:n,isStraight:!0,start:{handle:o,point:o,arrowhead:e.props.arrowheadStart},end:{handle:a,point:a,arrowhead:e.props.arrowheadEnd},middle:l,isValid:!1,length:0};const c=b.Sub(a,o).uni(),u=lg(t,e,"start"),h=lg(t,e,"end"),p=t.getShapePageTransform(e);a7(a,i.start,p,h),a7(o,i.end,p,u);let f=0,v=0,m=0,x=0,y=lc*e.props.scale;const S=u&&h&&u.shape===h.shape,w=u&&h?q4(t,u.shape.id,h.shape.id):"safe";w==="safe"&&u&&h&&!S&&!u.isExact&&!h.isExact&&(h.didIntersect&&!u.didIntersect?u.isClosed&&o.setTo(a.clone().add(c.clone().mul(lc*e.props.scale))):h.didIntersect||h.isClosed&&a.setTo(o.clone().sub(c.clone().mul(lc*e.props.scale))));const P=b.Sub(a,o),E=b.Len(P)?P.uni():b.From(P),M=!b.Equals(E,c);S||(w!=="start-contains-end"&&u&&r!=="none"&&!u.isExact&&(m=Bo[e.props.size]/2+("size"in u.shape.props?Bo[u.shape.props.size]/2:0),f=(cg+m)*e.props.scale,y+=m*e.props.scale),w!=="end-contains-start"&&h&&s!=="none"&&!h.isExact&&(x=Bo[e.props.size]/2+("size"in h.shape.props?Bo[h.shape.props.size]/2:0),v=(cg+x)*e.props.scale,y+=x*e.props.scale));const I=o.clone().add(E.clone().mul(f*(M?-1:1))),_=a.clone().sub(E.clone().mul(v*(M?-1:1)));b.DistMin(I,_,y)&&(f!==0&&v!==0?(f*=-1.5,v*=-1.5):f!==0?f*=-1:v!==0&&(v*=-1)),o.add(E.clone().mul(f*(M?-1:1))),a.sub(E.clone().mul(v*(M?-1:1))),M?(u&&h&&a.setTo(b.Add(o,E.clone().mul(-lc*e.props.scale))),l.setTo(b.Med(i.start,i.end))):l.setTo(b.Med(o,a));const D=b.Dist(o,a);return{bindings:n,isStraight:!0,start:{handle:i.start,point:o,arrowhead:e.props.arrowheadStart},end:{handle:i.end,point:a,arrowhead:e.props.arrowheadEnd},middle:l,isValid:D>0,length:D}}function a7(t,e,n,r){if(r===void 0||r.isExact)return;const s=xe.applyToPoint(n,e),i=xe.applyToPoint(n,t),o=xe.applyToPoint(xe.Inverse(r.transform),s),a=xe.applyToPoint(xe.Inverse(r.transform),i),l=r.isClosed,u=(l?L4:YX)(o,a,r.outline);let h;if(u!==null&&(h=u.sort((v,m)=>b.Dist2(v,o)-b.Dist2(m,o))[0]??(l?void 0:a)),h===void 0)return;const p=xe.applyToPoint(r.transform,h),f=xe.applyToPoint(xe.Inverse(n),p);t.setTo(f),r.didIntersect=!0}function pJ(t,e,n){const{arrowheadEnd:r,arrowheadStart:s}=e.props,i=e.props.bend;if(Math.abs(i)>Math.abs(e.props.bend*(vJ*e.props.scale)))return J2(t,e,n);const o=ac(t,e,n),a=b.Med(o.start,o.end),l=b.Sub(o.end,o.start),c=b.Len(l)?l.uni():b.From(l),u=b.Add(a,c.per().mul(-i)),h=lg(t,e,"start"),p=lg(t,e,"end"),f=o.start.clone(),v=o.end.clone(),m=u.clone();if(b.Equals(f,v))return{bindings:n,isStraight:!0,start:{handle:f,point:f,arrowhead:e.props.arrowheadStart},end:{handle:v,point:v,arrowhead:e.props.arrowheadEnd},middle:m,isValid:!1,length:0};const x=e.props.bend<0,y=x?Ph:qI,S=l7(f,v,m),w=b.Angle(S.center,f),P=b.Angle(S.center,v),E=y(w,P);if(S.length===0||S.size===0||!C6(S.length)||!C6(S.size))return J2(t,e,n);const M=f.clone(),I=v.clone(),_=m.clone(),D=t.getShapePageTransform(e);let R=0,$=0,U=lc*e.props.scale;if(h&&!h.isExact){const ne=xe.applyToPoint(D,M),le=xe.applyToPoint(D,S.center),de=xe.applyToPoint(D,I),_e=xe.Inverse(h.transform),je=xe.applyToPoint(_e,ne),ce=xe.applyToPoint(_e,le),tt=xe.applyToPoint(_e,de),{isClosed:Ue}=h,et=Ue?V2:W6;let Ge,lt=et(ce,S.radius,h.outline);if(lt){const nt=ce.angle(je),qn=ce.angle(tt),en=y(nt,qn);lt=lt.filter(Et=>y(nt,ce.angle(Et))<=en);const an=en*.25;lt.sort(Ue?(Et,tn)=>Math.abs(y(nt,ce.angle(Et))-an)<Math.abs(y(nt,ce.angle(tn))-an)?-1:1:(Et,tn)=>y(nt,ce.angle(Et))<y(nt,ce.angle(tn))?-1:1),Ge=lt[0]??(Ue?void 0:je)}else Ge=Ue?void 0:je;if(Ge&&(M.setTo(t.getPointInShapeSpace(e,xe.applyToPoint(h.transform,Ge))),h.didIntersect=!0,s!=="none")){const nt=Bo[e.props.size]/2+("size"in h.shape.props?Bo[h.shape.props.size]/2:0);R=(cg+nt)*e.props.scale,U+=nt*e.props.scale}}if(p&&!p.isExact){const ne=xe.applyToPoint(D,M),le=xe.applyToPoint(D,I),de=xe.applyToPoint(D,S.center),_e=xe.Inverse(p.transform),je=xe.applyToPoint(_e,ne),ce=xe.applyToPoint(_e,de),tt=xe.applyToPoint(_e,le),Ue=p.isClosed,et=Ue?V2:W6;let Ge,lt=et(ce,S.radius,p.outline);if(lt){const nt=ce.angle(je),qn=ce.angle(tt),en=y(nt,qn),an=en*.75;lt=lt.filter(Et=>y(nt,ce.angle(Et))<=en),lt.sort(Ue?(Et,tn)=>Math.abs(y(nt,ce.angle(Et))-an)<Math.abs(y(nt,ce.angle(tn))-an)?-1:1:(Et,tn)=>y(nt,ce.angle(Et))<y(nt,ce.angle(tn))?-1:1),lt[0]?Ge=lt[0]:Ge=Ue?void 0:tt}else Ge=Ue?void 0:tt;if(Ge&&(I.setTo(t.getPointInShapeSpace(e,xe.applyToPoint(p.transform,Ge))),p.didIntersect=!0,r!=="none")){const nt=Bo[e.props.size]/2+("size"in p.shape.props?Bo[p.shape.props.size]/2:0);$=(cg+nt)*e.props.scale,U+=nt*e.props.scale}}let O=b.Angle(S.center,M),N=b.Angle(S.center,I),H=y(O,N),Z=H*S.radius;const q=M.clone(),V=I.clone();if(R!==0&&q.setTo(S.center).add(b.FromAngle(O+H*(R/Z*(x?1:-1))).mul(S.radius)),$!==0&&V.setTo(S.center).add(b.FromAngle(N+H*($/Z*(x?-1:1))).mul(S.radius)),b.DistMin(q,V,U)&&(R!==0&&$!==0?(R*=-1.5,$*=-1.5):R!==0?R*=-2:$!==0&&($*=-2)),R!==0&&M.setTo(S.center).add(b.FromAngle(O+H*(R/Z*(x?1:-1))).mul(S.radius)),$!==0&&I.setTo(S.center).add(b.FromAngle(N+H*($/Z*(x?-1:1))).mul(S.radius)),h&&p&&!h.isExact&&!p.isExact){O=b.Angle(S.center,M),N=b.Angle(S.center,I),H=y(O,N),Z=H*S.radius;const ne=q4(t,h.shape.id,p.shape.id);ne==="double-bound"&&Z<30?(M.setTo(f),I.setTo(v),_.setTo(m)):ne==="safe"&&(h&&!h.didIntersect&&M.setTo(f),(p&&!p.didIntersect||y(w,O)>y(w,N))&&I.setTo(S.center).add(b.FromAngle(O+H*(Math.min(.9,lc*e.props.scale/Z)*(x?1:-1))).mul(S.radius)))}fJ(S.center,S.radius,M,I,_,E,x),M.equals(I)&&(M.setTo(_.clone().addXY(1,1)),I.setTo(_.clone().subXY(1,1))),f.setTo(M),v.setTo(I),m.setTo(_);const Q=l7(f,v,m);return{bindings:n,isStraight:!1,start:{point:f,handle:o.start,arrowhead:e.props.arrowheadStart},end:{point:v,handle:o.end,arrowhead:e.props.arrowheadEnd},middle:m,handleArc:S,bodyArc:Q,isValid:Q.length!==0&&isFinite(Q.center.x)&&isFinite(Q.center.y)}}function l7(t,e,n){const r=E4(t,e,n),s=b.Dist(r,t),i=+b.Clockwise(t,n,e),o=((t.y-e.y)**2+(t.x-e.x)**2)**.5,a=((e.y-n.y)**2+(e.x-n.x)**2)**.5,l=((n.y-t.y)**2+(n.x-t.x)**2)**.5,c=Math.acos((a*a+l*l-o*o)/(2*a*l))*2,u=+(Qe>c),h=(it-c)*(i?1:-1),p=h*s;return{center:r,radius:s,size:h,length:p,largeArcFlag:u,sweepFlag:i}}function fJ(t,e,n,r,s,i,o){const a=b.Angle(t,n),l=b.Angle(t,r);let c=Ph(a,l);if(o||(c=it-c),s.setTo(t).add(b.FromAngle(a+c*(.5*(o?1:-1))).mul(e)),c>i){s.rotWith(t,Qe);const u=r.clone();r.setTo(n),n.setTo(u)}}const gJ=8;function mJ(t){return Math.abs(t.props.bend)<gJ*t.props.scale}function lg(t,e,n){const r=t.getBindingsFromShape(e,"arrow").find(l=>l.props.terminal===n);if(!r)return;const s=t.getShape(r.toId);if(!s)return;const i=t.getShapePageTransform(s),o=t.getShapeGeometry(s),a=o instanceof $s?o.children[0].vertices:o.vertices;return{shape:s,transform:i,isClosed:o.isClosed,isExact:r.props.isExact,didIntersect:!1,outline:a}}function c7(t,e,n,r){const s=t.getShape(n.toId);if(s){const{point:i,size:o}=t.getShapeGeometry(s).bounds,a=b.Add(i,b.MulV(n.props.isPrecise||r?n.props.normalizedAnchor:{x:.5,y:.5},o)),l=xe.applyToPoint(t.getShapePageTransform(s),a);return xe.applyToPoint(xe.Inverse(e),l)}else return new b(0,0)}function vr(t,e){const n=t.getBindingsFromShape(e,"arrow");return{start:n.find(r=>r.props.terminal==="start"),end:n.find(r=>r.props.terminal==="end")}}const yJ=qG("arrow info",(t,e)=>{const n=vr(t,e);return mJ(e)?J2(t,e,n):pJ(t,e,n)});function li(t,e){const n=typeof e=="string"?e:e.id;return yJ.get(t,n)}function ac(t,e,n){var a,l;const r=t.getShapePageTransform(e),s=q4(t,(a=n.start)==null?void 0:a.toId,(l=n.end)==null?void 0:l.toId),i=n.start?c7(t,r,n.start,s==="double-bound"||s==="start-contains-end"):b.From(e.props.start),o=n.end?c7(t,r,n.end,s==="double-bound"||s==="end-contains-start"):b.From(e.props.end);return{start:i,end:o}}function Mu(t,e,n,r){const s=typeof e=="string"?e:e.id,i=typeof n=="string"?n:n.id,o=t.getBindingsFromShape(s,"arrow").filter(l=>l.props.terminal===r.terminal);o.length>1&&t.deleteBindings(o.slice(1));const a=o[0];a?t.updateBinding({...a,toId:i,props:r}):t.createBinding({type:"arrow",fromId:s,toId:i,props:r})}function zp(t,e,n){const r=t.getBindingsFromShape(e,"arrow").filter(s=>s.props.terminal===n);t.deleteBindings(r)}const lc=10,cg=10,vJ=10,Bo={s:2,m:3.5,l:5,xl:10};function q4(t,e,n){if(!e||!n)return"safe";if(e===n)return"double-bound";const r=t.getShapePageBounds(e),s=t.getShapePageBounds(n);if(r&&s){if(r.contains(s))return"start-contains-end";if(s.contains(r))return"end-contains-start"}return"safe"}class Fp extends Np{getDefaultProps(){return{isPrecise:!1,isExact:!1,normalizedAnchor:{x:.5,y:.5}}}onAfterCreate({binding:e}){vy(this.editor,this.editor.getShape(e.fromId))}onAfterChange({bindingAfter:e}){vy(this.editor,this.editor.getShape(e.fromId))}onAfterChangeFromShape({shapeAfter:e}){vy(this.editor,e)}onAfterChangeToShape({binding:e}){nT(this.editor,e.fromId)}onBeforeIsolateFromShape({binding:e}){const n=this.editor.getShape(e.fromId);n&&ug({editor:this.editor,arrow:n,terminal:e.props.terminal})}}g(Fp,"type","arrow"),g(Fp,"props",fI),g(Fp,"migrations",gI);function nT(t,e){var x;const n=t.getShape(e);if(!n)return;const r=vr(t,n),{start:s,end:i}=r,o=s?t.getShape(s.toId):void 0,a=i?t.getShape(i.toId):void 0,l=t.getAncestorPageId(n);if(!l)return;let c;if(o&&a)c=t.findCommonAncestor([o,a])??l;else if(o||a){const y=(x=o||a)==null?void 0:x.parentId;y&&y===n.parentId?c=n.parentId:c=l}else return;c&&c!==n.parentId&&t.reparentShapes([e],c);const u=t.getShape(e);if(!u)throw Error("no reparented arrow");const h=t.getShapeNearestSibling(u,o),p=t.getShapeNearestSibling(u,a);let f;if(h&&p)f=h.index>p.index?h:p;else if(h&&!p)f=h;else if(p&&!h)f=p;else return;let v;const m=t.getSortedChildIdsForParent(f.parentId).map(y=>t.getShape(y)).filter(y=>y.index>f.index);if(m.length){const y=m.find(S=>S.type!=="arrow");if(u.index>f.index&&(!y||u.index<y.index))return;v=Gd(f.index,m[0].index)}else v=js(f.index);v!==u.index&&t.updateShapes([{id:e,type:"arrow",index:v}])}function vy(t,e){const n=vr(t,e);for(const r of["start","end"]){const s=n[r];if(!s)continue;const i=t.getShape(s.toId),o=t.getAncestorPageId(e)===t.getAncestorPageId(i);(!i||!o)&&ug({editor:t,arrow:e,terminal:r,unbind:!0})}nT(t,e.id)}function ug({editor:t,arrow:e,terminal:n,unbind:r=!1,useHandle:s=!1}){const i=li(t,e);if(!i)throw new Error("expected arrow info");const o=s?i.start.handle:i.start.point,a=s?i.end.handle:i.end.point,l=n==="start"?o:a,c={id:e.id,type:"arrow",props:{[n]:{x:l.x,y:l.y},bend:e.props.bend}};if(!i.isStraight){const u=n==="start"?o:i.start.handle,h=n==="end"?a:i.end.handle,p=b.Med(u,h),f=b.Sub(u,h).per().uni().mul(i.handleArc.radius*2*Math.sign(e.props.bend)),v=_h(i.handleArc.center,b.Add(p,f),i.handleArc.center,i.handleArc.radius);We((v==null?void 0:v.length)===1);const m=b.Dist(p,v[0])*Math.sign(e.props.bend);ea(m,c.props.bend)||(c.props.bend=m)}t.updateShape(c),r&&zp(t,e,n)}const rT=[Fp],En={lineHeight:1.35,fontWeight:"normal",fontVariant:"normal",fontStyle:"normal",padding:"0px"},hn={s:2,m:3.5,l:5,xl:10},Rc={s:18,m:24,l:36,xl:44},Xi={s:18,m:22,l:26,xl:32},SJ={s:18,m:20,l:24,xl:28},mi={draw:"var(--tl-font-draw)",sans:"var(--tl-font-sans)",serif:"var(--tl-font-serif)",mono:"var(--tl-font-mono)"},xJ=20,wJ=4.25,ss=16;/*!
 * canvas-size
 * v1.2.6
 * https://github.com/jhildenbiddle/canvas-size
 * (c) 2015-2023 John Hildenbiddle <http://hildenbiddle.com>
 * MIT license
 */function bJ(t,e){var n=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(n!=null){var r,s,i,o,a=[],l=!0,c=!1;try{if(i=(n=n.call(t)).next,e===0){if(Object(n)!==n)return;l=!1}else for(;!(l=(r=i.call(n)).done)&&(a.push(r.value),a.length!==e);l=!0);}catch(u){c=!0,s=u}finally{try{if(!l&&n.return!=null&&(o=n.return(),Object(o)!==o))return}finally{if(c)throw s}}return a}}function u7(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(s){return Object.getOwnPropertyDescriptor(t,s).enumerable})),n.push.apply(n,r)}return n}function Rr(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?u7(Object(n),!0).forEach(function(r){CJ(t,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):u7(Object(n)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(n,r))})}return t}function CJ(t,e,n){return e=DJ(e),e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function PJ(t,e){if(t==null)return{};var n={},r=Object.keys(t),s,i;for(i=0;i<r.length;i++)s=r[i],!(e.indexOf(s)>=0)&&(n[s]=t[s]);return n}function kJ(t,e){if(t==null)return{};var n=PJ(t,e),r,s;if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);for(s=0;s<i.length;s++)r=i[s],!(e.indexOf(r)>=0)&&Object.prototype.propertyIsEnumerable.call(t,r)&&(n[r]=t[r])}return n}function d7(t,e){return EJ(t)||bJ(t,e)||sT(t,e)||_J()}function N0(t){return IJ(t)||TJ(t)||sT(t)||MJ()}function IJ(t){if(Array.isArray(t))return eS(t)}function EJ(t){if(Array.isArray(t))return t}function TJ(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function sT(t,e){if(t){if(typeof t=="string")return eS(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);if(n==="Object"&&t.constructor&&(n=t.constructor.name),n==="Map"||n==="Set")return Array.from(t);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return eS(t,e)}}function eS(t,e){(e==null||e>t.length)&&(e=t.length);for(var n=0,r=new Array(e);n<e;n++)r[n]=t[n];return r}function MJ(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function _J(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function AJ(t,e){if(typeof t!="object"||t===null)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var r=n.call(t,e||"default");if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function DJ(t){var e=AJ(t,"string");return typeof e=="symbol"?e:String(e)}function wd(t){var e=t.sizes.shift(),n=Math.max(Math.ceil(e[0]),1),r=Math.max(Math.ceil(e[1]),1),s=[n-1,r-1,1,1],i=Date.now(),o=typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope,a,l;o?(a=new OffscreenCanvas(1,1),l=new OffscreenCanvas(n,r)):(a=document.createElement("canvas"),a.width=1,a.height=1,l=document.createElement("canvas"),l.width=n,l.height=r);var c=a.getContext("2d"),u=l.getContext("2d");u&&(u.fillRect.apply(u,s),c.drawImage(l,n-1,r-1,1,1,0,0,1,1));var h=c&&c.getImageData(0,0,1,1).data[3]!==0,p=Date.now()-i;return[a,l].forEach(function(f){f.height=0,f.width=0}),o?(postMessage({width:n,height:r,benchmark:p,isTestPass:h}),!h&&t.sizes.length&&wd(t)):h?t.onSuccess(n,r,p):(t.onError(n,r,p),t.sizes.length&&wd(t)),h}var Sy={area:[16384,14188,11402,11180,10836,8192,4096,1],height:[8388607,65535,32767,16384,8192,4096,1],width:[4194303,65535,32767,16384,8192,4096,1]},jJ=["onError","onSuccess"],cc={max:null,min:1,sizes:[],step:1024,usePromise:!1,useWorker:!1,onError:Function.prototype,onSuccess:Function.prototype},_u={};function xy(t){var e=t.width===t.height,n=t.height===1,r=t.width===1,s=[];if(!t.width||!t.height)t.sizes.forEach(function(u){var h=e||n?u:1,p=e||r?u:1;s.push([h,p])});else for(var i=t.min||cc.min,o=t.step||cc.step,a=Math.max(t.width,t.height);a>=i;){var l=e||n?a:1,c=e||r?a:1;s.push([l,c]),a-=o}return s}function z0(t){var e=window&&"HTMLCanvasElement"in window,n=window&&"OffscreenCanvas"in window,r=Date.now(),s=t.onError,i=t.onSuccess,o=kJ(t,jJ),a=null;if(!e)return!1;if(t.useWorker&&n){var l=`
            var canvasTest = `.concat(wd.toString(),`;
            onmessage = function(e) {
                canvasTest(e.data);
            };
        `),c=new Blob([l],{type:"application/javascript"}),u=URL.createObjectURL(c);a=new Worker(u),URL.revokeObjectURL(u),a.onmessage=function(h){var p=h.data,f=p.width,v=p.height,m=p.benchmark,x=p.isTestPass;x?(_u[r].onSuccess(f,v,m),delete _u[r]):_u[r].onError(f,v,m)}}if(t.usePromise)return new Promise(function(h,p){var f=Rr(Rr({},t),{},{onError:function(y,S,w){var P;if(t.sizes.length===0)P=!0;else{var E=t.sizes.slice(-1),M=d7(E,1),I=d7(M[0],2),_=I[0],D=I[1];P=y===_&&S===D}s(y,S,w),P&&p({width:y,height:S,benchmark:w})},onSuccess:function(y,S,w){i(y,S,w),h({width:y,height:S,benchmark:w})}});if(a){var v=f.onError,m=f.onSuccess;_u[r]={onError:v,onSuccess:m},a.postMessage(o)}else wd(f)});if(a)_u[r]={onError:s,onSuccess:i},a.postMessage(o);else return wd(t)}var wy={maxArea:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},n=xy({width:e.max,height:e.max,min:e.min,step:e.step,sizes:N0(Sy.area)}),r=Rr(Rr(Rr({},cc),e),{},{sizes:n});return z0(r)},maxHeight:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},n=xy({width:1,height:e.max,min:e.min,step:e.step,sizes:N0(Sy.height)}),r=Rr(Rr(Rr({},cc),e),{},{sizes:n});return z0(r)},maxWidth:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},n=xy({width:e.max,height:1,min:e.min,step:e.step,sizes:N0(Sy.width)}),r=Rr(Rr(Rr({},cc),e),{},{sizes:n});return z0(r)},test:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},n=Rr(Rr({},cc),e);return n.sizes=N0(n.sizes),n.width&&n.height&&(n.sizes=[[n.width,n.height]]),z0(n)}};let by=null;function RJ(){return by||(by=OJ()),by}async function OJ(){const t=await wy.maxWidth({usePromise:!0}),e=await wy.maxHeight({usePromise:!0}),n=await wy.maxArea({usePromise:!0});return{maxWidth:t.width,maxHeight:e.height,maxArea:n.width*n.height}}const h7=8192,LJ=4096*4096;async function NJ(t,e){if(t<=h7&&e<=h7&&t*e<=LJ)return[t,e];const{maxWidth:n,maxHeight:r,maxArea:s}=await RJ(),i=t/e;if(t>n&&(t=n,e=t/i),e>r&&(e=r,t=e*i),t*e>s){const o=Math.sqrt(s/(t*e));t*=o,e*=o}return[t,e]}function zJ(t,e){const n=t.w/e.w,r=t.h/e.h;return n<=1&&r<=1?t:n>r?{w:t.w/n,h:t.h/n}:{w:t.w/r,h:t.h/r}}function FJ(t){if(typeof t!="string")throw new TypeError("Expected a string");return t.replace(/[|\\{}()[\]^$+*?.]/g,"\\$&").replace(/-/g,"\\x2d")}function $J(t){const e=new URL(t).host.replace("www.","");for(const n of Ch)if(iT(n.hostnames,e)){const r=n.fromEmbedUrl(t);if(r)return{definition:n,url:r,embedUrl:t}}}const BJ=t=>t.split("*").map(e=>FJ(e)).join(".+"),iT=(t,e)=>!!t.find(n=>{const r=new RegExp(BJ(n));return e.match(r)});function UJ(t){const e=new URL(t).host.replace("www.","");for(const n of Ch)if(iT(n.hostnames,e)){const r=n.toEmbedUrl(t);if(r)return{definition:n,embedUrl:r,url:t}}}function oT(t){return UJ(t)??$J(t)}function Uo(t){try{return oT(t)}catch(e){console.error(e)}}/*!
 * MIT License
 * Adapted (mostly copied) the work of https://github.com/fregante/text-field-edit
 * Copyright (c) Federico Brigante <opensource@bfred.it> (bfred.it)
 */const uc="  ",Xn=class Xn{static insertTextFirefox(e,n){e.setRangeText(n,e.selectionStart||0,e.selectionEnd||0,"end"),e.dispatchEvent(new InputEvent("input",{data:n,inputType:"insertText",isComposing:!1}))}static insert(e,n){const r=e.ownerDocument,s=r.activeElement;s!==e&&e.focus(),r.execCommand("insertText",!1,n)||Xn.insertTextFirefox(e,n),s===r.body?e.blur():s instanceof HTMLElement&&s!==e&&s.focus()}static set(e,n){e.select(),Xn.insert(e,n)}static getSelection(e){const{selectionStart:n,selectionEnd:r}=e;return e.value.slice(n||void 0,r||void 0)}static wrapSelection(e,n,r){const{selectionStart:s,selectionEnd:i}=e,o=Xn.getSelection(e);Xn.insert(e,n+o+(r??n)),e.selectionStart=(s||0)+n.length,e.selectionEnd=(i||0)+n.length}static replace(e,n,r){let s=0;e.value.replace(n,(...i)=>{const o=s+i[i.length-2],a=i[0].length;e.selectionStart=o,e.selectionEnd=o+a;const l=typeof r=="string"?r:r(...i);return Xn.insert(e,l),e.selectionStart=o,s+=l.length-a,l})}static findLineEnd(e,n){const r=e.lastIndexOf(`
`,n-1)+1;return e.charAt(r)!=="	"?n:r+1}static indent(e){var a;const{selectionStart:n,selectionEnd:r,value:s}=e,i=s.slice(n,r),o=(a=/\n/g.exec(i))==null?void 0:a.length;if(o&&o>0){const l=s.lastIndexOf(`
`,n-1)+1,c=e.value.slice(l,r-1),u=c.replace(/^|\n/g,`$&${uc}`),h=u.length-c.length;e.setSelectionRange(l,r-1),Xn.insert(e,u),e.setSelectionRange(n+1,r+h)}else Xn.insert(e,uc)}static unindent(e){const{selectionStart:n,selectionEnd:r,value:s}=e,i=s.lastIndexOf(`
`,n-1)+1,o=Xn.findLineEnd(s,r),a=e.value.slice(i,o),l=a.replace(/(^|\n)(\t| {1,2})/g,"$1"),c=a.length-l.length;e.setSelectionRange(i,o),Xn.insert(e,l);const u=/\t| {1,2}/.exec(s.slice(i,n)),h=u?u[0].length:0,p=n-h;e.setSelectionRange(n-h,Math.max(p,r-c))}static indentCE(e){var l;const n=window.getSelection(),r=e.innerText,s=F0(e)??0,i=F0(e)??0,o=r.slice(s,i),a=(l=/\n/g.exec(o))==null?void 0:l.length;if(a&&a>0){const c=r.lastIndexOf(`
`,s-1)+1,u=r.slice(c,i-1),p=u.replace(/^|\n/g,`$&${uc}`).length-u.length;n&&n.setBaseAndExtent(e,s+1,e,i+p)}else{const c=window.getSelection();e.innerText=r.slice(0,s)+uc+r.slice(s),c==null||c.setBaseAndExtent(e,s+1,e,s+2)}}static unindentCE(e){const n=window.getSelection(),r=e.innerText,s=F0(e)??0,i=F0(e)??0,o=r.lastIndexOf(`
`,s-1)+1,a=Xn.findLineEnd(r,i),l=r.slice(o,a),c=l.replace(/(^|\n)(\t| {1,2})/g,"$1"),u=l.length-c.length;if(n){n.setBaseAndExtent(e,o,e,a);const h=/\t| {1,2}/.exec(r.slice(o,s)),p=h?h[0].length:0,f=s-p;n.setBaseAndExtent(e,s-p,e,Math.max(f,i-u))}}static normalizeText(e){return e.replace(Xn.fixNewLines,`
`)}static normalizeTextForDom(e){return e.replace(Xn.fixNewLines,`
`).split(`
`).map(n=>n||" ").join(`
`)}};g(Xn,"fixNewLines",/\r?\n|\r/g);let Oc=Xn;function F0(t){if(typeof window.getSelection>"u")return;const e=window.getSelection();if(!e)return;let n=0;if(e.rangeCount!==0){const r=e.getRangeAt(0),s=r.cloneRange();s.selectNodeContents(t),s.setEnd(r.endContainer,r.endOffset),n=s.toString().length}return n}const HJ=/[\u0590-\u05FF\u0600-\u06FF\u0750-\u077F\u08A0-\u08FF\uFB50-\uFDFF\uFE70-\uFEFF]/;function aT(t){return HJ.test(t)}function WJ(t){return t.replace(/\t/g,uc)}function KJ(t){const e=t.split(`
`);for(;e[0]&&e[0].trim().length===0;)e.shift();let n=1/0;for(const r of e)if(r.trim().length>0){const s=r.length-r.trimStart().length;n=Math.min(n,s)}return e.map(r=>r.slice(n)).join(`
`)}function GJ(t){return t.replace(/[ \t]+$/gm,"").replace(/\n+$/,"")}function VJ(t){return GJ(KJ(WJ(t)))}function qJ(t,{maxImageDimension:e,maxAssetSize:n,acceptedImageMimeTypes:r,acceptedVideoMimeTypes:s},{toasts:i,msg:o}){t.registerExternalAssetHandler("file",async({file:a})=>{const l=a.name;let c=a;const u=r.includes(c.type),h=s.includes(c.type);!u&&!h&&i.addToast({title:o("assets.files.type-not-allowed"),severity:"error"}),We(u||h,`File type not allowed: ${c.type}`),c.size>n&&i.addToast({title:o("assets.files.size-too-big"),severity:"error"}),We(c.size<=n,`File size too big: ${(c.size/1024).toFixed()}kb > ${(n/1024).toFixed()}kb`),c.type==="video/quicktime"&&(c=new File([c],c.name,{type:"video/mp4"}));let p=u?await oi.getImageSize(c):await oi.getVideoSize(c);const f=await oi.isAnimated(c)||h,v=mG(await c.arrayBuffer());if(isFinite(e)){const y=zJ(p,{w:e,h:e});p!==y&&oi.isStaticImageType(c.type)&&(p=y)}const x={id:Ga.createId(v),type:u?"image":"video",typeName:"asset",props:{name:l,src:"",w:p.w,h:p.h,fileSize:c.size,mimeType:c.type,isAnimated:f}};return x.props.src=await t.uploadAsset(x,c),Ga.create(x)}),t.registerExternalAssetHandler("url",async({url:a})=>{var c,u,h,p,f;let l;try{const m=await(await yi(a,{method:"GET",mode:"no-cors"})).text(),x=new DOMParser().parseFromString(m,"text/html");l={image:((c=x.head.querySelector('meta[property="og:image"]'))==null?void 0:c.getAttribute("content"))??"",favicon:((u=x.head.querySelector('link[rel="apple-touch-icon"]'))==null?void 0:u.getAttribute("href"))??((h=x.head.querySelector('link[rel="icon"]'))==null?void 0:h.getAttribute("href"))??"",title:((p=x.head.querySelector('meta[property="og:title"]'))==null?void 0:p.getAttribute("content"))??a,description:((f=x.head.querySelector('meta[property="og:description"]'))==null?void 0:f.getAttribute("content"))??""},l.image.startsWith("http")||(l.image=new URL(l.image,a).href),l.favicon.startsWith("http")||(l.favicon=new URL(l.favicon,a).href)}catch(v){console.error(v),i.addToast({title:o("assets.url.failed"),severity:"error"}),l={image:"",favicon:"",title:"",description:""}}return{id:Ga.createId(R2(a)),typeName:"asset",type:"bookmark",props:{src:a,description:l.description,image:l.image,favicon:l.favicon,title:l.title},meta:{}}}),t.registerExternalContentHandler("svg-text",async({point:a,text:l})=>{const c=a??(t.inputs.shiftKey?t.inputs.currentPagePoint:t.getViewportPageBounds().center),u=new DOMParser().parseFromString(l,"image/svg+xml").querySelector("svg");if(!u)throw new Error("No <svg/> element present");let h=parseFloat(u.getAttribute("width")||"0"),p=parseFloat(u.getAttribute("height")||"0");if(!(h&&p)){document.body.appendChild(u);const v=u.getBoundingClientRect();document.body.removeChild(u),h=v.width,p=v.height}const f=await t.getAssetForExternalContent({type:"file",file:new File([l],"asset.svg",{type:"image/svg+xml"})});if(!f)throw Error("Could not create an asset");p7(t,[f],c)}),t.registerExternalContentHandler("embed",({point:a,url:l,embed:c})=>{const u=a??(t.inputs.shiftKey?t.inputs.currentPagePoint:t.getViewportPageBounds().center),{width:h,height:p}=c,f=ot(),v={id:f,type:"embed",x:u.x-(h||450)/2,y:u.y-(p||450)/2,props:{w:h,h:p,url:l}};t.createShapes([v]).select(f)}),t.registerExternalContentHandler("files",async({point:a,files:l})=>{const c=a??(t.inputs.shiftKey?t.inputs.currentPagePoint:t.getViewportPageBounds().center),u=new b(c.x,c.y),h=[];await Promise.all(l.map(async(p,f)=>{if(p.size>n)return i.addToast({title:o("assets.files.size-too-big"),severity:"error"}),console.warn(`File size too big: ${(p.size/1024).toFixed()}kb > ${(n/1024).toFixed()}kb`),null;if(!p.type)throw new Error("No mime type");if(!r.concat(s).includes(p.type))return i.addToast({title:o("assets.files.type-not-allowed"),severity:"error"}),console.warn(`${p.name} not loaded - Extension not allowed.`),null;try{const v=await t.getAssetForExternalContent({type:"file",file:p});if(!v)throw Error("Could not create an asset");h[f]=v}catch(v){return i.addToast({title:o("assets.files.upload-failed"),severity:"error"}),console.error(v),null}})),p7(t,Le(h),u)}),t.registerExternalContentHandler("text",async({point:a,text:l})=>{const c=a??(t.inputs.shiftKey?t.inputs.currentPagePoint:t.getViewportPageBounds().center),u=t.getShapeUtil("text").getDefaultProps(),h=VJ(l),p=t.getOnlySelectedShape();if(p&&"text"in p.props){t.updateShapes([{id:p.id,type:p.type,props:{text:h}}]);return}let f,v,m,x="middle";const y=h.split(`
`).length>1,S=aT(h);y&&(x=y?S?"end":"start":"middle");const w=t.textMeasure.measureText(h,{...En,fontFamily:mi[u.font],fontSize:Rc[u.size],maxWidth:null}),P=Math.min(y?t.getViewportPageBounds().width*.9:920,Math.max(200,t.getViewportPageBounds().width*.9));if(w.w>P){const E=t.textMeasure.measureText(h,{...En,fontFamily:mi[u.font],fontSize:Rc[u.size],maxWidth:P});f=E.w,v=E.h,m=!1,x=S?"end":"start"}else f=w.w,v=w.h,m=!0;c.y-v/2<t.getViewportPageBounds().minY+40&&(c.y=t.getViewportPageBounds().minY+40+v/2),t.createShapes([{id:ot(),type:"text",x:c.x-f/2,y:c.y-v/2,props:{text:h,textAlign:x,autoSize:m,w:f}}])}),t.registerExternalContentHandler("url",async({point:a,url:l})=>{const c=Uo(l);if(c)return t.putExternalContent({type:"embed",url:c.url,point:a,embed:c.definition});const u=a??(t.inputs.shiftKey?t.inputs.currentPagePoint:t.getViewportPageBounds().center),h=Ga.createId(R2(l)),p=YJ(t,l,u);let f=t.getAsset(h),v=!1;if(!f){v=!0;try{const m=await t.getAssetForExternalContent({type:"url",url:l});if(!m)throw Error("Could not create an asset");f=m}catch{i.addToast({title:o("assets.url.failed"),severity:"error"});return}}t.run(()=>{v&&t.createAssets([f]),t.updateShapes([{id:p.id,type:p.type,props:{assetId:f.id}}])})})}async function p7(t,e,n){if(!e.length)return[];const r=b.From(n),s=[];for(let i=0;i<e.length;i++){const o=e[i];switch(o.type){case"bookmark":{s.push({id:ot(),type:"bookmark",x:r.x,y:r.y,opacity:1,props:{assetId:o.id,url:o.props.src}}),r.x+=300;break}case"image":{s.push({id:ot(),type:"image",x:r.x,y:r.y,opacity:1,props:{assetId:o.id,w:o.props.w,h:o.props.h}}),r.x+=o.props.w;break}case"video":s.push({id:ot(),type:"video",x:r.x,y:r.y,opacity:1,props:{assetId:o.id,w:o.props.w,h:o.props.h}}),r.x+=o.props.w}}return t.run(()=>{const i=e.filter(o=>!t.getAsset(o.id));i.length&&t.createAssets(i),t.createShapes(s).select(...s.map(o=>o.id)),lT(t,n)}),s.map(i=>i.id)}function lT(t,e){const n=t.getViewportPageBounds();let r=t.getSelectionPageBounds();if(r){const s=r.center.sub(e);t.updateShapes(t.getSelectedShapes().map(i=>{const o=t.getShapeParentTransform(i).decompose().rotation,a=b.Rot(s,-o);return{id:i.id,type:i.type,x:i.x-a.x,y:i.y-a.y}}))}r=t.getSelectionPageBounds(),r&&!n.contains(r)&&t.zoomToSelection()}function YJ(t,e,n){const r={id:ot(),type:"bookmark",x:n.x-150,y:n.y-160,opacity:1,props:{assetId:null,url:e}};return t.run(()=>{t.createShapes([r]).select(r.id),lT(t,n)}),t.getShape(r.id)}var lv;let XJ=(lv=class extends Se{constructor(){super(...arguments);g(this,"onPointerDown",n=>{this.parent.transition("pointing",n)});g(this,"onEnter",()=>{this.editor.setCursor({type:"cross",rotation:0})});g(this,"onCancel",()=>{this.editor.setCurrentTool("select")});g(this,"onKeyUp",n=>{var r;if(n.key==="Enter"){if(this.editor.getInstanceState().isReadonly)return null;const s=this.editor.getOnlySelectedShape();s&&this.editor.getShapeUtil(s).canEdit(s)&&(this.editor.setCurrentTool("select"),this.editor.setEditingShape(s.id),(r=this.editor.root.getCurrent())==null||r.transition("editing_shape",{...n,target:"shape",shape:s}))}})}},g(lv,"id","idle"),lv);var cv;let ZJ=(cv=class extends Se{constructor(){super(...arguments);g(this,"shape");g(this,"markId","");g(this,"onEnter",()=>{this.didTimeout=!1;const n=this.editor.getShapeAtPoint(this.editor.inputs.currentPagePoint,{filter:r=>!r.isLocked&&this.editor.canBindShapes({fromShape:"arrow",toShape:r,binding:"arrow"}),margin:0,hitInside:!0,renderingOnly:!0});n?this.editor.setHintingShapes([n.id]):this.createArrowShape(),this.startPreciseTimeout()});g(this,"onExit",()=>{this.shape=void 0,this.editor.setHintingShapes([]),this.clearPreciseTimeout()});g(this,"onPointerMove",()=>{if(this.editor.inputs.isDragging){if(this.shape||this.createArrowShape(),!this.shape)throw Error("expected shape");this.updateArrowShapeEndHandle(),this.editor.setCurrentTool("select.dragging_handle",{shape:this.shape,handle:{id:"end",type:"vertex",index:"a3",x:0,y:0},isCreating:!0,onInteractionEnd:"arrow"})}});g(this,"onPointerUp",()=>{this.cancel()});g(this,"onCancel",()=>{this.cancel()});g(this,"onComplete",()=>{this.cancel()});g(this,"onInterrupt",()=>{this.cancel()});g(this,"preciseTimeout",-1);g(this,"didTimeout",!1)}cancel(){this.shape&&this.editor.bailToMark(this.markId),this.editor.setHintingShapes([]),this.parent.transition("idle")}createArrowShape(){var u;const{originPagePoint:n}=this.editor.inputs,r=ot();this.markId=`creating:${r}`,this.editor.mark(this.markId),this.editor.createShape({id:r,type:"arrow",x:n.x,y:n.y,props:{scale:this.editor.user.getIsDynamicResizeMode()?1/this.editor.getZoomLevel():1}});const s=this.editor.getShape(r);if(!s)throw Error("expected shape");const i=this.editor.getShapeHandles(s);if(!i)throw Error("expected handles for arrow");const o=this.editor.getShapeUtil("arrow"),a=this.shape,l=i.find(h=>h.id==="start"),c=(u=o.onHandleDrag)==null?void 0:u.call(o,s,{handle:{...l,x:0,y:0},isPrecise:!0,initial:a});c&&this.editor.updateShapes([c]),this.shape=this.editor.getShape(r),this.editor.select(r)}updateArrowShapeEndHandle(){var s,i;const n=this.shape;if(!n)throw Error("expected shape");const r=this.editor.getShapeHandles(n);if(!r)throw Error("expected handles for arrow");{const o=this.editor.getShapeUtil("arrow"),a=this.shape,l=r.find(u=>u.id==="start"),c=(s=o.onHandleDrag)==null?void 0:s.call(o,n,{handle:{...l,x:0,y:0},isPrecise:this.didTimeout,initial:a});c&&this.editor.updateShapes([c])}{const o=this.editor.getShapeUtil("arrow"),a=this.shape,l=this.editor.getPointInShapeSpace(n,this.editor.inputs.currentPagePoint),c=r.find(h=>h.id==="end"),u=(i=o.onHandleDrag)==null?void 0:i.call(o,this.editor.getShape(n),{handle:{...c,x:l.x,y:l.y},isPrecise:!1,initial:a});u&&this.editor.updateShapes([u])}this.shape=this.editor.getShape(n.id)}startPreciseTimeout(){this.preciseTimeout=this.editor.timers.setTimeout(()=>{this.getIsActive()&&(this.didTimeout=!0)},320)}clearPreciseTimeout(){clearTimeout(this.preciseTimeout)}},g(cv,"id","pointing"),cv);class $p extends Se{constructor(){super(...arguments);g(this,"shapeType","arrow")}}g($p,"id","arrow"),g($p,"initial","idle"),g($p,"children",()=>[XJ,ZJ]);class Y4 extends Se{constructor(){super(...arguments);g(this,"info",{});g(this,"initialShape");g(this,"shapeType",this.parent.id==="highlight"?"highlight":"draw");g(this,"util",this.editor.getShapeUtil(this.shapeType));g(this,"isPen",!1);g(this,"isPenOrStylus",!1);g(this,"segmentMode","free");g(this,"didJustShiftClickToExtendPreviousShapeLine",!1);g(this,"pagePointWhereCurrentSegmentChanged",{});g(this,"pagePointWhereNextSegmentChanged",null);g(this,"lastRecordedPoint",{});g(this,"mergeNextPoint",!1);g(this,"currentLineLength",0);g(this,"canDraw",!1);g(this,"markId",null);g(this,"onEnter",n=>{this.markId=null,this.info=n,this.canDraw=!this.editor.getIsMenuOpen(),this.lastRecordedPoint=this.editor.inputs.currentPagePoint.clone(),this.canDraw&&this.startShape()});g(this,"onPointerMove",()=>{const{inputs:n}=this.editor;if(this.isPen&&!n.isPen){if(this.markId){this.editor.bailToMark(this.markId),this.startShape();return}}else!this.canDraw&&n.isDragging&&(this.startShape(),this.canDraw=!0);this.canDraw&&(this.isPenOrStylus?b.Dist(n.currentPagePoint,this.lastRecordedPoint)>=1/this.editor.getZoomLevel()?(this.lastRecordedPoint=n.currentPagePoint.clone(),this.mergeNextPoint=!1):this.mergeNextPoint=!0:this.mergeNextPoint=!1,this.updateDrawingShape())});g(this,"onKeyDown",n=>{if(n.key==="Shift")switch(this.segmentMode){case"free":{this.segmentMode="starting_straight",this.pagePointWhereNextSegmentChanged=this.editor.inputs.currentPagePoint.clone();break}case"starting_free":this.segmentMode="starting_straight"}this.updateDrawingShape()});g(this,"onKeyUp",n=>{if(n.key==="Shift")switch(this.editor.snaps.clearIndicators(),this.segmentMode){case"straight":{this.segmentMode="starting_free",this.pagePointWhereNextSegmentChanged=this.editor.inputs.currentPagePoint.clone();break}case"starting_straight":{this.pagePointWhereNextSegmentChanged=null,this.segmentMode="free";break}}this.updateDrawingShape()});g(this,"onExit",()=>{this.editor.snaps.clearIndicators(),this.pagePointWhereCurrentSegmentChanged=this.editor.inputs.currentPagePoint.clone()});g(this,"onPointerUp",()=>{this.complete()});g(this,"onCancel",()=>{this.cancel()});g(this,"onComplete",()=>{this.complete()});g(this,"onInterrupt",()=>{this.editor.inputs.isDragging||(this.markId&&this.editor.bailToMark(this.markId),this.cancel())})}canClose(){return this.shapeType!=="highlight"}getIsClosed(n,r,s){if(!this.canClose())return!1;const i=hn[r],o=n[0].points[0],a=n[n.length-1],l=a.points[a.points.length-1];return o!==l&&this.currentLineLength>i*4*s&&b.DistMin(o,l,i*2*s)}startShape(){const{inputs:{originPagePoint:n,isPen:r}}=this.editor;this.markId="draw start "+dt(),this.editor.mark(this.markId);const{z:s=.5}=this.info.point;this.isPen=r,this.isPenOrStylus=r||s>0&&s<.5||s>.5&&s<1;const i=this.isPenOrStylus?s*1.25:.5;if(this.segmentMode=this.editor.inputs.shiftKey?"straight":"free",this.didJustShiftClickToExtendPreviousShapeLine=!1,this.lastRecordedPoint=n.clone(),this.initialShape){const a=this.editor.getShape(this.initialShape.id);if(a&&this.segmentMode==="straight"){this.didJustShiftClickToExtendPreviousShapeLine=!0;const l=xn(a.props.segments);if(!l)throw Error("Expected a previous segment!");const c=xn(l.points);if(!c)throw Error("Expected a previous point!");const{x:u,y:h}=this.editor.getPointInShapeSpace(a,n).toFixed(),p={type:this.segmentMode,points:[{x:c.x,y:c.y,z:+i.toFixed(2)},{x:u,y:h,z:+i.toFixed(2)}]},f=xe.applyToPoint(this.editor.getShapePageTransform(a.id),c);this.pagePointWhereCurrentSegmentChanged=f,this.pagePointWhereNextSegmentChanged=null;const v=[...a.props.segments,p];this.currentLineLength<hn[a.props.size]*4&&(this.currentLineLength=this.getLineLength(v));const m={id:a.id,type:this.shapeType,props:{segments:v}};this.canClose()&&(m.props.isClosed=this.getIsClosed(v,a.props.size,a.props.scale)),this.editor.updateShapes([m]);return}}this.pagePointWhereCurrentSegmentChanged=n.clone();const o=ot();this.editor.createShapes([{id:o,type:this.shapeType,x:n.x,y:n.y,props:{isPen:this.isPenOrStylus,scale:this.editor.user.getIsDynamicResizeMode()?1/this.editor.getZoomLevel():1,segments:[{type:this.segmentMode,points:[{x:0,y:0,z:+i.toFixed(2)}]}]}}]),this.currentLineLength=0,this.initialShape=this.editor.getShape(o)}updateDrawingShape(){const{initialShape:n}=this,{inputs:r}=this.editor;if(!n)return;const{id:s,props:{size:i,scale:o}}=n,a=this.editor.getShape(s);if(!a)return;const{segments:l}=a.props,{x:c,y:u,z:h}=this.editor.getPointInShapeSpace(a,r.currentPagePoint).toFixed(),p=this.isPenOrStylus?+(r.currentPagePoint.z*1.25).toFixed(2):.5,f={x:c,y:u,z:p};switch(this.segmentMode){case"starting_straight":{const{pagePointWhereNextSegmentChanged:v}=this;if(v===null)throw Error("We should have a point where the segment changed");if(b.Dist2(v,r.currentPagePoint)>this.editor.options.dragDistanceSquared){this.pagePointWhereCurrentSegmentChanged=this.pagePointWhereNextSegmentChanged.clone(),this.pagePointWhereNextSegmentChanged=null,this.segmentMode="straight";const x=xn(l);if(!x)throw Error("Expected a previous segment!");const y=xn(x.points);if(!y)throw Error("Expected a previous last point!");let S;const w=this.editor.getPointInShapeSpace(a,this.pagePointWhereCurrentSegmentChanged).toFixed().toJson();if(x.type==="straight"){this.currentLineLength+=b.Dist(y,w),S={type:"straight",points:[{...y},w]};const E=this.editor.getShapePageTransform(a);this.pagePointWhereCurrentSegmentChanged=xe.applyToPoint(E,y)}else S={type:"straight",points:[w,f]};const P={id:s,type:this.shapeType,props:{segments:[...l,S]}};this.canClose()&&(P.props.isClosed=this.getIsClosed(l,i,o)),this.editor.updateShapes([P])}break}case"starting_free":{const{pagePointWhereNextSegmentChanged:v}=this;if(v===null)throw Error("We should have a point where the segment changed");if(b.Dist2(v,r.currentPagePoint)>this.editor.options.dragDistanceSquared){this.pagePointWhereCurrentSegmentChanged=this.pagePointWhereNextSegmentChanged.clone(),this.pagePointWhereNextSegmentChanged=null,this.segmentMode="free";const x=l.slice(),y=x[x.length-1],S=xn(y.points);if(!S)throw Error("No previous point!");const w={type:"free",points:[...b.PointsBetween(S,f,6).map(M=>({x:Ui(M.x),y:Ui(M.y),z:Ui(M.z)}))]},P=[...x,w];this.currentLineLength<hn[a.props.size]*4&&(this.currentLineLength=this.getLineLength(P));const E={id:s,type:this.shapeType,props:{segments:P}};this.canClose()&&(E.props.isClosed=this.getIsClosed(P,i,o)),this.editor.updateShapes([E])}break}case"straight":{const v=l.slice(),m=v[v.length-1],{pagePointWhereCurrentSegmentChanged:x}=this,{ctrlKey:y,currentPagePoint:S}=this.editor.inputs;if(!x)throw Error("We should have a point where the segment changed");let w,P=!1;this.didJustShiftClickToExtendPreviousShapeLine?this.editor.inputs.isDragging&&(P=!y,this.didJustShiftClickToExtendPreviousShapeLine=!1):P=!y;let E=this.editor.getPointInShapeSpace(a,S).toFixed().toJson(),M=!1,I;if((this.editor.user.getIsSnapMode()?!y:y)&&v.length>2){let R,$=8/this.editor.getZoomLevel();for(let U=0,O=l.length-2;U<O;U++){const N=l[U];if(!N)break;if(N.type==="free")continue;const H=N.points[0],Z=xn(N.points);if(!(H&&Z))continue;const q=b.NearestPointOnLineSegment(H,Z,E);if(b.DistMin(q,E,$)){R=q.toFixed().toJson(),$=b.Dist(q,E),I=N;break}}R&&(M=!0,E=R)}if(M&&I){const R=this.editor.getShapePageTransform(a),$=I.points[0],U=xn(I.points);if(!U)throw Error("Expected a last point!");const O=xe.applyToPoint(R,$),N=xe.applyToPoint(R,U),H=xe.applyToPoint(R,E);this.editor.snaps.setIndicators([{id:dt(),type:"points",points:[O,H,N]}])}else{if(this.editor.snaps.clearIndicators(),P){const R=b.Angle(x,S),U=sg(R,24)-R;w=b.RotWith(S,x,U)}else w=S;E=this.editor.getPointInShapeSpace(a,w).toFixed().toJson()}this.currentLineLength+=b.Dist(m.points[0],E),v[v.length-1]={...m,type:"straight",points:[m.points[0],E]};const D={id:s,type:this.shapeType,props:{segments:v}};this.canClose()&&(D.props.isClosed=this.getIsClosed(l,i,o)),this.editor.updateShapes([D]);break}case"free":{const v=l.slice(),m=v[v.length-1],x=[...m.points];if(x.length&&this.mergeNextPoint){const{z:S}=x[x.length-1];x[x.length-1]={x:f.x,y:f.y,z:S?Math.max(S,f.z):f.z}}else this.currentLineLength+=b.Dist(x[x.length-1],f),x.push(f);v[v.length-1]={...m,points:x},this.currentLineLength<hn[a.props.size]*4&&(this.currentLineLength=this.getLineLength(v));const y={id:s,type:this.shapeType,props:{segments:v}};if(this.canClose()&&(y.props.isClosed=this.getIsClosed(v,i,o)),this.editor.updateShapes([y]),x.length>this.editor.options.maxPointsPerDrawShape){this.editor.updateShapes([{id:s,type:this.shapeType,props:{isComplete:!0}}]);const S=ot(),w=this.editor.getShape(s).props;this.editor.createShapes([{id:S,type:this.shapeType,x:Ui(r.currentPagePoint.x),y:Ui(r.currentPagePoint.y),props:{isPen:this.isPenOrStylus,scale:w.scale,segments:[{type:"free",points:[{x:0,y:0,z:this.isPenOrStylus?+(h*1.25).toFixed():.5}]}]}}]),this.initialShape=yt(this.editor.getShape(S)),this.mergeNextPoint=!1,this.lastRecordedPoint=r.currentPagePoint.clone(),this.currentLineLength=0}break}}}getLineLength(n){let r=0;for(const s of n)for(let i=0;i<s.points.length-1;i++){const o=s.points[i],a=s.points[i+1];r+=b.Dist2(a,o)}return Math.sqrt(r)}complete(){if(!this.canDraw){this.cancel();return}const{initialShape:n}=this;n&&(this.editor.updateShapes([{id:n.id,type:n.type,props:{isComplete:!0}}]),this.parent.transition("idle"))}cancel(){this.parent.transition("idle",this.info)}}g(Y4,"id","drawing");var uv;let cT=(uv=class extends Se{constructor(){super(...arguments);g(this,"onPointerDown",n=>{this.parent.transition("drawing",n)});g(this,"onEnter",()=>{this.editor.setCursor({type:"cross",rotation:0})});g(this,"onCancel",()=>{this.editor.setCurrentTool("select")})}},g(uv,"id","idle"),uv);class Gu extends Se{constructor(){super(...arguments);g(this,"shapeType","draw");g(this,"onExit",()=>{const n=this.children.drawing;n.initialShape=void 0})}}g(Gu,"id","draw"),g(Gu,"initial","idle"),g(Gu,"isLockable",!1),g(Gu,"children",()=>[cT,Y4]);class tS extends xd{constructor(){super(...arguments);g(this,"shapeType","frame");g(this,"onCreate",n=>{if(!n)return;const r=this.editor.getShapePageBounds(n),s=[],i=this.editor.getShapeAncestors(n).map(o=>o.id);this.editor.getSortedChildIdsForParent(n.parentId).map(o=>{const a=this.editor.getShape(o);if(!a||a.id===n.id||a.isLocked)return;const l=this.editor.getShapePageBounds(a);l&&r.contains(l)&&QJ(a,i,n)&&s.push(a.id)}),this.editor.reparentShapes(s,n.id),this.editor.getInstanceState().isToolLocked?this.editor.setCurrentTool("frame"):this.editor.setCurrentTool("select.idle")})}}g(tS,"id","frame"),g(tS,"initial","idle");function QJ(t,e,n){return e.includes(t.id)?!1:t.parentId===n.parentId}var dv;let JJ=(dv=class extends Se{constructor(){super(...arguments);g(this,"onPointerDown",n=>{this.parent.transition("pointing",n)});g(this,"onEnter",()=>{this.editor.setCursor({type:"cross",rotation:0})});g(this,"onKeyUp",n=>{var r;if(n.key==="Enter"){if(this.editor.getInstanceState().isReadonly)return null;const s=this.editor.getOnlySelectedShape();s&&this.editor.getShapeUtil(s).canEdit(s)&&(this.editor.setCurrentTool("select"),this.editor.setEditingShape(s.id),(r=this.editor.root.getCurrent())==null||r.transition("editing_shape",{...n,target:"shape",shape:s}))}});g(this,"onCancel",()=>{this.editor.setCurrentTool("select")})}},g(dv,"id","idle"),dv);var hv;let eee=(hv=class extends Se{constructor(){super(...arguments);g(this,"markId","");g(this,"onPointerUp",()=>{this.complete()});g(this,"onPointerMove",n=>{if(this.editor.inputs.isDragging){const{originPagePoint:r}=this.editor.inputs,s=ot();this.markId=`creating:${s}`,this.editor.mark(this.markId),this.editor.createShapes([{id:s,type:"geo",x:r.x,y:r.y,props:{w:1,h:1,geo:this.editor.getStyleForNextShape(Os),scale:this.editor.user.getIsDynamicResizeMode()?1/this.editor.getZoomLevel():1}}]).select(s).setCurrentTool("select.resizing",{...n,target:"selection",handle:"bottom_right",isCreating:!0,creationCursorOffset:{x:1,y:1},onInteractionEnd:"geo"})}});g(this,"onCancel",()=>{this.cancel()});g(this,"onComplete",()=>{this.complete()});g(this,"onInterrupt",()=>{this.cancel()})}complete(){const{originPagePoint:n}=this.editor.inputs,r=ot();this.markId=`creating:${r}`,this.editor.mark(this.markId);const s=this.editor.user.getIsDynamicResizeMode()?1/this.editor.getZoomLevel():1,i=this.editor.getStyleForNextShape(Os),o=i==="star"?{w:200,h:190}:i==="cloud"?{w:300,h:180}:{w:200,h:200};this.editor.createShapes([{id:r,type:"geo",x:n.x,y:n.y,props:{geo:this.editor.getStyleForNextShape(Os),scale:s,...o}}]);const a=this.editor.getShape(r);if(!a)return;const{w:l,h:c}=a.props,u=new b(l/2,c/2).mul(s),h=this.editor.getShapeParentTransform(a);h&&u.rot(-h.rotation()),this.editor.select(r),this.editor.updateShape({id:a.id,type:"geo",x:a.x-u.x,y:a.y-u.y,props:{geo:this.editor.getStyleForNextShape(Os),w:l*s,h:c*s}}),this.editor.getInstanceState().isToolLocked?this.parent.transition("idle"):this.editor.setCurrentTool("select",{})}cancel(){this.parent.transition("idle")}},g(hv,"id","pointing"),hv);class Bp extends Se{constructor(){super(...arguments);g(this,"shapeType","geo")}}g(Bp,"id","geo"),g(Bp,"initial","idle"),g(Bp,"children",()=>[JJ,eee]);class Vu extends Se{constructor(){super(...arguments);g(this,"shapeType","highlight");g(this,"onExit",()=>{const n=this.children.drawing;n.initialShape=void 0})}}g(Vu,"id","highlight"),g(Vu,"initial","idle"),g(Vu,"children",()=>[cT,Y4]),g(Vu,"isLockable",!1);var pv;let tee=(pv=class extends Se{constructor(){super(...arguments);g(this,"shapeId","");g(this,"onEnter",n=>{this.shapeId=n.shapeId,this.editor.setCursor({type:"cross",rotation:0})});g(this,"onPointerDown",()=>{this.parent.transition("pointing",{shapeId:this.shapeId})});g(this,"onCancel",()=>{this.editor.setCurrentTool("select")})}},g(pv,"id","idle"),pv);const f7=2;var fv;let nee=(fv=class extends Se{constructor(){super(...arguments);g(this,"shape",{});g(this,"markId");g(this,"onEnter",n=>{const{inputs:r}=this.editor,{currentPagePoint:s}=r;this.markId=void 0;const i=n.shapeId&&this.editor.getShape(n.shapeId);if(i&&r.shiftKey){this.markId=`creating:${i.id}`,this.editor.mark(this.markId),this.shape=i;const o=this.editor.getShapeHandles(this.shape);if(!o)return;const a=o.filter(f=>f.type==="vertex").sort(Un),l=a[a.length-1],c=a[a.length-2],u=xe.applyToPoint(this.editor.getShapeParentTransform(this.shape),new b(this.shape.x,this.shape.y)),h=b.Sub(s,u).addXY(.1,.1),p=yt(this.shape.props.points);if(b.DistMin(l,c,f7)||b.DistMin(h,l,f7))p[l.id]={id:l.id,index:l.index,x:h.x,y:h.y};else{const f=js(l.index);p[f]={id:f,index:f,x:h.x,y:h.y}}this.editor.updateShapes([{id:this.shape.id,type:this.shape.type,props:{points:p}}])}else{const o=ot();this.markId=`creating:${o}`,this.editor.mark(this.markId),this.editor.createShapes([{id:o,type:"line",x:s.x,y:s.y,props:{scale:this.editor.user.getIsDynamicResizeMode()?1/this.editor.getZoomLevel():1}}]),this.editor.select(o),this.shape=this.editor.getShape(o)}});g(this,"onPointerMove",()=>{if(this.shape&&this.editor.inputs.isDragging){const n=this.editor.getShapeHandles(this.shape);if(!n)throw this.markId&&this.editor.bailToMark(this.markId),Error("No handles found");const r=xn(n);this.editor.setCurrentTool("select.dragging_handle",{shape:this.shape,isCreating:!0,handle:{...r,x:r.x-.1,y:r.y-.1},onInteractionEnd:"line"})}});g(this,"onPointerUp",()=>{this.complete()});g(this,"onCancel",()=>{this.cancel()});g(this,"onComplete",()=>{this.complete()});g(this,"onInterrupt",()=>{this.parent.transition("idle"),this.markId&&this.editor.bailToMark(this.markId),this.editor.snaps.clearIndicators()})}complete(){this.parent.transition("idle",{shapeId:this.shape.id}),this.editor.snaps.clearIndicators()}cancel(){this.markId&&this.editor.bailToMark(this.markId),this.parent.transition("idle",{shapeId:this.shape.id}),this.editor.snaps.clearIndicators()}},g(fv,"id","pointing"),fv);class Up extends Se{constructor(){super(...arguments);g(this,"shapeType","line")}}g(Up,"id","line"),g(Up,"initial","idle"),g(Up,"children",()=>[tee,nee]);var gv;let ree=(gv=class extends Se{constructor(){super(...arguments);g(this,"onPointerDown",n=>{this.parent.transition("pointing",n)});g(this,"onEnter",()=>{this.editor.setCursor({type:"cross",rotation:0})});g(this,"onCancel",()=>{this.editor.setCurrentTool("select")})}},g(gv,"id","idle"),gv);function ft(t,e){var s;const n=new Set;for(const i of e){const o=t.getShape(i);if(!o)continue;t.getShapeUtil(o).onDragShapesOut&&n.add(o);const a=t.getShape(o.parentId);a&&t.getShapeUtil(a).onDragShapesOut&&n.add(a)}const r=new Map;for(const i of n){const o=uT(t,i);o.length&&r.set(i,o)}for(const[i,o]of r){const a=t.getShapeUtil(i),l=Le(o.map(c=>t.getShape(c)));(s=a.onDragShapesOut)==null||s.call(a,i,l)}}function uT(t,e){const n=t.getSortedChildIdsForParent(e.id);if(n.length===0)return[];const r=t.getShapePageBounds(e);if(!r)return[];let s,i,o;const a=[];for(const l of n){const c=t.getShapePageBounds(l);if(!c)continue;if(!r.includes(c)){a.push(l);continue}s??(s=t.getShapeGeometry(e)),i??(i=t.getShapePageTransform(e)),o??(o=i.applyToPoints(s.vertices));const u=t.getShapePageTransform(l).clone().invert().applyToPoints(o),{vertices:h,isClosed:p}=t.getShapeGeometry(l);if(!h.some(f=>Wr(f,u))){if(p){if(OE(u,h))continue}else if(QX(u,h))continue;a.push(l)}}return a}function dg(t,e,n=!1){t.select(e),t.setEditingShape(e),t.setCurrentTool("select.editing_shape",{target:"shape",shape:e}),n&&t.emit("select-all-text",{shapeId:e.id}),dT(t)}const see=16;function dT(t){const e=t.getSelectionPageBounds(),n=t.getViewportPageBounds();if(e&&!n.contains(e)){const r=e.clone().expandBy(see/t.getZoomLevel()).expand(n),s=n.clone().translate({x:(r.center.x-n.center.x)*2,y:(r.center.y-n.center.y)*2});t.zoomToBounds(s,{animation:{duration:t.options.animationMediumMs},inset:0})}}const iee=0,ut=200,ym=new b(ut/2,ut/2),hT=10,oee=t=>[[["a1"],new b(ut*.5,ut*-.5-t.options.adjacentShapeMargin)],[["a2"],new b(ut*1.5+t.options.adjacentShapeMargin,ut*.5)],[["a3"],new b(ut*.5,ut*1.5+t.options.adjacentShapeMargin)],[["a4"],new b(ut*-.5-t.options.adjacentShapeMargin,ut*.5)]];function aee(t,e){if(e===1)return oee(t);const n=ut*e,r=t.options.adjacentShapeMargin*e;return[[["a1"],new b(n*.5,n*-.5-r)],[["a2"],new b(n*1.5+r,n*.5)],[["a3"],new b(n*.5,n*1.5+r)],[["a4"],new b(n*-.5-r,n*.5)]]}function pT(t,e,n,r,s,i){return Object.fromEntries(aee(t,i).map(([o,a],l)=>{const c=a.clone();return l===0&&s?c.y-=s:l===2&&r&&(c.y+=r),[o,c.rot(n).add(e)]}))}function fT(t,e,n,r){const s=new Set(t.getSelectedShapeIds()),i=(ut+t.options.adjacentShapeMargin+r)**2,o=new Map,a=[];for(const u of t.getCurrentPageShapes()){if(!t.isShapeOfType(u,"note")||n!==u.props.scale||s.has(u.id))continue;const h=t.getShapePageTransform(u.id);e===h.rotation()&&(o.set(u,t.getShapePageBounds(u).center),a.push(...Object.values(pT(t,h.point(),e,u.props.growY,r,n))))}const l=a.length;let c;for(const[u,h]of o)for(let p=0;p<l;p++)c=a[p],c&&(b.Dist2(h,c)>i||t.isPointInShape(u,c)&&(a[p]=void 0));return Le(a)}function gT(t,e,n,r,s=!1){let i;const o=t.getCurrentPageShapesSorted(),a=(ut+t.options.adjacentShapeMargin**2)**e.props.scale;for(let l=o.length-1;l>=0;l--){const c=o[l];if(c.type==="note"&&c.id!==e.id){const u=t.getShapePageBounds(c);if(u&&b.Dist2(u.center,n)<a&&t.isPointInShape(c,n)){i=c;break}}}if(t.complete(),!i||s){t.mark("creating note shape");const l=ot();t.createShape({id:l,type:"note",x:n.x,y:n.y,rotation:r,opacity:e.opacity,props:{...e.props,text:"",growY:0,fontSizeAdjustment:0,url:""}});const c=t.getShape(l);if(!c)return;const u=t.getPointInParentSpace(c,b.Sub(n,b.Rot(ym.clone().mul(c.props.scale),r)));t.updateShape({id:l,type:"note",x:u.x,y:u.y}),i=t.getShape(l)}return dT(t),i}var mv;let lee=(mv=class extends Se{constructor(){super(...arguments);g(this,"dragged",!1);g(this,"info",{});g(this,"wasFocusedOnEnter",!1);g(this,"markId","");g(this,"shape",{});g(this,"onEnter",()=>{const{editor:n}=this;if(this.wasFocusedOnEnter=!n.getIsMenuOpen(),this.wasFocusedOnEnter){const r=ot();this.markId=`creating:${r}`,n.mark(this.markId);const s=this.editor.inputs.originPagePoint.clone(),i=g7(this.editor,s,this.editor.user.getIsDynamicResizeMode()?1/this.editor.getZoomLevel():1);i&&s.sub(i),this.shape=m7(this.editor,r,s)}});g(this,"onPointerMove",n=>{if(this.editor.inputs.isDragging){if(!this.wasFocusedOnEnter){const r=ot(),s=this.editor.inputs.originPagePoint.clone(),i=g7(this.editor,s,this.editor.user.getIsDynamicResizeMode()?1/this.editor.getZoomLevel():1);i&&s.sub(i),this.shape=m7(this.editor,r,s)}this.editor.setCurrentTool("select.translating",{...n,target:"shape",shape:this.shape,onInteractionEnd:"note",isCreating:!0,onCreate:()=>{this.editor.setEditingShape(this.shape.id),this.editor.setCurrentTool("select.editing_shape")}})}});g(this,"onPointerUp",()=>{this.complete()});g(this,"onInterrupt",()=>{this.cancel()});g(this,"onComplete",()=>{this.complete()});g(this,"onCancel",()=>{this.cancel()})}complete(){this.wasFocusedOnEnter&&(this.editor.getInstanceState().isToolLocked?this.parent.transition("idle"):(this.editor.setEditingShape(this.shape.id),this.editor.setCurrentTool("select.editing_shape",{...this.info,target:"shape",shape:this.shape})))}cancel(){this.editor.bailToMark(this.markId),this.parent.transition("idle",this.info)}},g(mv,"id","pointing"),mv);function g7(t,e,n){let r=hT/t.getZoomLevel(),s;for(const i of fT(t,0,n,0)){const o=b.Sub(e,i),a=o.len();a<r&&(r=a,s=o)}return s}function m7(t,e,n){t.createShape({id:e,type:"note",x:n.x,y:n.y,props:{scale:t.user.getIsDynamicResizeMode()?1/t.getZoomLevel():1}}).select(e);const r=t.getShape(e),s=t.getShapeGeometry(r).bounds;return t.updateShapes([{id:e,type:"note",x:r.x-s.width/2,y:r.y-s.height/2}]),t.getShape(e)}class Hp extends Se{constructor(){super(...arguments);g(this,"shapeType","note")}}g(Hp,"id","note"),g(Hp,"initial","idle"),g(Hp,"children",()=>[ree,lee]);function cee(t){const e=t.getShapeAtPoint(t.inputs.currentPagePoint,{hitInside:!1,hitLabels:!1,margin:t.options.hitTestMargin/t.getZoomLevel(),renderingOnly:!0});if(!e)return t.setHoveredShape(null);let n;const r=t.getOutermostSelectableShape(e);return r===e||r.id===t.getFocusedGroupId()||t.getSelectedShapeIds().includes(r.id)?n=e:n=r,t.setHoveredShape(n.id)}const Gi=Tk(cee,32);var yv;let uee=(yv=class extends Se{constructor(){super(...arguments);g(this,"onPointerMove",n=>{switch(n.target){case"shape":case"canvas":Gi(this.editor)}});g(this,"onPointerDown",n=>{this.parent.transition("pointing",n)});g(this,"onEnter",()=>{this.editor.setCursor({type:"cross",rotation:0})});g(this,"onExit",()=>{Gi.cancel()});g(this,"onKeyDown",n=>{var r;if(n.key==="Enter"){if(this.editor.getInstanceState().isReadonly)return null;const s=this.editor.getOnlySelectedShape();s&&this.editor.getShapeUtil(s).canEdit(s)&&(this.editor.setCurrentTool("select"),this.editor.setEditingShape(s.id),(r=this.editor.root.getCurrent())==null||r.transition("editing_shape",{...n,target:"shape",shape:s}))}});g(this,"onCancel",()=>{this.editor.setCurrentTool("select")})}},g(yv,"id","idle"),yv);var vv;let dee=(vv=class extends Se{constructor(){super(...arguments);g(this,"shape");g(this,"markId","");g(this,"onExit",()=>{this.editor.setHintingShapes([])});g(this,"onPointerMove",n=>{if(this.editor.inputs.isDragging){const{inputs:{originPagePoint:r}}=this.editor,s=ot();this.markId=`creating:${s}`,this.editor.mark(this.markId);const i=this.createTextShape(s,r,!1);if(!i){this.cancel();return}this.shape=this.editor.getShape(i),this.editor.select(s),this.editor.setCurrentTool("select.resizing",{...n,target:"selection",handle:"right",isCreating:!0,creationCursorOffset:{x:18,y:1},onInteractionEnd:"text",onCreate:()=>{this.editor.setEditingShape(i.id),this.editor.setCurrentTool("select.editing_shape")}})}});g(this,"onPointerUp",()=>{this.complete()});g(this,"onComplete",()=>{this.cancel()});g(this,"onCancel",()=>{this.cancel()});g(this,"onInterrupt",()=>{this.cancel()})}complete(){var i;this.editor.mark("creating text shape");const n=ot(),{currentPagePoint:r}=this.editor.inputs;this.createTextShape(n,r,!0)&&(this.editor.select(n),this.editor.setEditingShape(n),this.editor.setCurrentTool("select"),(i=this.editor.root.getCurrent())==null||i.transition("editing_shape"))}cancel(){this.parent.transition("idle"),this.editor.bailToMark(this.markId)}createTextShape(n,r,s){this.editor.createShape({id:n,type:"text",x:r.x,y:r.y,props:{text:"",autoSize:s,w:20,scale:this.editor.user.getIsDynamicResizeMode()?1/this.editor.getZoomLevel():1}});const i=this.editor.getShape(n);if(!i){this.cancel();return}const o=this.editor.getShapePageBounds(i),a=new b;if(s)switch(i.props.textAlign){case"start":{a.x=0;break}case"middle":{a.x=-o.width/2;break}case"end":{a.x=-o.width;break}}else a.x=0;if(a.y=-o.height/2,fr(i.parentId)){const l=this.editor.getShapeParentTransform(i);a.rot(-l.rotation())}return this.editor.updateShape({...i,x:i.x+a.x,y:i.y+a.y}),i}},g(vv,"id","pointing"),vv);class qu extends Se{constructor(){super(...arguments);g(this,"shapeType","text")}}g(qu,"id","text"),g(qu,"initial","idle"),g(qu,"children",()=>[uee,dee]),g(qu,"isLockable",!1);const hee=[qu,Gu,Bp,Hp,Up,tS,$p,Vu];function Cs(){return go({isDarkMode:Dh()})}function vm(t){return{key:`${vi.id}:${t}`,getElement:async()=>{const e=pee(t);if(!e)return null;const n=e.$$_url,r=e.$$_fontface;if(!n||!r)return null;const s=await(await yi(n)).blob(),i=await Za.blobToDataUrl(s),o=r.replace(n,i);return d.jsx("style",{children:o})}}}function pee(t){const e=uI[t];for(const n of document.fonts)if(e.includes(n.family))return n;return null}function X4(t){return{key:`${vi.id}:${t}`,getElement:async()=>t!=="pattern"?null:d.jsx(fee,{})}}function fee(){const t=Cs(),e=8/12;return d.jsxs(d.Fragment,{children:[d.jsxs("mask",{id:"hash_pattern_mask",children:[d.jsx("rect",{x:"0",y:"0",width:"8",height:"8",fill:"white"}),d.jsxs("g",{strokeLinecap:"round",stroke:"black",children:[d.jsx("line",{x1:e*1,y1:e*3,x2:e*3,y2:e*1}),d.jsx("line",{x1:e*5,y1:e*7,x2:e*7,y2:e*5}),d.jsx("line",{x1:e*9,y1:e*11,x2:e*11,y2:e*9})]})]}),d.jsx("pattern",{id:hg(1,t.id),width:"8",height:"8",patternUnits:"userSpaceOnUse",children:d.jsx("rect",{x:"0",y:"0",width:"8",height:"8",fill:t.solid,mask:"url(#hash_pattern_mask)"})})]})}function Z4(){return{key:`${vi.id}:pattern`,component:vee}}const Yu=8,y7=(t,e,n)=>new Promise((r,s)=>{const i=Yu*e*t,o=document.createElement("canvas");o.width=i,o.height=i;const a=o.getContext("2d");if(!a)return;a.fillStyle=n?Qf.darkMode.solid:Qf.lightMode.solid,a.fillRect(0,0,i,i),a.globalCompositeOperation="destination-out",a.lineCap="round",a.lineWidth=1.25*e*t;const l=8/12,c=u=>u*e*t;a.beginPath(),a.moveTo(c(l*1),c(l*3)),a.lineTo(c(l*3),c(l*1)),a.moveTo(c(l*5),c(l*7)),a.lineTo(c(l*7),c(l*5)),a.moveTo(c(l*9),c(l*11)),a.lineTo(c(l*11),c(l*9)),a.stroke(),o.toBlob(u=>{!u||Vt.throwToBlob.get()?s():r(u)})}),v7=(t,e)=>{const n=document.createElement("canvas");n.width=t[0],n.height=t[1];const r=n.getContext("2d");return r?(e(r),n.toDataURL()):""};let Cy=null;function gee(){return Cy||(Cy={white:v7([1,1],t=>{t.fillStyle="#f8f9fa",t.fillRect(0,0,1,1)}),black:v7([1,1],t=>{t.fillStyle="#212529",t.fillRect(0,0,1,1)})}),Cy}function mT(t){return Math.ceil(Math.log2(Math.max(1,t)))}function hg(t,e){const n=mT(t);return`tldraw_hash_pattern_${e}_${n}`}function yT(t){const e=[],r=mT(t);for(let s=0;s<=r;s++)e.push(Math.pow(2,s));return e}function mee(t){const e=gee();return yT(t).flatMap(n=>[{zoom:n,url:e.white,theme:"light"},{zoom:n,url:e.black,theme:"dark"}])}function yee(){const t=G(),e=J("devicePixelRatio",()=>t.getInstanceState().devicePixelRatio,[t]),n=J("maxZoom",()=>Math.ceil(xn(t.getCameraOptions().zoomSteps)),[t]),[r,s]=C.useState(!1),[i,o]=C.useState(()=>mee(n));return C.useEffect(()=>{const l=Promise.all(yT(n).flatMap(u=>[y7(e,u,!1).then(h=>({zoom:u,theme:"light",url:URL.createObjectURL(h)})),y7(e,u,!0).then(h=>({zoom:u,theme:"dark",url:URL.createObjectURL(h)}))]));let c=!1;return l.then(u=>{c||(o(u),s(!0))}),()=>{c=!0,s(!1),l.then(u=>{for(const{url:h}of u)URL.revokeObjectURL(h)})}},[e,n]),{defs:d.jsx(d.Fragment,{children:i.map(l=>{const c=hg(l.zoom,l.theme);return d.jsx("pattern",{id:c,width:Yu,height:Yu,patternUnits:"userSpaceOnUse",children:d.jsx("image",{href:l.url,width:Yu,height:Yu})},c)})}),isReady:r}}function vee(){const t=G(),e=C.useRef(null),{defs:n,isReady:r}=yee();return C.useEffect(()=>{if(r&&t.environment.isSafari){const s=vT(e.current);s&&t.timers.requestAnimationFrame(()=>{s.style.display="none",t.timers.requestAnimationFrame(()=>{s.style.display=""})})}},[t,r]),d.jsx("g",{ref:e,"data-testid":r?"ready-pattern-fill-defs":void 0,children:n})}function vT(t){return t.classList.contains("tl-html-layer")?t:t.parentElement?vT(t.parentElement):null}const Ln=Ne.memo(function({theme:e,d:n,color:r,fill:s,scale:i}){switch(s){case"none":return null;case"solid":return d.jsx("path",{fill:e[r].semi,d:n});case"semi":return d.jsx("path",{fill:e.solid,d:n});case"fill":return d.jsx("path",{fill:e[r].fill,d:n});case"pattern":return d.jsx(See,{theme:e,color:r,fill:s,d:n,scale:i})}});function See({d:t,color:e,theme:n}){const r=G(),s=$E(),i=J("zoomLevel",()=>r.getZoomLevel(),[r]),o=r.getZoomLevel()<=.18;return d.jsxs(d.Fragment,{children:[d.jsx("path",{fill:n[e].pattern,d:t}),d.jsx("path",{fill:s?`url(#${hg(1,n.id)})`:o?n[e].semi:`url(#${hg(i,n.id)})`,d:t})]})}function xee(t){return t.replace(/\s/g," ")}function nS(t,e,n){const{padding:r=0}=n;if(e.length===0)return null;const s=fe.From(e[0].box);for(const{box:c}of e)s.union(c);const i=r+(n.offsetX??0),o=(n.offsetY??0)+n.fontSize/2+(n.verticalTextAlign==="start"?r:n.verticalTextAlign==="end"?n.height-r-s.height:(Math.ceil(n.height)-s.height)/2);let a=null;const l=[];for(const{text:c,box:u}of e)a!==null&&u.y>a&&l.push(d.jsx("tspan",{alignmentBaseline:"mathematical",x:i,y:u.y+o,children:`
`},l.length)),l.push(d.jsx("tspan",{alignmentBaseline:"mathematical",x:u.x+i,y:u.y+o,unicodeBidi:"plaintext",children:xee(c)},l.length)),a=u.y;return d.jsx("text",{fontSize:n.fontSize,fontFamily:n.fontFamily,fontStyle:n.fontStyle,fontWeight:n.fontWeight,dominantBaseline:"mathematical",alignmentBaseline:"mathematical",stroke:n.stroke,strokeWidth:n.strokeWidth,fill:n.fill,children:l})}function wee(t,e,n,r){if((t==="start-legacy"||t==="end-legacy")&&n.length!==0){const s=fe.From(n[0].box);for(const{box:i}of n)s.union(i);if(t==="start-legacy")return(r-2*e-s.width)/2;if(t==="end-legacy")return-(r-2*e-s.width)/2}}function bee(t){return t==="start-legacy"||t==="middle-legacy"||t==="end-legacy"}function Sm({fontSize:t,font:e,align:n,verticalAlign:r,text:s,labelColor:i,bounds:o,padding:a=16,stroke:l=!0}){const c=G(),u=Cs(),h={fontSize:t,fontFamily:uI[e],textAlign:n,verticalTextAlign:r,width:Math.ceil(o.width),height:Math.ceil(o.height),padding:a,lineHeight:En.lineHeight,fontStyle:"normal",fontWeight:"normal",overflow:"wrap",offsetX:0,offsetY:0,fill:i,stroke:void 0,strokeWidth:void 0},p=c.textMeasure.measureTextSpans(s,h),f=wee(n,a,p,o.width);f&&(h.offsetX=f),h.offsetX+=o.x,h.offsetY+=o.y;const v=nS(c,p,h);let m=null;return l&&(h.fill=u.background,h.stroke=u.background,h.strokeWidth=2,m=nS(c,p,h)),d.jsxs(d.Fragment,{children:[m,v]})}const Cee=C.forwardRef(function({isEditing:e,text:n,handleFocus:r,handleChange:s,handleKeyDown:i,handleBlur:o,handleInputPointerDown:a,handleDoubleClick:l},c){return d.jsx("textarea",{ref:c,className:"tl-text tl-text-input",name:"text",tabIndex:-1,readOnly:!e,autoComplete:"off",autoCapitalize:"off",autoCorrect:"off",autoSave:"off",placeholder:"",spellCheck:"true",wrap:"off",dir:"auto",defaultValue:n,onFocus:r,onChange:s,onKeyDown:i,onBlur:o,onTouchEnd:sn,onContextMenu:e?sn:void 0,onPointerDown:a,onDoubleClick:l,onDragStart:Ve})});function Pee(t,e,n){const r=G(),s=C.useRef(null),i=J("isEditing",()=>r.getEditingShapeId()===t,[r]),o=J("isEditingAnything",()=>!!r.getEditingShapeId(),[r]);C.useEffect(()=>{function u({shapeId:h}){var p;h===t&&((p=s.current)==null||p.select())}return r.on("select-all-text",u),()=>{r.off("select-all-text",u)}},[r,t,i]),C.useEffect(()=>{var u,h,p,f;i&&(document.activeElement!==s.current&&((u=s.current)==null||u.focus()),r.getInstanceState().isCoarsePointer&&((h=s.current)==null||h.select()),r.environment.isSafari&&((p=s.current)==null||p.blur(),(f=s.current)==null||f.focus()))},[r,i]);const a=C.useCallback(u=>{if(r.getEditingShapeId()===t)switch(u.key){case"Enter":{(u.ctrlKey||u.metaKey)&&r.complete();break}}},[r,t]),l=C.useCallback(u=>{if(r.getEditingShapeId()!==t)return;let h=Oc.normalizeText(u.currentTarget.value);const p=h.replace(/\t/g,uc);if(p!==h){const f=u.currentTarget.selectionStart;u.currentTarget.value=p,u.currentTarget.selectionStart=f+(p.length-h.length),u.currentTarget.selectionEnd=f+(p.length-h.length),h=p}r.updateShape({id:t,type:e,props:{text:h}})},[r,t,e]),c=C.useCallback(u=>{r.dispatch({...wr(u),type:"pointer",name:"pointer_down",target:"shape",shape:r.getShape(t)}),sn(u)},[r,t]);return{rInput:s,handleFocus:Kd,handleBlur:Kd,handleKeyDown:a,handleChange:l,handleInputPointerDown:c,handleDoubleClick:sn,isEmpty:n.trim().length===0,isEditing:i,isEditingAnything:o}}const xm=Ne.memo(function({id:e,type:n,text:r,labelColor:s,font:i,fontSize:o,lineHeight:a,align:l,verticalAlign:c,wrap:u,isSelected:h,padding:p=0,onKeyDown:f,classNamePrefix:v,style:m,textWidth:x,textHeight:y}){const{rInput:S,isEmpty:w,isEditing:P,isEditingAnything:E,...M}=Pee(e,n,r),[I,_]=C.useState(r);C.useEffect(()=>{P||_(r)},[P,r]);const D=Oc.normalizeTextForDom(r),R=D.length>0,$=bee(l);if(!P&&!R)return null;const U=v||"tl-text";return d.jsx("div",{className:`${U}-label tl-text-wrapper`,"data-font":i,"data-align":l,"data-hastext":!w,"data-isediting":P,"data-iseditinganything":E,"data-textwrap":!!u,"data-isselected":h,style:{justifyContent:l==="middle"||$?"center":l,alignItems:c==="middle"?"center":c,padding:p,...m},children:d.jsxs("div",{className:`${U}-label__inner tl-text-content__wrapper`,style:{fontSize:o,lineHeight:Math.floor(o*a)+"px",minHeight:Math.floor(o*a)+"px",minWidth:Math.ceil(x||0),color:s,width:x?Math.ceil(x):void 0,height:y?Math.ceil(y):void 0},children:[d.jsx("div",{className:`${U} tl-text tl-text-content`,dir:"auto",children:D.split(`
`).map((O,N)=>d.jsx("div",{dir:"auto",children:O},N))}),(E||h)&&d.jsx(Cee,{ref:S,text:r,isEditing:P,...M,handleKeyDown:f??M.handleKeyDown},I)]})})});function ti(t,e,n={}){const{closed:r=!1,snap:s=1,start:i="outset",end:o="outset",lengthRatio:a=2,style:l="dashed"}=n;let c=0,u=0,h=1,p=0,f=0;switch(l){case"dashed":{h=1,c=Math.min(e*a,t/4);break}case"dotted":{h=100,c=e/h;break}default:return{strokeDasharray:"none",strokeDashoffset:"none"}}return r||(i==="outset"?(t+=c/2,f+=c/2):i==="skip"&&(t-=c,f-=c),o==="outset"?t+=c/2:o==="skip"&&(t-=c)),u=Math.floor(t/c/(2*h)),u-=u%s,u<3&&l==="dashed"?t/e<4?(c=t,u=1,p=0):(c=t*(1/3),p=t*(1/3)):(c=t/u/(2*h),r?(f=c/2,p=(t-u*c)/u):p=(t-u*c)/Math.max(1,u-1)),{strokeDasharray:[c,p].join(" "),strokeDashoffset:f.toString()}}const S7=new WeakMap;function Q4(t,e){const n=S7.get(e);if(n)return n;const r=li(t,e);let s=0,i=0;const o=r.isStraight?new Ki({start:b.From(r.start.point),end:b.From(r.end.point)}):new oc({center:b.Cast(r.handleArc.center),start:b.Cast(r.start.point),end:b.Cast(r.end.point),sweepFlag:r.bodyArc.sweepFlag,largeArcFlag:r.bodyArc.largeArcFlag});if(e.props.text.trim()){const l=o.bounds,c=rS(e),{w:u,h}=t.textMeasure.measureText(e.props.text,{...En,fontFamily:mi[e.props.font],fontSize:c,maxWidth:null});if(s=u,i=h,l.width>l.height){s=Math.max(Math.min(u,64),Math.min(l.width-64,u));const{w:p,h:f}=t.textMeasure.measureText(e.props.text,{...En,fontFamily:mi[e.props.font],fontSize:c,maxWidth:s});s=p,i=f}if(s>16*c){s=16*c;const{w:p,h:f}=t.textMeasure.measureText(e.props.text,{...En,fontFamily:mi[e.props.font],fontSize:c,maxWidth:s});s=p,i=f}}const a=new b(s,i).addScalar(wJ*2*e.props.scale);return S7.set(e,a),a}function ST(t){const e=hn[t.props.size];return(xJ+(e-hn.s)*2+(e===hn.xl?20:0))*t.props.scale}function kee(t,e,n){const r=Q4(t,e),s=ST(e),i=b.Nudge(n.start.point,n.end.point,s),o=b.Nudge(n.end.point,n.start.point,s),a=L4(i,o,fe.FromCenter(n.middle,r).corners);if(!a||a.length!==2)return{start:.5,end:.5};let[l,c]=a;b.Dist2(l,i)>b.Dist2(c,i)&&([c,l]=a);const u=i.add(b.Sub(n.middle,l)),h=o.add(b.Sub(n.middle,c)),p=b.Dist(n.start.point,u)/n.length,f=b.Dist(n.start.point,h)/n.length;return{start:p,end:f}}function Iee(t,e,n){const r=Q4(t,e),s=ST(e),i=Math.sign(e.props.bend),o=s/n.handleArc.radius*i,a=b.Angle(n.bodyArc.center,n.start.point)-o,l=b.Angle(n.bodyArc.center,n.end.point)+o,c=ul(n.bodyArc.center,n.bodyArc.radius,a),u=ul(n.bodyArc.center,n.bodyArc.radius,l),h=[],p=x7(n.bodyArc.center,n.bodyArc.radius,a,l,i,fe.FromCenter(c,r).corners);h.push(new Kt({points:fe.FromCenter(c,r).corners,debugColor:"lime",isFilled:!1,ignore:!0}));const f=x7(n.bodyArc.center,n.bodyArc.radius,a,l,i,fe.FromCenter(u,r).corners);h.push(new Kt({points:fe.FromCenter(u,r).corners,debugColor:"lime",isFilled:!1,ignore:!0}));for(const I of[...p??[],...f??[],c,u])h.push(new G4({x:I.x-3,y:I.y-3,radius:3,isFilled:!1,debugColor:"magenta",ignore:!0}));const v=(p&&w7(n.start.point,p))??n.middle,m=(f&&w7(n.end.point,f))??n.middle,x=b.Angle(n.bodyArc.center,n.start.point),y=b.Angle(n.bodyArc.center,n.end.point),S=b.Angle(n.bodyArc.center,v),w=b.Angle(n.bodyArc.center,m);if(Lo(x,S,i)>Lo(x,w,i))return{start:.5,end:.5,dbg:h};const P=Lo(x,y,i),E=Lo(x,S,i)/P,M=Lo(x,w,i)/P;return{start:E,end:M,dbg:h}}function Wp(t,e){let n;const r=[],s=li(t,e),i=!!s.bindings.start,o=!!s.bindings.end,a=s.start.arrowhead!=="none",l=s.end.arrowhead!=="none";if(s.isStraight){const u=kee(t,e,s);let h=cn(e.props.labelPosition,a||i?u.start:0,l||o?u.end:1);h=h>=.48&&h<=.52?.5:h,n=b.Lrp(s.start.point,s.end.point,h)}else{const u=Iee(t,e,s);u.dbg&&r.push(...u.dbg);let h=cn(e.props.labelPosition,a||i?u.start:0,l||o?u.end:1);h=h>=.48&&h<=.52?.5:h;const p=Eee(b.Angle(s.bodyArc.center,s.start.point),b.Angle(s.bodyArc.center,s.end.point),Math.sign(e.props.bend),h);n=ul(s.bodyArc.center,s.bodyArc.radius,p)}const c=Q4(t,e);return{box:fe.FromCenter(n,c),debugGeom:r}}function x7(t,e,n,r,s,i){const o=V2(t,e,i),a=Lo(n,r,s);return o==null?void 0:o.filter(l=>{const c=Lo(n,b.Angle(t,l),s);return c>=0&&c<=a})}function w7(t,e){let n=null,r=-1/0;for(const s of e){const i=b.Dist2(t,s);i>r&&(n=s,r=i)}return n}function Eee(t,e,n,r){const s=Lo(t,e,n);return t+s*r*n*-1}function rS(t){return SJ[t.props.size]*t.props.scale}function Tee(t,e,n){const r=e==="end"?t.end.point:t.start.point,s=e==="end"?t.start.point:t.end.point,i=t.isStraight?b.Dist(s,r):Math.abs(t.bodyArc.length),o=Math.max(Math.min(i/5,n*3),n);let a;if(t.isStraight)a=b.Nudge(r,s,o);else{const l=XX(r,o,t.handleArc.center,t.handleArc.radius);a=e==="end"?t.handleArc.sweepFlag?l[0]:l[1]:t.handleArc.sweepFlag?l[1]:l[0]}return b.IsNaN(a)&&(a=t.start.point),{point:r,int:a}}function Mee({point:t,int:e}){const n=b.RotWith(e,t,Qe/6),r=b.RotWith(e,t,-Qe/6);return`M ${n.x} ${n.y} L ${t.x} ${t.y} L ${r.x} ${r.y}`}function _ee({point:t,int:e}){const n=b.RotWith(e,t,Qe/6),r=b.RotWith(e,t,-Qe/6);return`M ${n.x} ${n.y} L ${t.x} ${t.y} L ${r.x} ${r.y} Z`}function Aee({point:t,int:e}){const n=b.Sub(e,t).div(2),r=b.Add(t,b.Rot(n,vt)),s=b.Sub(t,b.Rot(n,vt));return`M ${r.x} ${r.y} L ${e.x} ${e.y} L ${s.x} ${s.y} Z`}function Dee({point:t,int:e}){const n=b.Lrp(t,e,.45),r=b.Dist(n,t);return`M ${n.x-r},${n.y}
  a ${r},${r} 0 1,0 ${r*2},0
  a ${r},${r} 0 1,0 -${r*2},0 `}function jee({point:t,int:e}){const n=b.Lrp(t,e,.75),r=b.RotWith(n,t,Qe/4),s=b.RotWith(n,t,-Qe/4),i=b.Lrp(r,s,.5);return i.add(b.Sub(i,t)),`M ${i.x} ${i.y} L ${r.x} ${r.y} ${t.x} ${t.y} L ${s.x} ${s.y} Z`}function Ree({int:t,point:e}){const n=b.Lrp(e,t,.85),r=b.Sub(n,e).div(2),s=b.Add(e,b.Rot(r,vt)),i=b.Sub(e,b.Rot(r,vt)),o=b.Add(n,b.Rot(r,vt)),a=b.Sub(n,b.Rot(r,vt));return`M ${s.x} ${s.y} L ${o.x} ${o.y} L ${a.x} ${a.y} L ${i.x} ${i.y} Z`}function Oee({int:t,point:e}){const n=b.Sub(t,e).div(2),r=b.Add(e,b.Rot(n,vt)),s=b.Sub(e,b.Rot(n,vt));return`M ${r.x} ${r.y} L ${s.x} ${s.y}`}function pg(t,e,n){const r=e==="end"?t.end.arrowhead:t.start.arrowhead;if(r==="none")return;const s=Tee(t,e,n);if(s){switch(r){case"bar":return Oee(s);case"square":return Ree(s);case"diamond":return jee(s);case"dot":return Dee(s);case"inverted":return Aee(s);case"arrow":return Mee(s);case"triangle":return _ee(s)}return""}}function Lee(t){const{start:e,end:n,handleArc:{radius:r,largeArcFlag:s,sweepFlag:i}}=t;return`M${e.handle.x},${e.handle.y} A${r} ${r} 0 ${s} ${i} ${n.handle.x},${n.handle.y}`}function xT(t){const{start:e,end:n,bodyArc:{radius:r,largeArcFlag:s,sweepFlag:i}}=t;return`M${e.point.x},${e.point.y} A${r} ${r} 0 ${s} ${i} ${n.point.x},${n.point.y}`}function wT(t,e){return`M${t.x},${t.y}L${e.x},${e.y}`}function Nee(t){return wT(t.start.handle,t.end.handle)}function bT(t){return wT(t.start.point,t.end.point)}let zee=0;class Kp extends fs{constructor(){super(...arguments);g(this,"canEdit",()=>!0);g(this,"canSnap",()=>!1);g(this,"hideResizeHandles",()=>!0);g(this,"hideRotateHandle",()=>!0);g(this,"hideSelectionBoundsBg",()=>!0);g(this,"hideSelectionBoundsFg",()=>!0);g(this,"canBeLaidOut",n=>{const r=vr(this.editor,n);return!r.start&&!r.end});g(this,"onHandleDrag",(n,{handle:r,isPrecise:s})=>{const i=r.id,o=vr(this.editor,n);if(i==="middle"){const{start:M,end:I}=ac(this.editor,n,o),_=b.Sub(I,M),D=b.Per(_),R=b.Med(I,M),$=b.Sub(R,D),U=b.Add(R,D),O=b.NearestPointOnLineSegment($,U,r,!1);let N=b.Dist(O,R);return b.Clockwise(O,I,R)&&(N*=-1),{id:n.id,type:n.type,props:{bend:N}}}const a={id:n.id,type:"arrow",props:{}},l=o[i],u=o[i==="start"?"end":"start"];if(this.editor.inputs.ctrlKey)return zp(this.editor,n,i),a.props[i]={x:r.x,y:r.y},a;const h=this.editor.getShapePageTransform(n.id).applyToPoint(r),p=this.editor.getShapeAtPoint(h,{hitInside:!0,hitFrameInside:!0,margin:0,filter:M=>!M.isLocked&&this.editor.canBindShapes({fromShape:n,toShape:M,binding:"arrow"})});if(!p)return zp(this.editor,n,i),a.props[i]={x:r.x,y:r.y},a;const f=this.editor.getShapeGeometry(p),v=fe.ZeroFix(f.bounds),x=this.editor.getShapePageTransform(a.id).applyToPoint(r),y=this.editor.getPointInShapeSpace(p,x);let S=s;S||(!l||l&&p.id!==l.toId)&&(S=this.editor.inputs.pointerVelocity.len()<.5),s||(f.isClosed||(S=!0),u&&p.id===u.toId&&u.props.isPrecise&&(S=!0));const w={x:(y.x-v.minX)/v.width,y:(y.y-v.minY)/v.height};S&&b.Dist(y,v.center)<Math.max(4,Math.min(Math.min(v.width,v.height)*.15,16))/this.editor.getZoomLevel()&&(w.x=.5,w.y=.5);const P={terminal:i,normalizedAnchor:w,isPrecise:S,isExact:this.editor.inputs.altKey};Mu(this.editor,n,p.id,P),this.editor.setHintingShapes([p.id]);const E=vr(this.editor,n);return E.start&&E.end&&E.start.toId===E.end.toId&&b.Equals(E.start.props.normalizedAnchor,E.end.props.normalizedAnchor)&&Mu(this.editor,n,E.end.toId,{...E.end.props,normalizedAnchor:{x:E.end.props.normalizedAnchor.x+.05,y:E.end.props.normalizedAnchor.y}}),a});g(this,"onTranslateStart",n=>{const r=vr(this.editor,n),s=ac(this.editor,n,r),i=this.editor.getShapePageTransform(n.id),o=this.editor.getSelectedShapeIds();if(!(r.start&&(o.includes(r.start.toId)||this.editor.isAncestorSelected(r.start.toId))||r.end&&(o.includes(r.end.toId)||this.editor.isAncestorSelected(r.end.toId)))){C7.set(n,{pagePosition:i.applyToPoint(n),terminalBindings:bh(s,(a,l)=>{const c=r[a];return c?{binding:c,shapePosition:l,pagePosition:i.applyToPoint(l)}:null})}),r.start&&(ug({editor:this.editor,arrow:n,terminal:"start",useHandle:!0}),n=this.editor.getShape(n.id)),r.end&&ug({editor:this.editor,arrow:n,terminal:"end",useHandle:!0});for(const a of["start","end"]){const l=r[a];l&&this.editor.updateBinding({...l,props:{...l.props,isPrecise:!0}})}}});g(this,"onTranslate",(n,r)=>{const s=C7.get(n);if(!s)return;const i=this.editor.getShapePageTransform(r.id),o=b.Sub(i.applyToPoint(r),s.pagePosition);for(const a of Object.values(s.terminalBindings)){if(!a)continue;const l=b.Add(a.pagePosition,b.Mul(o,.5)),c=this.editor.getShapeAtPoint(l,{hitInside:!0,hitFrameInside:!0,margin:0,filter:u=>!u.isLocked&&this.editor.canBindShapes({fromShape:r,toShape:u,binding:"arrow"})});if((c==null?void 0:c.id)===a.binding.toId){const u=fe.ZeroFix(this.editor.getShapeGeometry(c).bounds),h=this.editor.getPointInShapeSpace(c,l),p={x:(h.x-u.minX)/u.width,y:(h.y-u.minY)/u.height};Mu(this.editor,r,c.id,{...a.binding.props,normalizedAnchor:p,isPrecise:!0})}else zp(this.editor,r,a.binding.props.terminal)}});g(this,"_resizeInitialBindings",new so);g(this,"onResize",(n,r)=>{const{scaleX:s,scaleY:i}=r,o=this._resizeInitialBindings.get(n,()=>vr(this.editor,n)),a=ac(this.editor,n,o),{start:l,end:c}=yt(n.props);let{bend:u}=n.props;o.start||(l.x=a.start.x*s,l.y=a.start.y*i),o.end||(c.x=a.end.x*s,c.y=a.end.y*i);const h=Math.abs(s),p=Math.abs(i),f=o!=null&&o.start?b.From(o.start.props.normalizedAnchor):null,v=o!=null&&o.end?b.From(o.end.props.normalizedAnchor):null;return s<0&&i>=0?(u!==0&&(u*=-1,u*=Math.max(h,p)),f&&(f.x=1-f.x),v&&(v.x=1-v.x)):s>=0&&i<0?(u!==0&&(u*=-1,u*=Math.max(h,p)),f&&(f.y=1-f.y),v&&(v.y=1-v.y)):s>=0&&i>=0?u!==0&&(u*=Math.max(h,p)):s<0&&i<0&&(u!==0&&(u*=Math.max(h,p)),f&&(f.x=1-f.x,f.y=1-f.y),v&&(v.x=1-v.x,v.y=1-v.y)),o.start&&f&&Mu(this.editor,n,o.start.toId,{...o.start.props,normalizedAnchor:f.toJson()}),o.end&&v&&Mu(this.editor,n,o.end.toId,{...o.end.props,normalizedAnchor:v.toJson()}),{props:{start:l,end:c,bend:u}}});g(this,"onDoubleClickHandle",(n,r)=>{switch(r.id){case"start":return{id:n.id,type:n.type,props:{...n.props,arrowheadStart:n.props.arrowheadStart==="none"?"arrow":"none"}};case"end":return{id:n.id,type:n.type,props:{...n.props,arrowheadEnd:n.props.arrowheadEnd==="none"?"arrow":"none"}}}});g(this,"onEditEnd",n=>{const{id:r,type:s,props:{text:i}}=n;i.trimEnd()!==n.props.text&&this.editor.updateShapes([{id:r,type:s,props:{text:i.trimEnd()}}])})}canBind({toShapeType:n}){return n!=="arrow"}getDefaultProps(){return{dash:"draw",size:"m",fill:"none",color:"black",labelColor:"black",bend:0,start:{x:0,y:0},end:{x:2,y:0},arrowheadStart:"none",arrowheadEnd:"arrow",text:"",labelPosition:.5,font:"draw",scale:1}}getGeometry(n){const r=li(this.editor,n),s=[],i=r.isStraight?new Ki({start:b.From(r.start.point),end:b.From(r.end.point)}):new oc({center:b.Cast(r.handleArc.center),start:b.Cast(r.start.point),end:b.Cast(r.end.point),sweepFlag:r.bodyArc.sweepFlag,largeArcFlag:r.bodyArc.largeArcFlag});let o;if(n.props.text.trim()){const a=Wp(this.editor,n);s.push(...a.debugGeom),o=new xi({x:a.box.x,y:a.box.y,width:a.box.w,height:a.box.h,isFilled:!0,isLabel:!0})}return new $s({children:[...o?[i,o]:[i],...s]})}getHandles(n){const r=li(this.editor,n);return[{id:"start",type:"vertex",index:"a0",x:r.start.handle.x,y:r.start.handle.y},{id:"middle",type:"virtual",index:"a2",x:r.middle.x,y:r.middle.y},{id:"end",type:"vertex",index:"a3",x:r.end.handle.x,y:r.end.handle.y}].filter(Boolean)}component(n){const r=Cs(),s=this.editor.getOnlySelectedShape(),i=this.editor.isInAny("select.idle","select.pointing_handle","select.dragging_handle","select.translating","arrow.dragging")&&!this.editor.getInstanceState().isReadonly,o=li(this.editor,n);if(!(o!=null&&o.isValid))return null;const a=Wp(this.editor,n),l=n.id===this.editor.getOnlySelectedShapeId(),u=this.editor.getEditingShapeId()===n.id||n.props.text;return d.jsxs(d.Fragment,{children:[d.jsx(oa,{id:n.id,style:{minWidth:50,minHeight:50},children:d.jsx(b7,{shape:n,shouldDisplayHandles:i&&(s==null?void 0:s.id)===n.id})}),u&&d.jsx(xm,{id:n.id,classNamePrefix:"tl-arrow",type:"arrow",font:n.props.font,fontSize:rS(n),lineHeight:En.lineHeight,align:"middle",verticalAlign:"middle",text:n.props.text,labelColor:r[n.props.labelColor].solid,textWidth:a.box.w,isSelected:l,padding:0,style:{transform:`translate(${a.box.center.x}px, ${a.box.center.y}px)`}})]})}indicator(n){const r=gm(n.id),s=li(this.editor,n);if(!s)return null;const{start:i,end:o}=ac(this.editor,n,s==null?void 0:s.bindings),a=this.editor.getShapeGeometry(n),l=a.bounds,c=n.props.text.trim()?a.children[1]:null;if(b.Equals(i,o))return null;const u=hn[n.props.size]*n.props.scale,h=s.start.arrowhead&&pg(s,"start",u),p=s.end.arrowhead&&pg(s,"end",u),f=s.isStraight?bT(s):xT(s),v=h&&s.start.arrowhead!=="arrow"||p&&s.end.arrowhead!=="arrow"||!!c,m=(n.id+"_clip").replace(":","_");return r&&c?d.jsx("rect",{x:K(c.x),y:K(c.y),width:c.w,height:c.h,rx:3.5*n.props.scale,ry:3.5*n.props.scale}):d.jsxs("g",{children:[v&&d.jsx("defs",{children:d.jsxs("mask",{id:m,children:[d.jsx("rect",{x:l.minX-100,y:l.minY-100,width:l.w+200,height:l.h+200,fill:"white"}),c&&d.jsx("rect",{x:K(c.x),y:K(c.y),width:c.w,height:c.h,fill:"black",rx:3.5*n.props.scale,ry:3.5*n.props.scale}),h&&d.jsx("path",{d:h,fill:s.start.arrowhead==="arrow"?"none":"black",stroke:"none"}),p&&d.jsx("path",{d:p,fill:s.end.arrowhead==="arrow"?"none":"black",stroke:"none"})]})}),d.jsxs("g",{...v?{mask:`url(#${m})`}:void 0,children:[v&&d.jsx("rect",{x:l.minX-100,y:l.minY-100,width:l.width+200,height:l.height+200,opacity:0}),d.jsx("path",{d:f})]}),h&&d.jsx("path",{d:h}),p&&d.jsx("path",{d:p}),c&&d.jsx("rect",{x:K(c.x),y:K(c.y),width:c.w,height:c.h,rx:3.5,ry:3.5})]})}toSvg(n,r){r.addExportDef(X4(n.props.fill)),n.props.text&&r.addExportDef(vm(n.props.font));const s=go(r),i=1/n.props.scale;return d.jsxs("g",{transform:`scale(${i})`,children:[d.jsx(b7,{shape:n,shouldDisplayHandles:!1}),d.jsx(Sm,{fontSize:rS(n),font:n.props.font,align:"middle",verticalAlign:"middle",text:n.props.text,labelColor:s[n.props.labelColor].solid,bounds:Wp(this.editor,n).box,padding:4*n.props.scale})]})}getCanvasSvgDefs(){return[Z4(),{key:"arrow:dot",component:$ee},{key:"arrow:cross",component:Bee}]}getInterpolatedProps(n,r,s){return{...r.props,start:{x:mr(n.props.start.x,r.props.start.x,s),y:mr(n.props.start.y,r.props.start.y,s)},end:{x:mr(n.props.end.x,r.props.end.x,s),y:mr(n.props.end.y,r.props.end.y,s)},bend:mr(n.props.bend,r.props.bend,s),labelPosition:mr(n.props.labelPosition,r.props.labelPosition,s)}}}g(Kp,"type","arrow"),g(Kp,"props",hI),g(Kp,"migrations",pI);function Fee(t,e){const n=li(t,e);return n.isStraight?b.Dist(n.start.handle,n.end.handle):Math.abs(n.handleArc.length)}const b7=gn(function({shape:e,shouldDisplayHandles:n}){const r=G(),s=Cs(),i=li(r,e),o=fe.ZeroFix(r.getShapeGeometry(e).bounds),a=vr(r,e),l=Ne.useMemo(()=>r.environment.isSafari?zee+=1:0,[e]);if(!(i!=null&&i.isValid))return null;const c=hn[e.props.size]*e.props.scale,u=i.start.arrowhead&&pg(i,"start",c),h=i.end.arrowhead&&pg(i,"end",c),p=i.isStraight?bT(i):xT(i);let f=null;if(n){const P=2/r.getZoomLevel(),{strokeDasharray:E,strokeDashoffset:M}=ti(Fee(r,e),P,{end:"skip",start:"skip",lengthRatio:2.5});f=a.start||a.end?d.jsx("path",{className:"tl-arrow-hint",d:i.isStraight?Nee(i):Lee(i),strokeDasharray:E,strokeDashoffset:M,strokeWidth:P,markerStart:a.start?a.start.props.isExact?"":a.start.props.isPrecise?"url(#arrowhead-cross)":"url(#arrowhead-dot)":"",markerEnd:a.end?a.end.props.isExact?"":a.end.props.isPrecise?"url(#arrowhead-cross)":"url(#arrowhead-dot)":"",opacity:.16}):null}const{strokeDasharray:v,strokeDashoffset:m}=ti(i.isStraight?i.length:Math.abs(i.bodyArc.length),c,{style:e.props.dash}),x=Wp(r,e),y=!(i.start.arrowhead==="none"||i.start.arrowhead==="arrow"),S=!(i.end.arrowhead==="none"||i.end.arrowhead==="arrow"),w=(e.id+"_clip_"+l).replace(":","_");return d.jsxs(d.Fragment,{children:[d.jsx("defs",{children:d.jsxs("mask",{id:w,children:[d.jsx("rect",{x:K(-100+o.minX),y:K(-100+o.minY),width:K(o.width+200),height:K(o.height+200),fill:"white"}),e.props.text.trim()&&d.jsx("rect",{x:x.box.x,y:x.box.y,width:x.box.w,height:x.box.h,fill:"black",rx:4,ry:4}),u&&y&&d.jsx("path",{d:u,fill:i.start.arrowhead==="arrow"?"none":"black",stroke:"none"}),h&&S&&d.jsx("path",{d:h,fill:i.end.arrowhead==="arrow"?"none":"black",stroke:"none"})]})}),d.jsxs("g",{fill:"none",stroke:s[e.props.color].solid,strokeWidth:c,strokeLinejoin:"round",strokeLinecap:"round",pointerEvents:"none",children:[f,d.jsxs("g",{mask:`url(#${w})`,children:[d.jsx("rect",{x:K(o.minX-100),y:K(o.minY-100),width:K(o.width+200),height:K(o.height+200),opacity:0}),d.jsx("path",{d:p,strokeDasharray:v,strokeDashoffset:m})]}),u&&y&&e.props.fill!=="none"&&d.jsx(Ln,{theme:s,d:u,color:e.props.color,fill:e.props.fill,scale:e.props.scale}),h&&S&&e.props.fill!=="none"&&d.jsx(Ln,{theme:s,d:h,color:e.props.color,fill:e.props.fill,scale:e.props.scale}),u&&d.jsx("path",{d:u}),h&&d.jsx("path",{d:h})]})]})}),C7=new WeakMap;function $ee(){return d.jsx("marker",{id:"arrowhead-dot",className:"tl-arrow-hint",refX:"3.0",refY:"3.0",orient:"0",children:d.jsx("circle",{cx:"3",cy:"3",r:"2",strokeDasharray:"100%"})})}function Bee(){return d.jsxs("marker",{id:"arrowhead-cross",className:"tl-arrow-hint",refX:"3.0",refY:"3.0",orient:"auto",children:[d.jsx("line",{x1:"1.5",y1:"1.5",x2:"4.5",y2:"4.5",strokeDasharray:"100%"}),d.jsx("line",{x1:"1.5",y1:"4.5",x2:"4.5",y2:"1.5",strokeDasharray:"100%"})]})}const P7="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='30' height='30' fill='none'%3E%3Cpath stroke='%23000' stroke-linecap='round' stroke-linejoin='round' stroke-width='2' d='M13 5H7a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2v-6M19 5h6m0 0v6m0-6L13 17'/%3E%3C/svg%3E";function Lc({url:t,zoomLevel:e}){return d.jsx("a",{className:be("tl-hyperlink-button",{"tl-hyperlink-button__hidden":e<.32}),href:t,target:"_blank",rel:"noopener noreferrer",onPointerDown:sn,onPointerUp:sn,title:t,draggable:!1,children:d.jsx("div",{className:"tl-hyperlink__icon",style:{mask:`url("${P7}") center 100% / 100% no-repeat`,WebkitMask:`url("${P7}") center 100% / 100% no-repeat`}})})}const k7="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='30' height='30' fill='none'%3E%3Cpath stroke='%23000' stroke-linecap='round' stroke-linejoin='round' stroke-width='2' d='M13 5H7a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2v-6M19 5h6m0 0v6m0-6L13 17'/%3E%3C/svg%3E",Uee=[{offsetX:0,offsetY:2,blur:4,spread:0,color:"#00000029"},{offsetX:0,offsetY:3,blur:6,spread:0,color:"#0000001f"}];function J4(t){return Uee.map(n=>{const{offsetX:r,offsetY:s,blur:i,spread:o,color:a}=n,l=new b(r,s),{x:c,y:u}=l.rot(-t);return`${c}px ${u}px ${i}px ${o}px ${a}`}).join(", ")}const Hee=300,CT=320,Wee=46,Kee=101;class Gp extends tu{constructor(){super(...arguments);g(this,"canResize",()=>!1);g(this,"hideSelectionBoundsFg",()=>!0);g(this,"onBeforeCreate",n=>I7(this.editor,n));g(this,"onBeforeUpdate",(n,r)=>{if(n.props.url!==r.props.url)if(Vr.isValid(r.props.url))Vee(this.editor,r);else return{...r,props:{...r.props,url:n.props.url}};if(n.props.assetId!==r.props.assetId)return I7(this.editor,r)})}getDefaultProps(){return{url:"",w:Hee,h:CT,assetId:null}}component(n){const r=n.props.assetId?this.editor.getAsset(n.props.assetId):null,s=this.editor.getShapePageTransform(n).rotation(),i=Gee(n);return d.jsx(aa,{children:d.jsxs("div",{className:"tl-bookmark__container",style:{boxShadow:J4(s),maxHeight:n.props.h},children:[(!r||r.props.image)&&d.jsxs("div",{className:"tl-bookmark__image_container",children:[r?d.jsx("img",{className:"tl-bookmark__image",draggable:!1,referrerPolicy:"strict-origin-when-cross-origin",src:r==null?void 0:r.props.image,alt:(r==null?void 0:r.props.title)||""}):d.jsx("div",{className:"tl-bookmark__placeholder"}),(r==null?void 0:r.props.image)&&d.jsx(Lc,{url:n.props.url,zoomLevel:this.editor.getZoomLevel()})]}),d.jsxs("div",{className:"tl-bookmark__copy_container",children:[r!=null&&r.props.title?d.jsx("h2",{className:"tl-bookmark__heading",children:r.props.title}):null,r!=null&&r.props.description&&(r!=null&&r.props.image)?d.jsx("p",{className:"tl-bookmark__description",children:r.props.description}):null,d.jsxs("a",{className:"tl-bookmark__link",href:n.props.url||"",target:"_blank",rel:"noopener noreferrer",onPointerDown:sn,onPointerUp:sn,onClick:sn,children:[r!=null&&r.props.favicon?d.jsx("img",{className:"tl-bookmark__favicon",src:r==null?void 0:r.props.favicon,referrerPolicy:"strict-origin-when-cross-origin",alt:`favicon of ${i}`}):d.jsx("div",{className:"tl-hyperlink__icon",style:{mask:`url("${k7}") center 100% / 100% no-repeat`,WebkitMask:`url("${k7}") center 100% / 100% no-repeat`}}),d.jsx("span",{children:i})]})]})]})})}indicator(n){return d.jsx("rect",{width:K(n.props.w),height:K(n.props.h),rx:"6",ry:"6"})}}g(Gp,"type","bookmark"),g(Gp,"props",SI),g(Gp,"migrations",xI);function I7(t,e){const n=e.props.assetId?t.getAsset(e.props.assetId):null;let r=CT;return n&&(n.props.image||(n.props.title?r=Kee:r=Wee)),{...e,props:{...e.props,h:r}}}const Gee=t=>{try{return new URL(t.props.url).hostname.replace(/^www\./,"")}catch{return t.props.url}};function Vee(t,e){const{url:n}=e.props,r=Ga.createId(R2(n));t.getAsset(r)?e.props.assetId!==r&&t.updateShapes([{id:e.id,type:e.type,props:{assetId:r}}]):(t.updateShapes([{id:e.id,type:e.type,props:{assetId:null}}]),qee(t,e))}const qee=Ok(async(t,e)=>{if(t.isDisposed)return;const{url:n}=e.props,r=await t.getAssetForExternalContent({type:"url",url:n});r&&t.run(()=>{t.createAssets([r]),t.updateShapes([{id:e.id,type:e.type,props:{assetId:r.id}}])})},500);function dl(t,e=!1){const n=t.length;if(n<2)return"";let r=t[0].point,s=t[1].point;if(n===2)return`M${Xe(r)}L${Xe(s)}`;let i="";for(let o=2,a=n-1;o<a;o++)r=t[o].point,s=t[o+1].point,i+=yr(r,s);return e?`M${yr(t[0].point,t[1].point)}Q${Xe(t[1].point)}${yr(t[1].point,t[2].point)}T${i}${yr(t[n-1].point,t[0].point)}${yr(t[0].point,t[1].point)}Z`:`M${Xe(t[0].point)}Q${Xe(t[1].point)}${yr(t[1].point,t[2].point)}${t.length>3?"T":""}${i}L${Xe(t[n-1].point)}`}function Yee(t,e={}){const{start:n={},end:r={}}=e,{cap:s=!0}=n,{cap:i=!0}=r;We(!n.taper&&!r.taper,"cap taper not supported here"),We(!n.easing&&!r.easing,"cap easing not supported here"),We(s&&i,"cap must be true");const o=wi(t,e);mm(o,e);const a=Xee(o);let l="";for(const c of a)l+=Qee(c,e);return l}function Xee(t){if(t.length<=2)return[t];const e=[];let n=[t[0]],r=b.Sub(t[1].point,t[0].point).uni(),s,i,o,a,l;for(let c=1,u=t.length;c<u-1;c++){if(o=t[c-1],a=t[c],l=t[c+1],s=b.Sub(l.point,a.point).uni(),i=b.Dpr(r,s),r=s,i<-.8){const h={...a,point:a.input};n.push(h),e.push(Py(n)),n=[h];continue}if(n.push(a),!(i>.7)&&(b.Dist2(o.point,a.point)+b.Dist2(a.point,l.point))/((o.radius+a.radius+l.radius)/3)**2<1.5){n.push(a),e.push(Py(n)),n=[a];continue}}return n.push(t[t.length-1]),e.push(Py(n)),e}function Py(t){const e=t[0];let n;for(;t.length>2&&(n=t[1],b.Dist2(e.point,n.point)<((e.radius+n.radius)/2*.5)**2);)t.splice(1,1);const r=t[t.length-1];let s;for(;t.length>2&&(s=t[t.length-2],b.Dist2(r.point,s.point)<((r.radius+s.radius)/2*.5)**2);)t.splice(t.length-2,1);return t.length>1&&(t[0]={...t[0],vector:b.Sub(t[0].point,t[1].point).uni()},t[t.length-1]={...t[t.length-1],vector:b.Sub(t[t.length-2].point,t[t.length-1].point).uni()}),t}function Zee(t,e,n){return"M "+t+" "+e+" m -"+n+", 0 a "+n+","+n+" 0 1,1 "+n*2+",0 a "+n+","+n+" 0 1,1 -"+n*2+",0"}function Qee(t,e={}){if(t.length===0)return"";if(t.length===1)return Zee(t[0].point.x,t[0].point.y,t[0].radius);const{left:n,right:r}=tT(t,e);r.reverse();let s=`M${Xe(n[0])}T`;for(let i=1;i<n.length;i++)s+=yr(n[i-1],n[i]);{const i=t[t.length-1],o=i.radius,a=i.vector.clone().per().neg(),l=b.Add(i.point,b.Mul(a,o)),c=b.Add(i.point,b.Mul(a,-o));s+=`${Xe(l)}A${K(o)},${K(o)} 0 0 1 ${Xe(c)}T`}for(let i=1;i<r.length;i++)s+=yr(r[i-1],r[i]);{const i=t[0],o=i.radius,a=i.vector.clone().per(),l=b.Add(i.point,b.Mul(a,o)),c=b.Add(i.point,b.Mul(a,-o));s+=`${Xe(l)}A${K(o)},${K(o)} 0 0 1 ${Xe(c)}Z`}return s}const Jee=t=>t*.65+vq(t*Qe/2)*.35,ete=t=>({size:t,thinning:.5,streamline:Dc(t,[9,16],[.64,.74],!0),smoothing:.62,easing:dn.easeOutSine,simulatePressure:!0}),tte=t=>({size:1+t*1.2,thinning:.62,streamline:.62,smoothing:.62,simulatePressure:!1,easing:Jee}),E7=t=>({size:t,thinning:0,streamline:Dc(t,[9,16],[.64,.74],!0),smoothing:.62,simulatePressure:!1,easing:dn.linear}),nte=t=>({size:t,thinning:0,streamline:.62,smoothing:.62,simulatePressure:!1,easing:dn.linear});function ew({strokeWidth:t,showAsComplete:e}){return{size:1+t,thinning:0,streamline:.5,smoothing:.5,simulatePressure:!1,easing:dn.easeOutSine,last:e}}function sS(t,e,n,r){const s=t.isComplete||n;return r?t.isPen?{...nte(e),last:s}:{...E7(e),last:s}:t.dash==="draw"?t.isPen?{...tte(e),last:s}:{...ete(e),last:s}:{...E7(e),last:s}}function Nc(t){const e=[];for(const n of t)if(n.type==="free"||n.points.length<2)e.push(...n.points.map(b.Cast));else{const r=Math.max(4,Math.floor(b.Dist(n.points[0],n.points[1])/16));e.push(...b.PointsBetween(n.points[0],n.points[1],r))}return e}function rte(t,e){return{draw:"none",solid:"none",dotted:`0.1 ${e*2}`,dashed:`${e*2} ${e*2}`}[t.props.dash]}class Vp extends fs{constructor(){super(...arguments);g(this,"hideResizeHandles",n=>ky(n));g(this,"hideRotateHandle",n=>ky(n));g(this,"hideSelectionBoundsFg",n=>ky(n));g(this,"onResize",(n,r)=>{const{scaleX:s,scaleY:i}=r,o=[];for(const a of n.props.segments)o.push({...a,points:a.points.map(({x:l,y:c,z:u})=>({x:Ui(s*l),y:Ui(i*c),z:u}))});return{props:{segments:o}}})}getDefaultProps(){return{segments:[],color:"black",fill:"none",dash:"draw",size:"m",isComplete:!1,isClosed:!1,isPen:!1,scale:1}}getGeometry(n){const r=Nc(n.props.segments),s=(hn[n.props.size]+1)*n.props.scale;if(n.props.segments.length===1){const o=fe.FromPoints(r);if(o.width<s*2&&o.height<s*2)return new G4({x:-s,y:-s,radius:s,isFilled:!0})}const i=wi(r,sS(n.props,s,n.props.isPen,!0)).map(o=>o.point);return n.props.isClosed?new Kt({points:i,isFilled:n.props.fill!=="none"}):new eu({points:i})}component(n){return d.jsx(oa,{id:n.id,children:d.jsx(T7,{shape:n,zoomLevel:this.editor.getZoomLevel()})})}indicator(n){var h;const r=Nc(n.props.segments);let s=(hn[n.props.size]+1)*n.props.scale;const i=this.editor.getZoomLevel();!(i<.5&&i<1.5/s)&&!n.props.isPen&&n.props.dash==="draw"&&r.length===1&&(s+=Hs(n.id)()*(s/6));const a=n.props.isComplete||((h=xn(n.props.segments))==null?void 0:h.type)==="straight",l=sS(n.props,s,a,!0),c=wi(r,l),u=c.length>1?dl(c,n.props.isClosed):PT(r[0],s);return d.jsx("path",{d:u})}toSvg(n,r){r.addExportDef(X4(n.props.fill));const s=1/n.props.scale;return d.jsx("g",{transform:`scale(${s})`,children:d.jsx(T7,{shape:n,zoomLevel:1})})}getCanvasSvgDefs(){return[Z4()]}expandSelectionOutlinePx(n){const r=n.props.dash==="draw"?1.6:1;return hn[n.props.size]*r/2*n.props.scale}}g(Vp,"type","draw"),g(Vp,"props",bI),g(Vp,"migrations",CI);function PT(t,e){const n=(e+1)*.5;return`M ${t.x} ${t.y} m -${n}, 0 a ${n},${n} 0 1,0 ${n*2},0 a ${n},${n} 0 1,0 -${n*2},0`}function ky(t){return t.props.segments.length===1&&t.props.segments[0].points.length<2}function T7({shape:t,zoomLevel:e}){var h;const n=Cs(),r=Nc(t.props.segments),s=t.props.isComplete||((h=xn(t.props.segments))==null?void 0:h.type)==="straight";let i=(hn[t.props.size]+1)*t.props.scale;const o=e<.5&&e<1.5/i;!o&&!t.props.isPen&&t.props.dash==="draw"&&r.length===1&&(i+=Hs(t.id)()*(i/6));const a=sS(t.props,i,s,o);if(!o&&t.props.dash==="draw")return d.jsxs(d.Fragment,{children:[t.props.isClosed&&t.props.fill&&r.length>1?d.jsx(Ln,{d:dl(wi(r,a),t.props.isClosed),theme:n,color:t.props.color,fill:t.props.isClosed?t.props.fill:"none",scale:t.props.scale}):null,d.jsx("path",{d:Yee(r,a),strokeLinecap:"round",fill:n[t.props.color].solid})]});const l=wi(r,a),c=l.length<2,u=c?PT(r[0],0):dl(l,t.props.isClosed);return d.jsxs(d.Fragment,{children:[d.jsx(Ln,{d:u,theme:n,color:t.props.color,fill:c||t.props.isClosed?t.props.fill:"none",scale:t.props.scale}),d.jsx("path",{d:u,strokeLinecap:"round",fill:c?n[t.props.color].solid:"none",stroke:n[t.props.color].solid,strokeWidth:i,strokeDasharray:c?"none":rte(t,i),strokeDashoffset:"0"})]})}function ste(t,e,n={}){const{newPoint:r,handle:s,scaleX:i,scaleY:o}=e,{minWidth:a=1,maxWidth:l=1/0,minHeight:c=1,maxHeight:u=1/0}=n;let h=t.props.w*i,p=t.props.h*o;const f=new b(0,0);if(h>0){if(h<a){switch(s){case"top_left":case"left":case"bottom_left":{f.x=h-a;break}case"top":case"bottom":{f.x=(h-a)/2;break}default:f.x=0}h=a}}else if(f.x=h,h=-h,h<a){switch(s){case"top_left":case"left":case"bottom_left":{f.x=-h;break}default:f.x=-a}h=a}if(p>0){if(p<c){switch(s){case"top_left":case"top":case"top_right":{f.y=p-c;break}case"right":case"left":{f.y=(p-c)/2;break}default:f.y=0}p=c}}else if(f.y=p,p=-p,p<c){switch(s){case"top_left":case"top":case"top_right":{f.y=-p;break}default:f.y=-c}p=c}const{x:v,y:m}=f.rot(t.rotation).add(r);return{x:v,y:m,props:{w:Math.min(l,h),h:Math.min(u,p)}}}const ite=t=>Object.entries(t).filter(([e,n])=>n).map(([e])=>e).join(" ");class qp extends tu{constructor(){super(...arguments);g(this,"hideSelectionBoundsFg",n=>!this.canResize(n));g(this,"canEdit",()=>!0);g(this,"canResize",n=>{var r,s;return!!((s=(r=Uo(n.props.url))==null?void 0:r.definition)!=null&&s.doesResize)});g(this,"canEditInReadOnly",()=>!0);g(this,"isAspectRatioLocked",n=>{const r=Uo(n.props.url);return(r==null?void 0:r.definition.isAspectRatioLocked)??!1});g(this,"onResize",(n,r)=>{const s=this.isAspectRatioLocked(n),i=Uo(n.props.url);let o=(i==null?void 0:i.definition.minWidth)??200,a=(i==null?void 0:i.definition.minHeight)??200;if(s){const l=n.props.w/n.props.h;l>1?o*=l:a/=l}return ste(n,r,{minWidth:o,minHeight:a})})}getDefaultProps(){return{w:300,h:300,url:""}}component(n){const{w:r,h:s,url:i}=n.props,o=gm(n.id),a=C.useMemo(()=>oT(i),[i]),l=J("is hovering",()=>{const{editingShapeId:f,hoveredShapeId:v}=this.editor.getCurrentPageState();if(f&&v!==f){const m=this.editor.getShape(f);if(m&&this.editor.isShapeOfType(m,"embed"))return!0}return!1},[]),c=this.editor.getShapePageTransform(n).rotation(),u=o||l;if(typeof window<"u"&&(window!==window.top||window.self!==window.parent)&&(a==null?void 0:a.definition.type)==="tldraw")return null;if((a==null?void 0:a.definition.type)==="github_gist"){const f=a.url.split("/").pop();if(!f)throw Error("No gist id!");return d.jsx(aa,{className:"tl-embed-container",id:n.id,children:d.jsx(ote,{id:f,width:K(r),height:K(s),isInteractive:u,pageRotation:c})})}const p=ite({...JV,...(a==null?void 0:a.definition.overridePermissions)??{}});return d.jsx(aa,{className:"tl-embed-container",id:n.id,children:a!=null&&a.definition?d.jsx("iframe",{className:"tl-embed",sandbox:p,src:a.embedUrl,width:K(r),height:K(s),draggable:!1,frameBorder:"0",referrerPolicy:"no-referrer-when-downgrade",style:{border:0,pointerEvents:u?"auto":"none",zIndex:u?"":"-1",boxShadow:J4(c),borderRadius:(a==null?void 0:a.definition.overrideOutlineRadius)??8,background:a==null?void 0:a.definition.backgroundColor}}):null})}indicator(n){const r=C.useMemo(()=>Uo(n.props.url),[n.props.url]);return d.jsx("rect",{width:K(n.props.w),height:K(n.props.h),rx:(r==null?void 0:r.definition.overrideOutlineRadius)??8,ry:(r==null?void 0:r.definition.overrideOutlineRadius)??8})}}g(qp,"type","embed"),g(qp,"props",PI),g(qp,"migrations",kI);function ote({id:t,file:e,isInteractive:n,width:r,height:s,style:i,pageRotation:o}){return d.jsx("iframe",{className:"tl-embed",draggable:!1,width:K(r),height:K(s),frameBorder:"0",scrolling:"no",seamless:!0,referrerPolicy:"no-referrer-when-downgrade",style:{...i,pointerEvents:n?"all":"none",zIndex:n?"":"-1",boxShadow:J4(o)},srcDoc:`
			<html>
				<head>
					<base target="_blank">
				</head>
				<body>
					<script src=${`https://gist.github.com/${t}.js${e?`?file=${e}`:""}`}><\/script>
					<style type="text/css">
						* { margin: 0px; }
						table { height: 100%; background-color: red; }
						.gist { background-color: none; height: 100%;  }
						.gist .gist-file { height: calc(100vh - 2px); padding: 0px; display: grid; grid-template-rows: 1fr auto; }
					</style>
				</body>
			</html>`})}const ate=C.forwardRef(({id:t,name:e,isEditing:n},r)=>{const s=G(),i=C.useCallback(l=>{l.key==="Enter"&&!l.nativeEvent.isComposing&&(sn(l),l.currentTarget.blur(),s.setEditingShape(null))},[s]),o=C.useCallback(l=>{const c=s.getShape(t);if(!c)return;const u=c.props.name,h=l.currentTarget.value.trim();u!==h&&s.updateShapes([{id:t,type:"frame",props:{name:h}}])},[t,s]),a=C.useCallback(l=>{const c=s.getShape(t);if(!c)return;const u=c.props.name,h=l.currentTarget.value;u!==h&&s.updateShapes([{id:t,type:"frame",props:{name:h}}])},[t,s]);return d.jsxs("div",{className:`tl-frame-label ${n?"tl-frame-label__editing":""}`,children:[d.jsx("input",{className:"tl-frame-name-input",ref:r,style:{display:n?void 0:"none"},value:e,autoFocus:!0,onKeyDown:i,onBlur:o,onChange:a}),kT(e,"Frame")+"​"]})}),lte=function({id:e,name:n,width:r,height:s}){const i=G(),o=J("shape rotation",()=>ta(i.getShapePageTransform(e).rotation()),[i,e]),a=gm(e),l=C.useRef(null),c=C.useCallback(v=>{const m=wr(v);v.preventDefault(),i.getEditingShapeId()!==e&&i.dispatch({type:"pointer",name:"pointer_down",target:"shape",shape:i.getShape(e),...m})},[i,e]);C.useEffect(()=>{const v=l.current;v&&a&&(v.focus(),v.select())},[l,a]);const h=((o+Math.PI/4)*(2/Math.PI)+4)%4,p=["top","left","bottom","right"][Math.floor(h)];let f;switch(p){case"top":f="";break;case"right":f=`translate(${K(r)}px, 0px) rotate(90deg)`;break;case"bottom":f=`translate(${K(r)}px, ${K(s)}px) rotate(180deg)`;break;case"left":f=`translate(0px, ${K(s)}px) rotate(270deg)`;break}return d.jsx("div",{className:"tl-frame-heading",style:{overflow:a?"visible":"hidden",maxWidth:`calc(var(--tl-zoom) * ${Math.ceil(p==="top"||p==="bottom"?r:s)}px + var(--space-5))`,bottom:"100%",transform:`${f} scale(var(--tl-scale)) translateX(calc(-1 * var(--space-3))`},onPointerDown:c,children:d.jsx("div",{className:"tl-frame-heading-hit-area",children:d.jsx(ate,{ref:l,id:e,name:n,isEditing:a})})})};function kT(t,e){return t.match(/^\s*$/)?e:t}class Yp extends tu{constructor(){super(...arguments);g(this,"canEdit",()=>!0);g(this,"canReceiveNewChildrenOfType",(n,r)=>!n.isLocked);g(this,"canDropShapes",(n,r)=>!n.isLocked);g(this,"onDragShapesOver",(n,r)=>{r.every(s=>s.parentId===n.id)||this.editor.reparentShapes(r,n.id)});g(this,"onDragShapesOut",(n,r)=>{const s=this.editor.getShape(n.parentId);s&&this.editor.isShapeOfType(s,"group")?this.editor.reparentShapes(r,s.id):this.editor.reparentShapes(r,this.editor.getCurrentPageId())});g(this,"onResize",(n,r)=>fm(n,r))}getDefaultProps(){return{w:160*2,h:90*2,name:""}}getGeometry(n){return new xi({width:n.props.w,height:n.props.h,isFilled:!1})}component(n){const r=this.editor.getShapeGeometry(n).bounds,s=Cs(),i=J("is creating this shape",()=>{const o=this.editor.getStateDescendant("select.resizing");if(!o||!o.getIsActive())return!1;const a=o==null?void 0:o.info;return a?a.isCreating&&this.editor.getOnlySelectedShapeId()===n.id:!1},[n.id]);return d.jsxs(d.Fragment,{children:[d.jsx(oa,{children:d.jsx("rect",{className:be("tl-frame__body",{"tl-frame__creating":i}),width:r.width,height:r.height,fill:s.solid,stroke:s.text})}),i?null:d.jsx(lte,{id:n.id,name:n.props.name,width:r.width,height:r.height})]})}toSvg(n,r){const s=go({isDarkMode:r.isDarkMode}),a=((ta(this.editor.getShapePageTransform(n.id).rotation())+Math.PI/4)*(2/Math.PI)+4)%4,l=Math.floor(a);let c;switch(l){case 0:c="";break;case 3:c=`translate(${K(n.props.w)}, 0) rotate(90)`;break;case 2:c=`translate(${K(n.props.w)}, ${K(n.props.h)}) rotate(180)`;break;case 1:c=`translate(0, ${K(n.props.h)}) rotate(270)`;break;default:throw Error("labelSide out of bounds")}const u={fontSize:12,fontFamily:"Inter, sans-serif",textAlign:"start",width:n.props.w,height:32,padding:0,lineHeight:1,fontStyle:"normal",fontWeight:"normal",overflow:"truncate-ellipsis",verticalTextAlign:"middle"},h=this.editor.textMeasure.measureTextSpans(kT(n.props.name,"Frame")+"​",u),p=h[0],f=xn(h),v=f.box.w+f.box.x-p.box.x,m=nS(this.editor,h,{offsetY:-u.height-2,...u});return d.jsxs(d.Fragment,{children:[d.jsx("rect",{width:n.props.w,height:n.props.h,fill:s.solid,stroke:s.black.solid,strokeWidth:1,rx:1,ry:1}),d.jsxs("g",{transform:c,children:[d.jsx("rect",{x:-8,y:-u.height-4,width:v+16,height:u.height,fill:s.background,rx:4,ry:4}),m]})]})}indicator(n){const r=this.editor.getShapeGeometry(n).bounds;return d.jsx("rect",{width:K(r.width),height:K(r.height),className:"tl-frame-indicator"})}providesBackgroundForChildren(){return!0}}g(Yp,"type","frame"),g(Yp,"props",II),g(Yp,"migrations",EI);function M7(t,e){return t>e?(Qe*(e/2)+(t-e))*2:(Qe*(t/2)+(e-t))*2}function IT(t,e){return tw(t,e).map((n,r)=>n.getSvgPathData(r===0)).join(" ")+" Z"}function cte(t,e,n,r){const s=t/4,i=e/4,o=Hs(r),a=n*.75,l=S=>S.addXY(o()*a,o()*a),c=new b(t/2,e),u=new b(0,i*1.2),h=new b(t/2,i*.9),p=new b(t,i*1.2),f=l(new b(t/2,e)),v=l(new b(0,i*1.2)),m=l(new b(t/2,i*.9)),x=l(new b(t,i*1.2));return[new zn({start:c,cp1:new b(s*1.5,i*3),cp2:new b(0,i*2.5),end:u}),new zn({start:u,cp1:new b(0,-i*.32),cp2:new b(s*1.85,-i*.32),end:h}),new zn({start:h,cp1:new b(s*2.15,-i*.32),cp2:new b(t,-i*.32),end:p}),new zn({start:p,cp1:new b(t,i*2.5),cp2:new b(s*2.5,i*3),end:f}),new zn({start:f,cp1:new b(s*1.5,i*3),cp2:new b(0,i*2.5),end:v}),new zn({start:v,cp1:new b(0,-i*.32),cp2:new b(s*1.85,-i*.32),end:m}),new zn({start:m,cp1:new b(s*2.15,-i*.32),cp2:new b(t,-i*.32),end:x}),new zn({start:x,cp1:new b(t,i*2.5),cp2:new b(s*2.5,i*3),end:c})].map((S,w)=>S.getSvgPathData(w===0)).join(" ")+" Z"}function tw(t,e){const n=t/4,r=e/4;return[new zn({start:new b(t/2,e),cp1:new b(n*1.5,r*3),cp2:new b(0,r*2.5),end:new b(0,r*1.2)}),new zn({start:new b(0,r*1.2),cp1:new b(0,-r*.32),cp2:new b(n*1.85,-r*.32),end:new b(t/2,r*.9)}),new zn({start:new b(t/2,r*.9),cp1:new b(n*2.15,-r*.32),cp2:new b(t,-r*.32),end:new b(t,r*1.2)}),new zn({start:new b(t,r*1.2),cp1:new b(t,r*2.5),cp2:new b(n*2.5,r*3),end:new b(t/2,e)})]}function ute(t){return{size:1+t,thinning:.25,end:{taper:t},start:{taper:t},streamline:0,smoothing:1,simulatePressure:!1}}function dte(t,e,n,r){const s=Hs(t),i=e/2,o=n/2,a=VI(i,o),l=[],c=it*s(),u=it+vt/2+Math.abs(s())*vt,h=Math.max(16,a/10);for(let p=0;p<h;p++){const f=p/(h-1),v=c+f*u,m=Math.cos(v),x=Math.sin(v);l.push(new b(i*m+e*.5+.05*s(),o*x+n/2+.05*s(),Math.min(1,.5+Math.abs(.5-(s()>0?dn.easeInOutSine(f):dn.easeInExpo(f)))/2)))}return wi(l,ute(r))}function hte(t,e,n,r){return dl(dte(t,e,n,r))}function iS(t){let e="M";const n=t.length;let r,s,i;for(let o=0,a=n;o<a;o+=3)r=t[o],s=t[o+1],i=t[o+2],e+=`${Xe(r)}L${Xe(s)}Q${Xe(i)}`;return e+=`${Xe(t[0])}`,e}function oS(t,e,n,r,s){const i=[],o=Hs(t);let a=e[0],l;const c=e.length;for(let u=0,h=c*s;u<h;u++){l=b.AddXY(e[(u+1)%c],o()*n,o()*n);const p=b.Sub(l,a),f=b.Len(p),v=b.Div(p,f).mul(Math.min(f/4,r));i.push(b.Add(a,v),b.Add(l,v.neg()),l),a=l}return i}function pte(t,e,n){const r=Math.min(t,e)/2,s=Math.max(t,e)-r*2,o=(Math.PI*(r*2)+2*s)/n,a=t>e?[{type:"straight",start:new b(r,0),delta:new b(1,0)},{type:"arc",center:new b(t-r,r),startAngle:-Qe/2},{type:"straight",start:new b(t-r,e),delta:new b(-1,0)},{type:"arc",center:new b(r,r),startAngle:Qe/2}]:[{type:"straight",start:new b(t,r),delta:new b(0,1)},{type:"arc",center:new b(r,e-r),startAngle:0},{type:"straight",start:new b(0,e-r),delta:new b(0,-1)},{type:"arc",center:new b(r,r),startAngle:Qe}];let l=0;const c=[];for(let u=0;u<n;u++){const h=a[0];h.type==="straight"?c.push(b.Add(h.start,b.Mul(h.delta,l))):c.push(ul(h.center,r,h.startAngle+l/r)),l+=o;let p=h.type==="straight"?s:Qe*r;for(;l>p;)l-=p,a.push(a.shift()),p=a[0].type==="straight"?s:Qe*r}return c}const fte={s:50,m:70,l:100,xl:130},gte=.2;function wm(t,e,n,r){const s=Hs(n),i=M7(t,e),o=Math.max(Math.ceil(i/fte[r]),6,Math.ceil(i/Math.min(t,e))),a=i/o*gte,l=Math.max(t-a*2,1),c=Math.max(e-a*2,1),h=M7(l,c)/o,p=(t-l)/2,f=(e-c)/2,v=pte(l,c,o).map(w=>w.addXY(p,f)),m=t<20?0:a*.3,x=e<20?0:a*.3,y=v.slice(0);for(let w=0;w<Math.floor(o/2);w++)y[w]=b.AddXY(y[w],s()*m,s()*x),y[o-w-1]=b.AddXY(y[o-w-1],s()*m,s()*x);const S=[];for(let w=0;w<y.length;w++){const P=w===y.length-1?0:w+1,E=y[w],M=y[P],I=v[w],_=v[P],D=b.Dist(I,_),R=h-D,U=b.Dist(E,M)/D,O=(Math.max(p,f)+R)*U,N=b.Lrp(I,_,.5).add(b.Sub(_,I).uni().per().mul(O));N.x<0?N.x=0:N.x>t&&(N.x=t),N.y<0?N.y=0:N.y>e&&(N.y=e);const H=E4(E,M,N),Z=b.Dist(H||b.Average([E,M]),E);S.push({leftPoint:E,rightPoint:M,arcPoint:N,center:H,radius:Z})}return S}function mte(t,e,n,r){const s=[],i=wm(t,e,n,r);for(const{center:o,radius:a,leftPoint:l,rightPoint:c}of i)s.push(...bq(l,c,o,a,10));return s}function aS(t,e,n,r){const s=wm(t,e,n,r);let i=`M${s[0].leftPoint.toFixed()}`;for(const{leftPoint:o,rightPoint:a,radius:l,center:c}of s){if(c===null){i+=` L${a.toFixed()}`;continue}const u=b.Clockwise(o,a,c)?"0":"1";i+=` A${K(l)},${K(l)} 0 ${u},1 ${a.toFixed()}`}return i+=" Z",i}const yte={s:.5,m:.7,l:.9,xl:1.6};function vte(t,e,n,r){const s=Hs(n),i=yte[r],o=wm(t,e,n,r),c=o.reduce((f,v)=>f+b.Dist2(v.leftPoint,v.rightPoint),0)/o.length>(i*15)**2?f=>f.addXY(s()*i*2,s()*i*2):f=>f;let u=`M${o[0].leftPoint.toFixed()}`,h=c(o[0].leftPoint),p=`M${h.toFixed()}`;for(const{leftPoint:f,center:v,rightPoint:m,radius:x,arcPoint:y}of o){if(v===null){u+=` L${m.toFixed()}`;const I=c(m);p+=` L${I.toFixed()}`,h=I;continue}const S=b.Clockwise(f,m,v)?"0":"1";u+=` A${K(x)},${K(x)} 0 ${S},1 ${m.toFixed()}`;const w=c(m),P=c(y),E=E4(h,w,P);if(!Number.isFinite(E.x)||!Number.isFinite(E.y)){p+=` L${w.toFixed()}`,h=w;continue}const M=Math.abs(b.Dist(E,h));p+=` A${K(M)},${K(M)} 0 ${S},1 ${w.toFixed()}`,h=w}return u+p+" Z"}function lS(t,e){switch(t.geo){case"x-box":return Ste(t.w,t.h,e,t.dash);case"check-box":return xte(t.w,t.h);default:return}}function Ste(t,e,n,r){const s=r==="draw"?.62:0;if(r==="dashed")return[[new b(0,0),new b(t/2,e/2)],[new b(t,e),new b(t/2,e/2)],[new b(0,e),new b(t/2,e/2)],[new b(t,0),new b(t/2,e/2)]];const i=a=>Math.max(0,Math.min(t,a)),o=a=>Math.max(0,Math.min(e,a));return[[new b(i(n*s),o(n*s)),new b(i(t-n*s),o(e-n*s))],[new b(i(n*s),o(e-n*s)),new b(i(t-n*s),o(n*s))]]}function xte(t,e){const n=Math.min(t,e)*.82,r=(t-n)/2,s=(e-n)/2,i=a=>Math.max(0,Math.min(t,a)),o=a=>Math.max(0,Math.min(e,a));return[[new b(i(r+n*.25),o(s+n*.52)),new b(i(r+n*.45),o(s+n*.82))],[new b(i(r+n*.45),o(s+n*.82)),new b(i(r+n*.82),o(s+n*.22))]]}function _7({shape:t,shouldScale:e}){const n=e?t.props.scale:1,r=G(),s=Cs(),{id:i,props:o}=t,{w:a,color:l,fill:c,dash:u,growY:h,size:p}=o,f=hn[p]*n,v=o.h+h;switch(o.geo){case"cloud":if(u==="solid"){const m=aS(a,v,i,p);return d.jsxs(d.Fragment,{children:[d.jsx(Ln,{theme:s,d:m,color:l,fill:c,scale:n}),d.jsx("path",{d:m,stroke:s[l].solid,strokeWidth:f,fill:"none"})]})}else if(u==="draw"){const m=vte(a,v,i,p);return d.jsxs(d.Fragment,{children:[d.jsx(Ln,{theme:s,d:m,color:l,fill:c,scale:n}),d.jsx("path",{d:m,stroke:s[l].solid,strokeWidth:f,fill:"none"})]})}else{const m=aS(a,v,i,p),x=wm(a,v,i,p);return d.jsxs(d.Fragment,{children:[d.jsx(Ln,{theme:s,d:m,color:l,fill:c,scale:n}),d.jsx("g",{strokeWidth:f,stroke:s[l].solid,fill:"none",pointerEvents:"all",children:x.map(({leftPoint:y,rightPoint:S,center:w,radius:P},E)=>{const M=w?P*ta(ta(b.Angle(w,S))-ta(b.Angle(w,y))):b.Dist(y,S),{strokeDasharray:I,strokeDashoffset:_}=ti(M,f,{style:u,start:"outset",end:"outset"});return d.jsx("path",{d:w?`M${y.x},${y.y}A${P},${P},0,0,1,${S.x},${S.y}`:`M${y.x},${y.y}L${S.x},${S.y}`,strokeDasharray:I,strokeDashoffset:_},E)})})]})}case"ellipse":{const m=e?r.getShapeGeometry(t):r.getShapeUtil(t).getGeometry(t),x=m.getSvgPathData(!0);if(u==="dashed"||u==="dotted"){const y=m.length,{strokeDasharray:S,strokeDashoffset:w}=ti(y<64?y*2:y,f,{style:u,snap:4,closed:!0});return d.jsxs(d.Fragment,{children:[d.jsx(Ln,{theme:s,d:x,color:l,fill:c,scale:n}),d.jsx("path",{d:x,strokeWidth:f,fill:"none",stroke:s[l].solid,strokeDasharray:S,strokeDashoffset:w})]})}else{const S=(e?r.getShapeGeometry(t):r.getShapeUtil(t).getGeometry(t)).getSvgPathData(!0);return d.jsxs(d.Fragment,{children:[d.jsx(Ln,{theme:s,d:S,color:l,fill:c,scale:n}),d.jsx("path",{d:S,stroke:s[l].solid,strokeWidth:f,fill:"none"})]})}}case"oval":{const m=e?r.getShapeGeometry(t):r.getShapeUtil(t).getGeometry(t),x=m.getSvgPathData(!0);if(u==="dashed"||u==="dotted"){const y=m.getLength(),{strokeDasharray:S,strokeDashoffset:w}=ti(y<64?y*2:y,f,{style:u,snap:4,start:"outset",end:"outset",closed:!0});return d.jsxs(d.Fragment,{children:[d.jsx(Ln,{theme:s,d:x,color:l,fill:c,scale:n}),d.jsx("path",{d:x,strokeWidth:f,fill:"none",stroke:s[l].solid,strokeDasharray:S,strokeDashoffset:w})]})}else return d.jsxs(d.Fragment,{children:[d.jsx(Ln,{theme:s,d:x,color:l,fill:c,scale:n}),d.jsx("path",{d:x,stroke:s[l].solid,strokeWidth:f,fill:"none"})]})}case"heart":if(u==="dashed"||u==="dotted"||u==="solid"){const m=IT(a,v),x=tw(a,v);return d.jsxs(d.Fragment,{children:[d.jsx(Ln,{theme:s,d:m,color:l,fill:c,scale:n}),x.map((y,S)=>{const{strokeDasharray:w,strokeDashoffset:P}=ti(y.length,f,{style:u,snap:1,start:"outset",end:"outset",closed:!0});return d.jsx("path",{d:y.getSvgPathData(),strokeWidth:f,fill:"none",stroke:s[l].solid,strokeDasharray:w,strokeDashoffset:P,pointerEvents:"all"},`curve_${S}`)})]})}else{const m=cte(a,v,f,t.id);return d.jsxs(d.Fragment,{children:[d.jsx(Ln,{theme:s,d:m,color:l,fill:c,scale:n}),d.jsx("path",{d:m,stroke:s[l].solid,strokeWidth:f,fill:"none"})]})}default:{const m=e?r.getShapeGeometry(t):r.getShapeUtil(t).getGeometry(t),x=m instanceof $s?m.children[0].vertices:m.vertices,y=lS(t.props,f);if(u==="solid"){let S="M"+x[0]+"L"+x.slice(1)+"Z";if(y)for(const[w,P]of y)S+=`M${w.x},${w.y}L${P.x},${P.y}`;return d.jsxs(d.Fragment,{children:[d.jsx(Ln,{theme:s,d:S,color:l,fill:c,scale:n}),d.jsx("path",{d:S,stroke:s[l].solid,strokeWidth:f,fill:"none"})]})}else if(u==="dashed"||u==="dotted"){const S="M"+x[0]+"L"+x.slice(1)+"Z";return d.jsxs(d.Fragment,{children:[d.jsx(Ln,{theme:s,d:S,color:l,fill:c,scale:n}),d.jsxs("g",{strokeWidth:f,stroke:s[l].solid,fill:"none",pointerEvents:"all",children:[Array.from(Array(x.length)).map((w,P)=>{const E=b.ToFixed(x[P]),M=b.ToFixed(x[(P+1)%x.length]),I=b.Dist(E,M),{strokeDasharray:_,strokeDashoffset:D}=ti(I,f,{style:u,start:"outset",end:"outset"});return d.jsx("line",{x1:E.x,y1:E.y,x2:M.x,y2:M.y,strokeDasharray:_,strokeDashoffset:D},P)}),y&&y.map(([w,P],E)=>{const M=b.Dist(w,P),{strokeDasharray:I,strokeDashoffset:_}=ti(M,f,{style:u,start:"skip",end:"skip",snap:u==="dotted"?4:void 0});return d.jsx("path",{d:`M${w.x},${w.y}L${P.x},${P.y}`,stroke:s[l].solid,strokeWidth:f,fill:"none",strokeDasharray:I,strokeDashoffset:_},`line_fg_${E}`)})]})]})}else if(u==="draw"){let S=iS(oS(i,x,f/3,f*2,2));if(y)for(const[P,E]of y)S+=`M${P.toFixed()}L${E.toFixed()}`;const w=iS(oS(i,x,0,f*2,1));return d.jsxs(d.Fragment,{children:[d.jsx(Ln,{theme:s,d:w,color:l,fill:c,scale:n}),d.jsx("path",{d:S,stroke:s[l].solid,strokeWidth:f,fill:"none"})]})}}}}const A7=17*3;class Xp extends tu{constructor(){super(...arguments);g(this,"canEdit",()=>!0);g(this,"onEditEnd",n=>{const{id:r,type:s,props:{text:i}}=n;i.trimEnd()!==n.props.text&&this.editor.updateShapes([{id:r,type:s,props:{text:i.trimEnd()}}])});g(this,"onResize",(n,{handle:r,newPoint:s,scaleX:i,scaleY:o,initialShape:a})=>{const l=a.props.w/a.props.scale,c=a.props.h/a.props.scale,u=a.props.growY/a.props.scale;let h=l*i,p=(c+u)*o,f=0,v=0;const m=A7;if(n.props.text.trim()){let E=Math.max(Math.abs(h),m),M=Math.max(Math.abs(p),m);E<m&&M===m&&(E=m),E===m&&M<m&&(M=m);const I=$0(this.editor,{...n,props:{...n.props,w:E*n.props.scale,h:M*n.props.scale}}),_=Math.max(Math.abs(h),I.w)*Math.sign(h),D=Math.max(Math.abs(p),I.h)*Math.sign(p);f=Math.abs(_)-Math.abs(h),v=Math.abs(D)-Math.abs(p),h=_,p=D}const x=h*n.props.scale,y=p*n.props.scale,S=new b(0,0);i<0&&(S.x+=x),(r==="left"||r==="top_left"||r==="bottom_left")&&(S.x+=i<0?f:-f),o<0&&(S.y+=y),(r==="top"||r==="top_left"||r==="top_right")&&(S.y+=o<0?v:-v);const{x:w,y:P}=S.rot(n.rotation).add(s);return{x:w,y:P,props:{w:Math.max(Math.abs(x),1),h:Math.max(Math.abs(y),1),growY:0}}});g(this,"onBeforeCreate",n=>{if(!n.props.text)return n.props.growY?{...n,props:{...n.props,growY:0}}:void 0;const r=n.props.h/n.props.scale,s=$0(this.editor,n).h;let i=null;if(s>r?i=s-r:n.props.growY&&(i=0),i!==null)return{...n,props:{...n.props,growY:i*n.props.scale}}});g(this,"onBeforeUpdate",(n,r)=>{const s=n.props.text,i=r.props.text;if(s===i&&n.props.font===r.props.font&&n.props.size===r.props.size)return;if(s&&!i)return{...r,props:{...r.props,growY:0}};const o=n.props.w/n.props.scale,a=n.props.h/n.props.scale,l=n.props.growY/n.props.scale,c=$0(this.editor,r);if(!s&&i&&i.length===1){let h=Math.max(o,c.w),p=Math.max(a,c.h);const f=A7;return o<f&&a<f&&(h=Math.max(h,f),p=Math.max(p,f),h=Math.max(h,p),p=Math.max(h,p)),{...r,props:{...r.props,w:h*r.props.scale,h:p*r.props.scale,growY:0}}}let u=null;if(c.h>a?u=c.h-a:l&&(u=0),u!==null){const h=r.props.w/r.props.scale;return{...r,props:{...r.props,growY:u*r.props.scale,w:Math.max(h,c.w)*r.props.scale}}}if(c.w>o)return{...r,props:{...r.props,w:c.w*r.props.scale}}});g(this,"onDoubleClick",n=>{if(this.editor.inputs.altKey)switch(n.props.geo){case"rectangle":return{...n,props:{geo:"check-box"}};case"check-box":return{...n,props:{geo:"rectangle"}}}})}getDefaultProps(){return{w:100,h:100,geo:"rectangle",color:"black",labelColor:"black",fill:"none",dash:"draw",size:"m",font:"draw",text:"",align:"middle",verticalAlign:"middle",growY:0,url:"",scale:1}}getGeometry(n){const r=Math.max(1,n.props.w),s=Math.max(1,n.props.h+n.props.growY),i=r/2,o=s/2,a=n.props.fill!=="none";let l;switch(n.props.geo){case"cloud":{l=new Kt({points:mte(r,s,n.id,n.props.size),isFilled:a});break}case"triangle":{l=new Kt({points:[new b(i,0),new b(r,s),new b(0,s)],isFilled:a});break}case"diamond":{l=new Kt({points:[new b(i,0),new b(r,o),new b(i,s),new b(0,o)],isFilled:a});break}case"pentagon":{l=new Kt({points:sy(r,s,5),isFilled:a});break}case"hexagon":{l=new Kt({points:sy(r,s,6),isFilled:a});break}case"octagon":{l=new Kt({points:sy(r,s,8),isFilled:a});break}case"ellipse":{l=new QQ({width:r,height:s,isFilled:a});break}case"oval":{l=new JQ({width:r,height:s,isFilled:a});break}case"star":{const w=it/5/2,P=Math.floor(5/4)*2,E=5*2-P,M=0,I=Math.floor(5/2)*2,_=Math.cos(-vt+P*w)*r/2,D=Math.cos(-vt+E*w)*r/2,R=Math.sin(-vt+M*w)*s/2,$=Math.sin(-vt+I*w)*s/2,U=r-Math.abs(_-D),O=s-Math.abs($-R),N=r/2+D-(r/2-_),H=s/2+R-(s/2-$),Z=1,q=(r-N)/2,V=(s-H)/2,Q=(r+U)/2,ne=(s+O)/2,le=Q*Z/2,de=ne*Z/2;l=new Kt({points:Array.from(Array(5*2)).map((_e,je)=>{const ce=-vt+je*w;return new b(q+(je%2?le:Q)*Math.cos(ce),V+(je%2?de:ne)*Math.sin(ce))}),isFilled:a});break}case"rhombus":{const S=Math.min(r*.38,s*.38);l=new Kt({points:[new b(S,0),new b(r,0),new b(r-S,s),new b(0,s)],isFilled:a});break}case"rhombus-2":{const S=Math.min(r*.38,s*.38);l=new Kt({points:[new b(0,0),new b(r-S,0),new b(r,s),new b(S,s)],isFilled:a});break}case"trapezoid":{const S=Math.min(r*.38,s*.38);l=new Kt({points:[new b(S,0),new b(r-S,0),new b(r,s),new b(0,s)],isFilled:a});break}case"arrow-right":{const S=Math.min(r,s)*.38,w=s*.16;l=new Kt({points:[new b(0,w),new b(r-S,w),new b(r-S,0),new b(r,s/2),new b(r-S,s),new b(r-S,s-w),new b(0,s-w)],isFilled:a});break}case"arrow-left":{const S=Math.min(r,s)*.38,w=s*.16;l=new Kt({points:[new b(S,0),new b(S,w),new b(r,w),new b(r,s-w),new b(S,s-w),new b(S,s),new b(0,s/2)],isFilled:a});break}case"arrow-up":{const S=r*.16,w=Math.min(r,s)*.38;l=new Kt({points:[new b(r/2,0),new b(r,w),new b(r-S,w),new b(r-S,s),new b(S,s),new b(S,w),new b(0,w)],isFilled:a});break}case"arrow-down":{const S=r*.16,w=Math.min(r,s)*.38;l=new Kt({points:[new b(S,0),new b(r-S,0),new b(r-S,s-w),new b(r,s-w),new b(r/2,s),new b(0,s-w),new b(S,s-w)],isFilled:a});break}case"check-box":case"x-box":case"rectangle":{l=new xi({width:r,height:s,isFilled:a});break}case"heart":{const w=tw(r,s).reduce((P,E)=>(P.push(...E.vertices),P),[]);l=new Kt({points:w,isFilled:a});break}default:Cn(n.props.geo)}const c=$0(this.editor,n),u=r/n.props.scale,h=s/n.props.scale,p=Math.min(100,u/2),f=Math.min(Xi[n.props.size]*En.lineHeight+ss*2,h/2),v=Math.min(u,Math.max(c.w,Math.min(p,Math.max(1,u-8)))),m=Math.min(h,Math.max(c.h,Math.min(f,Math.max(1,h-8)))),x=lS(n.props,hn[n.props.size]*n.props.scale),y=x?x.map(S=>new eu({points:S})):[];return new $s({children:[l,new xi({x:n.props.align==="start"?0:n.props.align==="end"?(u-v)*n.props.scale:(u-v)/2*n.props.scale,y:n.props.verticalAlign==="start"?0:n.props.verticalAlign==="end"?(h-m)*n.props.scale:(h-m)/2*n.props.scale,width:v*n.props.scale,height:m*n.props.scale,isFilled:!0,isLabel:!0}),...y]})}getHandleSnapGeometry(n){const r=this.getGeometry(n),s=r.children[0];switch(n.props.geo){case"arrow-down":case"arrow-left":case"arrow-right":case"arrow-up":case"check-box":case"diamond":case"hexagon":case"octagon":case"pentagon":case"rectangle":case"rhombus":case"rhombus-2":case"star":case"trapezoid":case"triangle":case"x-box":return{outline:s,points:[...s.getVertices(),r.bounds.center]};case"cloud":case"ellipse":case"heart":case"oval":return{outline:s,points:[r.bounds.center]};default:Cn(n.props.geo)}}component(n){const{id:r,type:s,props:i}=n,{fill:o,font:a,align:l,verticalAlign:c,size:u,text:h}=i,p=n.id===this.editor.getOnlySelectedShapeId(),f=Cs(),m=this.editor.getEditingShapeId()!==null||n.props.text;return d.jsxs(d.Fragment,{children:[d.jsx(oa,{id:r,children:d.jsx(_7,{shape:n,shouldScale:!0})}),m&&d.jsx(aa,{style:{overflow:"hidden",width:n.props.w,height:n.props.h+i.growY},children:d.jsx(xm,{id:r,type:s,font:a,fontSize:Xi[u]*n.props.scale,lineHeight:En.lineHeight,padding:ss*n.props.scale,fill:o,align:l,verticalAlign:c,text:h,isSelected:p,labelColor:f[i.labelColor].solid,wrap:!0})}),n.props.url&&d.jsx(Lc,{url:n.props.url,zoomLevel:this.editor.getZoomLevel()})]})}indicator(n){const{id:r,props:s}=n,{w:i,size:o}=s,a=s.h+s.growY,l=hn[o],c=this.editor.getShapeGeometry(n);switch(s.geo){case"ellipse":return s.dash==="draw"?d.jsx("path",{d:hte(r,i,a,l)}):d.jsx("path",{d:c.getSvgPathData(!0)});case"heart":return d.jsx("path",{d:IT(i,a)});case"oval":return d.jsx("path",{d:c.getSvgPathData(!0)});case"cloud":return d.jsx("path",{d:aS(i,a,r,o)});default:{const u=this.editor.getShapeGeometry(n),h=u instanceof $s?u.children[0].vertices:u.vertices;let p;if(s.dash==="draw"){const v=oS(r,h,0,l*2*n.props.scale,1);p=iS(v)}else p="M"+h[0]+"L"+h.slice(1)+"Z";const f=lS(n.props,l);if(f)for(const[v,m]of f)p+=`M${v.x},${v.y}L${m.x},${m.y}`;return d.jsx("path",{d:p})}}}toSvg(n,r){const s={...n,props:{...n.props,w:n.props.w/n.props.scale,h:n.props.h/n.props.scale}},i=s.props;r.addExportDef(X4(i.fill));let o;if(i.text){r.addExportDef(vm(i.font));const a=go(r),l=new fe(0,0,i.w,i.h+i.growY);o=d.jsx(Sm,{fontSize:Xi[i.size],font:i.font,align:i.align,verticalAlign:i.verticalAlign,text:i.text,labelColor:a[i.labelColor].solid,bounds:l,padding:16})}return d.jsxs(d.Fragment,{children:[d.jsx(_7,{shouldScale:!1,shape:s}),o]})}getCanvasSvgDefs(){return[Z4()]}}g(Xp,"type","geo"),g(Xp,"props",TI),g(Xp,"migrations",MI);function $0(t,e){const{text:n,font:r,size:s,w:i}=e.props;if(!n)return{w:0,h:0};const o=t.textMeasure.measureText("w",{...En,fontFamily:mi[r],fontSize:Xi[s],maxWidth:100}),a={s:2,m:3.5,l:5,xl:10},l=t.textMeasure.measureText(n,{...En,fontFamily:mi[r],fontSize:Xi[s],minWidth:o.w,maxWidth:Math.max(0,Math.ceil(o.w+a[s]),Math.ceil(i/e.props.scale-ss*2))});return{w:l.w+ss*2,h:l.h+ss*2}}function wte(){const[t,e]=C.useState(!1);return C.useEffect(()=>{const r=CSS.supports("color","color(display-p3 1 1 1)"),s=matchMedia("(color-gamut: p3)");e(r&&s.matches);const i=()=>e(r&&s.matches);return s.addEventListener("change",i),()=>s.removeEventListener("change",i)},[]),J(Vt.forceSrgb)||!t?"srgb":"p3"}const D7=.35,j7=.82;class Zp extends fs{constructor(){super(...arguments);g(this,"hideResizeHandles",n=>B0(n));g(this,"hideRotateHandle",n=>B0(n));g(this,"hideSelectionBoundsFg",n=>B0(n));g(this,"onResize",(n,r)=>{const{scaleX:s,scaleY:i}=r,o=[];for(const a of n.props.segments)o.push({...a,points:a.points.map(({x:l,y:c,z:u})=>({x:s*l,y:i*c,z:u}))});return{props:{segments:o}}})}getDefaultProps(){return{segments:[],color:"black",size:"m",isComplete:!1,isPen:!1,scale:1}}getGeometry(n){const r=Ba(n);if(B0(n))return new G4({x:-r/2,y:-r/2,radius:r/2,isFilled:!0});const{strokePoints:s,sw:i}=R7(n,r,!0),o=ew({strokeWidth:i,showAsComplete:!0});return mm(s,o),new Kt({points:V4(s,o),isFilled:!0})}component(n){const r=Iy(this.editor,n),s=Ba(n);return d.jsx(oa,{id:n.id,children:d.jsx(U0,{shape:n,forceSolid:r,strokeWidth:s,opacity:D7})})}backgroundComponent(n){const r=Iy(this.editor,n),s=Ba(n);return d.jsx(oa,{id:n.id,children:d.jsx(U0,{shape:n,forceSolid:r,strokeWidth:s,opacity:j7})})}indicator(n){const r=Iy(this.editor,n),s=Ba(n),{strokePoints:i,sw:o}=R7(n,s,r),a=Nc(n.props.segments);let l;return i.length<2?l=Cte(a[0],o):l=dl(i,!1),d.jsx("path",{d:l})}toSvg(n){const r=Ba(n),s=r<1.5,i=1/n.props.scale;return d.jsx("g",{transform:`scale(${i})`,children:d.jsx(U0,{forceSolid:s,strokeWidth:r,shape:n,opacity:D7})})}toBackgroundSvg(n){const r=Ba(n),s=r<1.5,i=1/n.props.scale;return d.jsx("g",{transform:`scale(${i})`,children:d.jsx(U0,{forceSolid:s,strokeWidth:r,shape:n,opacity:j7})})}}g(Zp,"type","highlight"),g(Zp,"props",DI),g(Zp,"migrations",jI);function bte(t){return`M ${t.x} ${t.y} m -${.1}, 0 a ${.1},${.1} 0 1,0 ${.1*2},0 a ${.1},${.1} 0 1,0 -${.1*2},0`}function Cte(t,e){const n=e/2;return`M ${t.x} ${t.y} m -${n}, 0 a ${n},${n} 0 1,0 ${n*2},0 a ${n},${n} 0 1,0 -${n*2},0`}function R7(t,e,n){var l;const r=Nc(t.props.segments),s=t.props.isComplete||((l=xn(t.props.segments))==null?void 0:l.type)==="straight";let i=e;!n&&!t.props.isPen&&r.length===1&&(i+=Hs(t.id)()*(e/6));const o=ew({strokeWidth:i,showAsComplete:s});return{strokePoints:wi(r,o),sw:i}}function Ba(t){return Rc[t.props.size]*1.12*t.props.scale}function B0(t){return t.props.segments.length===1&&t.props.segments[0].points.length<2}function U0({strokeWidth:t,forceSolid:e,shape:n,opacity:r}){var p;const s=Cs(),i=Nc(n.props.segments);let o=t;!e&&!n.props.isPen&&i.length===1&&(o+=Hs(n.id)()*(o/6));const a=ew({strokeWidth:o,showAsComplete:n.props.isComplete||((p=xn(n.props.segments))==null?void 0:p.type)==="straight"}),l=wi(i,a),c=l.length>1?dl(l,!1):bte(n.props.segments[0].points[0]),u=wte(),h=s[n.props.color].highlight[u];return d.jsx("path",{d:c,strokeLinecap:"round",fill:"none",pointerEvents:"all",stroke:h,strokeWidth:o,opacity:r})}function Iy(t,e){return J("forceSolid",()=>{const n=Ba(e),r=t.getZoomLevel();return n/r<1.5},[t])}function ET(){return d.jsxs("svg",{width:"15",height:"15",viewBox:"0 0 30 30",xmlns:"http://www.w3.org/2000/svg",fill:"none",stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",children:[d.jsx("path",{d:"M3,11 L3,3 11,3",strokeWidth:"2"}),d.jsx("path",{d:"M19,27 L27,27 L27,19",strokeWidth:"2"}),d.jsx("path",{d:"M27,3 L3,27",strokeWidth:"2"})]})}function TT(t,e,n){const r=G(),[s,i]=C.useState(null),o=e?r.getAsset(e):null,l=r.getCulledShapes().has(t),c=C.useRef(!1);C.useEffect(()=>{s&&(c.current=!0)},[s]);const u=o&&"w"in o.props?n/o.props.w:1,h=J("zoom level",()=>r.getZoomLevel()*u,[r,u]);return C.useEffect(()=>{if(l)return;let p=!1;const f=r.timers.setTimeout(async()=>{const v=await r.resolveAssetUrl(e,{screenScale:h});p||i(v)},c.current?500:0);return()=>{clearTimeout(f),p=!0}},[e,o==null?void 0:o.props.src,l,h,r]),{asset:o,url:s}}function MT(){const[t,e]=C.useState(!1);return C.useEffect(()=>{if(typeof window>"u"||!("matchMedia"in window))return;const n=window.matchMedia("(prefers-reduced-motion: reduce)"),r=()=>{e(n.matches)};return r(),n.addEventListener("change",r),()=>n.removeEventListener("change",r)},[]),t}async function Pte(t){const n=await(await yi(t)).blob();return Za.blobToDataUrl(n)}class Qp extends tu{constructor(){super(...arguments);g(this,"isAspectRatioLocked",()=>!0);g(this,"canCrop",()=>!0);g(this,"onResize",(n,r)=>{let s=fm(n,r);const{flipX:i,flipY:o}=r.initialShape.props;return s={...s,props:{...s.props,flipX:r.scaleX<0!==i,flipY:r.scaleY<0!==o}},s});g(this,"onDoubleClick",n=>{const r=n.props.assetId?this.editor.getAsset(n.props.assetId):void 0;!r||!(r.props.src&&this.isAnimated(n))||this.editor.updateShapes([{type:"image",id:n.id,props:{playing:!n.props.playing}}])});g(this,"onDoubleClickEdge",n=>{const r=n.props;if(!r||this.editor.getCroppingShapeId()!==n.id)return;const s=yt(r.crop)||{topLeft:{x:0,y:0},bottomRight:{x:1,y:1}},i=1/(s.bottomRight.x-s.topLeft.x)*n.props.w,o=1/(s.bottomRight.y-s.topLeft.y)*n.props.h,a=new b(s.topLeft.x*i,s.topLeft.y*o).rot(n.rotation),l={id:n.id,type:n.type,x:n.x-a.x,y:n.y-a.y,props:{crop:{topLeft:{x:0,y:0},bottomRight:{x:1,y:1}},w:i,h:o}};this.editor.updateShapes([l])})}getDefaultProps(){return{w:100,h:100,assetId:null,playing:!0,url:"",crop:null,flipX:!1,flipY:!1}}isAnimated(n){const r=n.props.assetId?this.editor.getAsset(n.props.assetId):void 0;return r?"mimeType"in r.props&&oi.isAnimatedImageType(r==null?void 0:r.props.mimeType)||"isAnimated"in r.props&&r.props.isAnimated:!1}component(n){var m;const r=this.editor.getCroppingShapeId()===n.id,s=MT(),[i,o]=C.useState(""),[a,l]=C.useState(""),c=n.id===this.editor.getOnlySelectedShapeId(),{asset:u,url:h}=TT(n.id,n.props.assetId,n.props.w);if(C.useEffect(()=>{if(h){let x=!1;const y=Ac();return y.onload=()=>{x||l(h)},y.src=h,()=>{x=!0}}},[h,n]),C.useEffect(()=>{if(h&&this.isAnimated(n)){let x=!1;const y=Ac();return y.onload=()=>{if(x)return;const S=document.createElement("canvas");S.width=y.width,S.height=y.height;const w=S.getContext("2d");w&&(w.drawImage(y,0,0),o(S.toDataURL()),l(h))},y.crossOrigin="anonymous",y.src=h,()=>{x=!0}}},[s,h,n]),(u==null?void 0:u.type)==="bookmark")throw Error("Bookmark assets can't be rendered as images");const p=c&&r&&this.editor.isIn("select.crop"),f=s&&(((m=u==null?void 0:u.props.mimeType)==null?void 0:m.includes("video"))||this.isAnimated(n)),v=O7(n);return u!=null&&u.props.src?a?d.jsxs(d.Fragment,{children:[p&&d.jsx("div",{style:v,children:d.jsx("img",{className:"tl-image",crossOrigin:this.isAnimated(n)?"anonymous":void 0,src:!n.props.playing||f?i:a,referrerPolicy:"strict-origin-when-cross-origin",style:{opacity:.1},draggable:!1})}),d.jsxs(aa,{id:n.id,style:{overflow:"hidden",width:n.props.w,height:n.props.h},children:[d.jsxs("div",{className:"tl-image-container",style:v,children:[d.jsx("img",{className:be("tl-image",{"tl-flip-x":n.props.flipX&&!n.props.flipY,"tl-flip-y":n.props.flipY&&!n.props.flipX,"tl-flip-xy":n.props.flipY&&n.props.flipX}),crossOrigin:this.isAnimated(n)?"anonymous":void 0,src:!n.props.playing||f?i:a,referrerPolicy:"strict-origin-when-cross-origin",draggable:!1}),this.isAnimated(n)&&!n.props.playing&&d.jsx("div",{className:"tl-image__tg",children:"GIF"})]}),n.props.url&&d.jsx(Lc,{url:n.props.url,zoomLevel:this.editor.getZoomLevel()})]})]}):null:d.jsxs(aa,{id:n.id,style:{overflow:"hidden",width:n.props.w,height:n.props.h,color:"var(--color-text-3)",backgroundColor:u?"transparent":"var(--color-low)",border:u?"none":"1px solid var(--color-low-border)"},children:[d.jsx("div",{className:"tl-image-container",style:v,children:u?null:d.jsx(ET,{})}),"url"in n.props&&n.props.url&&d.jsx(Lc,{url:n.props.url,zoomLevel:this.editor.getZoomLevel()})]})}indicator(n){return this.editor.getCroppingShapeId()===n.id?null:d.jsx("rect",{width:K(n.props.w),height:K(n.props.h)})}async toSvg(n){if(!n.props.assetId||!this.editor.getAsset(n.props.assetId))return null;let s=await this.editor.resolveAssetUrl(n.props.assetId,{shouldResolveToOriginal:!0});if(!s)return null;(s.startsWith("blob:")||s.startsWith("http")||s.startsWith("/")||s.startsWith("./"))&&(s=await Pte(s)||"");const i=O7(n),o=n.props.crop;if(i.transform&&o){const{transform:a,width:l,height:c}=i,u=(o.bottomRight.x-o.topLeft.x)*l,h=(o.bottomRight.y-o.topLeft.y)*c,p=[new b(0,0),new b(u,0),new b(u,h),new b(0,h)],f=`cropClipPath_${n.id.replace(":","_")}`;return d.jsxs(d.Fragment,{children:[d.jsx("defs",{children:d.jsx("clipPath",{id:f,children:d.jsx("polygon",{points:p.map(v=>`${v.x},${v.y}`).join(" ")})})}),d.jsx("g",{clipPath:`url(#${f})`,children:d.jsx("image",{href:s,width:l,height:c,style:{transform:a}})})]})}else return d.jsx("image",{href:s,width:n.props.w,height:n.props.h})}}g(Qp,"type","image"),g(Qp,"props",RI),g(Qp,"migrations",OI);function O7(t){const e=t.props.crop,n=e==null?void 0:e.topLeft;if(!n)return{width:t.props.w,height:t.props.h};const r=1/(e.bottomRight.x-e.topLeft.x)*t.props.w,s=1/(e.bottomRight.y-e.topLeft.y)*t.props.h,i=-n.x*r,o=-n.y*s;return{transform:`translate(${i}px, ${o}px)`,width:r,height:s}}function _T(t){return{size:t,thinning:.4,streamline:0,smoothing:.5,simulatePressure:!0,last:!0}}function AT(t,e,n){const r=e.vertices,s=_T(n);return wi(r,s)}function kte(t,e,n){const r=_T(n);return V4(mm(AT(t,e,n),r),r)}function Ite(t,e,n){const r=kte(t,e,n);return _4(r)}function Ete(t,e,n){if(t.props.dash==="draw"){const r=AT(t,e,n);return dl(r)}return e.getSvgPathData()}function DT(t,e,n){let r=`M ${Xe(e[0])}L`,s=`M ${Xe(e[0])}L`;const i=n/3,o=n*2,a=Hs(t);let l=e[0],c,u=e[0],h;const p=e.length;for(let f=0,v=p-1;f<v;f++){c=e[f+1],h=b.AddXY(e[f+1],a()*i,a()*i);const m=b.Sub(c,l),x=b.Len(m),y=b.Div(m,x).mul(Math.min(x/4,o)),S=b.Add(l,y),w=b.Add(c,y.neg()),P=b.Sub(h,u),E=b.Len(P),M=b.Div(P,E).mul(Math.min(E/4,o)),I=b.Add(u,M),_=b.Add(h,M.neg());f===v-1?(r+=`${Xe(S)}L ${Xe(c)}`,s+=`${Xe(I)}L ${Xe(h)}`):(r+=`${Xe(S)}L ${Xe(w)}Q ${Xe(c)}`,s+=`${Xe(I)}L ${Xe(_)}Q ${Xe(h)}`,l=c,u=h)}return[r,r+s]}const Tte=new so;class Jp extends fs{constructor(){super(...arguments);g(this,"hideResizeHandles",()=>!0);g(this,"hideRotateHandle",()=>!0);g(this,"hideSelectionBoundsFg",()=>!0);g(this,"hideSelectionBoundsBg",()=>!0);g(this,"onResize",(n,r)=>{const{scaleX:s,scaleY:i}=r;return{props:{points:bh(n.props.points,(o,{id:a,index:l,x:c,y:u})=>({id:a,index:l,x:c*s,y:u*i}))}}});g(this,"onHandleDrag",(n,{handle:r})=>{if(r.type==="vertex")return{...n,props:{...n.props,points:{...n.props.points,[r.id]:{id:r.id,index:r.index,x:r.x,y:r.y}}}}})}getDefaultProps(){const[n,r]=Vd(2);return{dash:"draw",size:"m",color:"black",spline:"line",points:{[n]:{id:n,index:n,x:0,y:0},[r]:{id:r,index:r,x:.1,y:.1}},scale:1}}getGeometry(n){return Zu(n)}getHandles(n){return Tte.get(n.props,()=>{const r=Zu(n),s=Xu(n),i=s.map(o=>({...o,id:o.index,type:"vertex",canSnap:!0}));for(let o=0;o<s.length-1;o++){const a=Gd(s[o].index,s[o+1].index),c=r.segments[o].midPoint();i.push({id:a,type:"create",index:a,x:c.x,y:c.y,canSnap:!0})}return i.sort(Un)})}component(n){return d.jsx(oa,{id:n.id,children:d.jsx(L7,{shape:n})})}indicator(n){const r=hn[n.props.size]*n.props.scale,s=Zu(n),{dash:i}=n.props;let o;if(n.props.spline==="line"){const a=s.points;if(i==="solid"||i==="dotted"||i==="dashed")o="M"+a[0]+"L"+a.slice(1);else{const[l]=DT(n.id,a,r);o=l}}else o=Ete(n,s,r);return d.jsx("path",{d:o})}toSvg(n){return d.jsx(L7,{shouldScale:!0,shape:n})}getHandleSnapGeometry(n){const r=Xu(n);return{points:r,getSelfSnapPoints:s=>{const i=this.getHandles(n).filter(o=>o.type==="vertex").findIndex(o=>o.id===s.id);return r.filter((o,a)=>Math.abs(a-i)>1).map(b.From)},getSelfSnapOutline:s=>{const i=this.getHandles(n).filter(a=>a.type==="vertex").findIndex(a=>a.id===s.id),o=Zu(n).segments.filter((a,l)=>l!==i-1&&l!==i);return o.length?new $s({children:o}):null}}}getInterpolatedProps(n,r,s){const i=Xu(n),o=Xu(r),a=[],l=[];let c=Kk;if(i.length>o.length)for(let u=0;u<i.length;u++)a[u]={...i[u]},o[u]===void 0?l[u]={...o[o.length-1],id:c}:l[u]={...o[u],id:c},c=js(c);else if(o.length>i.length)for(let u=0;u<o.length;u++)l[u]={...o[u]},i[u]===void 0?a[u]={...i[i.length-1],id:c}:a[u]={...i[u],id:c},c=js(c);else for(let u=0;u<o.length;u++)a[u]=i[u],l[u]=o[u];return{...r.props,points:Object.fromEntries(a.map((u,h)=>{const p=l[h];return[u.id,{...u,x:mr(u.x,p.x,s),y:mr(u.y,p.y,s)}]}))}}}g(Jp,"type","line"),g(Jp,"props",LI),g(Jp,"migrations",NI);function Xu(t){return Object.values(t.props.points).sort(Un)}function Zu(t){const e=Xu(t).map(b.From);switch(t.props.spline){case"cubic":return new ZQ({points:e});case"line":return new eu({points:e})}}function L7({shape:t,shouldScale:e=!1}){const n=Cs(),r=Zu(t),{dash:s,color:i,size:o}=t.props,a=1/t.props.scale,l=e?a:1,c=hn[o]*t.props.scale;if(t.props.spline==="line"){if(s==="solid"){const u=r.points,h="M"+u[0]+"L"+u.slice(1);return d.jsx("path",{d:h,stroke:n[i].solid,strokeWidth:c,fill:"none",transform:`scale(${l})`})}if(s==="dashed"||s==="dotted")return d.jsx("g",{stroke:n[i].solid,strokeWidth:c,transform:`scale(${l})`,children:r.segments.map((u,h)=>{const{strokeDasharray:p,strokeDashoffset:f}=ti(u.length,c,{style:s,start:h>0?"outset":"none",end:h<r.segments.length-1?"outset":"none"});return d.jsx("path",{strokeDasharray:p,strokeDashoffset:f,d:u.getSvgPathData(!0),fill:"none"},h)})});if(s==="draw"){const u=r.points,[h,p]=DT(t.id,u,c);return d.jsx("path",{d:p,stroke:n[i].solid,strokeWidth:c,fill:"none",transform:`scale(${l})`})}}if(t.props.spline==="cubic"){const u=r.getSvgPathData();if(s==="solid")return d.jsx("path",{strokeWidth:c,stroke:n[i].solid,fill:"none",d:u,transform:`scale(${l})`});if(s==="dashed"||s==="dotted")return d.jsx("g",{stroke:n[i].solid,strokeWidth:c,transform:`scale(${l})`,children:r.segments.map((h,p)=>{const{strokeDasharray:f,strokeDashoffset:v}=ti(h.length,c,{style:s,start:p>0?"outset":"none",end:p<r.segments.length-1?"outset":"none"});return d.jsx("path",{strokeDasharray:f,strokeDashoffset:v,d:h.getSvgPathData(),fill:"none"},p)})});if(s==="draw")return d.jsx("path",{d:Ite(t,r,c),strokeWidth:1,stroke:n[i].solid,fill:n[i].solid,transform:`scale(${l})`})}}const jT=C.createContext(null);function Mte({assetUrls:t,children:e}){return C.useEffect(()=>{for(const n of Object.values(t.icons)){const r=Ac();r.src=n,r.decode()}for(const n of Object.values(t.embedIcons)){const r=Ac();r.src=n,r.decode()}},[t]),d.jsx(jT.Provider,{value:t,children:e})}function nw(){const t=C.useContext(jT);if(!t)throw new Error("useAssetUrls must be used within an AssetUrlsProvider");return t}const cS={"action.convert-to-bookmark":"Convert to Bookmark","action.convert-to-embed":"Convert to Embed","action.open-embed-link":"Open link","action.align-bottom":"Align bottom","action.align-center-horizontal":"Align horizontally","action.align-center-vertical":"Align vertically","action.align-center-horizontal.short":"Align H","action.align-center-vertical.short":"Align V","action.align-left":"Align left","action.align-right":"Align right","action.align-top":"Align top","action.back-to-content":"Back to content","action.bring-forward":"Bring forward","action.bring-to-front":"Bring to front","action.copy-as-json.short":"JSON","action.copy-as-json":"Copy as JSON","action.copy-as-png.short":"PNG","action.copy-as-png":"Copy as PNG","action.copy-as-svg.short":"SVG","action.copy-as-svg":"Copy as SVG","action.copy":"Copy","action.cut":"Cut","action.delete":"Delete","action.unlock-all":"Unlock all","action.distribute-horizontal":"Distribute horizontally","action.distribute-vertical":"Distribute vertically","action.distribute-horizontal.short":"Distribute H","action.distribute-vertical.short":"Distribute V","action.duplicate":"Duplicate","action.edit-link":"Edit link","action.exit-pen-mode":"Exit pen mode","action.export-as-json.short":"JSON","action.export-as-json":"Export as JSON","action.export-as-png.short":"PNG","action.export-as-png":"Export as PNG","action.export-as-svg.short":"SVG","action.export-as-svg":"Export as SVG","action.export-all-as-json.short":"JSON","action.export-all-as-json":"Export as JSON","action.export-all-as-png.short":"PNG","action.export-all-as-png":"Export as PNG","action.export-all-as-svg.short":"SVG","action.export-all-as-svg":"Export as SVG","action.fit-frame-to-content":"Fit to content","action.flip-horizontal":"Flip horizontally","action.flip-vertical":"Flip vertically","action.flip-horizontal.short":"Flip H","action.flip-vertical.short":"Flip V","action.fork-project":"Fork this project","action.fork-project-on-tldraw":"Fork project on tldraw","action.group":"Group","action.insert-embed":"Insert embed","action.insert-media":"Upload media","action.leave-shared-project":"Leave shared project","action.new-project":"New project","action.new-shared-project":"New shared project","action.open-cursor-chat":"Cursor chat","action.open-file":"Open file","action.pack":"Pack","action.paste":"Paste","action.paste-error-title":"Pasting failed","action.paste-error-description":"Could not paste due to missing clipboard permissions. Please enable the permissions and try again.","action.print":"Print","action.redo":"Redo","action.remove-frame":"Remove frame","action.rename":"Rename","action.rotate-ccw":"Rotate counterclockwise","action.rotate-cw":"Rotate clockwise","action.save-copy":"Save a copy","action.select-all":"Select all","action.select-none":"Select none","action.send-backward":"Send backward","action.send-to-back":"Send to back","action.share-project":"Share this project","action.stack-horizontal":"Stack horizontally","action.stack-vertical":"Stack vertically","action.stack-horizontal.short":"Stack H","action.stack-vertical.short":"Stack V","action.stop-following":"Stop following","action.stretch-horizontal":"Stretch horizontally","action.stretch-vertical":"Stretch vertically","action.stretch-horizontal.short":"Stretch H","action.stretch-vertical.short":"Stretch V","action.toggle-auto-size":"Toggle auto size","action.toggle-dark-mode.menu":"Dark mode","action.toggle-dark-mode":"Toggle dark mode","action.toggle-paste-at-cursor.menu":"Paste at cursor","action.toggle-paste-at-cursor":"Toggle paste at cursor","action.toggle-wrap-mode.menu":"Select on wrap","action.toggle-wrap-mode":"Toggle Select on wrap","action.toggle-reduce-motion.menu":"Reduce motion","action.toggle-reduce-motion":"Toggle reduce motion","action.toggle-edge-scrolling.menu":"Edge scrolling","action.toggle-edge-scrolling":"Toggle edge scrolling","action.toggle-debug-mode.menu":"Debug mode","action.toggle-debug-mode":"Toggle debug mode","action.toggle-focus-mode.menu":"Focus mode","action.toggle-focus-mode":"Toggle focus mode","action.toggle-dynamic-size-mode.menu":"Dynamic size","action.toggle-dynamic-size-mode":"Toggle dynamic size","action.toggle-grid.menu":"Show grid","action.toggle-grid":"Toggle grid","action.toggle-lock":"Toggle locked","action.flatten-to-image":"Flatten","action.toggle-snap-mode.menu":"Always snap","action.toggle-snap-mode":"Toggle always snap","action.toggle-tool-lock.menu":"Tool lock","action.toggle-tool-lock":"Toggle tool lock","action.toggle-transparent.context-menu":"Transparent","action.toggle-transparent.menu":"Transparent","action.toggle-transparent":"Toggle transparent background","action.undo":"Undo","action.ungroup":"Ungroup","action.zoom-in":"Zoom in","action.zoom-out":"Zoom out","action.zoom-to-100":"Zoom to 100%","action.zoom-to-fit":"Zoom to fit","action.zoom-to-selection":"Zoom to selection","assets.files.size-too-big":"File size is too big","assets.files.type-not-allowed":"File type is not allowed","assets.files.upload-failed":"Upload failed","assets.url.failed":"Couldn't load URL preview","theme.dark":"Dark","theme.light":"Light","theme.system":"System","color-style.white":"White","color-style.black":"Black","color-style.blue":"Blue","color-style.green":"Green","color-style.grey":"Grey","color-style.light-blue":"Light blue","color-style.light-green":"Light green","color-style.light-red":"Light red","color-style.light-violet":"Light violet","color-style.orange":"Orange","color-style.red":"Red","color-style.violet":"Violet","color-style.yellow":"Yellow","fill-style.none":"None","document.default-name":"Untitled","fill-style.semi":"Semi","fill-style.solid":"Solid","fill-style.pattern":"Pattern","fill-style.fill":"Fill","dash-style.dashed":"Dashed","dash-style.dotted":"Dotted","dash-style.draw":"Draw","dash-style.solid":"Solid","size-style.s":"Small","size-style.m":"Medium","size-style.l":"Large","size-style.xl":"Extra large","opacity-style.0.1":"10%","opacity-style.0.25":"25%","opacity-style.0.5":"50%","opacity-style.0.75":"75%","opacity-style.1":"100%","font-style.draw":"Draw","font-style.sans":"Sans","font-style.serif":"Serif","font-style.mono":"Mono","align-style.start":"Start","align-style.middle":"Middle","align-style.end":"End","align-style.justify":"Justify","verticalAlign-style.start":"Top","verticalAlign-style.middle":"Middle","verticalAlign-style.end":"Bottom","geo-style.arrow-down":"Arrow down","geo-style.arrow-left":"Arrow left","geo-style.arrow-right":"Arrow right","geo-style.arrow-up":"Arrow up","geo-style.diamond":"Diamond","geo-style.ellipse":"Ellipse","geo-style.hexagon":"Hexagon","geo-style.octagon":"Octagon","geo-style.oval":"Oval","geo-style.cloud":"Cloud","geo-style.pentagon":"Pentagon","geo-style.rectangle":"Rectangle","geo-style.rhombus-2":"Rhombus 2","geo-style.rhombus":"Rhombus","geo-style.star":"Star","geo-style.trapezoid":"Trapezoid","geo-style.triangle":"Triangle","geo-style.x-box":"X box","geo-style.check-box":"Check box","arrowheadStart-style.none":"None","arrowheadStart-style.arrow":"Arrow","arrowheadStart-style.bar":"Bar","arrowheadStart-style.diamond":"Diamond","arrowheadStart-style.dot":"Dot","arrowheadStart-style.inverted":"Inverted","arrowheadStart-style.pipe":"Pipe","arrowheadStart-style.square":"Square","arrowheadStart-style.triangle":"Triangle","arrowheadEnd-style.none":"None","arrowheadEnd-style.arrow":"Arrow","arrowheadEnd-style.bar":"Bar","arrowheadEnd-style.diamond":"Diamond","arrowheadEnd-style.dot":"Dot","arrowheadEnd-style.inverted":"Inverted","arrowheadEnd-style.pipe":"Pipe","arrowheadEnd-style.square":"Square","arrowheadEnd-style.triangle":"Triangle","spline-style.line":"Line","spline-style.cubic":"Cubic","tool.select":"Select","tool.hand":"Hand","tool.draw":"Draw","tool.eraser":"Eraser","tool.arrow-down":"Arrow down","tool.arrow-left":"Arrow left","tool.arrow-right":"Arrow right","tool.arrow-up":"Arrow up","tool.arrow":"Arrow","tool.cloud":"Cloud","tool.diamond":"Diamond","tool.ellipse":"Ellipse","tool.hexagon":"Hexagon","tool.highlight":"Highlight","tool.line":"Line","tool.octagon":"Octagon","tool.oval":"Oval","tool.pentagon":"Pentagon","tool.rectangle":"Rectangle","tool.rhombus":"Rhombus","tool.star":"Star","tool.trapezoid":"Trapezoid","tool.triangle":"Triangle","tool.x-box":"X box","tool.check-box":"Check box","tool.asset":"Asset","tool.frame":"Frame","tool.note":"Note","tool.laser":"Laser","tool.embed":"Embed","tool.text":"Text","menu.title":"Menu","menu.theme":"Theme","menu.copy-as":"Copy as","menu.edit":"Edit","menu.export-as":"Export as","menu.file":"File","menu.language":"Language","menu.preferences":"Preferences","menu.help":"Help","menu.view":"View","context-menu.edit":"Edit","context-menu.arrange":"Arrange","context-menu.copy-as":"Copy as","context-menu.export-as":"Export as","context-menu.export-all-as":"Export","context-menu.move-to-page":"Move to page","context-menu.reorder":"Reorder","page-menu.title":"Pages","page-menu.create-new-page":"Create new page","page-menu.max-page-count-reached":"Max pages reached","page-menu.new-page-initial-name":"Page 1","page-menu.edit-start":"Edit","page-menu.edit-done":"Done","page-menu.go-to-page":"Go to page","page-menu.submenu.rename":"Rename","page-menu.submenu.duplicate-page":"Duplicate","page-menu.submenu.title":"Menu","page-menu.submenu.move-down":"Move down","page-menu.submenu.move-up":"Move up","page-menu.submenu.delete":"Delete","share-menu.title":"Share","share-menu.save-note":"Download this project to your computer as a .tldr file.","share-menu.fork-note":"Create a new shared project based on this snapshot.","share-menu.share-project":"Share this project","share-menu.default-project-name":"Shared Project","share-menu.copy-link":"Copy editor link","share-menu.readonly-link":"Read-only","share-menu.create-snapshot-link":"Copy snapshot link","share-menu.snapshot-link-note":"Capture and share this project as a read-only snapshot link.","share-menu.copy-readonly-link":"Copy viewer link","share-menu.offline-note":"Create a new shared project based on your current project.","share-menu.copy-link-note":"Anyone with the link will be able to view and edit this project.","share-menu.copy-readonly-link-note":"Anyone with the link will be able to access this project.","share-menu.project-too-large":"Sorry, this project can't be shared because it's too large. We're working on it!","share-menu.upload-failed":"Sorry, we couldn't upload your project at the moment. Please try again or let us know if the problem persists.","share-menu.creating-project":"Creating the new project…","share-menu.copied":"Copied link","status.offline":"Offline","status.online":"Online","people-menu.title":"People","people-menu.change-name":"Change name","people-menu.change-color":"Change color","people-menu.follow":"Following","people-menu.following":"Following","people-menu.leading":"Following You","people-menu.user":"(You)","people-menu.invite":"Invite others","help-menu.title":"Help and resources","help-menu.about":"About","help-menu.docs":"Documentation & API","help-menu.discord":"Discord","help-menu.github":"GitHub","help-menu.keyboard-shortcuts":"Keyboard shortcuts","help-menu.twitter":"Twitter","actions-menu.title":"Actions","edit-link-dialog.title":"Edit link","edit-link-dialog.invalid-url":"A link must be a valid URL.","edit-link-dialog.detail":"Links will open in a new tab.","edit-link-dialog.url":"URL","edit-link-dialog.clear":"Clear","edit-link-dialog.save":"Continue","edit-link-dialog.cancel":"Cancel","embed-dialog.title":"Insert embed","embed-dialog.back":"Back","embed-dialog.create":"Create","embed-dialog.cancel":"Cancel","embed-dialog.url":"URL","embed-dialog.instruction":"Paste in the site's URL to create the embed.","embed-dialog.invalid-url":"We could not create an embed from that URL.","edit-pages-dialog.move-down":"Move down","edit-pages-dialog.move-up":"Move up","shortcuts-dialog.title":"Keyboard shortcuts","shortcuts-dialog.edit":"Edit","shortcuts-dialog.file":"File","shortcuts-dialog.preferences":"Preferences","shortcuts-dialog.tools":"Tools","shortcuts-dialog.transform":"Transform","shortcuts-dialog.view":"View","shortcuts-dialog.collaboration":"Collaboration","home-project-dialog.title":"Home project","home-project-dialog.description":"This is your local home project. It's just for you!","rename-project-dialog.title":"Rename project","rename-project-dialog.cancel":"Cancel","rename-project-dialog.rename":"Rename","home-project-dialog.ok":"Ok","style-panel.title":"Styles","style-panel.align":"Align","style-panel.vertical-align":"Vertical align","style-panel.position":"Position","style-panel.arrowheads":"Arrows","style-panel.arrowhead-start":"Start","style-panel.arrowhead-end":"End","style-panel.color":"Color","style-panel.dash":"Dash","style-panel.fill":"Fill","style-panel.font":"Font","style-panel.geo":"Shape","style-panel.mixed":"Mixed","style-panel.opacity":"Opacity","style-panel.size":"Size","style-panel.spline":"Spline","tool-panel.drawing":"Drawing","tool-panel.shapes":"Shapes","tool-panel.more":"More","debug-panel.more":"More","navigation-zone.toggle-minimap":"Toggle minimap","navigation-zone.zoom":"Zoom","focus-mode.toggle-focus-mode":"Toggle focus mode","toast.close":"Close","file-system.file-open-error.title":"Could not open file","file-system.file-open-error.not-a-tldraw-file":"The file you tried to open doesn't look like a tldraw file.","file-system.file-open-error.file-format-version-too-new":"The file you tried to open is from a newer version of tldraw. Please reload the page and try again.","file-system.file-open-error.generic-corrupted-file":"The file you tried to open is corrupted.","file-system.confirm-open.title":"Overwrite current project?","file-system.confirm-open.description":"Opening a file will replace your current project and any unsaved changes will be lost. Are you sure you want to continue?","file-system.confirm-open.cancel":"Cancel","file-system.confirm-open.open":"Open file","file-system.confirm-open.dont-show-again":"Don't ask again","file-system.confirm-clear.title":"Clear current project?","file-system.confirm-clear.description":"Creating a new project will clear your current project and any unsaved changes will be lost. Are you sure you want to continue?","file-system.confirm-clear.cancel":"Cancel","file-system.confirm-clear.continue":"Continue","file-system.confirm-clear.dont-show-again":"Don't ask again","file-system.shared-document-file-open-error.title":"Could not open file","file-system.shared-document-file-open-error.description":"Opening files from shared projects is not supported.","sharing.confirm-leave.title":"Leave current project?","sharing.confirm-leave.description":"Are you sure you want to leave this shared project? You can return to it by navigating to its URL.","sharing.confirm-leave.cancel":"Cancel","sharing.confirm-leave.leave":"Leave","sharing.confirm-leave.dont-show-again":"Don't ask again","toast.error.export-fail.title":"Failed export","toast.error.export-fail.desc":"Failed to export image","toast.error.copy-fail.title":"Failed copy","toast.error.copy-fail.desc":"Failed to copy image","context.pages.new-page":"New page","vscode.file-open.desc":"We've updated this document to work with the current version of tldraw. If you'd like to keep the original version (which will work on old.tldraw.com), click below to create a backup.","vscode.file-open.open":"Continue","vscode.file-open.backup":"Backup","vscode.file-open.backup-saved":"Backup saved","vscode.file-open.backup-failed":"Backup failed: this is not a .tldr file.","vscode.file-open.dont-show-again":"Don't ask again","cursor-chat.type-to-chat":"Type to chat..."},_te=new Set(["ar","fa","he","ur","ku"]),Ol={locale:"en",label:"English",messages:cS,dir:"ltr"};async function Ate(t,e){if(!(await yi(e.translations.en)).ok)return console.warn("No main translations found."),Ol;if(t==="en")return Ol;const r=Zd.find(a=>a.locale===t);if(!r)return console.warn(`No translation found for locale ${t}`),Ol;const i=await(await yi(e.translations[r.locale])).json();if(!i)return console.warn(`No messages found for locale ${t}`),Ol;const o=[];for(const a in Ol.messages)i[a]||o.push(a);return o.length>0,{locale:t,label:r.label,dir:_te.has(r.locale)?"rtl":"ltr",messages:{...Ol.messages,...i}}}const RT=C.createContext(null);function OT(){const t=C.useContext(RT);if(!t)throw new Error("useCurrentTranslation must be used inside of <TldrawUiContextProvider />");return t}const Dte=gn(function({overrides:e,children:n}){const s=G().user.getLocale(),i=nw(),[o,a]=C.useState(()=>e&&e.en?{locale:"en",label:"English",dir:"ltr",messages:{...cS,...e.en}}:{locale:"en",label:"English",dir:"ltr",messages:cS});return C.useEffect(()=>{let l=!1;async function c(){const u=await Ate(s,i);u&&!l&&(e&&e[s]?a({...u,messages:{...u.messages,...e[s]}}):a(u))}return c(),()=>{l=!0}},[i,s,e]),d.jsx(RT.Provider,{value:o,children:n})});function Be(){const t=OT();return C.useCallback(function(n){return t.messages[n]??n},[t])}class ef extends fs{constructor(){super(...arguments);g(this,"canEdit",()=>!0);g(this,"hideResizeHandles",()=>!0);g(this,"hideSelectionBoundsFg",()=>!1);g(this,"onBeforeCreate",n=>N7(this.editor,n));g(this,"onBeforeUpdate",(n,r)=>{if(!(n.props.text===r.props.text&&n.props.font===r.props.font&&n.props.size===r.props.size))return N7(this.editor,r)});g(this,"onEditEnd",n=>{const{id:r,type:s,props:{text:i}}=n;i.trimEnd()!==n.props.text&&this.editor.updateShapes([{id:r,type:s,props:{text:i.trimEnd()}}])})}getDefaultProps(){return{color:"black",size:"m",text:"",font:"draw",align:"middle",verticalAlign:"middle",growY:0,fontSizeAdjustment:0,url:"",scale:1}}getGeometry(n){const{labelHeight:r,labelWidth:s}=LT(this.editor,n),{scale:i}=n.props,o=r*i,a=s*i,l=ut*i,c=H0(n);return new $s({children:[new xi({width:l,height:c,isFilled:!0}),new xi({x:n.props.align==="start"?0:n.props.align==="end"?l-a:(l-a)/2,y:n.props.verticalAlign==="start"?0:n.props.verticalAlign==="end"?c-o:(c-o)/2,width:a,height:o,isFilled:!0,isLabel:!0})]})}getHandles(n){const{scale:r}=n.props;if(this.editor.getInstanceState().isCoarsePointer)return[];const i=this.editor.getZoomLevel();if(i*r<.25)return[];const o=H0(n),a=ut*r,l=iee/i*r;return i*r<.5?[{id:"bottom",index:"a3",type:"clone",x:a/2,y:o+l}]:[{id:"top",index:"a1",type:"clone",x:a/2,y:-l},{id:"right",index:"a2",type:"clone",x:a+l,y:o/2},{id:"bottom",index:"a3",type:"clone",x:a/2,y:o+l},{id:"left",index:"a4",type:"clone",x:-l,y:o/2}]}component(n){const{id:r,type:s,props:{scale:i,color:o,font:a,size:l,align:c,text:u,verticalAlign:h,fontSizeAdjustment:p}}=n,f=Ote(r),v=Cs(),m=ut*i,x=H0(n),y=J("shape rotation",()=>{var P;return((P=this.editor.getShapePageTransform(r))==null?void 0:P.rotation())??0},[this.editor]),S=J("zoom",()=>this.editor.getZoomLevel()<.35/i,[i,this.editor]),w=n.id===this.editor.getOnlySelectedShapeId();return d.jsxs(d.Fragment,{children:[d.jsx("div",{id:r,className:"tl-note__container",style:{width:m,height:x,backgroundColor:v[o].note.fill,borderBottom:S?`${3*i}px solid rgb(15, 23, 31, .2)`:"none",boxShadow:S?"none":Lte(n.id,y,i)},children:d.jsx(xm,{id:r,type:s,font:a,fontSize:(p||Xi[l])*i,lineHeight:En.lineHeight,align:c,verticalAlign:h,text:u,isNote:!0,isSelected:w,labelColor:v[o].note.text,wrap:!0,padding:16*i,onKeyDown:f})}),"url"in n.props&&n.props.url&&d.jsx(Lc,{url:n.props.url,zoomLevel:this.editor.getZoomLevel()})]})}indicator(n){const{scale:r}=n.props;return d.jsx("rect",{rx:r,width:K(ut*r),height:K(H0(n))})}toSvg(n,r){n.props.text&&r.addExportDef(vm(n.props.font));const s=go({isDarkMode:r.isDarkMode}),i=Nte(n);return d.jsxs(d.Fragment,{children:[d.jsx("rect",{x:5,y:5,rx:1,width:ut-10,height:i.h,fill:"rgba(0,0,0,.1)"}),d.jsx("rect",{rx:1,width:ut,height:i.h,fill:s[n.props.color].note.fill}),d.jsx(Sm,{fontSize:n.props.fontSizeAdjustment||Xi[n.props.size],font:n.props.font,align:n.props.align,verticalAlign:n.props.verticalAlign,text:n.props.text,labelColor:s[n.props.color].note.text,bounds:i,stroke:!1})]})}}g(ef,"type","note"),g(ef,"props",zI),g(ef,"migrations",FI);function N7(t,e){const{labelHeight:n,fontSizeAdjustment:r}=LT(t,e),s=Math.max(0,n-ut);if(s!==e.props.growY||r!==e.props.fontSizeAdjustment)return{...e,props:{...e.props,growY:s,fontSizeAdjustment:r}}}function jte(t,e){const{text:n}=e.props;if(!n)return{labelHeight:Xi[e.props.size]*En.lineHeight+ss*2,labelWidth:100,fontSizeAdjustment:0};const r=Xi[e.props.size];let s=0,i=0,o=ut,a=ut;const l=1;do{s=Math.min(r,r-i);const c=t.textMeasure.measureText(n,{...En,fontFamily:mi[e.props.font],fontSize:s,maxWidth:ut-ss*2-l,disableOverflowWrapBreaking:!0});if(o=c.h+ss*2,a=c.w+ss*2,s<=14){const u=t.textMeasure.measureText(n,{...En,fontFamily:mi[e.props.font],fontSize:s,maxWidth:ut-ss*2-l});o=u.h+ss*2,a=u.w+ss*2;break}if(c.scrollWidth.toFixed(0)===c.w.toFixed(0))break}while(i++<50);return{labelHeight:o,labelWidth:a,fontSizeAdjustment:s}}const Rte=new so;function LT(t,e){return Rte.get(e,()=>jte(t,e))}function Ote(t){const e=G(),n=OT();return C.useCallback(r=>{const s=e.getShape(t);if(!s)return;const i=r.key==="Tab",o=(r.metaKey||r.ctrlKey)&&r.key==="Enter";if(i||o){r.preventDefault();const a=e.getShapePageTransform(t),l=a.rotation(),c=!!(n.dir==="rtl"||aT(s.props.text)),u=(ut+e.options.adjacentShapeMargin+(o&&!r.shiftKey?s.props.growY:0))*s.props.scale,h=new b(i?r.shiftKey!=c?-1:1:0,o?r.shiftKey?-1:1:0).mul(u).add(ym.clone().mul(s.props.scale)).rot(l).add(a.point()),p=gT(e,s,h,l);p&&(e.mark("editing adjacent shape"),dg(e,p,!0))}},[t,e,n.dir])}function H0(t){return(ut+t.props.growY)*t.props.scale}function Lte(t,e,n){const r=Hs(t),s=Math.abs(r())+.5,i=Math.cos(e),o=5*n,a=4*n,l=6*n,c=7*n;return`0px ${o-s}px ${o}px -${o}px rgba(15, 23, 31, .6),
	0px ${(a+s*c)*Math.max(0,i)}px ${l+s*c}px -${a+s*l}px rgba(15, 23, 31, ${(.3+s*.1).toFixed(2)}), 
	0px ${48*n}px ${10*n}px -${10*n}px inset rgba(15, 23, 44, ${((.022+r()*.005)*((1+i)/2)).toFixed(2)})`}function Nte(t){return new fe(0,0,ut,ut+t.props.growY)}function zte(t,{initialBounds:e,scaleX:n,scaleY:r,newPoint:s}){const i=Math.max(.01,Math.min(Math.abs(n),Math.abs(r))),o=new b(0,0);n<0&&(o.x=-(e.width*i)),r<0&&(o.y=-(e.height*i));const{x:a,y:l}=b.Add(s,o.rot(t.rotation));return{x:a,y:l,props:{scale:i*t.props.scale}}}const Fte=new so;class tf extends fs{constructor(){super(...arguments);g(this,"canEdit",()=>!0);g(this,"isAspectRatioLocked",()=>!0);g(this,"onResize",(n,r)=>{const{newPoint:s,initialBounds:i,initialShape:o,scaleX:a,handle:l}=r;if(r.mode==="scale_shape"||l!=="right"&&l!=="left")return{id:n.id,type:n.type,...zte(n,r)};{const c=Math.max(1,Math.abs(i.width*a)),{x:u,y:h}=a<0?b.Sub(s,b.FromAngle(n.rotation).mul(c)):s;return{id:n.id,type:n.type,x:u,y:h,props:{w:c/o.props.scale,autoSize:!1}}}});g(this,"onEditEnd",n=>{const{id:r,type:s,props:{text:i}}=n,o=n.props.text.trimEnd();o.length===0?this.editor.deleteShapes([n.id]):o!==n.props.text&&this.editor.updateShapes([{id:r,type:s,props:{text:i.trimEnd()}}])});g(this,"onBeforeUpdate",(n,r)=>{if(!r.props.autoSize)return;const s=n.props.size!==r.props.size||n.props.textAlign!==r.props.textAlign||n.props.font!==r.props.font||n.props.scale!==1&&r.props.scale===1,i=n.props.text!==r.props.text;if(!s&&!i)return;const o=this.getMinDimensions(n),a=z7(this.editor,r.props),l=o.width*n.props.scale,c=o.height*n.props.scale,u=a.width*r.props.scale,h=a.height*r.props.scale;let p;switch(r.props.textAlign){case"middle":{p=new b((u-l)/2,i?0:(h-c)/2);break}case"end":{p=new b(u-l,i?0:(h-c)/2);break}default:{if(i)break;p=new b(0,(h-c)/2);break}}if(p){p.rot(r.rotation);const{x:f,y:v}=r;return{...r,x:f-p.x,y:v-p.y,props:{...r.props,w:u}}}else return{...r,props:{...r.props,w:u}}})}getDefaultProps(){return{color:"black",size:"m",w:8,text:"",font:"draw",textAlign:"start",autoSize:!0,scale:1}}getMinDimensions(n){return Fte.get(n.props,r=>z7(this.editor,r))}getGeometry(n){const{scale:r}=n.props,{width:s,height:i}=this.getMinDimensions(n);return new xi({width:s*r,height:i*r,isFilled:!0,isLabel:!0})}component(n){const{id:r,props:{font:s,size:i,text:o,color:a,scale:l,textAlign:c}}=n,{width:u,height:h}=this.getMinDimensions(n),p=n.id===this.editor.getOnlySelectedShapeId(),f=Cs(),v=$te(r);return d.jsx(xm,{id:r,classNamePrefix:"tl-text-shape",type:"text",font:s,fontSize:Rc[i],lineHeight:En.lineHeight,align:c,verticalAlign:"middle",text:o,labelColor:f[a].solid,isSelected:p,textWidth:u,textHeight:h,style:{transform:`scale(${l})`,transformOrigin:"top left"},wrap:!0,onKeyDown:v})}indicator(n){const r=this.editor.getShapeGeometry(n).bounds,s=G();return n.props.autoSize&&s.getEditingShapeId()===n.id?null:d.jsx("rect",{width:K(r.width),height:K(r.height)})}toSvg(n,r){n.props.text&&r.addExportDef(vm(n.props.font));const s=this.editor.getShapeGeometry(n).bounds,i=s.width/(n.props.scale??1),o=s.height/(n.props.scale??1),a=go(r);return d.jsx(Sm,{fontSize:Rc[n.props.size],font:n.props.font,align:n.props.textAlign,verticalAlign:"middle",text:n.props.text,labelColor:a[n.props.color].solid,bounds:new fe(0,0,i,o),padding:0})}}g(tf,"type","text"),g(tf,"props",$I),g(tf,"migrations",BI);function z7(t,e){const{font:n,text:r,autoSize:s,size:i,w:o}=e,a=s?16:Math.max(16,o),l=Rc[i],c=s?null:Math.floor(Math.max(a,o)),u=t.textMeasure.measureText(r,{...En,fontFamily:mi[n],fontSize:l,maxWidth:c});return s&&(u.w+=1),{width:Math.max(a,u.w),height:Math.max(l,u.h)}}function $te(t){const e=G();return C.useCallback(n=>{if(e.getEditingShapeId()===t)switch(n.key){case"Enter":{(n.ctrlKey||n.metaKey)&&e.complete();break}case"Tab":{Ve(n),n.shiftKey?Oc.unindent(n.currentTarget):Oc.indent(n.currentTarget);break}}},[e,t])}class nf extends tu{constructor(){super(...arguments);g(this,"canEdit",()=>!0);g(this,"isAspectRatioLocked",()=>!0)}getDefaultProps(){return{w:100,h:100,assetId:null,time:0,playing:!0,url:""}}component(n){const{editor:r}=this,s=r.getShapeGeometry(n).bounds.w*r.getZoomLevel()>=110,{asset:i,url:o}=TT(n.id,n.props.assetId,n.props.w),{time:a,playing:l}=n.props,c=gm(n.id),u=MT(),h=C.useRef(null),p=C.useCallback(S=>{const w=S.currentTarget;w&&r.updateShapes([{type:"video",id:n.id,props:{playing:!0,time:w.currentTime}}])},[n.id,r]),f=C.useCallback(S=>{const w=S.currentTarget;w&&r.updateShapes([{type:"video",id:n.id,props:{playing:!1,time:w.currentTime}}])},[n.id,r]),v=C.useCallback(S=>{const w=S.currentTarget;w&&c&&r.updateShapes([{type:"video",id:n.id,props:{time:w.currentTime}}])},[c,n.id,r]),[m,x]=C.useState(!1),y=C.useCallback(S=>{const w=S.currentTarget;w&&(a!==w.currentTime&&(w.currentTime=a),l||w.pause(),x(!0))},[l,a]);return C.useEffect(()=>{const S=h.current;S&&(m&&!c&&a!==S.currentTime&&(S.currentTime=a),c&&document.activeElement!==S&&S.focus())},[c,m,a]),C.useEffect(()=>{if(u){const S=h.current;if(!S)return;S.pause(),S.currentTime=0}},[h,u]),d.jsxs(d.Fragment,{children:[d.jsx(aa,{id:n.id,style:{color:"var(--color-text-3)",backgroundColor:i?"transparent":"var(--color-low)",border:i?"none":"1px solid var(--color-low-border)"},children:d.jsx("div",{className:"tl-counter-scaled",children:d.jsx("div",{className:"tl-video-container",children:i!=null&&i.props.src?o?d.jsx("video",{ref:h,style:c?{pointerEvents:"all"}:void 0,className:`tl-video tl-video-shape-${n.id.split(":")[1]}`,width:"100%",height:"100%",draggable:!1,playsInline:!0,autoPlay:!0,muted:!0,loop:!0,disableRemotePlayback:!0,disablePictureInPicture:!0,controls:c&&s,onPlay:p,onPause:f,onTimeUpdate:v,onLoadedData:y,hidden:!m,children:d.jsx("source",{src:o})}):null:d.jsx(ET,{})})})}),"url"in n.props&&n.props.url&&d.jsx(Lc,{url:n.props.url,zoomLevel:r.getZoomLevel()})]})}indicator(n){return d.jsx("rect",{width:K(n.props.w),height:K(n.props.h)})}toSvg(n){return d.jsx("image",{href:Bte(n.id),width:n.props.w,height:n.props.h})}}g(nf,"type","video"),g(nf,"props",UI),g(nf,"migrations",HI);function Bte(t){const e=t.split(":")[1],n=document.querySelector(`.tl-video-shape-${e}`);if(n){const r=document.createElement("canvas");return r.width=n.videoWidth,r.height=n.videoHeight,r.getContext("2d").drawImage(n,0,0),r.toDataURL("image/png")}else throw new Error("Video with not found when attempting serialization.")}const rw=[tf,Gp,Vp,Xp,ef,Jp,Yp,Kp,Zp,qp,Qp,nf];function Ute(t){return t.sideEffects.register({instance_page_state:{afterChange:(e,n)=>{if(e.croppingShapeId!==n.croppingShapeId){const r=t.isIn("select.crop");!e.croppingShapeId&&n.croppingShapeId?r||t.setCurrentTool("select.crop.idle"):e.croppingShapeId&&!n.croppingShapeId&&r&&t.setCurrentTool("select.idle")}e.editingShapeId!==n.editingShapeId&&(!e.editingShapeId&&n.editingShapeId?t.isIn("select.editing_shape")||t.setCurrentTool("select.editing_shape"):e.editingShapeId&&!n.editingShapeId&&t.isIn("select.editing_shape")&&t.setCurrentTool("select.idle"))}}})}class NT extends Se{constructor(){super(...arguments);g(this,"info",{});g(this,"scribbleId","id");g(this,"markId","");g(this,"excludedShapeIds",new Set);g(this,"onEnter",n=>{this.markId="erase scribble begin",this.editor.mark(this.markId),this.info=n;const{originPagePoint:r}=this.editor.inputs;this.excludedShapeIds=new Set(this.editor.getCurrentPageShapes().filter(i=>{if(this.editor.isShapeOrAncestorLocked(i))return!0;if(this.editor.isShapeOfType(i,"group")||this.editor.isShapeOfType(i,"frame")){const o=this.editor.getPointInShapeSpace(i,r);return this.editor.getShapeGeometry(i).bounds.containsPoint(o)}return!1}).map(i=>i.id));const s=this.editor.scribbles.addScribble({color:"muted-1",size:12});this.scribbleId=s.id,this.update()});g(this,"pushPointToScribble",()=>{const{x:n,y:r}=this.editor.inputs.currentPagePoint;this.editor.scribbles.addPoint(this.scribbleId,n,r)});g(this,"onExit",()=>{this.editor.scribbles.stop(this.scribbleId)});g(this,"onPointerMove",()=>{this.update()});g(this,"onPointerUp",()=>{this.complete()});g(this,"onCancel",()=>{this.cancel()});g(this,"onComplete",()=>{this.complete()})}update(){const{editor:n,excludedShapeIds:r}=this,s=n.getErasingShapeIds(),i=n.getZoomLevel(),o=n.getCurrentPageShapes(),{inputs:{currentPagePoint:a,previousPagePoint:l}}=n;this.pushPointToScribble();const c=new Set(s),u=this.editor.options.hitTestMargin/i;for(const h of o){if(n.isShapeOfType(h,"group"))continue;const p=n.getShapeMask(h.id);if(p&&!Wr(a,p))continue;const f=n.getShapeGeometry(h),v=n.getShapePageTransform(h);if(!f||!v)continue;const m=v.clone().invert(),x=m.applyToPoint(l),y=m.applyToPoint(a),{bounds:S}=f;S.minX-u>Math.max(x.x,y.x)||S.minY-u>Math.max(x.y,y.y)||S.maxX+u<Math.min(x.x,y.x)||S.maxY+u<Math.min(x.y,y.y)||f.hitTestLineSegment(x,y,u)&&c.add(n.getOutermostSelectableShape(h).id)}this.editor.setErasingShapes([...c].filter(h=>!r.has(h)))}complete(){const{editor:n}=this;n.deleteShapes(n.getCurrentPageState().erasingShapeIds),n.setErasingShapes([]),this.parent.transition("idle")}cancel(){const{editor:n}=this;n.setErasingShapes([]),n.bailToMark(this.markId),this.parent.transition("idle",this.info)}}g(NT,"id","erasing");var Sv;let Hte=(Sv=class extends Se{constructor(){super(...arguments);g(this,"onPointerDown",n=>{this.parent.transition("pointing",n)});g(this,"onCancel",()=>{this.editor.setCurrentTool("select")})}},g(Sv,"id","idle"),Sv);var xv;let Wte=(xv=class extends Se{constructor(){super(...arguments);g(this,"onEnter",()=>{const n=this.editor.getZoomLevel(),r=this.editor.getCurrentPageShapesSorted(),{inputs:{currentPagePoint:s}}=this.editor,i=new Set,o=i.size;for(let a=r.length,l=a-1;l>=0;l--){const c=r[l];if(!(this.editor.isShapeOrAncestorLocked(c)||this.editor.isShapeOfType(c,"group"))&&this.editor.isPointInShape(c,s,{hitInside:!1,margin:this.editor.options.hitTestMargin/n})){const u=this.editor.getOutermostSelectableShape(c);if(this.editor.isShapeOfType(u,"frame")&&i.size>o)break;i.add(u.id)}}this.editor.setErasingShapes([...i])});g(this,"onLongPress",n=>{this.startErasing(n)});g(this,"onPointerMove",n=>{this.editor.inputs.isDragging&&this.startErasing(n)});g(this,"onPointerUp",()=>{this.complete()});g(this,"onCancel",()=>{this.cancel()});g(this,"onComplete",()=>{this.complete()});g(this,"onInterrupt",()=>{this.cancel()})}startErasing(n){this.parent.transition("erasing",n)}complete(){const n=this.editor.getErasingShapeIds();n.length&&(this.editor.mark("erase end"),this.editor.deleteShapes(n)),this.editor.setErasingShapes([]),this.parent.transition("idle")}cancel(){this.editor.setErasingShapes([]),this.parent.transition("idle")}},g(xv,"id","pointing"),xv);class Qu extends Se{constructor(){super(...arguments);g(this,"onEnter",()=>{this.editor.setCursor({type:"cross",rotation:0})})}}g(Qu,"id","eraser"),g(Qu,"initial","idle"),g(Qu,"isLockable",!1),g(Qu,"children",()=>[Hte,Wte,NT]);class zT extends Se{constructor(){super(...arguments);g(this,"initialCamera",new b);g(this,"onEnter",()=>{this.initialCamera=b.From(this.editor.getCamera()),this.update()});g(this,"onPointerMove",()=>{this.update()});g(this,"onPointerUp",()=>{this.complete()});g(this,"onCancel",()=>{this.parent.transition("idle")});g(this,"onComplete",()=>{this.complete()})}update(){const{initialCamera:n,editor:r}=this,{currentScreenPoint:s,originScreenPoint:i}=r.inputs,o=b.Sub(s,i).div(r.getZoomLevel());o.len2()!==0&&r.setCamera(n.clone().add(o))}complete(){const{editor:n}=this,{pointerVelocity:r}=n.inputs,s=Math.min(r.len(),2);s>.1&&this.editor.slideCamera({speed:s,direction:r}),this.parent.transition("idle")}}g(zT,"id","dragging");var wv;let Kte=(wv=class extends Se{constructor(){super(...arguments);g(this,"onEnter",()=>{this.editor.setCursor({type:"grab",rotation:0})});g(this,"onPointerDown",n=>{this.parent.transition("pointing",n)});g(this,"onCancel",()=>{this.editor.setCurrentTool("select")})}},g(wv,"id","idle"),wv);var bv;let Gte=(bv=class extends Se{constructor(){super(...arguments);g(this,"onEnter",()=>{this.editor.stopCameraAnimation(),this.editor.setCursor({type:"grabbing",rotation:0})});g(this,"onLongPress",()=>{this.startDragging()});g(this,"onPointerMove",()=>{this.editor.inputs.isDragging&&this.startDragging()});g(this,"onPointerUp",()=>{this.complete()});g(this,"onCancel",()=>{this.complete()});g(this,"onComplete",()=>{this.complete()});g(this,"onInterrupt",()=>{this.complete()})}startDragging(){this.parent.transition("dragging")}complete(){this.parent.transition("idle")}},g(bv,"id","pointing"),bv);class Ju extends Se{constructor(){super(...arguments);g(this,"onDoubleClick",n=>{if(n.phase==="settle"){const{currentScreenPoint:r}=this.editor.inputs;this.editor.zoomIn(r,{animation:{duration:220,easing:dn.easeOutQuint}})}});g(this,"onTripleClick",n=>{if(n.phase==="settle"){const{currentScreenPoint:r}=this.editor.inputs;this.editor.zoomOut(r,{animation:{duration:320,easing:dn.easeOutQuint}})}});g(this,"onQuadrupleClick",n=>{if(n.phase==="settle"){const r=this.editor.getZoomLevel(),{inputs:{currentScreenPoint:s}}=this.editor;r===1?this.editor.zoomToFit({animation:{duration:400,easing:dn.easeOutQuint}}):this.editor.resetZoom(s,{animation:{duration:320,easing:dn.easeOutQuint}})}})}}g(Ju,"id","hand"),g(Ju,"initial","idle"),g(Ju,"isLockable",!1),g(Ju,"children",()=>[Kte,Gte,zT]);var Cv;let Vte=(Cv=class extends Se{constructor(){super(...arguments);g(this,"onPointerDown",n=>{this.parent.transition("lasering",n)})}},g(Cv,"id","idle"),Cv);class FT extends Se{constructor(){super(...arguments);g(this,"scribbleId","id");g(this,"onEnter",()=>{const n=this.editor.scribbles.addScribble({color:"laser",opacity:.7,size:4,delay:1200,shrink:.05,taper:!0});this.scribbleId=n.id,this.pushPointToScribble()});g(this,"onExit",()=>{this.editor.scribbles.stop(this.scribbleId)});g(this,"onPointerMove",()=>{this.pushPointToScribble()});g(this,"onPointerUp",()=>{this.complete()});g(this,"pushPointToScribble",()=>{const{x:n,y:r}=this.editor.inputs.currentPagePoint;this.editor.scribbles.addPoint(this.scribbleId,n,r)});g(this,"onCancel",()=>{this.cancel()});g(this,"onComplete",()=>{this.complete()})}complete(){this.parent.transition("idle")}cancel(){this.parent.transition("idle")}}g(FT,"id","lasering");class ed extends Se{constructor(){super(...arguments);g(this,"onEnter",()=>{this.editor.setCursor({type:"cross",rotation:0})})}}g(ed,"id","laser"),g(ed,"initial","idle"),g(ed,"children",()=>[Vte,FT]),g(ed,"isLockable",!1);class $T extends Se{constructor(){super(...arguments);g(this,"info",{});g(this,"initialSelectedShapeIds",[]);g(this,"excludedShapeIds",new Set);g(this,"isWrapMode",!1);g(this,"initialStartShape",null);g(this,"onEnter",n=>{const{altKey:r,currentPagePoint:s}=this.editor.inputs;if(this.isWrapMode=this.editor.user.getIsWrapMode(),r){this.parent.transition("scribble_brushing",n);return}this.excludedShapeIds=new Set(this.editor.getCurrentPageShapes().filter(i=>this.editor.isShapeOfType(i,"group")||this.editor.isShapeOrAncestorLocked(i)).map(i=>i.id)),this.info=n,this.initialSelectedShapeIds=this.editor.getSelectedShapeIds().slice(),this.initialStartShape=this.editor.getShapesAtPoint(s)[0],this.hitTestShapes()});g(this,"onExit",()=>{this.initialSelectedShapeIds=[],this.editor.updateInstanceState({brush:null})});g(this,"onTick",({elapsed:n})=>{const{editor:r}=this;r.edgeScrollManager.updateEdgeScrolling(n)});g(this,"onPointerMove",()=>{this.hitTestShapes()});g(this,"onPointerUp",()=>{this.complete()});g(this,"onComplete",()=>{this.complete()});g(this,"onCancel",n=>{this.editor.setSelectedShapes(this.initialSelectedShapeIds),this.parent.transition("idle",n)});g(this,"onKeyDown",n=>{this.editor.inputs.altKey?this.parent.transition("scribble_brushing",n):this.hitTestShapes()});g(this,"onKeyUp",()=>{this.hitTestShapes()});g(this,"onInterrupt",()=>{this.editor.updateInstanceState({brush:null})})}complete(){this.hitTestShapes(),this.parent.transition("idle")}hitTestShapes(){const{editor:n,excludedShapeIds:r,isWrapMode:s}=this,{inputs:{originPagePoint:i,currentPagePoint:o,shiftKey:a,ctrlKey:l}}=n,c=new Set(a?this.initialSelectedShapeIds:[]),u=s?!l:l,h=fe.FromPoints([i,o]),{corners:p}=h;let f,v,m,x,y,S;const w=n.getCurrentPageShapes(),P=n.getCurrentPageId();e:for(let I=0,_=w.length;I<_;I++){if(m=w[I],r.has(m.id)||c.has(m.id)||(x=n.getShapePageBounds(m),!x))continue e;if(h.contains(x)){this.handleHit(m,o,P,c,p);continue e}if(u||n.isShapeOfType(m,"frame"))continue e;if(h.collides(x)){if(y=n.getShapePageTransform(m),!y)continue e;S=y.clone().invert().applyToPoints(p);const D=n.getShapeGeometry(m);t:for(let R=0;R<4;R++)if(f=S[R],v=S[(R+1)%4],D.hitTestLineSegment(f,v,0)){this.handleHit(m,o,P,c,p);break t}}}n.getInstanceState().isCoarsePointer;const E=n.getInstanceState().brush;(!E||!h.equals(E))&&n.updateInstanceState({brush:{...h.toJson()}});const M=n.getSelectedShapeIds();(M.length!==c.size||M.some(I=>!c.has(I)))&&n.setSelectedShapes(Array.from(c))}handleHit(n,r,s,i,o){if(n.parentId===s){i.add(n.id);return}const a=this.editor.getOutermostSelectableShape(n),l=this.editor.getShapeMask(a.id);l&&!OE(l,o)&&!Wr(r,l)||i.add(a.id)}}g($T,"id","brushing");const zc={bottom:"ns-resize",top:"ns-resize",left:"ew-resize",right:"ew-resize",bottom_left:"nesw-resize",bottom_right:"nwse-resize",top_left:"nwse-resize",top_right:"nesw-resize",bottom_left_rotate:"swne-rotate",bottom_right_rotate:"senw-rotate",top_left_rotate:"nwse-rotate",top_right_rotate:"nesw-rotate",mobile_rotate:"grabbing"};class BT extends Se{constructor(){super(...arguments);g(this,"info",{});g(this,"onEnter",n=>{this.info=n,this.updateCursor()});g(this,"onPointerMove",()=>{this.editor.inputs.isDragging&&this.startResizing()});g(this,"onLongPress",()=>{this.startResizing()});g(this,"onPointerUp",()=>{this.complete()});g(this,"onCancel",()=>{this.cancel()});g(this,"onComplete",()=>{this.cancel()});g(this,"onInterrupt",()=>{this.cancel()})}updateCursor(){const n=this.editor.getSelectedShapes(),r=zc[this.info.handle];this.editor.setCursor({type:r,rotation:n.length===1?this.editor.getSelectionRotation():0})}startResizing(){this.editor.getInstanceState().isReadonly||this.parent.transition("resizing",this.info)}complete(){this.info.onInteractionEnd?this.editor.setCurrentTool(this.info.onInteractionEnd,{}):this.parent.transition("idle")}cancel(){this.info.onInteractionEnd?this.editor.setCurrentTool(this.info.onInteractionEnd,{}):this.parent.transition("idle")}}g(BT,"id","pointing_resize_handle");const ns=8;class sw extends Se{constructor(){super(...arguments);g(this,"info",{});g(this,"markId","");g(this,"snapshot",{});g(this,"onEnter",n=>{this.info=n,this.markId="cropping",this.editor.mark(this.markId),this.snapshot=this.createSnapshot(),this.updateShapes()});g(this,"onPointerMove",()=>{this.updateShapes()});g(this,"onPointerUp",()=>{this.complete()});g(this,"onComplete",()=>{this.complete()});g(this,"onCancel",()=>{this.cancel()});g(this,"getDefaultCrop",()=>({topLeft:{x:0,y:0},bottomRight:{x:1,y:1}}))}updateCursor(){if(!this.editor.getSelectedShapes()[0])return;const r=zc[this.info.handle];this.editor.setCursor({type:r,rotation:this.editor.getSelectionRotation()})}updateShapes(){const{shape:n,cursorHandleOffset:r}=this.snapshot;if(!n||!this.editor.getShapeUtil("image"))return;const i=n.props,o=this.editor.inputs.currentPagePoint.clone().sub(r),a=this.editor.inputs.originPagePoint.clone().sub(r),l=o.clone().sub(a).rot(-n.rotation),c=i.crop??this.getDefaultCrop(),u=yt(c),h=new b(n.x,n.y),p=new b(0,0),f=1/(c.bottomRight.x-c.topLeft.x)*i.w,v=1/(c.bottomRight.y-c.topLeft.y)*i.h;let m=!1;switch(this.info.handle){case"top":case"top_left":case"top_right":{if(v<ns)break;m=!0,u.topLeft.y=u.topLeft.y+l.y/v,v*(u.bottomRight.y-u.topLeft.y)<ns?(u.topLeft.y=u.bottomRight.y-ns/v,p.y=(u.topLeft.y-c.topLeft.y)*v):u.topLeft.y<=0?(u.topLeft.y=0,p.y=(u.topLeft.y-c.topLeft.y)*v):p.y=l.y;break}case"bottom":case"bottom_left":case"bottom_right":{if(v<ns)break;m=!0,u.bottomRight.y=Math.min(1,u.bottomRight.y+l.y/v),v*(u.bottomRight.y-u.topLeft.y)<ns&&(u.bottomRight.y=u.topLeft.y+ns/v);break}}switch(this.info.handle){case"left":case"top_left":case"bottom_left":{if(f<ns)break;m=!0,u.topLeft.x=u.topLeft.x+l.x/f,f*(u.bottomRight.x-u.topLeft.x)<ns?(u.topLeft.x=u.bottomRight.x-ns/f,p.x=(u.topLeft.x-c.topLeft.x)*f):u.topLeft.x<=0?(u.topLeft.x=0,p.x=(u.topLeft.x-c.topLeft.x)*f):p.x=l.x;break}case"right":case"top_right":case"bottom_right":{if(f<ns)break;m=!0,u.bottomRight.x=Math.min(1,u.bottomRight.x+l.x/f),f*(u.bottomRight.x-u.topLeft.x)<ns&&(u.bottomRight.x=u.topLeft.x+ns/f);break}}if(!m)return;h.add(p.rot(n.rotation));const x={id:n.id,type:n.type,x:h.x,y:h.y,props:{crop:u,w:(u.bottomRight.x-u.topLeft.x)*f,h:(u.bottomRight.y-u.topLeft.y)*v}};this.editor.updateShapes([x]),this.updateCursor()}complete(){this.updateShapes(),ft(this.editor,[this.snapshot.shape.id]),this.info.onInteractionEnd?this.editor.setCurrentTool(this.info.onInteractionEnd,this.info):(this.editor.setCroppingShape(null),this.editor.setCurrentTool("select.idle"))}cancel(){this.editor.bailToMark(this.markId),this.info.onInteractionEnd?this.editor.setCurrentTool(this.info.onInteractionEnd,this.info):(this.editor.setCroppingShape(null),this.editor.setCurrentTool("select.idle"))}createSnapshot(){const n=this.editor.getSelectionRotation(),{inputs:{originPagePoint:r}}=this.editor,s=this.editor.getOnlySelectedShape(),i=this.editor.getSelectionRotatedPageBounds(),o=b.RotWith(i.getHandlePoint(this.info.handle),i.point,n),a=b.Sub(r,o);return{shape:s,cursorHandleOffset:a}}}g(sw,"id","cropping");function UT(t,e=!1){const n=t.getZoomLevel(),{inputs:{currentPagePoint:r}}=t;return t.getShapeAtPoint(r,{hitInside:!1,hitLabels:e,margin:t.options.hitTestMargin/n,renderingOnly:!0})??t.getSelectedShapeAtPoint(r)}function HT(t,e,n){if(!e)throw Error("Needs to translate a cropped shape!");const{crop:r}=e.props;if(!r)return;const s=t.inputs.shiftKey?Math.abs(n.x)<Math.abs(n.y)?"x":"y":null;s==="x"?n.x=0:s==="y"&&(n.y=0),n.rot(-e.rotation);const i=1/(r.bottomRight.x-r.topLeft.x)*e.props.w,o=1/(r.bottomRight.y-r.topLeft.y)*e.props.h,a=r.bottomRight.y-r.topLeft.y,l=r.bottomRight.x-r.topLeft.x,c=yt(r);return c.topLeft.x=Math.min(1-l,Math.max(0,c.topLeft.x-n.x/i)),c.topLeft.y=Math.min(1-a,Math.max(0,c.topLeft.y-n.y/o)),c.bottomRight.x=c.topLeft.x+l,c.bottomRight.y=c.topLeft.y+a,{id:e.id,type:e.type,props:{crop:c}}}var Pv;let qte=(Pv=class extends Se{constructor(){super(...arguments);g(this,"onEnter",()=>{this.editor.setCursor({type:"default",rotation:0});const n=this.editor.getOnlySelectedShape();n&&this.editor.setCroppingShape(n.id)});g(this,"onExit",()=>{this.editor.setCursor({type:"default",rotation:0})});g(this,"onCancel",()=>{this.editor.setCroppingShape(null),this.editor.setCurrentTool("select.idle",{})});g(this,"onPointerDown",n=>{var r;if(!this.editor.getIsMenuOpen()){if(n.ctrlKey){this.cancel(),this.editor.root.handleEvent(n);return}switch(n.target){case"canvas":{const s=UT(this.editor);if(s&&!this.editor.isShapeOfType(s,"group")){this.onPointerDown({...n,shape:s,target:"shape"});return}this.cancel(),this.editor.root.handleEvent(n);break}case"shape":{if(n.shape.id===this.editor.getCroppingShapeId()){this.editor.setCurrentTool("select.crop.pointing_crop",n);return}else(r=this.editor.getShapeUtil(n.shape))!=null&&r.canCrop(n.shape)?(this.editor.setCroppingShape(n.shape.id),this.editor.setSelectedShapes([n.shape.id]),this.editor.setCurrentTool("select.crop.pointing_crop",n)):(this.cancel(),this.editor.root.handleEvent(n));break}case"selection":{switch(n.handle){case"mobile_rotate":case"top_left_rotate":case"top_right_rotate":case"bottom_left_rotate":case"bottom_right_rotate":{this.editor.setCurrentTool("select.pointing_rotate_handle",{...n,onInteractionEnd:"select.crop.idle"});break}case"top":case"right":case"bottom":case"left":case"top_left":case"top_right":case"bottom_left":case"bottom_right":{this.editor.setCurrentTool("select.crop.pointing_crop_handle",{...n,onInteractionEnd:"select.crop.idle"});break}default:this.cancel()}break}}}});g(this,"onDoubleClick",n=>{var o;if(this.editor.inputs.shiftKey||n.phase!=="up")return;const r=this.editor.getCroppingShapeId();if(!r)return;const s=this.editor.getShape(r);if(!s)return;const i=this.editor.getShapeUtil(s);if(i){if(n.target==="selection"){(o=i.onDoubleClickEdge)==null||o.call(i,s);return}this.cancel(),this.editor.root.handleEvent(n)}});g(this,"onKeyDown",()=>{this.nudgeCroppingImage(!1)});g(this,"onKeyRepeat",()=>{this.nudgeCroppingImage(!0)});g(this,"onKeyUp",n=>{switch(n.code){case"Enter":{this.editor.setCroppingShape(null),this.editor.setCurrentTool("select.idle",{});break}}})}cancel(){this.editor.setCroppingShape(null),this.editor.setCurrentTool("select.idle",{})}nudgeCroppingImage(n=!1){const{editor:{inputs:{keys:r}}}=this,s=r.has("ShiftLeft"),i=new b(0,0);if(r.has("ArrowLeft")&&(i.x+=1),r.has("ArrowRight")&&(i.x-=1),r.has("ArrowUp")&&(i.y+=1),r.has("ArrowDown")&&(i.y-=1),i.equals(new b(0,0)))return;s&&i.mul(10);const o=this.editor.getShape(this.editor.getCroppingShapeId());if(!o)return;const a=HT(this.editor,o,i);a&&(n||this.editor.mark("translate crop"),this.editor.updateShapes([a]))}},g(Pv,"id","idle"),Pv);class WT extends Se{constructor(){super(...arguments);g(this,"onCancel",()=>{this.editor.setCurrentTool("select.crop.idle",{})});g(this,"onPointerMove",n=>{this.editor.inputs.isDragging&&this.editor.setCurrentTool("select.crop.translating_crop",n)});g(this,"onPointerUp",n=>{this.editor.setCurrentTool("select.crop.idle",n)})}}g(WT,"id","pointing_crop");class iw extends Se{constructor(){super(...arguments);g(this,"info",{});g(this,"onEnter",n=>{this.info=n,this.parent.setCurrentToolIdMask(n.onInteractionEnd);const r=this.editor.getSelectedShapes()[0];if(!r)return;const s=zc[this.info.handle];this.editor.setCursor({type:s,rotation:this.editor.getSelectionRotation()}),this.editor.setCroppingShape(r.id)});g(this,"onExit",()=>{this.editor.setCursor({type:"default",rotation:0}),this.parent.setCurrentToolIdMask(void 0)});g(this,"onPointerMove",()=>{this.editor.inputs.isDragging&&this.startCropping()});g(this,"onLongPress",()=>{this.startCropping()});g(this,"onPointerUp",()=>{this.info.onInteractionEnd?this.editor.setCurrentTool(this.info.onInteractionEnd,this.info):(this.editor.setCroppingShape(null),this.editor.setCurrentTool("select.idle"))});g(this,"onCancel",()=>{this.cancel()});g(this,"onComplete",()=>{this.cancel()});g(this,"onInterrupt",()=>{this.cancel()})}startCropping(){this.editor.getInstanceState().isReadonly||this.parent.transition("cropping",{...this.info,onInteractionEnd:this.info.onInteractionEnd})}cancel(){this.info.onInteractionEnd?this.editor.setCurrentTool(this.info.onInteractionEnd,this.info):(this.editor.setCroppingShape(null),this.editor.setCurrentTool("select.idle"))}}g(iw,"id","pointing_crop_handle");class KT extends Se{constructor(){super(...arguments);g(this,"info",{});g(this,"markId","translating crop");g(this,"snapshot",{});g(this,"onEnter",n=>{this.info=n,this.snapshot=this.createSnapshot(),this.editor.mark(this.markId),this.editor.setCursor({type:"move",rotation:0}),this.updateShapes()});g(this,"onExit",()=>{this.editor.setCursor({type:"default",rotation:0})});g(this,"onPointerMove",()=>{this.updateShapes()});g(this,"onPointerUp",()=>{this.complete()});g(this,"onComplete",()=>{this.complete()});g(this,"onCancel",()=>{this.cancel()});g(this,"onKeyDown",n=>{switch(n.key){case"Alt":case"Shift":{this.updateShapes();return}}});g(this,"onKeyUp",n=>{switch(n.key){case"Enter":{this.complete();return}case"Alt":case"Shift":this.updateShapes()}})}complete(){this.updateShapes(),this.editor.setCurrentTool("select.crop.idle",this.info)}cancel(){this.editor.bailToMark(this.markId),this.editor.setCurrentTool("select.crop.idle",this.info)}createSnapshot(){return{shape:this.editor.getOnlySelectedShape()}}updateShapes(){const n=this.snapshot.shape;if(!n)return;const{originPagePoint:r,currentPagePoint:s}=this.editor.inputs,i=s.clone().sub(r),o=HT(this.editor,n,i);o&&this.editor.updateShapes([o])}}g(KT,"id","translating_crop");class rf extends Se{constructor(){super(...arguments);g(this,"markId","");g(this,"onEnter",()=>{this.didCancel=!1,this.markId="crop",this.editor.mark(this.markId)});g(this,"didCancel",!1);g(this,"onExit",()=>{this.didCancel?this.editor.bailToMark(this.markId):this.editor.squashToMark(this.markId)});g(this,"onCancel",()=>{this.didCancel=!0})}}g(rf,"id","crop"),g(rf,"initial","idle"),g(rf,"children",()=>[qte,KT,WT,iw,sw]);class GT extends Se{constructor(){super(...arguments);g(this,"shapeId","");g(this,"initialHandle",{});g(this,"initialAdjacentHandle",null);g(this,"initialPagePoint",{});g(this,"markId","");g(this,"initialPageTransform");g(this,"initialPageRotation");g(this,"info",{});g(this,"isPrecise",!1);g(this,"isPreciseId",null);g(this,"pointingId",null);g(this,"onEnter",n=>{const{shape:r,isCreating:s,handle:i}=n;if(this.info=n,this.parent.setCurrentToolIdMask(n.onInteractionEnd),this.shapeId=r.id,this.markId=s?`creating:${r.id}`:"dragging handle",s||this.editor.mark(this.markId),this.initialHandle=yt(i),this.editor.isShapeOfType(r,"line")&&this.initialHandle.type==="create"){this.editor.updateShape({...r,props:{points:{...r.props.points,[i.index]:{id:i.index,index:i.index,x:i.x,y:i.y}}}});const c=this.editor.getShapeHandles(r).find(u=>u.index===i.index);this.initialHandle=yt(c)}this.initialPageTransform=this.editor.getShapePageTransform(r),this.initialPageRotation=this.initialPageTransform.rotation(),this.initialPagePoint=this.editor.inputs.originPagePoint.clone(),this.editor.setCursor({type:s?"cross":"grabbing",rotation:0});const o=this.editor.getShapeHandles(r).sort(Un),a=o.findIndex(l=>l.id===n.handle.id);this.initialAdjacentHandle=null;for(let l=a+1;l<o.length;l++){const c=o[l];if(c.type==="vertex"&&c.id!=="middle"&&c.id!==n.handle.id){this.initialAdjacentHandle=c;break}}if(!this.initialAdjacentHandle)for(let l=o.length-1;l>=0;l--){const c=o[l];if(c.type==="vertex"&&c.id!=="middle"&&c.id!==n.handle.id){this.initialAdjacentHandle=c;break}}if(this.editor.isShapeOfType(r,"arrow")){const l=vr(this.editor,r)[n.handle.id];this.isPrecise=!1,l?(this.editor.setHintingShapes([l.toId]),this.isPrecise=l.props.isPrecise,this.isPrecise?this.isPreciseId=l.toId:this.resetExactTimeout()):this.editor.setHintingShapes([])}this.update(),this.editor.select(this.shapeId)});g(this,"exactTimeout",-1);g(this,"onPointerMove",()=>{this.update()});g(this,"onKeyDown",()=>{this.update()});g(this,"onKeyUp",()=>{this.update()});g(this,"onPointerUp",()=>{this.complete()});g(this,"onComplete",()=>{this.update(),this.complete()});g(this,"onCancel",()=>{this.cancel()});g(this,"onExit",()=>{this.parent.setCurrentToolIdMask(void 0),this.editor.setHintingShapes([]),this.editor.snaps.clearIndicators(),this.editor.setCursor({type:"default",rotation:0})})}resetExactTimeout(){this.exactTimeout!==-1&&this.clearExactTimeout(),this.exactTimeout=this.editor.timers.setTimeout(()=>{this.getIsActive()&&!this.isPrecise&&(this.isPrecise=!0,this.isPreciseId=this.pointingId,this.update()),this.exactTimeout=-1},750)}clearExactTimeout(){this.exactTimeout!==-1&&(clearTimeout(this.exactTimeout),this.exactTimeout=-1)}complete(){this.editor.snaps.clearIndicators(),ft(this.editor,[this.shapeId]);const{onInteractionEnd:n}=this.info;if(this.editor.getInstanceState().isToolLocked&&n){this.editor.setCurrentTool(n,{shapeId:this.shapeId});return}this.parent.transition("idle")}cancel(){this.editor.bailToMark(this.markId),this.editor.snaps.clearIndicators();const{onInteractionEnd:n}=this.info;if(n){this.editor.setCurrentTool(n,{shapeId:this.shapeId});return}this.parent.transition("idle")}update(){var I;const{editor:n,shapeId:r,initialPagePoint:s}=this,{initialHandle:i,initialPageRotation:o,initialAdjacentHandle:a}=this,l=this.editor.getHintingShapeIds(),c=this.editor.user.getIsSnapMode(),{snaps:u,inputs:{currentPagePoint:h,shiftKey:p,ctrlKey:f,altKey:v,pointerVelocity:m}}=n,x=this.info.shape,y=n.getShape(r);if(!y)return;const S=n.getShapeUtil(y);let w=h.clone().sub(s).rot(-o).add(i);if(p&&a&&i.id!=="middle"){const _=b.Angle(a,w),R=sg(_,24)-_;w=b.RotWith(w,a,R)}n.snaps.clearIndicators();let P={...i,x:w.x,y:w.y};if(i.canSnap&&(c?!f:f)){if(!n.getShapePageTransform(y.id))throw Error("Expected a page transform");const D=u.handles.snapHandle({currentShapeId:r,handle:P});D&&(D.nudge.rot(-n.getShapeParentTransform(y).rotation()),w.add(D.nudge),P={...i,x:w.x,y:w.y})}const E=(I=S.onHandleDrag)==null?void 0:I.call(S,y,{handle:P,isPrecise:this.isPrecise||v,initial:x}),M={id:y.id,type:y.type,...E};if(i.type==="vertex"&&this.editor.isShapeOfType(y,"arrow")){const _=vr(n,y)[i.id];_?l[0]!==_.toId&&(n.setHintingShapes([_.toId]),this.pointingId=_.toId,this.isPrecise=m.len()<.5||v,this.isPreciseId=this.isPrecise?_.toId:null,this.resetExactTimeout()):l.length>0&&(n.setHintingShapes([]),this.pointingId=null,this.isPrecise=!1,this.isPreciseId=null,this.resetExactTimeout())}E&&n.updateShapes([M])}}g(GT,"id","dragging_handle");function VT(t){return t.isLabel?[t]:t instanceof $s?t.children.filter(e=>e.isLabel):[]}class qT extends Se{constructor(){super(...arguments);g(this,"hitShapeForPointerUp",null);g(this,"onEnter",()=>{const n=this.editor.getEditingShape();if(!n)throw Error("Entered editing state without an editing shape");this.hitShapeForPointerUp=null,Gi(this.editor),this.editor.select(n)});g(this,"onExit",()=>{var i;const{editingShapeId:n}=this.editor.getCurrentPageState();if(!n)return;this.editor.setEditingShape(null),Gi.cancel();const r=this.editor.getShape(n),s=this.editor.getShapeUtil(r);(i=s.onEditEnd)==null||i.call(s,r)});g(this,"onPointerMove",n=>{if(this.hitShapeForPointerUp&&this.editor.inputs.isDragging){if(this.editor.getInstanceState().isReadonly||this.hitShapeForPointerUp.isLocked)return;this.editor.select(this.hitShapeForPointerUp),this.parent.transition("translating",n),this.hitShapeForPointerUp=null;return}switch(n.target){case"shape":case"canvas":{Gi(this.editor);return}}});g(this,"onPointerDown",n=>{switch(this.hitShapeForPointerUp=null,n.target){case"shape":{const{shape:r}=n,s=this.editor.getEditingShape();if(!s)throw Error("Expected an editing shape!");const i=this.editor.getShapeUtil(r).getGeometry(r),o=VT(i),a=o.length===1?o[0]:void 0,l=this.editor.isShapeOfType(s,"text")&&s.props.text.trim()==="";if(a&&!l){const c=this.editor.getPointInShapeSpace(r,this.editor.inputs.currentPagePoint);if(a.bounds.containsPoint(c,0)&&a.hitTestPoint(c)){if(r.id===s.id)return;this.hitShapeForPointerUp=r,this.editor.mark("editing on pointer up"),this.editor.select(r.id);return}}else{if(r.id===s.id)this.editor.isShapeOfType(r,"frame")&&(this.editor.setEditingShape(null),this.parent.transition("idle",n));else{this.parent.transition("pointing_shape",n);return}return}break}}this.parent.transition("idle",n),this.editor.root.handleEvent(n)});g(this,"onPointerUp",n=>{const r=this.hitShapeForPointerUp;if(!r)return;this.hitShapeForPointerUp=null;const s=this.editor.getShapeUtil(r);if(!r.isLocked){if(this.editor.getInstanceState().isReadonly&&!s.canEditInReadOnly(r)){this.parent.transition("pointing_shape",n);return}this.editor.select(r.id),this.editor.setEditingShape(r.id),Gi(this.editor)}});g(this,"onComplete",n=>{this.parent.transition("idle",n)});g(this,"onCancel",n=>{this.parent.transition("idle",n)})}}g(qT,"id","editing_shape");function F7(t){const e=t.getOnlySelectedShape();return!!(e&&!t.isShapeOrAncestorLocked(e)&&t.getShapeUtil(e).canCrop(e))}function fg(t){const e=t.getSelectedShapeIds(),{shiftKey:n,altKey:r,currentPagePoint:s}=t.inputs,i=t.getShapeAtPoint(s,{hitInside:!1,margin:t.options.hitTestMargin/t.getZoomLevel(),hitLabels:!0,renderingOnly:!0,filter:o=>!o.isLocked});if(i){const o=t.getOutermostSelectableShape(i);if(n&&!r)t.cancelDoubleClick(),e.includes(o.id)?(t.mark("deselecting shape"),t.deselect(o)):(t.mark("shift selecting shape"),t.setSelectedShapes([...e,o.id]));else{let a;o===i||o.id===t.getFocusedGroupId()||e.includes(o.id)?a=i:a=o,a&&!e.includes(a.id)&&(t.mark("selecting shape"),t.select(a.id))}}else{if(n)return;{e.length>0&&(t.mark("selecting none"),t.selectNone());const o=t.getFocusedGroupId();if(fr(o)){const a=t.getShape(o);t.isPointInShape(a,s,{margin:0,hitInside:!0})||t.setFocusedGroup(null)}}}}const Yte=["Delete","Backspace","[","]","Enter"," ","Shift","Tab"];var kv;let Xte=(kv=class extends Se{constructor(){super(...arguments);g(this,"onEnter",()=>{this.parent.setCurrentToolIdMask(void 0),Gi(this.editor),this.editor.setCursor({type:"default",rotation:0})});g(this,"onExit",()=>{Gi.cancel()});g(this,"onPointerMove",()=>{Gi(this.editor)});g(this,"onPointerDown",n=>{if(this.editor.getIsMenuOpen())return;const r=n.ctrlKey&&F7(this.editor);if(n.ctrlKey&&!r){if(n.target==="shape"&&this.isDarwin&&this.editor.inputs.keys.has("ControlLeft")&&!this.editor.isShapeOrAncestorLocked(n.shape)){this.parent.transition("pointing_shape",n);return}this.parent.transition("brushing",n);return}switch(n.target){case"canvas":{const s=UT(this.editor);if(s&&!s.isLocked){this.onPointerDown({...n,shape:s,target:"shape"});return}const i=this.editor.getSelectedShapeIds(),o=this.editor.getOnlySelectedShape(),{inputs:{currentPagePoint:a}}=this.editor;if((i.length>1||o&&!this.editor.getShapeUtil(o).hideSelectionBoundsBg(o))&&$7(this.editor,a)){this.onPointerDown({...n,target:"selection"});return}this.parent.transition("pointing_canvas",n);break}case"shape":{const{shape:s}=n;if(this.isOverArrowLabelTest(s)){this.parent.transition("pointing_arrow_label",n);break}if(this.editor.isShapeOrAncestorLocked(s)){this.parent.transition("pointing_canvas",n);break}this.parent.transition("pointing_shape",n);break}case"handle":{if(this.editor.getInstanceState().isReadonly)break;this.editor.inputs.altKey?this.parent.transition("pointing_shape",n):this.parent.transition("pointing_handle",n);break}case"selection":{switch(n.handle){case"mobile_rotate":case"top_left_rotate":case"top_right_rotate":case"bottom_left_rotate":case"bottom_right_rotate":{this.parent.transition("pointing_rotate_handle",n);break}case"top":case"right":case"bottom":case"left":case"top_left":case"top_right":case"bottom_left":case"bottom_right":{r?this.parent.transition("crop.pointing_crop_handle",n):this.parent.transition("pointing_resize_handle",n);break}default:{const s=this.editor.getHoveredShape();if(s&&!this.editor.getSelectedShapeIds().includes(s.id)&&!s.isLocked){this.onPointerDown({...n,shape:s,target:"shape"});return}this.parent.transition("pointing_selection",n)}}break}}});g(this,"onDoubleClick",n=>{var r,s,i,o;if(!(this.editor.inputs.shiftKey||n.phase!=="up"))switch(n.target){case"canvas":{const a=this.editor.getHoveredShape(),l=a&&!this.editor.isShapeOfType(a,"group")?a:this.editor.getSelectedShapeAtPoint(this.editor.inputs.currentPagePoint)??this.editor.getShapeAtPoint(this.editor.inputs.currentPagePoint,{margin:this.editor.options.hitTestMargin/this.editor.getZoomLevel(),hitInside:!1}),c=this.editor.getFocusedGroupId();if(l){if(this.editor.isShapeOfType(l,"group")){fg(this.editor);return}else{const u=this.editor.getShape(l.parentId);if(u&&this.editor.isShapeOfType(u,"group")&&!(c&&u.id===c)){fg(this.editor);return}}this.onDoubleClick({...n,shape:l,target:"shape"});return}this.editor.inputs.shiftKey||this.handleDoubleClickOnCanvas(n);break}case"selection":{if(this.editor.getInstanceState().isReadonly)break;const a=this.editor.getOnlySelectedShape();if(a){const l=this.editor.getShapeUtil(a);if(!this.canInteractWithShapeInReadOnly(a))return;if(n.handle==="right"||n.handle==="left"||n.handle==="top"||n.handle==="bottom"){const c=(r=l.onDoubleClickEdge)==null?void 0:r.call(l,a);if(c){this.editor.mark("double click edge"),this.editor.updateShapes([c]),ft(this.editor,[a.id]);return}}if(l.canCrop(a)&&!this.editor.isShapeOrAncestorLocked(a)){this.parent.transition("crop",n);return}this.shouldStartEditingShape(a)&&this.startEditingShape(a,n,!0)}break}case"shape":{const{shape:a}=n,l=this.editor.getShapeUtil(a);if(a.type!=="video"&&a.type!=="embed"&&this.editor.getInstanceState().isReadonly)break;if(l.onDoubleClick){const c=(s=l.onDoubleClick)==null?void 0:s.call(l,a);if(c){this.editor.updateShapes([c]);return}else if(l.canCrop(a)&&!this.editor.isShapeOrAncestorLocked(a)){this.editor.mark("select and crop"),this.editor.select((i=n.shape)==null?void 0:i.id),this.parent.transition("crop",n);return}}this.shouldStartEditingShape(a)?this.startEditingShape(a,n,!0):this.handleDoubleClickOnCanvas(n);break}case"handle":{if(this.editor.getInstanceState().isReadonly)break;const{shape:a,handle:l}=n,c=this.editor.getShapeUtil(a),u=(o=c.onDoubleClickHandle)==null?void 0:o.call(c,a,l);u?this.editor.updateShapes([u]):this.shouldStartEditingShape(a)&&this.startEditingShape(a,n,!0)}}});g(this,"onRightClick",n=>{switch(n.target){case"canvas":{const r=this.editor.getHoveredShape(),s=r&&!this.editor.isShapeOfType(r,"group")?r:this.editor.getShapeAtPoint(this.editor.inputs.currentPagePoint,{margin:this.editor.options.hitTestMargin/this.editor.getZoomLevel(),hitInside:!1,hitLabels:!0,hitLocked:!0,hitFrameInside:!1,renderingOnly:!0});if(s){this.onRightClick({...n,shape:s,target:"shape"});return}const i=this.editor.getSelectedShapeIds(),o=this.editor.getOnlySelectedShape(),{inputs:{currentPagePoint:a}}=this.editor;if((i.length>1||o&&!this.editor.getShapeUtil(o).hideSelectionBoundsBg(o))&&$7(this.editor,a)){this.onRightClick({...n,target:"selection"});return}this.editor.selectNone();break}case"shape":{const{selectedShapeIds:r}=this.editor.getCurrentPageState(),{shape:s}=n,i=this.editor.getOutermostSelectableShape(s,o=>!r.includes(o.id));!r.includes(i.id)&&!this.editor.findShapeAncestor(i,o=>r.includes(o.id))&&(this.editor.mark("selecting shape"),this.editor.setSelectedShapes([i.id]));break}}});g(this,"onCancel",()=>{this.editor.getFocusedGroupId()!==this.editor.getCurrentPageId()&&this.editor.getSelectedShapeIds().length>0?this.editor.popFocusedGroupId():(this.editor.mark("clearing selection"),this.editor.selectNone())});g(this,"onKeyDown",n=>{switch(n.code){case"ArrowLeft":case"ArrowRight":case"ArrowUp":case"ArrowDown":{this.nudgeSelectedShapes(!1);return}}if(Vt.editOnType.get()&&!Yte.includes(n.key)&&!n.altKey&&!n.ctrlKey){const r=this.editor.getOnlySelectedShape();if(r&&this.editor.isShapeOfType(r,"note")&&this.shouldStartEditingShape(r)){this.startEditingShape(r,{...n,target:"shape",shape:r},!0);return}}});g(this,"onKeyRepeat",n=>{switch(n.code){case"ArrowLeft":case"ArrowRight":case"ArrowUp":case"ArrowDown":{this.nudgeSelectedShapes(!0);break}}});g(this,"onKeyUp",n=>{switch(n.code){case"Enter":{const r=this.editor.getSelectedShapes();if(r.every(i=>this.editor.isShapeOfType(i,"group"))){this.editor.setSelectedShapes(r.flatMap(i=>this.editor.getSortedChildIdsForParent(i.id)));return}const s=this.editor.getOnlySelectedShape();if(s&&this.shouldStartEditingShape(s)){this.startEditingShape(s,{...n,target:"shape",shape:s},!0);return}F7(this.editor)&&this.parent.transition("crop",n);break}}});g(this,"isDarwin",window.navigator.userAgent.toLowerCase().indexOf("mac")>-1)}shouldStartEditingShape(n=this.editor.getOnlySelectedShape()){return!n||this.editor.isShapeOrAncestorLocked(n)&&n.type!=="embed"||!this.canInteractWithShapeInReadOnly(n)?!1:this.editor.getShapeUtil(n).canEdit(n)}startEditingShape(n,r,s){this.editor.isShapeOrAncestorLocked(n)&&n.type!=="embed"||(this.editor.mark("editing shape"),dg(this.editor,n,s),this.parent.transition("editing_shape",r))}isOverArrowLabelTest(n){if(!n)return!1;const r=this.editor.getPointInShapeSpace(n,this.editor.inputs.currentPagePoint);if(this.editor.isShapeOfType(n,"arrow")){const s=this.editor.getShapeGeometry(n).children[1];if(s&&Wr(r,s.vertices))return!0}return!1}handleDoubleClickOnCanvas(n){if(this.editor.getInstanceState().isReadonly)return;this.editor.mark("creating text shape");const r=ot(),{x:s,y:i}=this.editor.inputs.currentPagePoint;this.editor.createShapes([{id:r,type:"text",x:s,y:i,props:{text:"",autoSize:!0}}]);const o=this.editor.getShape(r);if(!o)return;const a=this.editor.getShapeUtil(o);this.editor.getInstanceState().isReadonly&&!a.canEditInReadOnly(o)||(this.editor.setEditingShape(r),this.editor.select(r),this.parent.transition("editing_shape",n))}nudgeSelectedShapes(n=!1){const{editor:{inputs:{keys:r}}}=this,s=r.has("ShiftLeft"),i=new b(0,0);if(r.has("ArrowLeft")&&(i.x-=1),r.has("ArrowRight")&&(i.x+=1),r.has("ArrowUp")&&(i.y-=1),r.has("ArrowDown")&&(i.y+=1),i.equals(new b(0,0)))return;n||this.editor.mark("nudge shapes");const{gridSize:o}=this.editor.getDocumentSettings(),a=this.editor.getInstanceState().isGridMode?s?o*Jte:o:s?Zte:Qte,l=this.editor.getSelectedShapeIds();this.editor.nudgeShapes(l,i.mul(a)),ft(this.editor,l)}canInteractWithShapeInReadOnly(n){return!!(!this.editor.getInstanceState().isReadonly||this.editor.getShapeUtil(n).canEditInReadOnly(n))}},g(kv,"id","idle"),kv);const Zte=10,Qte=1,Jte=5;function $7(t,e){const n=t.getSelectionRotatedPageBounds();if(!n)return!1;const r=t.getSelectionRotation();return r?Wr(e,n.corners.map(s=>b.RotWith(s,n.point,r))):n.containsPoint(e)}class YT extends Se{constructor(){super(...arguments);g(this,"shapeId","");g(this,"markId","");g(this,"wasAlreadySelected",!1);g(this,"didDrag",!1);g(this,"info",{});g(this,"onEnter",n=>{const{shape:r}=n;this.parent.setCurrentToolIdMask(n.onInteractionEnd),this.info=n,this.shapeId=r.id,this.didDrag=!1,this.wasAlreadySelected=this.editor.getOnlySelectedShapeId()===r.id,this.updateCursor();const i=this.editor.getShapeGeometry(r).children[1];if(!i)throw Error(`Expected to find an arrow label geometry for shape: ${r.id}`);const{currentPagePoint:o}=this.editor.inputs,a=this.editor.getPointInShapeSpace(r,o);this._labelDragOffset=b.Sub(i.center,a),this.markId="label-drag start",this.editor.mark(this.markId),this.editor.setSelectedShapes([this.shapeId])});g(this,"onExit",()=>{this.parent.setCurrentToolIdMask(void 0),this.editor.setCursor({type:"default",rotation:0})});g(this,"_labelDragOffset",new b(0,0));g(this,"onPointerMove",()=>{const{isDragging:n}=this.editor.inputs;if(!n)return;const r=this.editor.getShape(this.shapeId);if(!r)return;const s=li(this.editor,r),i=this.editor.getShapeGeometry(r),o=i.children[0],a=this.editor.getPointInShapeSpace(r,this.editor.inputs.currentPagePoint),l=o.nearestPoint(b.Add(a,this._labelDragOffset));let c;if(s.isStraight){const u=b.Dist(s.start.point,s.end.point);c=1-b.Dist(s.end.point,l)/u}else{const{_center:u,measure:h,angleEnd:p,angleStart:f}=i.children[0];c=H2(h,f,p,u.angle(l))}isNaN(c)&&(c=.5),this.didDrag=!0,this.editor.updateShape({id:r.id,type:r.type,props:{labelPosition:c}})});g(this,"onPointerUp",()=>{const n=this.editor.getShape(this.shapeId);n&&(this.didDrag||!this.wasAlreadySelected?this.complete():(this.editor.setEditingShape(n.id),this.editor.setCurrentTool("select.editing_shape")))});g(this,"onCancel",()=>{this.cancel()});g(this,"onComplete",()=>{this.cancel()});g(this,"onInterrupt",()=>{this.cancel()})}updateCursor(){this.editor.setCursor({type:"grabbing",rotation:0})}complete(){this.info.onInteractionEnd?this.editor.setCurrentTool(this.info.onInteractionEnd,{}):this.parent.transition("idle")}cancel(){this.editor.bailToMark(this.markId),this.info.onInteractionEnd?this.editor.setCurrentTool(this.info.onInteractionEnd,{}):this.parent.transition("idle")}}g(YT,"id","pointing_arrow_label");class XT extends Se{constructor(){super(...arguments);g(this,"onEnter",()=>{const{inputs:n}=this.editor;n.shiftKey||this.editor.getSelectedShapeIds().length>0&&(this.editor.mark("selecting none"),this.editor.selectNone())});g(this,"onPointerMove",n=>{this.editor.inputs.isDragging&&this.parent.transition("brushing",n)});g(this,"onPointerUp",()=>{fg(this.editor),this.complete()});g(this,"onComplete",()=>{this.complete()});g(this,"onInterrupt",()=>{this.parent.transition("idle")})}complete(){this.parent.transition("idle")}}g(XT,"id","pointing_canvas");class ZT extends Se{constructor(){super(...arguments);g(this,"info",{});g(this,"onEnter",n=>{this.info=n;const{shape:r}=n;if(this.editor.isShapeOfType(r,"arrow")){const s=vr(this.editor,r)[n.handle.id];s&&this.editor.setHintingShapes([s.toId])}this.editor.setCursor({type:"grabbing",rotation:0})});g(this,"onExit",()=>{this.editor.setHintingShapes([]),this.editor.setCursor({type:"default",rotation:0})});g(this,"onPointerUp",()=>{const{shape:n,handle:r}=this.info;if(this.editor.isShapeOfType(n,"note")){const{editor:s}=this,i=B7(s,n,r,!1);if(i){dg(s,i,!0);return}}this.parent.transition("idle",this.info)});g(this,"onPointerMove",()=>{const{editor:n}=this;n.inputs.isDragging&&this.startDraggingHandle()});g(this,"onLongPress",()=>{this.startDraggingHandle()});g(this,"onCancel",()=>{this.cancel()});g(this,"onComplete",()=>{this.cancel()});g(this,"onInterrupt",()=>{this.cancel()})}startDraggingHandle(){const{editor:n}=this;if(n.getInstanceState().isReadonly)return;const{shape:r,handle:s}=this.info;if(n.isShapeOfType(r,"note")){const i=B7(n,r,s,!0);if(i){const o=n.getPointInParentSpace(i,n.inputs.originPagePoint).sub(b.Rot(ym.clone().mul(r.props.scale),i.rotation));n.updateShape({...i,x:o.x,y:o.y}),n.setHoveredShape(i.id).select(i.id).setCurrentTool("select.translating",{...this.info,target:"shape",shape:n.getShape(i),onInteractionEnd:"note",isCreating:!0,onCreate:()=>{dg(n,i,!0)}});return}}this.parent.transition("dragging_handle",this.info)}cancel(){this.parent.transition("idle")}}g(ZT,"id","pointing_handle");function B7(t,e,n,r){const s=t.getShapePageTransform(e.id),i=s.point(),o=s.rotation(),l=pT(t,i,o,e.props.growY,0,e.props.scale)[n.index];if(l)return gT(t,e,l,o,r)}class QT extends Se{constructor(){super(...arguments);g(this,"info",{});g(this,"onEnter",n=>{this.parent.setCurrentToolIdMask(n.onInteractionEnd),this.info=n,this.updateCursor()});g(this,"onExit",()=>{this.parent.setCurrentToolIdMask(void 0),this.editor.setCursor({type:"default",rotation:0})});g(this,"onPointerMove",()=>{this.editor.inputs.isDragging&&this.startRotating()});g(this,"onLongPress",()=>{this.startRotating()});g(this,"onPointerUp",()=>{this.complete()});g(this,"onCancel",()=>{this.cancel()});g(this,"onComplete",()=>{this.cancel()});g(this,"onInterrupt",()=>{this.cancel()})}updateCursor(){this.editor.setCursor({type:zc[this.info.handle],rotation:this.editor.getSelectionRotation()})}startRotating(){this.editor.getInstanceState().isReadonly||this.parent.transition("rotating",this.info)}complete(){this.info.onInteractionEnd?this.editor.setCurrentTool(this.info.onInteractionEnd,{}):this.parent.transition("idle")}cancel(){this.info.onInteractionEnd?this.editor.setCurrentTool(this.info.onInteractionEnd,{}):this.parent.transition("idle")}}g(QT,"id","pointing_rotate_handle");class JT extends Se{constructor(){super(...arguments);g(this,"info",{});g(this,"onEnter",n=>{this.info=n});g(this,"onPointerUp",n=>{fg(this.editor),this.parent.transition("idle",n)});g(this,"onPointerMove",n=>{this.editor.inputs.isDragging&&this.startTranslating(n)});g(this,"onLongPress",n=>{this.startTranslating(n)});g(this,"onDoubleClick",n=>{var i,o;const r=this.editor.getHoveredShape(),s=r&&!this.editor.isShapeOfType(r,"group")?r:this.editor.getShapeAtPoint(this.editor.inputs.currentPagePoint,{hitInside:!0,margin:0,renderingOnly:!0});if(s){this.parent.transition("idle"),(o=(i=this.parent).onDoubleClick)==null||o.call(i,{...n,target:"shape",shape:this.editor.getShape(s)});return}});g(this,"onCancel",()=>{this.cancel()});g(this,"onComplete",()=>{this.cancel()});g(this,"onInterrupt",()=>{this.cancel()})}startTranslating(n){this.editor.getInstanceState().isReadonly||this.parent.transition("translating",n)}cancel(){this.parent.transition("idle")}}g(JT,"id","pointing_selection");class eM extends Se{constructor(){super(...arguments);g(this,"hitShape",{});g(this,"hitShapeForPointerUp",{});g(this,"isDoubleClick",!1);g(this,"didSelectOnEnter",!1);g(this,"onEnter",n=>{const r=this.editor.getSelectedShapeIds(),s=this.editor.getSelectionRotatedPageBounds(),i=this.editor.getFocusedGroupId(),{inputs:{currentPagePoint:o,shiftKey:a,altKey:l}}=this.editor;this.hitShape=n.shape,this.isDoubleClick=!1;const c=this.editor.getOutermostSelectableShape(n.shape),u=this.editor.findShapeAncestor(c,h=>r.includes(h.id));if(this.editor.getShapeUtil(n.shape).onClick||c.id===i||r.includes(c.id)||u||r.length>1&&(s!=null&&s.containsPoint(o))){this.didSelectOnEnter=!1,this.hitShapeForPointerUp=c;return}this.didSelectOnEnter=!0,a&&!l?(this.editor.cancelDoubleClick(),r.includes(c.id)||(this.editor.mark("shift selecting shape"),this.editor.setSelectedShapes([...r,c.id]))):(this.editor.mark("selecting shape"),this.editor.setSelectedShapes([c.id]))});g(this,"onPointerUp",n=>{var u;const r=this.editor.getSelectedShapeIds(),s=this.editor.getFocusedGroupId(),i=this.editor.getZoomLevel(),{inputs:{currentPagePoint:o,shiftKey:a}}=this.editor,l=this.editor.getShapeAtPoint(o,{margin:this.editor.options.hitTestMargin/i,hitInside:!0,renderingOnly:!0})??this.hitShape,c=l?this.editor.getOutermostSelectableShape(l):this.hitShapeForPointerUp;if(c){const h=this.editor.getShapeUtil(c);if(h.onClick){const p=(u=h.onClick)==null?void 0:u.call(h,c);if(p){this.editor.mark("shape on click"),this.editor.updateShapes([p]),this.parent.transition("idle",n);return}}if(c.id===s){r.length>0?(this.editor.mark("clearing shape ids"),this.editor.setSelectedShapes([])):this.editor.popFocusedGroupId(),this.parent.transition("idle",n);return}}if(!this.didSelectOnEnter){const h=this.editor.getOutermostSelectableShape(l,p=>!r.includes(p.id));if(r.includes(h.id))if(a)this.editor.mark("deselecting on pointer up"),this.editor.deselect(c);else if(r.includes(c.id)){if(r.length===1){const p=this.editor.getShapeUtil(c).getGeometry(c),f=VT(p),v=f.length===1?f[0]:void 0;if(v){const m=this.editor.getPointInShapeSpace(c,o);if(v.bounds.containsPoint(m,0)&&v.hitTestPoint(m)){this.editor.run(()=>{this.editor.mark("editing on pointer up"),this.editor.select(c.id);const x=this.editor.getShapeUtil(c);this.editor.getInstanceState().isReadonly&&!x.canEditInReadOnly(c)||(this.editor.setEditingShape(c.id),this.editor.setCurrentTool("select.editing_shape"),this.isDoubleClick&&this.editor.emit("select-all-text",{shapeId:c.id}))});return}}}this.editor.mark("selecting on pointer up"),this.editor.select(c.id)}else this.editor.mark("selecting on pointer up"),this.editor.select(c);else if(a){const p=this.editor.getShapeAncestors(h);this.editor.mark("shift deselecting on pointer up"),this.editor.setSelectedShapes([...this.editor.getSelectedShapeIds().filter(f=>!p.find(v=>v.id===f)),h.id])}else this.editor.mark("selecting on pointer up"),this.editor.setSelectedShapes([h.id])}this.parent.transition("idle",n)});g(this,"onDoubleClick",()=>{this.isDoubleClick=!0});g(this,"onPointerMove",n=>{this.editor.inputs.isDragging&&this.startTranslating(n)});g(this,"onLongPress",n=>{this.startTranslating(n)});g(this,"onCancel",()=>{this.cancel()});g(this,"onComplete",()=>{this.cancel()});g(this,"onInterrupt",()=>{this.cancel()})}startTranslating(n){this.editor.getInstanceState().isReadonly||(this.editor.focus(),this.parent.transition("translating",n))}cancel(){this.parent.transition("idle")}}g(eM,"id","pointing_shape");class tM extends Se{constructor(){super(...arguments);g(this,"info",{});g(this,"markId","");g(this,"didHoldCommand",!1);g(this,"creationCursorOffset",{x:0,y:0});g(this,"snapshot",{});g(this,"onEnter",n=>{const{isCreating:r=!1,creationCursorOffset:s={x:0,y:0}}=n;this.info=n,this.didHoldCommand=!1,this.parent.setCurrentToolIdMask(n.onInteractionEnd),this.creationCursorOffset=s,this.snapshot=this._createSnapshot(),r?(this.markId=`creating:${this.editor.getOnlySelectedShape().id}`,this.editor.setCursor({type:"cross",rotation:0})):(this.markId="starting resizing",this.editor.mark(this.markId)),this.handleResizeStart(),this.updateShapes()});g(this,"onTick",({elapsed:n})=>{const{editor:r}=this;r.edgeScrollManager.updateEdgeScrolling(n)});g(this,"onPointerMove",()=>{this.updateShapes()});g(this,"onKeyDown",()=>{this.updateShapes()});g(this,"onKeyUp",()=>{this.updateShapes()});g(this,"onPointerUp",()=>{this.complete()});g(this,"onComplete",()=>{this.complete()});g(this,"onCancel",()=>{this.cancel()});g(this,"onExit",()=>{this.parent.setCurrentToolIdMask(void 0),this.editor.setCursor({type:"default",rotation:0}),this.editor.snaps.clearIndicators()});g(this,"_createSnapshot",()=>{const n=this.editor.getSelectedShapeIds(),r=this.editor.getSelectionRotation(),{inputs:{originPagePoint:s}}=this.editor,i=this.editor.getSelectionRotatedPageBounds(),o=b.RotWith(i.getHandlePoint(this.info.handle),i.point,r),a=b.Sub(s,o),l=new Map,c=[];n.forEach(h=>{const p=this.editor.getShape(h);if(p){if(p.type==="frame"&&c.push({id:h,children:Le(this.editor.getSortedChildIdsForParent(p).map(f=>this.editor.getShape(f)))}),l.set(p.id,this._createShapeSnapshot(p)),this.editor.isShapeOfType(p,"frame")&&n.length===1)return;this.editor.visitDescendants(p.id,f=>{const v=this.editor.getShape(f);if(v&&(l.set(v.id,this._createShapeSnapshot(v)),this.editor.isShapeOfType(v,"frame")))return!1})}});const u=![...l.values()].some(h=>!YI(h.pageRotation,r)||h.isAspectRatioLocked);return{shapeSnapshots:l,selectionBounds:i,cursorHandleOffset:a,selectionRotation:r,selectedShapeIds:n,canShapesDeform:u,initialSelectionPageBounds:this.editor.getSelectionPageBounds(),frames:c}});g(this,"_createShapeSnapshot",n=>{const r=this.editor.getShapePageTransform(n),s=this.editor.getShapeUtil(n);return{shape:n,bounds:this.editor.getShapeGeometry(n).bounds,pageTransform:r,pageRotation:xe.Decompose(r).rotation,isAspectRatioLocked:s.isAspectRatioLocked(n)}})}cancel(){this.editor.bailToMark(this.markId),this.info.onInteractionEnd?this.editor.setCurrentTool(this.info.onInteractionEnd,{}):this.parent.transition("idle")}complete(){var n,r;if(ft(this.editor,this.snapshot.selectedShapeIds),this.handleResizeEnd(),this.info.isCreating&&this.info.onCreate){(r=(n=this.info).onCreate)==null||r.call(n,this.editor.getOnlySelectedShape());return}if(this.editor.getInstanceState().isToolLocked&&this.info.onInteractionEnd){this.editor.setCurrentTool(this.info.onInteractionEnd,{});return}this.parent.transition("idle")}handleResizeStart(){const{shapeSnapshots:n}=this.snapshot,r=[];n.forEach(({shape:s})=>{var a;const i=this.editor.getShapeUtil(s),o=(a=i.onResizeStart)==null?void 0:a.call(i,s);o&&r.push(o)}),r.length>0&&this.editor.updateShapes(r)}handleResizeEnd(){const{shapeSnapshots:n}=this.snapshot,r=[];n.forEach(({shape:s})=>{var l;const i=this.editor.getShape(s.id),o=this.editor.getShapeUtil(s),a=(l=o.onResizeEnd)==null?void 0:l.call(o,s,i);a&&r.push(a)}),r.length>0&&this.editor.updateShapes(r)}updateShapes(){const{altKey:n,shiftKey:r}=this.editor.inputs,{frames:s,shapeSnapshots:i,selectionBounds:o,cursorHandleOffset:a,selectedShapeIds:l,selectionRotation:c,canShapesDeform:u}=this.snapshot;let h=r||!u;if(i.size===1){const _=[...i.values()][0];this.editor.isShapeOfType(_.shape,"text")&&(h=!(this.info.handle==="left"||this.info.handle==="right"))}const{ctrlKey:p}=this.editor.inputs,f=this.editor.inputs.currentPagePoint.clone().sub(a).sub(this.creationCursorOffset),v=this.editor.inputs.originPagePoint.clone().sub(a);if(this.editor.getInstanceState().isGridMode&&!p){const{gridSize:_}=this.editor.getDocumentSettings();f.snapToGrid(_)}const m=this.info.handle,x=U7(m,Math.PI);if(this.editor.snaps.clearIndicators(),(this.editor.user.getIsSnapMode()?!p:p)&&c%vt===0){const{nudge:_}=this.editor.snaps.shapeBounds.snapResizeShapes({dragDelta:b.Sub(f,v),initialSelectionPageBounds:this.snapshot.initialSelectionPageBounds,handle:U7(m,c),isAspectRatioLocked:h,isResizingFromCenter:n});f.add(_)}const S=b.RotWith(n?o.center:o.getHandlePoint(x),o.point,c),w=b.Sub(f,S).rot(-c),P=b.Sub(v,S).rot(-c),E=b.DivV(w,P);Number.isFinite(E.x)||(E.x=1),Number.isFinite(E.y)||(E.y=1);const M=m==="top"||m==="bottom",I=m==="left"||m==="right";h?I?E.y=Math.abs(E.x):M?E.x=Math.abs(E.y):Math.abs(E.x)>Math.abs(E.y)?E.y=Math.abs(E.x)*(E.y<0?-1:1):E.x=Math.abs(E.y)*(E.x<0?-1:1):(M&&(E.x=1),I&&(E.y=1)),this.info.isCreating||this.updateCursor({dragHandle:m,isFlippedX:E.x<0,isFlippedY:E.y<0,rotation:c});for(const _ of i.keys()){const D=i.get(_);this.editor.resizeShape(_,E,{initialShape:D.shape,initialBounds:D.bounds,initialPageTransform:D.pageTransform,dragHandle:m,mode:l.length===1&&_===l[0]?"resize_bounds":"scale_shape",scaleOrigin:S,isAspectRatioLocked:h,scaleAxisRotation:c,skipStartAndEndCallbacks:!0})}if(this.editor.inputs.ctrlKey){this.didHoldCommand=!0;for(const{id:_,children:D}of s){if(!D.length)continue;const R=i.get(_).shape,$=this.editor.getShape(_);if(!(R&&$))continue;const U=$.x-R.x,O=$.y-R.y,N=new b(U,O).rot(-R.rotation);if(N.x!==0||N.y!==0)for(const H of D)this.editor.updateShape({id:H.id,type:H.type,x:H.x-N.x,y:H.y-N.y})}}else if(this.didHoldCommand){this.didHoldCommand=!1;for(const{children:_}of s)if(_.length)for(const D of _)this.editor.updateShape({id:D.id,type:D.type,x:D.x,y:D.y})}}updateCursor({dragHandle:n,isFlippedX:r,isFlippedY:s,rotation:i}){const o={...this.editor.getInstanceState().cursor};switch(n){case"top_left":case"bottom_right":{o.type="nwse-resize",r!==s&&(o.type="nesw-resize");break}case"top_right":case"bottom_left":{o.type="nesw-resize",r!==s&&(o.type="nwse-resize");break}}o.rotation=i,this.editor.setCursor(o)}}g(tM,"id","resizing");const Ey=["top","top_right","right","bottom_right","bottom","bottom_left","left","top_left"];function U7(t,e){e=e%it;const n=Math.round(e/(Qe/4)),r=Ey.indexOf(t);return Ey[(r+n)%Ey.length]}const H7=Math.PI/180;class nM extends Se{constructor(){super(...arguments);g(this,"snapshot",{});g(this,"info",{});g(this,"markId","");g(this,"onEnter",n=>{this.info=n,this.parent.setCurrentToolIdMask(n.onInteractionEnd),this.markId="rotate start",this.editor.mark(this.markId);const r=zE({editor:this.editor});if(!r)return this.parent.transition("idle",this.info);this.snapshot=r;const s=this._getRotationFromPointerPosition({snapToNearestDegree:!1});Rp({editor:this.editor,delta:this._getRotationFromPointerPosition({snapToNearestDegree:!1}),snapshot:this.snapshot,stage:"start"}),this.editor.setCursor({type:zc[this.info.handle],rotation:s+this.snapshot.initialSelectionRotation})});g(this,"onExit",()=>{this.editor.setCursor({type:"default",rotation:0}),this.parent.setCurrentToolIdMask(void 0),this.snapshot={}});g(this,"onPointerMove",()=>{this.update()});g(this,"onKeyDown",()=>{this.update()});g(this,"onKeyUp",()=>{this.update()});g(this,"onPointerUp",()=>{this.complete()});g(this,"onComplete",()=>{this.complete()});g(this,"onCancel",()=>{this.cancel()});g(this,"update",()=>{const n=this._getRotationFromPointerPosition({snapToNearestDegree:!1});Rp({editor:this.editor,delta:n,snapshot:this.snapshot,stage:"update"}),this.editor.setCursor({type:zc[this.info.handle],rotation:n+this.snapshot.initialSelectionRotation})});g(this,"cancel",()=>{this.editor.bailToMark(this.markId),this.info.onInteractionEnd?this.editor.setCurrentTool(this.info.onInteractionEnd,this.info):this.parent.transition("idle",this.info)});g(this,"complete",()=>{Rp({editor:this.editor,delta:this._getRotationFromPointerPosition({snapToNearestDegree:!0}),snapshot:this.snapshot,stage:"end"}),ft(this.editor,this.snapshot.shapeSnapshots.map(n=>n.shape.id)),this.info.onInteractionEnd?this.editor.setCurrentTool(this.info.onInteractionEnd,this.info):this.parent.transition("idle",this.info)})}_getRotationFromPointerPosition({snapToNearestDegree:n}){const r=this.editor.getSelectionRotation(),s=this.editor.getSelectionRotatedPageBounds(),{inputs:{shiftKey:i,currentPagePoint:o}}=this.editor,{initialCursorAngle:a,initialSelectionRotation:l}=this.snapshot;if(!s)return l;const u=s.center.clone().rotWith(s.point,r).angle(o)-a;let h=l+u;if(i)h=sg(h,24);else if(n&&(h=Math.round(h/H7)*H7,this.editor.getInstanceState().isCoarsePointer)){const p=sg(h,4),f=Ap(h,p);Math.abs(f)<Sq(5)&&(h=p)}return h-l}}g(nM,"id","rotating");class rM extends Se{constructor(){super(...arguments);g(this,"hits",new Set);g(this,"size",0);g(this,"scribbleId","id");g(this,"initialSelectedShapeIds",new Set);g(this,"newlySelectedShapeIds",new Set);g(this,"onEnter",()=>{this.initialSelectedShapeIds=new Set(this.editor.inputs.shiftKey?this.editor.getSelectedShapeIds():[]),this.newlySelectedShapeIds=new Set,this.size=0,this.hits.clear();const n=this.editor.scribbles.addScribble({color:"selection-stroke",opacity:.32,size:12});this.scribbleId=n.id,this.updateScribbleSelection(!0),this.editor.updateInstanceState({brush:null})});g(this,"onExit",()=>{this.editor.scribbles.stop(this.scribbleId)});g(this,"onPointerMove",()=>{this.updateScribbleSelection(!0)});g(this,"onPointerUp",()=>{this.complete()});g(this,"onKeyDown",()=>{this.updateScribbleSelection(!1)});g(this,"onKeyUp",()=>{this.editor.inputs.altKey?this.updateScribbleSelection(!1):this.parent.transition("brushing")});g(this,"onCancel",()=>{this.cancel()});g(this,"onComplete",()=>{this.complete()});g(this,"pushPointToScribble",()=>{const{x:n,y:r}=this.editor.inputs.currentPagePoint;this.editor.scribbles.addPoint(this.scribbleId,n,r)})}updateScribbleSelection(n){const{editor:r}=this,s=this.editor.getCurrentPageShapes(),{inputs:{shiftKey:i,originPagePoint:o,previousPagePoint:a,currentPagePoint:l}}=this.editor,{newlySelectedShapeIds:c,initialSelectedShapeIds:u}=this;n&&this.pushPointToScribble();const h=s;let p,f,v,m;const x=0;for(let w=0,P=h.length;w<P;w++){if(p=h[w],r.isShapeOfType(p,"group")||c.has(p.id)||r.isShapeOrAncestorLocked(p)||(f=r.getShapeGeometry(p),r.isShapeOfType(p,"frame")&&f.bounds.containsPoint(r.getPointInShapeSpace(p,o))))continue;const E=r.getShapePageTransform(p);if(!f||!E)continue;const M=E.clone().invert();v=M.applyToPoint(a),m=M.applyToPoint(l);const{bounds:I}=f;if(!(I.minX-x>Math.max(v.x,m.x)||I.minY-x>Math.max(v.y,m.y)||I.maxX+x<Math.min(v.x,m.x)||I.maxY+x<Math.min(v.y,m.y))&&f.hitTestLineSegment(v,m,x)){const _=this.editor.getOutermostSelectableShape(p),D=this.editor.getShapeMask(_.id);if(D&&L4(a,l,D)!==null&&!Wr(l,D))continue;c.add(_.id)}}const y=r.getSelectedShapeIds(),S=new Set(i?[...c,...u]:[...c]);(y.length!==S.size||y.some(w=>!S.has(w)))&&this.editor.setSelectedShapes(Array.from(S))}complete(){this.updateScribbleSelection(!0),this.parent.transition("idle")}cancel(){this.editor.setSelectedShapes([...this.initialSelectedShapeIds]),this.parent.transition("idle")}}g(rM,"id","scribble_brushing");const ene=20,tne=100;class nne{constructor(e){g(this,"prevDroppingShapeId",null);g(this,"droppingNodeTimer",null);g(this,"first",!0);g(this,"dispose",()=>{this.clear()});this.editor=e,e.disposables.add(this.dispose)}updateDroppingNode(e,n){var r;this.first&&(this.editor.setHintingShapes(e.map(s=>this.editor.findShapeAncestor(s,i=>i.type!=="group")).filter(s=>s)),this.prevDroppingShapeId=((r=this.editor.getDroppingOverShape(this.editor.inputs.originPagePoint,e))==null?void 0:r.id)??null,this.first=!1),this.droppingNodeTimer===null?this.setDragTimer(e,ene,n):this.editor.inputs.pointerVelocity.len()>.5&&(clearTimeout(this.droppingNodeTimer),this.setDragTimer(e,tne,n))}setDragTimer(e,n,r){this.droppingNodeTimer=this.editor.timers.setTimeout(()=>{this.editor.run(()=>{this.handleDrag(this.editor.inputs.currentPagePoint,e,r)}),this.droppingNodeTimer=null},n)}handleDrag(e,n,r){var l,c,u,h,p;n=Le(n.map(f=>this.editor.getShape(f.id)));const s=((l=this.editor.getDroppingOverShape(e,n))==null?void 0:l.id)??null;if(s===this.prevDroppingShapeId){this.hintParents(n);return}const{prevDroppingShapeId:i}=this,o=i&&this.editor.getShape(i),a=s&&this.editor.getShape(s);o&&((u=(c=this.editor.getShapeUtil(o)).onDragShapesOut)==null||u.call(c,o,n)),a&&((p=(h=this.editor.getShapeUtil(a)).onDragShapesOver)==null||p.call(h,a,n)),this.hintParents(n),r==null||r(),this.prevDroppingShapeId=s}hintParents(e){const n=new Map;for(const s of e){const i=this.editor.findShapeAncestor(s,o=>o.type!=="group");i&&(n.has(i.id)||n.set(i.id,[]),n.get(i.id).push(s.id))}const r=[];for(const[s,i]of n){const o=this.editor.getShape(s);o&&uT(this.editor,o).length<i.length&&r.push(o.id)}this.editor.setHintingShapes(r)}dropShapes(e){var r,s;const{prevDroppingShapeId:n}=this;if(this.handleDrag(this.editor.inputs.currentPagePoint,e),n){const i=this.editor.getShape(n);if(!i)return;(s=(r=this.editor.getShapeUtil(i)).onDropShapesOver)==null||s.call(r,i,e)}}clear(){this.prevDroppingShapeId=null,this.droppingNodeTimer!==null&&clearTimeout(this.droppingNodeTimer),this.droppingNodeTimer=null,this.editor.setHintingShapes([]),this.first=!0}}class sM extends Se{constructor(){super(...arguments);g(this,"info",{});g(this,"selectionSnapshot",{});g(this,"snapshot",{});g(this,"markId","");g(this,"isCloning",!1);g(this,"isCreating",!1);g(this,"onCreate",()=>{});g(this,"dragAndDropManager",new nne(this.editor));g(this,"onEnter",n=>{var i;const{isCreating:r=!1,onCreate:s=()=>{}}=n;if(!((i=this.editor.getSelectedShapeIds())!=null&&i.length)){this.parent.transition("idle");return}if(this.info=n,this.parent.setCurrentToolIdMask(n.onInteractionEnd),this.isCreating=r,this.onCreate=s,r?this.markId=`creating:${this.editor.getOnlySelectedShape().id}`:(this.markId="translating",this.editor.mark(this.markId)),this.isCloning=!1,this.info=n,this.editor.setCursor({type:"move",rotation:0}),this.selectionSnapshot=W7(this.editor),!this.isCreating&&this.editor.inputs.altKey){this.startCloning();return}this.snapshot=this.selectionSnapshot,this.handleStart(),this.updateShapes()});g(this,"onExit",()=>{this.parent.setCurrentToolIdMask(void 0),this.selectionSnapshot={},this.snapshot={},this.editor.snaps.clearIndicators(),this.editor.setCursor({type:"default",rotation:0}),this.dragAndDropManager.clear()});g(this,"onTick",({elapsed:n})=>{const{editor:r}=this;this.dragAndDropManager.updateDroppingNode(this.snapshot.movingShapes,this.updateParentTransforms),r.edgeScrollManager.updateEdgeScrolling(n)});g(this,"onPointerMove",()=>{this.updateShapes()});g(this,"onKeyDown",()=>{if(this.editor.inputs.altKey&&!this.isCloning){this.startCloning();return}this.updateShapes()});g(this,"onKeyUp",()=>{if(!this.editor.inputs.altKey&&this.isCloning){this.stopCloning();return}this.updateShapes()});g(this,"onPointerUp",()=>{this.complete()});g(this,"onComplete",()=>{this.complete()});g(this,"onCancel",()=>{this.cancel()});g(this,"updateParentTransforms",()=>{const{editor:n,snapshot:{shapeSnapshots:r}}=this;r.forEach(s=>{const i=n.getShape(s.shape.id);if(!i)return null;const o=dr(i.parentId)?null:xe.Inverse(n.getShapePageTransform(i.parentId));s.parentTransform=o})})}startCloning(){this.isCreating||(this.isCloning=!0,this.reset(),this.markId="translating",this.editor.mark(this.markId),this.editor.duplicateShapes(Array.from(this.editor.getSelectedShapeIds())),this.snapshot=W7(this.editor),this.handleStart(),this.updateShapes())}stopCloning(){this.isCloning=!1,this.snapshot=this.selectionSnapshot,this.reset(),this.markId="translating",this.editor.mark(this.markId),this.updateShapes()}reset(){this.editor.bailToMark(this.markId)}complete(){var n;this.updateShapes(),this.dragAndDropManager.dropShapes(this.snapshot.movingShapes),ft(this.editor,this.snapshot.movingShapes.map(r=>r.id)),this.handleEnd(),this.editor.getInstanceState().isToolLocked&&this.info.onInteractionEnd?this.editor.setCurrentTool(this.info.onInteractionEnd):this.isCreating?(n=this.onCreate)==null||n.call(this,this.editor.getOnlySelectedShape()):this.parent.transition("idle")}cancel(){this.reset(),this.info.onInteractionEnd?this.editor.setCurrentTool(this.info.onInteractionEnd):this.parent.transition("idle",this.info)}handleStart(){const{movingShapes:n}=this.snapshot,r=[];n.forEach(s=>{var a;const i=this.editor.getShapeUtil(s),o=(a=i.onTranslateStart)==null?void 0:a.call(i,s);o&&r.push(o)}),r.length>0&&this.editor.updateShapes(r),this.editor.setHoveredShape(null)}handleEnd(){const{movingShapes:n}=this.snapshot;if(this.isCloning&&n.length>0){const s=b.Average(n.map(o=>this.editor.getShapePageTransform(o.id).point())),i=b.Sub(s,this.selectionSnapshot.averagePagePoint);b.IsNaN(i)||this.editor.updateInstanceState({duplicateProps:{shapeIds:n.map(o=>o.id),offset:{x:i.x,y:i.y}}})}const r=[];n.forEach(s=>{var l;const i=this.editor.getShape(s.id),o=this.editor.getShapeUtil(s),a=(l=o.onTranslateEnd)==null?void 0:l.call(o,s,i);a&&r.push(a)}),r.length>0&&this.editor.updateShapes(r)}updateShapes(){const{snapshot:n}=this;this.dragAndDropManager.updateDroppingNode(n.movingShapes,this.updateParentTransforms),rne({editor:this.editor,snapshot:n});const{movingShapes:r}=n,s=[];r.forEach(i=>{var c;const o=this.editor.getShape(i.id),a=this.editor.getShapeUtil(i),l=(c=a.onTranslate)==null?void 0:c.call(a,i,o);l&&s.push(l)}),s.length>0&&this.editor.updateShapes(s)}}g(sM,"id","translating");function W7(t){var h;const e=[],n=[],r=t.getSelectedShapeIds(),s=Le(r.map(p=>{const f=t.getShape(p);if(!f)return null;e.push(f);const v=t.getShapePageTransform(p),m=v.point(),x=v.rotation();n.push(m);const y=io.isId(f.parentId)?null:xe.Inverse(t.getShapePageTransform(f.parentId));return{shape:f,pagePoint:m,pageRotation:x,parentTransform:y}})),i=t.getOnlySelectedShape();let o=[];if(i)o=t.snaps.shapeBounds.getSnapPoints(i.id);else{const p=t.getSelectionPageBounds();p&&(o=p.cornersAndCenter.map((f,v)=>({id:"selection:"+v,x:f.x,y:f.y})))}let a,l;const{originPagePoint:c}=t.inputs,u=s.filter(p=>t.isShapeOfType(p.shape,"note")&&t.isPointInShape(p.shape,c));if(u.length!==0)if(u.length===1)l=u[0];else{const p=t.getCurrentPageShapesSorted();l=(h=u.map(f=>({snapshot:f,index:p.findIndex(v=>v.id===f.shape.id)})).sort((f,v)=>v.index-f.index)[0])==null?void 0:h.snapshot}return l&&(a=fT(t,l.pageRotation,l.shape.props.scale,l.shape.props.growY??0)),{averagePagePoint:b.Average(n),movingShapes:e,shapeSnapshots:s,initialPageBounds:t.getSelectionPageBounds(),initialSnapPoints:o,noteAdjacentPositions:a,noteSnapshot:l}}function rne({editor:t,snapshot:e}){const{inputs:n}=t,{noteSnapshot:r,noteAdjacentPositions:s,initialPageBounds:i,initialSnapPoints:o,shapeSnapshots:a,averagePagePoint:l}=e,c=t.getInstanceState().isGridMode,u=t.getDocumentSettings().gridSize,h=b.Sub(n.currentPagePoint,n.originPagePoint),p=t.inputs.shiftKey?Math.abs(h.x)<Math.abs(h.y)?"x":"y":null;if(p==="x"?h.x=0:p==="y"&&(h.y=0),t.snaps.clearIndicators(),(t.user.getIsSnapMode()?!n.ctrlKey:n.ctrlKey)&&t.inputs.pointerVelocity.len()<.5){const{nudge:x}=t.snaps.shapeBounds.snapTranslateShapes({dragDelta:h,initialSelectionPageBounds:i,lockedAxis:p,initialSelectionSnapPoints:o});h.add(x)}else if(r&&s){const{scale:x}=r.shape.props,y=r.pagePoint.clone().add(h).add(ym.clone().mul(x).rot(r.pageRotation));let S=hT/t.getZoomLevel(),w=new b(0,0);for(const P of s){const E=b.Sub(y,P),M=E.len();M<S&&(S=M,w=E)}h.sub(w)}const v=b.Add(l,h);c&&!n.ctrlKey&&v.snapToGrid(u);const m=b.Sub(v,l);t.updateShapes(Le(a.map(({shape:x,pagePoint:y,parentTransform:S})=>{const w=b.Add(y,m),P=S?xe.applyToPoint(S,w):w;return{id:x.id,type:x.type,x:P.x,y:P.y}})))}class td extends Se{constructor(){super(...arguments);g(this,"reactor");g(this,"cleanUpDuplicateProps",()=>{const n=this.editor.getSelectedShapeIds(),r=this.editor.getInstanceState();if(!r.duplicateProps)return;const s=new Set(r.duplicateProps.shapeIds);n.length===s.size&&n.every(i=>s.has(i))||this.editor.updateInstanceState({duplicateProps:null})});g(this,"onEnter",()=>{this.reactor=ba("clean duplicate props",()=>{try{this.cleanUpDuplicateProps()}catch(n){typeof process<"u",console.error(n)}})});g(this,"onExit",()=>{var n;(n=this.reactor)==null||n.call(this),this.editor.getCurrentPageState().editingShapeId&&this.editor.setEditingShape(null)})}}g(td,"id","select"),g(td,"initial","idle"),g(td,"isLockable",!1),g(td,"children",()=>[rf,sw,Xte,XT,eM,sM,$T,rM,iw,JT,BT,qT,tM,nM,QT,YT,ZT,GT]);class iM extends Se{constructor(){super(...arguments);g(this,"info",{});g(this,"onEnter",n=>{this.info=n});g(this,"onPointerDown",()=>{this.parent.transition("pointing",this.info)})}}g(iM,"id","idle");class oM extends Se{constructor(){super(...arguments);g(this,"info",{});g(this,"onEnter",n=>{this.info=n});g(this,"onPointerUp",()=>{this.complete()});g(this,"onPointerMove",()=>{this.editor.inputs.isDragging&&this.parent.transition("zoom_brushing",this.info)});g(this,"onCancel",()=>{this.cancel()})}complete(){const{currentScreenPoint:n}=this.editor.inputs;this.editor.inputs.altKey?this.editor.zoomOut(n,{animation:{duration:220}}):this.editor.zoomIn(n,{animation:{duration:220}}),this.parent.transition("idle",this.info)}cancel(){this.parent.transition("idle",this.info)}}g(oM,"id","pointing");class aM extends Se{constructor(){super(...arguments);g(this,"info",{});g(this,"zoomBrush",new fe);g(this,"onEnter",n=>{this.info=n,this.update()});g(this,"onExit",()=>{this.editor.updateInstanceState({zoomBrush:null})});g(this,"onPointerMove",()=>{this.update()});g(this,"onPointerUp",()=>{this.complete()});g(this,"onCancel",()=>{this.cancel()})}update(){const{inputs:{originPagePoint:n,currentPagePoint:r}}=this.editor;this.zoomBrush.setTo(fe.FromPoints([n,r])),this.editor.updateInstanceState({zoomBrush:this.zoomBrush.toJson()})}cancel(){this.parent.transition("idle",this.info)}complete(){const{zoomBrush:n}=this,r=8/this.editor.getZoomLevel();if(n.width<r&&n.height<r){const s=this.editor.inputs.currentScreenPoint;this.editor.inputs.altKey?this.editor.zoomOut(s,{animation:{duration:220}}):this.editor.zoomIn(s,{animation:{duration:220}})}else{const s=this.editor.inputs.altKey?this.editor.getZoomLevel()/2:void 0;this.editor.zoomToBounds(n,{targetZoom:s,animation:{duration:220}})}this.parent.transition("idle",this.info)}}g(aM,"id","zoom_brushing");class nd extends Se{constructor(){super(...arguments);g(this,"info",{});g(this,"onEnter",n=>{this.info=n,this.parent.setCurrentToolIdMask(n.onInteractionEnd),this.updateCursor()});g(this,"onExit",()=>{this.parent.setCurrentToolIdMask(void 0),this.editor.updateInstanceState({zoomBrush:null,cursor:{type:"default",rotation:0}}),this.parent.setCurrentToolIdMask(void 0)});g(this,"onKeyDown",()=>{this.updateCursor()});g(this,"onKeyUp",n=>{this.updateCursor(),n.code==="KeyZ"&&this.complete()});g(this,"onInterrupt",()=>{this.complete()})}complete(){this.info.onInteractionEnd&&this.info.onInteractionEnd!=="select"?this.editor.setCurrentTool(this.info.onInteractionEnd,this.info):this.parent.transition("select")}updateCursor(){this.editor.inputs.altKey?this.editor.setCursor({type:"zoom-out",rotation:0}):this.editor.setCursor({type:"zoom-in",rotation:0})}}g(nd,"id","zoom"),g(nd,"initial","idle"),g(nd,"children",()=>[iM,aM,oM]),g(nd,"isLockable",!1);const sne=[Qu,Ju,ed,nd,td];function ve(t,e,{checkForDefaultPrevented:n=!0}={}){return function(s){if(t==null||t(s),n===!1||!s.defaultPrevented)return e==null?void 0:e(s)}}function ine(t,e){typeof t=="function"?t(e):t!=null&&(t.current=e)}function bm(...t){return e=>t.forEach(n=>ine(n,e))}function xt(...t){return C.useCallback(bm(...t),t)}function one(t,e){const n=C.createContext(e);function r(i){const{children:o,...a}=i,l=C.useMemo(()=>a,Object.values(a));return d.jsx(n.Provider,{value:l,children:o})}function s(i){const o=C.useContext(n);if(o)return o;if(e!==void 0)return e;throw new Error(`\`${i}\` must be used within \`${t}\``)}return r.displayName=t+"Provider",[r,s]}function Ei(t,e=[]){let n=[];function r(i,o){const a=C.createContext(o),l=n.length;n=[...n,o];function c(h){const{scope:p,children:f,...v}=h,m=(p==null?void 0:p[t][l])||a,x=C.useMemo(()=>v,Object.values(v));return d.jsx(m.Provider,{value:x,children:f})}function u(h,p){const f=(p==null?void 0:p[t][l])||a,v=C.useContext(f);if(v)return v;if(o!==void 0)return o;throw new Error(`\`${h}\` must be used within \`${i}\``)}return c.displayName=i+"Provider",[c,u]}const s=()=>{const i=n.map(o=>C.createContext(o));return function(a){const l=(a==null?void 0:a[t])||i;return C.useMemo(()=>({[`__scope${t}`]:{...a,[t]:l}}),[a,l])}};return s.scopeName=t,[r,ane(s,...e)]}function ane(...t){const e=t[0];if(t.length===1)return e;const n=()=>{const r=t.map(s=>({useScope:s(),scopeName:s.scopeName}));return function(i){const o=r.reduce((a,{useScope:l,scopeName:c})=>{const h=l(i)[`__scope${c}`];return{...a,...h}},{});return C.useMemo(()=>({[`__scope${e.scopeName}`]:o}),[o])}};return n.scopeName=e.scopeName,n}var la=globalThis!=null&&globalThis.document?C.useLayoutEffect:()=>{},lne=jO.useId||(()=>{}),cne=0;function Zi(t){const[e,n]=C.useState(lne());return la(()=>{t||n(r=>r??String(cne++))},[t]),t||(e?`radix-${e}`:"")}function Mn(t){const e=C.useRef(t);return C.useEffect(()=>{e.current=t}),C.useMemo(()=>(...n)=>{var r;return(r=e.current)==null?void 0:r.call(e,...n)},[])}function Pa({prop:t,defaultProp:e,onChange:n=()=>{}}){const[r,s]=une({defaultProp:e,onChange:n}),i=t!==void 0,o=i?t:r,a=Mn(n),l=C.useCallback(c=>{if(i){const h=typeof c=="function"?c(t):c;h!==t&&a(h)}else s(c)},[i,t,s,a]);return[o,l]}function une({defaultProp:t,onChange:e}){const n=C.useState(t),[r]=n,s=C.useRef(r),i=Mn(e);return C.useEffect(()=>{s.current!==r&&(i(r),s.current=r)},[r,s,i]),n}var hl=C.forwardRef((t,e)=>{const{children:n,...r}=t,s=C.Children.toArray(n),i=s.find(hne);if(i){const o=i.props.children,a=s.map(l=>l===i?C.Children.count(o)>1?C.Children.only(null):C.isValidElement(o)?o.props.children:null:l);return d.jsx(uS,{...r,ref:e,children:C.isValidElement(o)?C.cloneElement(o,void 0,a):null})}return d.jsx(uS,{...r,ref:e,children:n})});hl.displayName="Slot";var uS=C.forwardRef((t,e)=>{const{children:n,...r}=t;if(C.isValidElement(n)){const s=fne(n);return C.cloneElement(n,{...pne(r,n.props),ref:e?bm(e,s):s})}return C.Children.count(n)>1?C.Children.only(null):null});uS.displayName="SlotClone";var dne=({children:t})=>d.jsx(d.Fragment,{children:t});function hne(t){return C.isValidElement(t)&&t.type===dne}function pne(t,e){const n={...e};for(const r in e){const s=t[r],i=e[r];/^on[A-Z]/.test(r)?s&&i?n[r]=(...a)=>{i(...a),s(...a)}:s&&(n[r]=s):r==="style"?n[r]={...s,...i}:r==="className"&&(n[r]=[s,i].filter(Boolean).join(" "))}return{...t,...n}}function fne(t){var r,s;let e=(r=Object.getOwnPropertyDescriptor(t.props,"ref"))==null?void 0:r.get,n=e&&"isReactWarning"in e&&e.isReactWarning;return n?t.ref:(e=(s=Object.getOwnPropertyDescriptor(t,"ref"))==null?void 0:s.get,n=e&&"isReactWarning"in e&&e.isReactWarning,n?t.props.ref:t.props.ref||t.ref)}var gne=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","span","svg","ul"],Ye=gne.reduce((t,e)=>{const n=C.forwardRef((r,s)=>{const{asChild:i,...o}=r,a=i?hl:e;return typeof window<"u"&&(window[Symbol.for("radix-ui")]=!0),d.jsx(a,{...o,ref:s})});return n.displayName=`Primitive.${e}`,{...t,[e]:n}},{});function ow(t,e){t&&xl.flushSync(()=>t.dispatchEvent(e))}function mne(t,e=globalThis==null?void 0:globalThis.document){const n=Mn(t);C.useEffect(()=>{const r=s=>{s.key==="Escape"&&n(s)};return e.addEventListener("keydown",r,{capture:!0}),()=>e.removeEventListener("keydown",r,{capture:!0})},[n,e])}var yne="DismissableLayer",dS="dismissableLayer.update",vne="dismissableLayer.pointerDownOutside",Sne="dismissableLayer.focusOutside",K7,lM=C.createContext({layers:new Set,layersWithOutsidePointerEventsDisabled:new Set,branches:new Set}),jh=C.forwardRef((t,e)=>{const{disableOutsidePointerEvents:n=!1,onEscapeKeyDown:r,onPointerDownOutside:s,onFocusOutside:i,onInteractOutside:o,onDismiss:a,...l}=t,c=C.useContext(lM),[u,h]=C.useState(null),p=(u==null?void 0:u.ownerDocument)??(globalThis==null?void 0:globalThis.document),[,f]=C.useState({}),v=xt(e,I=>h(I)),m=Array.from(c.layers),[x]=[...c.layersWithOutsidePointerEventsDisabled].slice(-1),y=m.indexOf(x),S=u?m.indexOf(u):-1,w=c.layersWithOutsidePointerEventsDisabled.size>0,P=S>=y,E=wne(I=>{const _=I.target,D=[...c.branches].some(R=>R.contains(_));!P||D||(s==null||s(I),o==null||o(I),I.defaultPrevented||a==null||a())},p),M=bne(I=>{const _=I.target;[...c.branches].some(R=>R.contains(_))||(i==null||i(I),o==null||o(I),I.defaultPrevented||a==null||a())},p);return mne(I=>{S===c.layers.size-1&&(r==null||r(I),!I.defaultPrevented&&a&&(I.preventDefault(),a()))},p),C.useEffect(()=>{if(u)return n&&(c.layersWithOutsidePointerEventsDisabled.size===0&&(K7=p.body.style.pointerEvents,p.body.style.pointerEvents="none"),c.layersWithOutsidePointerEventsDisabled.add(u)),c.layers.add(u),G7(),()=>{n&&c.layersWithOutsidePointerEventsDisabled.size===1&&(p.body.style.pointerEvents=K7)}},[u,p,n,c]),C.useEffect(()=>()=>{u&&(c.layers.delete(u),c.layersWithOutsidePointerEventsDisabled.delete(u),G7())},[u,c]),C.useEffect(()=>{const I=()=>f({});return document.addEventListener(dS,I),()=>document.removeEventListener(dS,I)},[]),d.jsx(Ye.div,{...l,ref:v,style:{pointerEvents:w?P?"auto":"none":void 0,...t.style},onFocusCapture:ve(t.onFocusCapture,M.onFocusCapture),onBlurCapture:ve(t.onBlurCapture,M.onBlurCapture),onPointerDownCapture:ve(t.onPointerDownCapture,E.onPointerDownCapture)})});jh.displayName=yne;var xne="DismissableLayerBranch",cM=C.forwardRef((t,e)=>{const n=C.useContext(lM),r=C.useRef(null),s=xt(e,r);return C.useEffect(()=>{const i=r.current;if(i)return n.branches.add(i),()=>{n.branches.delete(i)}},[n.branches]),d.jsx(Ye.div,{...t,ref:s})});cM.displayName=xne;function wne(t,e=globalThis==null?void 0:globalThis.document){const n=Mn(t),r=C.useRef(!1),s=C.useRef(()=>{});return C.useEffect(()=>{const i=a=>{if(a.target&&!r.current){let l=function(){uM(vne,n,c,{discrete:!0})};const c={originalEvent:a};a.pointerType==="touch"?(e.removeEventListener("click",s.current),s.current=l,e.addEventListener("click",s.current,{once:!0})):l()}else e.removeEventListener("click",s.current);r.current=!1},o=window.setTimeout(()=>{e.addEventListener("pointerdown",i)},0);return()=>{window.clearTimeout(o),e.removeEventListener("pointerdown",i),e.removeEventListener("click",s.current)}},[e,n]),{onPointerDownCapture:()=>r.current=!0}}function bne(t,e=globalThis==null?void 0:globalThis.document){const n=Mn(t),r=C.useRef(!1);return C.useEffect(()=>{const s=i=>{i.target&&!r.current&&uM(Sne,n,{originalEvent:i},{discrete:!1})};return e.addEventListener("focusin",s),()=>e.removeEventListener("focusin",s)},[e,n]),{onFocusCapture:()=>r.current=!0,onBlurCapture:()=>r.current=!1}}function G7(){const t=new CustomEvent(dS);document.dispatchEvent(t)}function uM(t,e,n,{discrete:r}){const s=n.originalEvent.target,i=new CustomEvent(t,{bubbles:!1,cancelable:!0,detail:n});e&&s.addEventListener(t,e,{once:!0}),r?ow(s,i):s.dispatchEvent(i)}var Cne=jh,Pne=cM,Ty="focusScope.autoFocusOnMount",My="focusScope.autoFocusOnUnmount",V7={bubbles:!1,cancelable:!0},kne="FocusScope",Cm=C.forwardRef((t,e)=>{const{loop:n=!1,trapped:r=!1,onMountAutoFocus:s,onUnmountAutoFocus:i,...o}=t,[a,l]=C.useState(null),c=Mn(s),u=Mn(i),h=C.useRef(null),p=xt(e,m=>l(m)),f=C.useRef({paused:!1,pause(){this.paused=!0},resume(){this.paused=!1}}).current;C.useEffect(()=>{if(r){let m=function(w){if(f.paused||!a)return;const P=w.target;a.contains(P)?h.current=P:Ao(h.current,{select:!0})},x=function(w){if(f.paused||!a)return;const P=w.relatedTarget;P!==null&&(a.contains(P)||Ao(h.current,{select:!0}))},y=function(w){if(document.activeElement===document.body)for(const E of w)E.removedNodes.length>0&&Ao(a)};document.addEventListener("focusin",m),document.addEventListener("focusout",x);const S=new MutationObserver(y);return a&&S.observe(a,{childList:!0,subtree:!0}),()=>{document.removeEventListener("focusin",m),document.removeEventListener("focusout",x),S.disconnect()}}},[r,a,f.paused]),C.useEffect(()=>{if(a){Y7.add(f);const m=document.activeElement;if(!a.contains(m)){const y=new CustomEvent(Ty,V7);a.addEventListener(Ty,c),a.dispatchEvent(y),y.defaultPrevented||(Ine(Ane(dM(a)),{select:!0}),document.activeElement===m&&Ao(a))}return()=>{a.removeEventListener(Ty,c),setTimeout(()=>{const y=new CustomEvent(My,V7);a.addEventListener(My,u),a.dispatchEvent(y),y.defaultPrevented||Ao(m??document.body,{select:!0}),a.removeEventListener(My,u),Y7.remove(f)},0)}}},[a,c,u,f]);const v=C.useCallback(m=>{if(!n&&!r||f.paused)return;const x=m.key==="Tab"&&!m.altKey&&!m.ctrlKey&&!m.metaKey,y=document.activeElement;if(x&&y){const S=m.currentTarget,[w,P]=Ene(S);w&&P?!m.shiftKey&&y===P?(m.preventDefault(),n&&Ao(w,{select:!0})):m.shiftKey&&y===w&&(m.preventDefault(),n&&Ao(P,{select:!0})):y===S&&m.preventDefault()}},[n,r,f.paused]);return d.jsx(Ye.div,{tabIndex:-1,...o,ref:p,onKeyDown:v})});Cm.displayName=kne;function Ine(t,{select:e=!1}={}){const n=document.activeElement;for(const r of t)if(Ao(r,{select:e}),document.activeElement!==n)return}function Ene(t){const e=dM(t),n=q7(e,t),r=q7(e.reverse(),t);return[n,r]}function dM(t){const e=[],n=document.createTreeWalker(t,NodeFilter.SHOW_ELEMENT,{acceptNode:r=>{const s=r.tagName==="INPUT"&&r.type==="hidden";return r.disabled||r.hidden||s?NodeFilter.FILTER_SKIP:r.tabIndex>=0?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});for(;n.nextNode();)e.push(n.currentNode);return e}function q7(t,e){for(const n of t)if(!Tne(n,{upTo:e}))return n}function Tne(t,{upTo:e}){if(getComputedStyle(t).visibility==="hidden")return!0;for(;t;){if(e!==void 0&&t===e)return!1;if(getComputedStyle(t).display==="none")return!0;t=t.parentElement}return!1}function Mne(t){return t instanceof HTMLInputElement&&"select"in t}function Ao(t,{select:e=!1}={}){if(t&&t.focus){const n=document.activeElement;t.focus({preventScroll:!0}),t!==n&&Mne(t)&&e&&t.select()}}var Y7=_ne();function _ne(){let t=[];return{add(e){const n=t[0];e!==n&&(n==null||n.pause()),t=X7(t,e),t.unshift(e)},remove(e){var n;t=X7(t,e),(n=t[0])==null||n.resume()}}}function X7(t,e){const n=[...t],r=n.indexOf(e);return r!==-1&&n.splice(r,1),n}function Ane(t){return t.filter(e=>e.tagName!=="A")}var Dne="Portal",Rh=C.forwardRef((t,e)=>{var a;const{container:n,...r}=t,[s,i]=C.useState(!1);la(()=>i(!0),[]);const o=n||s&&((a=globalThis==null?void 0:globalThis.document)==null?void 0:a.body);return o?WN.createPortal(d.jsx(Ye.div,{...r,ref:e}),o):null});Rh.displayName=Dne;function jne(t,e){return C.useReducer((n,r)=>e[n][r]??n,t)}var Ks=t=>{const{present:e,children:n}=t,r=Rne(e),s=typeof n=="function"?n({present:r.isPresent}):C.Children.only(n),i=xt(r.ref,One(s));return typeof n=="function"||r.isPresent?C.cloneElement(s,{ref:i}):null};Ks.displayName="Presence";function Rne(t){const[e,n]=C.useState(),r=C.useRef({}),s=C.useRef(t),i=C.useRef("none"),o=t?"mounted":"unmounted",[a,l]=jne(o,{mounted:{UNMOUNT:"unmounted",ANIMATION_OUT:"unmountSuspended"},unmountSuspended:{MOUNT:"mounted",ANIMATION_END:"unmounted"},unmounted:{MOUNT:"mounted"}});return C.useEffect(()=>{const c=W0(r.current);i.current=a==="mounted"?c:"none"},[a]),la(()=>{const c=r.current,u=s.current;if(u!==t){const p=i.current,f=W0(c);t?l("MOUNT"):f==="none"||(c==null?void 0:c.display)==="none"?l("UNMOUNT"):l(u&&p!==f?"ANIMATION_OUT":"UNMOUNT"),s.current=t}},[t,l]),la(()=>{if(e){const c=h=>{const f=W0(r.current).includes(h.animationName);h.target===e&&f&&xl.flushSync(()=>l("ANIMATION_END"))},u=h=>{h.target===e&&(i.current=W0(r.current))};return e.addEventListener("animationstart",u),e.addEventListener("animationcancel",c),e.addEventListener("animationend",c),()=>{e.removeEventListener("animationstart",u),e.removeEventListener("animationcancel",c),e.removeEventListener("animationend",c)}}else l("ANIMATION_END")},[e,l]),{isPresent:["mounted","unmountSuspended"].includes(a),ref:C.useCallback(c=>{c&&(r.current=getComputedStyle(c)),n(c)},[])}}function W0(t){return(t==null?void 0:t.animationName)||"none"}function One(t){var r,s;let e=(r=Object.getOwnPropertyDescriptor(t.props,"ref"))==null?void 0:r.get,n=e&&"isReactWarning"in e&&e.isReactWarning;return n?t.ref:(e=(s=Object.getOwnPropertyDescriptor(t,"ref"))==null?void 0:s.get,n=e&&"isReactWarning"in e&&e.isReactWarning,n?t.props.ref:t.props.ref||t.ref)}var _y=0;function aw(){C.useEffect(()=>{const t=document.querySelectorAll("[data-radix-focus-guard]");return document.body.insertAdjacentElement("afterbegin",t[0]??Z7()),document.body.insertAdjacentElement("beforeend",t[1]??Z7()),_y++,()=>{_y===1&&document.querySelectorAll("[data-radix-focus-guard]").forEach(e=>e.remove()),_y--}},[])}function Z7(){const t=document.createElement("span");return t.setAttribute("data-radix-focus-guard",""),t.tabIndex=0,t.style.cssText="outline: none; opacity: 0; position: fixed; pointer-events: none",t}var ii=function(){return ii=Object.assign||function(e){for(var n,r=1,s=arguments.length;r<s;r++){n=arguments[r];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},ii.apply(this,arguments)};function hM(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,r=Object.getOwnPropertySymbols(t);s<r.length;s++)e.indexOf(r[s])<0&&Object.prototype.propertyIsEnumerable.call(t,r[s])&&(n[r[s]]=t[r[s]]);return n}function Lne(t,e,n){if(n||arguments.length===2)for(var r=0,s=e.length,i;r<s;r++)(i||!(r in e))&&(i||(i=Array.prototype.slice.call(e,0,r)),i[r]=e[r]);return t.concat(i||Array.prototype.slice.call(e))}var sf="right-scroll-bar-position",of="width-before-scroll-bar",Nne="with-scroll-bars-hidden",zne="--removed-body-scroll-bar-size";function Ay(t,e){return typeof t=="function"?t(e):t&&(t.current=e),t}function Fne(t,e){var n=C.useState(function(){return{value:t,callback:e,facade:{get current(){return n.value},set current(r){var s=n.value;s!==r&&(n.value=r,n.callback(r,s))}}}})[0];return n.callback=e,n.facade}var $ne=typeof window<"u"?C.useLayoutEffect:C.useEffect,Q7=new WeakMap;function Bne(t,e){var n=Fne(null,function(r){return t.forEach(function(s){return Ay(s,r)})});return $ne(function(){var r=Q7.get(n);if(r){var s=new Set(r),i=new Set(t),o=n.current;s.forEach(function(a){i.has(a)||Ay(a,null)}),i.forEach(function(a){s.has(a)||Ay(a,o)})}Q7.set(n,t)},[t]),n}function Une(t){return t}function Hne(t,e){e===void 0&&(e=Une);var n=[],r=!1,s={read:function(){if(r)throw new Error("Sidecar: could not `read` from an `assigned` medium. `read` could be used only with `useMedium`.");return n.length?n[n.length-1]:t},useMedium:function(i){var o=e(i,r);return n.push(o),function(){n=n.filter(function(a){return a!==o})}},assignSyncMedium:function(i){for(r=!0;n.length;){var o=n;n=[],o.forEach(i)}n={push:function(a){return i(a)},filter:function(){return n}}},assignMedium:function(i){r=!0;var o=[];if(n.length){var a=n;n=[],a.forEach(i),o=n}var l=function(){var u=o;o=[],u.forEach(i)},c=function(){return Promise.resolve().then(l)};c(),n={push:function(u){o.push(u),c()},filter:function(u){return o=o.filter(u),n}}}};return s}function Wne(t){t===void 0&&(t={});var e=Hne(null);return e.options=ii({async:!0,ssr:!1},t),e}var pM=function(t){var e=t.sideCar,n=hM(t,["sideCar"]);if(!e)throw new Error("Sidecar: please provide `sideCar` property to import the right car");var r=e.read();if(!r)throw new Error("Sidecar medium not found");return C.createElement(r,ii({},n))};pM.isSideCarExport=!0;function Kne(t,e){return t.useMedium(e),pM}var fM=Wne(),Dy=function(){},Pm=C.forwardRef(function(t,e){var n=C.useRef(null),r=C.useState({onScrollCapture:Dy,onWheelCapture:Dy,onTouchMoveCapture:Dy}),s=r[0],i=r[1],o=t.forwardProps,a=t.children,l=t.className,c=t.removeScrollBar,u=t.enabled,h=t.shards,p=t.sideCar,f=t.noIsolation,v=t.inert,m=t.allowPinchZoom,x=t.as,y=x===void 0?"div":x,S=t.gapMode,w=hM(t,["forwardProps","children","className","removeScrollBar","enabled","shards","sideCar","noIsolation","inert","allowPinchZoom","as","gapMode"]),P=p,E=Bne([n,e]),M=ii(ii({},w),s);return C.createElement(C.Fragment,null,u&&C.createElement(P,{sideCar:fM,removeScrollBar:c,shards:h,noIsolation:f,inert:v,setCallbacks:i,allowPinchZoom:!!m,lockRef:n,gapMode:S}),o?C.cloneElement(C.Children.only(a),ii(ii({},M),{ref:E})):C.createElement(y,ii({},M,{className:l,ref:E}),a))});Pm.defaultProps={enabled:!0,removeScrollBar:!0,inert:!1};Pm.classNames={fullWidth:of,zeroRight:sf};var Gne=function(){if(typeof __webpack_nonce__<"u")return __webpack_nonce__};function Vne(){if(!document)return null;var t=document.createElement("style");t.type="text/css";var e=Gne();return e&&t.setAttribute("nonce",e),t}function qne(t,e){t.styleSheet?t.styleSheet.cssText=e:t.appendChild(document.createTextNode(e))}function Yne(t){var e=document.head||document.getElementsByTagName("head")[0];e.appendChild(t)}var Xne=function(){var t=0,e=null;return{add:function(n){t==0&&(e=Vne())&&(qne(e,n),Yne(e)),t++},remove:function(){t--,!t&&e&&(e.parentNode&&e.parentNode.removeChild(e),e=null)}}},Zne=function(){var t=Xne();return function(e,n){C.useEffect(function(){return t.add(e),function(){t.remove()}},[e&&n])}},gM=function(){var t=Zne(),e=function(n){var r=n.styles,s=n.dynamic;return t(r,s),null};return e},Qne={left:0,top:0,right:0,gap:0},jy=function(t){return parseInt(t||"",10)||0},Jne=function(t){var e=window.getComputedStyle(document.body),n=e[t==="padding"?"paddingLeft":"marginLeft"],r=e[t==="padding"?"paddingTop":"marginTop"],s=e[t==="padding"?"paddingRight":"marginRight"];return[jy(n),jy(r),jy(s)]},ere=function(t){if(t===void 0&&(t="margin"),typeof window>"u")return Qne;var e=Jne(t),n=document.documentElement.clientWidth,r=window.innerWidth;return{left:e[0],top:e[1],right:e[2],gap:Math.max(0,r-n+e[2]-e[0])}},tre=gM(),wc="data-scroll-locked",nre=function(t,e,n,r){var s=t.left,i=t.top,o=t.right,a=t.gap;return n===void 0&&(n="margin"),`
  .`.concat(Nne,` {
   overflow: hidden `).concat(r,`;
   padding-right: `).concat(a,"px ").concat(r,`;
  }
  body[`).concat(wc,`] {
    overflow: hidden `).concat(r,`;
    overscroll-behavior: contain;
    `).concat([e&&"position: relative ".concat(r,";"),n==="margin"&&`
    padding-left: `.concat(s,`px;
    padding-top: `).concat(i,`px;
    padding-right: `).concat(o,`px;
    margin-left:0;
    margin-top:0;
    margin-right: `).concat(a,"px ").concat(r,`;
    `),n==="padding"&&"padding-right: ".concat(a,"px ").concat(r,";")].filter(Boolean).join(""),`
  }
  
  .`).concat(sf,` {
    right: `).concat(a,"px ").concat(r,`;
  }
  
  .`).concat(of,` {
    margin-right: `).concat(a,"px ").concat(r,`;
  }
  
  .`).concat(sf," .").concat(sf,` {
    right: 0 `).concat(r,`;
  }
  
  .`).concat(of," .").concat(of,` {
    margin-right: 0 `).concat(r,`;
  }
  
  body[`).concat(wc,`] {
    `).concat(zne,": ").concat(a,`px;
  }
`)},J7=function(){var t=parseInt(document.body.getAttribute(wc)||"0",10);return isFinite(t)?t:0},rre=function(){C.useEffect(function(){return document.body.setAttribute(wc,(J7()+1).toString()),function(){var t=J7()-1;t<=0?document.body.removeAttribute(wc):document.body.setAttribute(wc,t.toString())}},[])},sre=function(t){var e=t.noRelative,n=t.noImportant,r=t.gapMode,s=r===void 0?"margin":r;rre();var i=C.useMemo(function(){return ere(s)},[s]);return C.createElement(tre,{styles:nre(i,!e,s,n?"":"!important")})},hS=!1;if(typeof window<"u")try{var K0=Object.defineProperty({},"passive",{get:function(){return hS=!0,!0}});window.addEventListener("test",K0,K0),window.removeEventListener("test",K0,K0)}catch{hS=!1}var Ll=hS?{passive:!1}:!1,ire=function(t){return t.tagName==="TEXTAREA"},mM=function(t,e){var n=window.getComputedStyle(t);return n[e]!=="hidden"&&!(n.overflowY===n.overflowX&&!ire(t)&&n[e]==="visible")},ore=function(t){return mM(t,"overflowY")},are=function(t){return mM(t,"overflowX")},e8=function(t,e){var n=e.ownerDocument,r=e;do{typeof ShadowRoot<"u"&&r instanceof ShadowRoot&&(r=r.host);var s=yM(t,r);if(s){var i=vM(t,r),o=i[1],a=i[2];if(o>a)return!0}r=r.parentNode}while(r&&r!==n.body);return!1},lre=function(t){var e=t.scrollTop,n=t.scrollHeight,r=t.clientHeight;return[e,n,r]},cre=function(t){var e=t.scrollLeft,n=t.scrollWidth,r=t.clientWidth;return[e,n,r]},yM=function(t,e){return t==="v"?ore(e):are(e)},vM=function(t,e){return t==="v"?lre(e):cre(e)},ure=function(t,e){return t==="h"&&e==="rtl"?-1:1},dre=function(t,e,n,r,s){var i=ure(t,window.getComputedStyle(e).direction),o=i*r,a=n.target,l=e.contains(a),c=!1,u=o>0,h=0,p=0;do{var f=vM(t,a),v=f[0],m=f[1],x=f[2],y=m-x-i*v;(v||y)&&yM(t,a)&&(h+=y,p+=v),a instanceof ShadowRoot?a=a.host:a=a.parentNode}while(!l&&a!==document.body||l&&(e.contains(a)||e===a));return(u&&(Math.abs(h)<1||!s)||!u&&(Math.abs(p)<1||!s))&&(c=!0),c},G0=function(t){return"changedTouches"in t?[t.changedTouches[0].clientX,t.changedTouches[0].clientY]:[0,0]},t8=function(t){return[t.deltaX,t.deltaY]},n8=function(t){return t&&"current"in t?t.current:t},hre=function(t,e){return t[0]===e[0]&&t[1]===e[1]},pre=function(t){return`
  .block-interactivity-`.concat(t,` {pointer-events: none;}
  .allow-interactivity-`).concat(t,` {pointer-events: all;}
`)},fre=0,Nl=[];function gre(t){var e=C.useRef([]),n=C.useRef([0,0]),r=C.useRef(),s=C.useState(fre++)[0],i=C.useState(gM)[0],o=C.useRef(t);C.useEffect(function(){o.current=t},[t]),C.useEffect(function(){if(t.inert){document.body.classList.add("block-interactivity-".concat(s));var m=Lne([t.lockRef.current],(t.shards||[]).map(n8),!0).filter(Boolean);return m.forEach(function(x){return x.classList.add("allow-interactivity-".concat(s))}),function(){document.body.classList.remove("block-interactivity-".concat(s)),m.forEach(function(x){return x.classList.remove("allow-interactivity-".concat(s))})}}},[t.inert,t.lockRef.current,t.shards]);var a=C.useCallback(function(m,x){if("touches"in m&&m.touches.length===2)return!o.current.allowPinchZoom;var y=G0(m),S=n.current,w="deltaX"in m?m.deltaX:S[0]-y[0],P="deltaY"in m?m.deltaY:S[1]-y[1],E,M=m.target,I=Math.abs(w)>Math.abs(P)?"h":"v";if("touches"in m&&I==="h"&&M.type==="range")return!1;var _=e8(I,M);if(!_)return!0;if(_?E=I:(E=I==="v"?"h":"v",_=e8(I,M)),!_)return!1;if(!r.current&&"changedTouches"in m&&(w||P)&&(r.current=E),!E)return!0;var D=r.current||E;return dre(D,x,m,D==="h"?w:P,!0)},[]),l=C.useCallback(function(m){var x=m;if(!(!Nl.length||Nl[Nl.length-1]!==i)){var y="deltaY"in x?t8(x):G0(x),S=e.current.filter(function(E){return E.name===x.type&&(E.target===x.target||x.target===E.shadowParent)&&hre(E.delta,y)})[0];if(S&&S.should){x.cancelable&&x.preventDefault();return}if(!S){var w=(o.current.shards||[]).map(n8).filter(Boolean).filter(function(E){return E.contains(x.target)}),P=w.length>0?a(x,w[0]):!o.current.noIsolation;P&&x.cancelable&&x.preventDefault()}}},[]),c=C.useCallback(function(m,x,y,S){var w={name:m,delta:x,target:y,should:S,shadowParent:mre(y)};e.current.push(w),setTimeout(function(){e.current=e.current.filter(function(P){return P!==w})},1)},[]),u=C.useCallback(function(m){n.current=G0(m),r.current=void 0},[]),h=C.useCallback(function(m){c(m.type,t8(m),m.target,a(m,t.lockRef.current))},[]),p=C.useCallback(function(m){c(m.type,G0(m),m.target,a(m,t.lockRef.current))},[]);C.useEffect(function(){return Nl.push(i),t.setCallbacks({onScrollCapture:h,onWheelCapture:h,onTouchMoveCapture:p}),document.addEventListener("wheel",l,Ll),document.addEventListener("touchmove",l,Ll),document.addEventListener("touchstart",u,Ll),function(){Nl=Nl.filter(function(m){return m!==i}),document.removeEventListener("wheel",l,Ll),document.removeEventListener("touchmove",l,Ll),document.removeEventListener("touchstart",u,Ll)}},[]);var f=t.removeScrollBar,v=t.inert;return C.createElement(C.Fragment,null,v?C.createElement(i,{styles:pre(s)}):null,f?C.createElement(sre,{gapMode:t.gapMode}):null)}function mre(t){for(var e=null;t!==null;)t instanceof ShadowRoot&&(e=t.host,t=t.host),t=t.parentNode;return e}const yre=Kne(fM,gre);var km=C.forwardRef(function(t,e){return C.createElement(Pm,ii({},t,{ref:e,sideCar:yre}))});km.classNames=Pm.classNames;var vre=function(t){if(typeof document>"u")return null;var e=Array.isArray(t)?t[0]:t;return e.ownerDocument.body},zl=new WeakMap,V0=new WeakMap,q0={},Ry=0,SM=function(t){return t&&(t.host||SM(t.parentNode))},Sre=function(t,e){return e.map(function(n){if(t.contains(n))return n;var r=SM(n);return r&&t.contains(r)?r:(console.error("aria-hidden",n,"in not contained inside",t,". Doing nothing"),null)}).filter(function(n){return!!n})},xre=function(t,e,n,r){var s=Sre(e,Array.isArray(t)?t:[t]);q0[n]||(q0[n]=new WeakMap);var i=q0[n],o=[],a=new Set,l=new Set(s),c=function(h){!h||a.has(h)||(a.add(h),c(h.parentNode))};s.forEach(c);var u=function(h){!h||l.has(h)||Array.prototype.forEach.call(h.children,function(p){if(a.has(p))u(p);else try{var f=p.getAttribute(r),v=f!==null&&f!=="false",m=(zl.get(p)||0)+1,x=(i.get(p)||0)+1;zl.set(p,m),i.set(p,x),o.push(p),m===1&&v&&V0.set(p,!0),x===1&&p.setAttribute(n,"true"),v||p.setAttribute(r,"true")}catch(y){console.error("aria-hidden: cannot operate on ",p,y)}})};return u(e),a.clear(),Ry++,function(){o.forEach(function(h){var p=zl.get(h)-1,f=i.get(h)-1;zl.set(h,p),i.set(h,f),p||(V0.has(h)||h.removeAttribute(r),V0.delete(h)),f||h.removeAttribute(n)}),Ry--,Ry||(zl=new WeakMap,zl=new WeakMap,V0=new WeakMap,q0={})}},lw=function(t,e,n){n===void 0&&(n="data-aria-hidden");var r=Array.from(Array.isArray(t)?t:[t]),s=vre(t);return s?(r.push.apply(r,Array.from(s.querySelectorAll("[aria-live]"))),xre(r,s,n,"aria-hidden")):function(){return null}},cw="Dialog",[xM,Wpe]=Ei(cw),[wre,Gs]=xM(cw),wM=t=>{const{__scopeDialog:e,children:n,open:r,defaultOpen:s,onOpenChange:i,modal:o=!0}=t,a=C.useRef(null),l=C.useRef(null),[c=!1,u]=Pa({prop:r,defaultProp:s,onChange:i});return d.jsx(wre,{scope:e,triggerRef:a,contentRef:l,contentId:Zi(),titleId:Zi(),descriptionId:Zi(),open:c,onOpenChange:u,onOpenToggle:C.useCallback(()=>u(h=>!h),[u]),modal:o,children:n})};wM.displayName=cw;var bM="DialogTrigger",bre=C.forwardRef((t,e)=>{const{__scopeDialog:n,...r}=t,s=Gs(bM,n),i=xt(e,s.triggerRef);return d.jsx(Ye.button,{type:"button","aria-haspopup":"dialog","aria-expanded":s.open,"aria-controls":s.contentId,"data-state":hw(s.open),...r,ref:i,onClick:ve(t.onClick,s.onOpenToggle)})});bre.displayName=bM;var uw="DialogPortal",[Cre,CM]=xM(uw,{forceMount:void 0}),PM=t=>{const{__scopeDialog:e,forceMount:n,children:r,container:s}=t,i=Gs(uw,e);return d.jsx(Cre,{scope:e,forceMount:n,children:C.Children.map(r,o=>d.jsx(Ks,{present:n||i.open,children:d.jsx(Rh,{asChild:!0,container:s,children:o})}))})};PM.displayName=uw;var gg="DialogOverlay",kM=C.forwardRef((t,e)=>{const n=CM(gg,t.__scopeDialog),{forceMount:r=n.forceMount,...s}=t,i=Gs(gg,t.__scopeDialog);return i.modal?d.jsx(Ks,{present:r||i.open,children:d.jsx(Pre,{...s,ref:e})}):null});kM.displayName=gg;var Pre=C.forwardRef((t,e)=>{const{__scopeDialog:n,...r}=t,s=Gs(gg,n);return d.jsx(km,{as:hl,allowPinchZoom:!0,shards:[s.contentRef],children:d.jsx(Ye.div,{"data-state":hw(s.open),...r,ref:e,style:{pointerEvents:"auto",...r.style}})})}),pl="DialogContent",IM=C.forwardRef((t,e)=>{const n=CM(pl,t.__scopeDialog),{forceMount:r=n.forceMount,...s}=t,i=Gs(pl,t.__scopeDialog);return d.jsx(Ks,{present:r||i.open,children:i.modal?d.jsx(kre,{...s,ref:e}):d.jsx(Ire,{...s,ref:e})})});IM.displayName=pl;var kre=C.forwardRef((t,e)=>{const n=Gs(pl,t.__scopeDialog),r=C.useRef(null),s=xt(e,n.contentRef,r);return C.useEffect(()=>{const i=r.current;if(i)return lw(i)},[]),d.jsx(EM,{...t,ref:s,trapFocus:n.open,disableOutsidePointerEvents:!0,onCloseAutoFocus:ve(t.onCloseAutoFocus,i=>{var o;i.preventDefault(),(o=n.triggerRef.current)==null||o.focus()}),onPointerDownOutside:ve(t.onPointerDownOutside,i=>{const o=i.detail.originalEvent,a=o.button===0&&o.ctrlKey===!0;(o.button===2||a)&&i.preventDefault()}),onFocusOutside:ve(t.onFocusOutside,i=>i.preventDefault())})}),Ire=C.forwardRef((t,e)=>{const n=Gs(pl,t.__scopeDialog),r=C.useRef(!1),s=C.useRef(!1);return d.jsx(EM,{...t,ref:e,trapFocus:!1,disableOutsidePointerEvents:!1,onCloseAutoFocus:i=>{var o,a;(o=t.onCloseAutoFocus)==null||o.call(t,i),i.defaultPrevented||(r.current||(a=n.triggerRef.current)==null||a.focus(),i.preventDefault()),r.current=!1,s.current=!1},onInteractOutside:i=>{var l,c;(l=t.onInteractOutside)==null||l.call(t,i),i.defaultPrevented||(r.current=!0,i.detail.originalEvent.type==="pointerdown"&&(s.current=!0));const o=i.target;((c=n.triggerRef.current)==null?void 0:c.contains(o))&&i.preventDefault(),i.detail.originalEvent.type==="focusin"&&s.current&&i.preventDefault()}})}),EM=C.forwardRef((t,e)=>{const{__scopeDialog:n,trapFocus:r,onOpenAutoFocus:s,onCloseAutoFocus:i,...o}=t,a=Gs(pl,n),l=C.useRef(null),c=xt(e,l);return aw(),d.jsxs(d.Fragment,{children:[d.jsx(Cm,{asChild:!0,loop:!0,trapped:r,onMountAutoFocus:s,onUnmountAutoFocus:i,children:d.jsx(jh,{role:"dialog",id:a.contentId,"aria-describedby":a.descriptionId,"aria-labelledby":a.titleId,"data-state":hw(a.open),...o,ref:c,onDismiss:()=>a.onOpenChange(!1)})}),d.jsxs(d.Fragment,{children:[d.jsx(Tre,{titleId:a.titleId}),d.jsx(_re,{contentRef:l,descriptionId:a.descriptionId})]})]})}),dw="DialogTitle",TM=C.forwardRef((t,e)=>{const{__scopeDialog:n,...r}=t,s=Gs(dw,n);return d.jsx(Ye.h2,{id:s.titleId,...r,ref:e})});TM.displayName=dw;var MM="DialogDescription",Ere=C.forwardRef((t,e)=>{const{__scopeDialog:n,...r}=t,s=Gs(MM,n);return d.jsx(Ye.p,{id:s.descriptionId,...r,ref:e})});Ere.displayName=MM;var _M="DialogClose",AM=C.forwardRef((t,e)=>{const{__scopeDialog:n,...r}=t,s=Gs(_M,n);return d.jsx(Ye.button,{type:"button",...r,ref:e,onClick:ve(t.onClick,()=>s.onOpenChange(!1))})});AM.displayName=_M;function hw(t){return t?"open":"closed"}var DM="DialogTitleWarning",[Kpe,jM]=one(DM,{contentName:pl,titleName:dw,docsSlug:"dialog"}),Tre=({titleId:t})=>{const e=jM(DM),n=`\`${e.contentName}\` requires a \`${e.titleName}\` for the component to be accessible for screen reader users.

If you want to hide the \`${e.titleName}\`, you can wrap it with our VisuallyHidden component.

For more information, see https://radix-ui.com/primitives/docs/components/${e.docsSlug}`;return C.useEffect(()=>{t&&(document.getElementById(t)||console.error(n))},[n,t]),null},Mre="DialogDescriptionWarning",_re=({contentRef:t,descriptionId:e})=>{const r=`Warning: Missing \`Description\` or \`aria-describedby={undefined}\` for {${jM(Mre).contentName}}.`;return C.useEffect(()=>{var i;const s=(i=t.current)==null?void 0:i.getAttribute("aria-describedby");e&&s&&(document.getElementById(e)||console.warn(r))},[r,t,e]),null},Are=wM,Dre=PM,jre=kM,Rre=IM;const RM=()=>{},OM=C.createContext(null);function Ore({onEvent:t,children:e}){return d.jsx(OM.Provider,{value:t??RM,children:e})}function An(){return C.useContext(OM)??RM}const LM=C.createContext(null);function Lre({children:t}){const e=G(),n=An(),[r,s]=C.useState([]),i=C.useCallback(c=>{const u=c.id??dt();return s(h=>[...h.filter(p=>p.id!==c.id),{...c,id:u}]),n("open-menu",{source:"dialog",id:u}),e.addOpenMenu(u),u},[e,n]),o=C.useCallback((c,u)=>(s(h=>h.map(p=>p.id===c?{...p,...u}:p)),n("open-menu",{source:"dialog",id:c}),e.addOpenMenu(c),c),[e,n]),a=C.useCallback(c=>(s(u=>u.filter(h=>{var p;return h.id===c?((p=h.onClose)==null||p.call(h),!1):!0})),n("close-menu",{source:"dialog",id:c}),e.deleteOpenMenu(c),c),[e,n]),l=C.useCallback(()=>{s(c=>(c.forEach(u=>{var h;(h=u.onClose)==null||h.call(u),n("close-menu",{source:"dialog",id:u.id}),e.deleteOpenMenu(u.id)}),[]))},[e,n]);return d.jsx(LM.Provider,{value:{dialogs:r,addDialog:i,removeDialog:a,clearDialogs:l,updateDialog:o},children:t})}function Pl(){const t=C.useContext(LM);if(!t)throw new Error("useDialogs must be used within a DialogsProvider");return t}const Nre=({id:t,component:e,onClose:n})=>{const{removeDialog:r}=Pl(),s=mn(),i=C.useCallback(o=>{if(!o){if(n)try{n()}catch(a){console.warn(a)}r(t)}},[t,n,r]);return d.jsx(Are,{onOpenChange:i,defaultOpen:!0,children:d.jsx(Dre,{container:s,children:d.jsx(jre,{dir:"ltr",className:"tlui-dialog__overlay",onClick:o=>{o.target===o.currentTarget&&i(!1)},children:d.jsx(Rre,{dir:"ltr",className:"tlui-dialog__content",children:d.jsx(e,{onClose:()=>i(!1)})})})})})};function zre(){const{dialogs:t}=Pl();return t.map(e=>d.jsx(Nre,{...e},e.id))}const Fre=Ne.memo(zre);function $re(){const t=G(),e=J("follow",()=>t.getInstanceState().followingUserId,[t]);return e?d.jsx(Bre,{userId:e}):null}function Bre({userId:t}){const e=cm(t);return e?d.jsx("div",{className:"tlui-following-indicator",style:{borderColor:e.color}}):null}function Im(t){const e=t+"CollectionProvider",[n,r]=Ei(e),[s,i]=n(e,{collectionRef:{current:null},itemMap:new Map}),o=f=>{const{scope:v,children:m}=f,x=Ne.useRef(null),y=Ne.useRef(new Map).current;return d.jsx(s,{scope:v,itemMap:y,collectionRef:x,children:m})};o.displayName=e;const a=t+"CollectionSlot",l=Ne.forwardRef((f,v)=>{const{scope:m,children:x}=f,y=i(a,m),S=xt(v,y.collectionRef);return d.jsx(hl,{ref:S,children:x})});l.displayName=a;const c=t+"CollectionItemSlot",u="data-radix-collection-item",h=Ne.forwardRef((f,v)=>{const{scope:m,children:x,...y}=f,S=Ne.useRef(null),w=xt(v,S),P=i(c,m);return Ne.useEffect(()=>(P.itemMap.set(S,{ref:S,...y}),()=>void P.itemMap.delete(S))),d.jsx(hl,{[u]:"",ref:w,children:x})});h.displayName=c;function p(f){const v=i(t+"CollectionConsumer",f);return Ne.useCallback(()=>{const x=v.collectionRef.current;if(!x)return[];const y=Array.from(x.querySelectorAll(`[${u}]`));return Array.from(v.itemMap.values()).sort((P,E)=>y.indexOf(P.ref.current)-y.indexOf(E.ref.current))},[v.collectionRef,v.itemMap])}return[{Provider:o,Slot:l,ItemSlot:h},p,r]}var Ure="VisuallyHidden",pw=C.forwardRef((t,e)=>d.jsx(Ye.span,{...t,ref:e,style:{position:"absolute",border:0,width:1,height:1,padding:0,margin:-1,overflow:"hidden",clip:"rect(0, 0, 0, 0)",whiteSpace:"nowrap",wordWrap:"normal",...t.style}}));pw.displayName=Ure;var fw="ToastProvider",[gw,Hre,Wre]=Im("Toast"),[NM,Gpe]=Ei("Toast",[Wre]),[Kre,Em]=NM(fw),zM=t=>{const{__scopeToast:e,label:n="Notification",duration:r=5e3,swipeDirection:s="right",swipeThreshold:i=50,children:o}=t,[a,l]=C.useState(null),[c,u]=C.useState(0),h=C.useRef(!1),p=C.useRef(!1);return n.trim()||console.error(`Invalid prop \`label\` supplied to \`${fw}\`. Expected non-empty \`string\`.`),d.jsx(gw.Provider,{scope:e,children:d.jsx(Kre,{scope:e,label:n,duration:r,swipeDirection:s,swipeThreshold:i,toastCount:c,viewport:a,onViewportChange:l,onToastAdd:C.useCallback(()=>u(f=>f+1),[]),onToastRemove:C.useCallback(()=>u(f=>f-1),[]),isFocusedToastEscapeKeyDownRef:h,isClosePausedRef:p,children:o})})};zM.displayName=fw;var FM="ToastViewport",Gre=["F8"],pS="toast.viewportPause",fS="toast.viewportResume",$M=C.forwardRef((t,e)=>{const{__scopeToast:n,hotkey:r=Gre,label:s="Notifications ({hotkey})",...i}=t,o=Em(FM,n),a=Hre(n),l=C.useRef(null),c=C.useRef(null),u=C.useRef(null),h=C.useRef(null),p=xt(e,h,o.onViewportChange),f=r.join("+").replace(/Key/g,"").replace(/Digit/g,""),v=o.toastCount>0;C.useEffect(()=>{const x=y=>{var w;r.every(P=>y[P]||y.code===P)&&((w=h.current)==null||w.focus())};return document.addEventListener("keydown",x),()=>document.removeEventListener("keydown",x)},[r]),C.useEffect(()=>{const x=l.current,y=h.current;if(v&&x&&y){const S=()=>{if(!o.isClosePausedRef.current){const M=new CustomEvent(pS);y.dispatchEvent(M),o.isClosePausedRef.current=!0}},w=()=>{if(o.isClosePausedRef.current){const M=new CustomEvent(fS);y.dispatchEvent(M),o.isClosePausedRef.current=!1}},P=M=>{!x.contains(M.relatedTarget)&&w()},E=()=>{x.contains(document.activeElement)||w()};return x.addEventListener("focusin",S),x.addEventListener("focusout",P),x.addEventListener("pointermove",S),x.addEventListener("pointerleave",E),window.addEventListener("blur",S),window.addEventListener("focus",w),()=>{x.removeEventListener("focusin",S),x.removeEventListener("focusout",P),x.removeEventListener("pointermove",S),x.removeEventListener("pointerleave",E),window.removeEventListener("blur",S),window.removeEventListener("focus",w)}}},[v,o.isClosePausedRef]);const m=C.useCallback(({tabbingDirection:x})=>{const S=a().map(w=>{const P=w.ref.current,E=[P,...ise(P)];return x==="forwards"?E:E.reverse()});return(x==="forwards"?S.reverse():S).flat()},[a]);return C.useEffect(()=>{const x=h.current;if(x){const y=S=>{var E,M,I;const w=S.altKey||S.ctrlKey||S.metaKey;if(S.key==="Tab"&&!w){const _=document.activeElement,D=S.shiftKey;if(S.target===x&&D){(E=c.current)==null||E.focus();return}const U=m({tabbingDirection:D?"backwards":"forwards"}),O=U.findIndex(N=>N===_);Oy(U.slice(O+1))?S.preventDefault():D?(M=c.current)==null||M.focus():(I=u.current)==null||I.focus()}};return x.addEventListener("keydown",y),()=>x.removeEventListener("keydown",y)}},[a,m]),d.jsxs(Pne,{ref:l,role:"region","aria-label":s.replace("{hotkey}",f),tabIndex:-1,style:{pointerEvents:v?void 0:"none"},children:[v&&d.jsx(gS,{ref:c,onFocusFromOutsideViewport:()=>{const x=m({tabbingDirection:"forwards"});Oy(x)}}),d.jsx(gw.Slot,{scope:n,children:d.jsx(Ye.ol,{tabIndex:-1,...i,ref:p})}),v&&d.jsx(gS,{ref:u,onFocusFromOutsideViewport:()=>{const x=m({tabbingDirection:"backwards"});Oy(x)}})]})});$M.displayName=FM;var BM="ToastFocusProxy",gS=C.forwardRef((t,e)=>{const{__scopeToast:n,onFocusFromOutsideViewport:r,...s}=t,i=Em(BM,n);return d.jsx(pw,{"aria-hidden":!0,tabIndex:0,...s,ref:e,style:{position:"fixed"},onFocus:o=>{var c;const a=o.relatedTarget;!((c=i.viewport)!=null&&c.contains(a))&&r()}})});gS.displayName=BM;var Tm="Toast",Vre="toast.swipeStart",qre="toast.swipeMove",Yre="toast.swipeCancel",Xre="toast.swipeEnd",UM=C.forwardRef((t,e)=>{const{forceMount:n,open:r,defaultOpen:s,onOpenChange:i,...o}=t,[a=!0,l]=Pa({prop:r,defaultProp:s,onChange:i});return d.jsx(Ks,{present:n||a,children:d.jsx(Jre,{open:a,...o,ref:e,onClose:()=>l(!1),onPause:Mn(t.onPause),onResume:Mn(t.onResume),onSwipeStart:ve(t.onSwipeStart,c=>{c.currentTarget.setAttribute("data-swipe","start")}),onSwipeMove:ve(t.onSwipeMove,c=>{const{x:u,y:h}=c.detail.delta;c.currentTarget.setAttribute("data-swipe","move"),c.currentTarget.style.setProperty("--radix-toast-swipe-move-x",`${u}px`),c.currentTarget.style.setProperty("--radix-toast-swipe-move-y",`${h}px`)}),onSwipeCancel:ve(t.onSwipeCancel,c=>{c.currentTarget.setAttribute("data-swipe","cancel"),c.currentTarget.style.removeProperty("--radix-toast-swipe-move-x"),c.currentTarget.style.removeProperty("--radix-toast-swipe-move-y"),c.currentTarget.style.removeProperty("--radix-toast-swipe-end-x"),c.currentTarget.style.removeProperty("--radix-toast-swipe-end-y")}),onSwipeEnd:ve(t.onSwipeEnd,c=>{const{x:u,y:h}=c.detail.delta;c.currentTarget.setAttribute("data-swipe","end"),c.currentTarget.style.removeProperty("--radix-toast-swipe-move-x"),c.currentTarget.style.removeProperty("--radix-toast-swipe-move-y"),c.currentTarget.style.setProperty("--radix-toast-swipe-end-x",`${u}px`),c.currentTarget.style.setProperty("--radix-toast-swipe-end-y",`${h}px`),l(!1)})})})});UM.displayName=Tm;var[Zre,Qre]=NM(Tm,{onClose(){}}),Jre=C.forwardRef((t,e)=>{const{__scopeToast:n,type:r="foreground",duration:s,open:i,onClose:o,onEscapeKeyDown:a,onPause:l,onResume:c,onSwipeStart:u,onSwipeMove:h,onSwipeCancel:p,onSwipeEnd:f,...v}=t,m=Em(Tm,n),[x,y]=C.useState(null),S=xt(e,N=>y(N)),w=C.useRef(null),P=C.useRef(null),E=s||m.duration,M=C.useRef(0),I=C.useRef(E),_=C.useRef(0),{onToastAdd:D,onToastRemove:R}=m,$=Mn(()=>{var H;(x==null?void 0:x.contains(document.activeElement))&&((H=m.viewport)==null||H.focus()),o()}),U=C.useCallback(N=>{!N||N===1/0||(window.clearTimeout(_.current),M.current=new Date().getTime(),_.current=window.setTimeout($,N))},[$]);C.useEffect(()=>{const N=m.viewport;if(N){const H=()=>{U(I.current),c==null||c()},Z=()=>{const q=new Date().getTime()-M.current;I.current=I.current-q,window.clearTimeout(_.current),l==null||l()};return N.addEventListener(pS,Z),N.addEventListener(fS,H),()=>{N.removeEventListener(pS,Z),N.removeEventListener(fS,H)}}},[m.viewport,E,l,c,U]),C.useEffect(()=>{i&&!m.isClosePausedRef.current&&U(E)},[i,E,m.isClosePausedRef,U]),C.useEffect(()=>(D(),()=>R()),[D,R]);const O=C.useMemo(()=>x?YM(x):null,[x]);return m.viewport?d.jsxs(d.Fragment,{children:[O&&d.jsx(ese,{__scopeToast:n,role:"status","aria-live":r==="foreground"?"assertive":"polite","aria-atomic":!0,children:O}),d.jsx(Zre,{scope:n,onClose:$,children:xl.createPortal(d.jsx(gw.ItemSlot,{scope:n,children:d.jsx(Cne,{asChild:!0,onEscapeKeyDown:ve(a,()=>{m.isFocusedToastEscapeKeyDownRef.current||$(),m.isFocusedToastEscapeKeyDownRef.current=!1}),children:d.jsx(Ye.li,{role:"status","aria-live":"off","aria-atomic":!0,tabIndex:0,"data-state":i?"open":"closed","data-swipe-direction":m.swipeDirection,...v,ref:S,style:{userSelect:"none",touchAction:"none",...t.style},onKeyDown:ve(t.onKeyDown,N=>{N.key==="Escape"&&(a==null||a(N.nativeEvent),N.nativeEvent.defaultPrevented||(m.isFocusedToastEscapeKeyDownRef.current=!0,$()))}),onPointerDown:ve(t.onPointerDown,N=>{N.button===0&&(w.current={x:N.clientX,y:N.clientY})}),onPointerMove:ve(t.onPointerMove,N=>{if(!w.current)return;const H=N.clientX-w.current.x,Z=N.clientY-w.current.y,q=!!P.current,V=["left","right"].includes(m.swipeDirection),Q=["left","up"].includes(m.swipeDirection)?Math.min:Math.max,ne=V?Q(0,H):0,le=V?0:Q(0,Z),de=N.pointerType==="touch"?10:2,_e={x:ne,y:le},je={originalEvent:N,delta:_e};q?(P.current=_e,Y0(qre,h,je,{discrete:!1})):r8(_e,m.swipeDirection,de)?(P.current=_e,Y0(Vre,u,je,{discrete:!1}),N.target.setPointerCapture(N.pointerId)):(Math.abs(H)>de||Math.abs(Z)>de)&&(w.current=null)}),onPointerUp:ve(t.onPointerUp,N=>{const H=P.current,Z=N.target;if(Z.hasPointerCapture(N.pointerId)&&Z.releasePointerCapture(N.pointerId),P.current=null,w.current=null,H){const q=N.currentTarget,V={originalEvent:N,delta:H};r8(H,m.swipeDirection,m.swipeThreshold)?Y0(Xre,f,V,{discrete:!0}):Y0(Yre,p,V,{discrete:!0}),q.addEventListener("click",Q=>Q.preventDefault(),{once:!0})}})})})}),m.viewport)})]}):null}),ese=t=>{const{__scopeToast:e,children:n,...r}=t,s=Em(Tm,e),[i,o]=C.useState(!1),[a,l]=C.useState(!1);return rse(()=>o(!0)),C.useEffect(()=>{const c=window.setTimeout(()=>l(!0),1e3);return()=>window.clearTimeout(c)},[]),a?null:d.jsx(Rh,{asChild:!0,children:d.jsx(pw,{...r,children:i&&d.jsxs(d.Fragment,{children:[s.label," ",n]})})})},tse="ToastTitle",HM=C.forwardRef((t,e)=>{const{__scopeToast:n,...r}=t;return d.jsx(Ye.div,{...r,ref:e})});HM.displayName=tse;var nse="ToastDescription",WM=C.forwardRef((t,e)=>{const{__scopeToast:n,...r}=t;return d.jsx(Ye.div,{...r,ref:e})});WM.displayName=nse;var KM="ToastAction",GM=C.forwardRef((t,e)=>{const{altText:n,...r}=t;return n.trim()?d.jsx(qM,{altText:n,asChild:!0,children:d.jsx(mw,{...r,ref:e})}):(console.error(`Invalid prop \`altText\` supplied to \`${KM}\`. Expected non-empty \`string\`.`),null)});GM.displayName=KM;var VM="ToastClose",mw=C.forwardRef((t,e)=>{const{__scopeToast:n,...r}=t,s=Qre(VM,n);return d.jsx(qM,{asChild:!0,children:d.jsx(Ye.button,{type:"button",...r,ref:e,onClick:ve(t.onClick,s.onClose)})})});mw.displayName=VM;var qM=C.forwardRef((t,e)=>{const{__scopeToast:n,altText:r,...s}=t;return d.jsx(Ye.div,{"data-radix-toast-announce-exclude":"","data-radix-toast-announce-alt":r||void 0,...s,ref:e})});function YM(t){const e=[];return Array.from(t.childNodes).forEach(r=>{if(r.nodeType===r.TEXT_NODE&&r.textContent&&e.push(r.textContent),sse(r)){const s=r.ariaHidden||r.hidden||r.style.display==="none",i=r.dataset.radixToastAnnounceExclude==="";if(!s)if(i){const o=r.dataset.radixToastAnnounceAlt;o&&e.push(o)}else e.push(...YM(r))}}),e}function Y0(t,e,n,{discrete:r}){const s=n.originalEvent.currentTarget,i=new CustomEvent(t,{bubbles:!0,cancelable:!0,detail:n});e&&s.addEventListener(t,e,{once:!0}),r?ow(s,i):s.dispatchEvent(i)}var r8=(t,e,n=0)=>{const r=Math.abs(t.x),s=Math.abs(t.y),i=r>s;return e==="left"||e==="right"?i&&r>n:!i&&s>n};function rse(t=()=>{}){const e=Mn(t);la(()=>{let n=0,r=0;return n=window.requestAnimationFrame(()=>r=window.requestAnimationFrame(e)),()=>{window.cancelAnimationFrame(n),window.cancelAnimationFrame(r)}},[e])}function sse(t){return t.nodeType===t.ELEMENT_NODE}function ise(t){const e=[],n=document.createTreeWalker(t,NodeFilter.SHOW_ELEMENT,{acceptNode:r=>{const s=r.tagName==="INPUT"&&r.type==="hidden";return r.disabled||r.hidden||s?NodeFilter.FILTER_SKIP:r.tabIndex>=0?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});for(;n.nextNode();)e.push(n.currentNode);return e}function Oy(t){const e=document.activeElement;return t.some(n=>n===e?!0:(n.focus(),document.activeElement!==e))}var ose=UM,ase=HM,lse=WM,cse=GM,s8=mw;const XM=C.createContext(null);function use({children:t}){const[e,n]=C.useState([]),r=C.useCallback(o=>{const a=o.id??dt();return n(l=>[...l.filter(c=>c.id!==o.id),{...o,id:a}]),a},[]),s=C.useCallback(o=>(n(a=>a.filter(l=>l.id!==o)),o),[]),i=C.useCallback(()=>{n(()=>[])},[]);return d.jsx(zM,{children:d.jsx(XM.Provider,{value:{toasts:e,addToast:r,removeToast:s,clearToasts:i},children:t})})}function Vs(){const t=C.useContext(XM);if(!t)throw new Error("useToasts must be used within a ToastsProvider");return t}const Ce=C.forwardRef(function({children:e,disabled:n,type:r,...s},i){return d.jsx("button",{ref:i,type:"button",draggable:!1,disabled:n,...s,className:be("tlui-button",`tlui-button__${r}`,s.className),children:e})});function qt({children:t}){return d.jsx("span",{className:"tlui-button__label",children:t})}const bi=C.memo(function({small:e,invertIcon:n,icon:r,color:s,className:i,...o}){const a=nw(),l=a.icons[r]??a.icons["question-mark-circle"],c=C.useRef(null);return C.useLayoutEffect(()=>{l||console.error(`Icon not found: ${r}. Add it to the assetUrls.icons object.`),c!=null&&c.current&&(c.current.style.webkitMask=`url(${l}) center 100% / 100% no-repeat`)},[c,l,r]),r==="none"?d.jsx("div",{className:be("tlui-icon tlui-icon__placeholder",{"tlui-icon__small":e},i)}):d.jsx("div",{...o,ref:c,className:be("tlui-icon",{"tlui-icon__small":e},i),style:{color:s,mask:`url(${l}) center 100% / 100% no-repeat`,transform:n?"scale(-1, 1)":void 0}})}),dse={success:"check-circle",warning:"warning-triangle",error:"cross-circle",info:"info-circle"};function hse({toast:t}){const{removeToast:e}=Vs(),n=Be(),r=o=>{o||e(t.id)},s=t.actions&&t.actions.length>0,i=t.icon||t.severity&&dse[t.severity];return d.jsxs(ose,{onOpenChange:r,className:"tlui-toast__container",duration:t.keepOpen?1/0:5e3,"data-severity":t.severity,children:[i&&d.jsx("div",{className:"tlui-toast__icon",children:d.jsx(bi,{icon:i})}),d.jsxs("div",{className:"tlui-toast__main",children:[d.jsxs("div",{className:"tlui-toast__content",children:[t.title&&d.jsx(ase,{className:"tlui-toast__title",children:t.title}),t.description&&d.jsx(lse,{className:"tlui-toast__description",children:t.description})]}),t.actions&&d.jsxs("div",{className:"tlui-toast__actions",children:[t.actions.map((o,a)=>d.jsx(cse,{altText:o.label,asChild:!0,onClick:o.onClick,children:d.jsx(Ce,{type:o.type,children:d.jsx(qt,{children:o.label})})},a)),d.jsx(s8,{asChild:!0,children:d.jsx(Ce,{type:"normal",className:"tlui-toast__close",style:{marginLeft:"auto"},children:d.jsx(qt,{children:t.closeLabel??n("toast.close")})})})]})]}),!s&&d.jsx(s8,{asChild:!0,children:d.jsx(Ce,{type:"normal",className:"tlui-toast__close",children:d.jsx(qt,{children:t.closeLabel??n("toast.close")})})})]})}function pse(){const{toasts:t}=Vs();return t.map(e=>d.jsx(hse,{toast:e},e.id))}const fse=C.memo(pse);function gse(){const t=G(),{toasts:e}=Vs(),[n,r]=C.useState(!1);return C.useEffect(()=>{let s=-1;return e.length?r(!0):s=t.timers.setTimeout(()=>{r(!1)},1e3),()=>{clearTimeout(s)}},[e.length,r,t]),n?d.jsx($M,{className:"tlui-toast__viewport"}):null}function Fe({icon:t,small:e,invertIcon:n}){return d.jsx(bi,{className:"tlui-button__icon",icon:t,small:e,invertIcon:n})}const Ly=[0,390,428,468,580,640,840,1023];var Wt=(t=>(t[t.ZERO=0]="ZERO",t[t.MOBILE_XXS=1]="MOBILE_XXS",t[t.MOBILE_XS=2]="MOBILE_XS",t[t.MOBILE_SM=3]="MOBILE_SM",t[t.MOBILE=4]="MOBILE",t[t.TABLET_SM=5]="TABLET_SM",t[t.TABLET=6]="TABLET",t[t.DESKTOP=7]="DESKTOP",t))(Wt||{});let mS={fonts:{draw:`${$o()}/fonts/Shantell_Sans-Tldrawish.woff2`,serif:`${$o()}/fonts/IBMPlexSerif-Medium.woff2`,sansSerif:`${$o()}/fonts/IBMPlexSans-Medium.woff2`,monospace:`${$o()}/fonts/IBMPlexMono-Medium.woff2`}};function ZM(t){return C.useMemo(()=>t?{fonts:{...mS.fonts,...t==null?void 0:t.fonts}}:mS,[t])}const mse=["align-bottom","align-center-horizontal","align-center-vertical","align-left","align-right","align-top","arrow-left","arrowhead-arrow","arrowhead-bar","arrowhead-diamond","arrowhead-dot","arrowhead-none","arrowhead-square","arrowhead-triangle-inverted","arrowhead-triangle","blob","bring-forward","bring-to-front","broken","check-circle","check","chevron-down","chevron-left","chevron-right","chevron-up","chevrons-ne","chevrons-sw","clipboard-copied","clipboard-copy","color","cross-2","cross-circle","dash-dashed","dash-dotted","dash-draw","dash-solid","disconnected","discord","distribute-horizontal","distribute-vertical","dot","dots-horizontal","dots-vertical","drag-handle-dots","duplicate","edit","external-link","fill-fill","fill-none","fill-pattern","fill-semi","fill-solid","follow","following","font-draw","font-mono","font-sans","font-serif","geo-arrow-down","geo-arrow-left","geo-arrow-right","geo-arrow-up","geo-check-box","geo-cloud","geo-diamond","geo-ellipse","geo-heart","geo-hexagon","geo-octagon","geo-oval","geo-pentagon","geo-rectangle","geo-rhombus-2","geo-rhombus","geo-star","geo-trapezoid","geo-triangle","geo-x-box","github","group","horizontal-align-end","horizontal-align-middle","horizontal-align-start","info-circle","leading","link","lock","menu","minus","mixed","pack","plus","question-mark-circle","question-mark","redo","reset-zoom","rotate-ccw","rotate-cw","send-backward","send-to-back","share-1","size-extra-large","size-large","size-medium","size-small","spline-cubic","spline-line","stack-horizontal","stack-vertical","status-offline","stretch-horizontal","stretch-vertical","text-align-center","text-align-left","text-align-right","toggle-off","toggle-on","tool-arrow","tool-eraser","tool-frame","tool-hand","tool-highlight","tool-laser","tool-line","tool-media","tool-note","tool-pencil","tool-pointer","tool-screenshot","tool-text","trash","twitter","undo","ungroup","unlock","vertical-align-end","vertical-align-middle","vertical-align-start","warning-triangle","zoom-in","zoom-out"];let Au={...mS,icons:Object.fromEntries(mse.map(t=>[t,`${$o()}/icons/icon/${t}.svg`])),translations:Object.fromEntries(Zd.map(t=>[t.locale,`${$o()}/translations/${t.locale}.json`])),embedIcons:Object.fromEntries(Ch.map(t=>[t.type,`${$o()}/embed-icons/${t.type}.png`]))};function yse(t){return t?{fonts:Object.assign({...Au.fonts},{...t==null?void 0:t.fonts}),icons:Object.assign({...Au.icons},{...t==null?void 0:t.icons}),embedIcons:Object.assign({...Au.embedIcons},{...t==null?void 0:t.embedIcons}),translations:Object.assign({...Au.translations},{...t==null?void 0:t.translations})}:Au}function Mm({className:t,children:e}){return d.jsx("div",{className:be("tlui-dialog__header",t),children:e})}function _m({className:t,children:e}){return d.jsx(TM,{dir:"ltr",className:be("tlui-dialog__header__title",t),children:e})}function Am(){return d.jsx("div",{className:"tlui-dialog__header__close",children:d.jsx(AM,{"data-testid":"dialog.close",dir:"ltr",asChild:!0,children:d.jsx(Ce,{type:"icon","aria-label":"Close",onTouchEnd:t=>t.target.click(),children:d.jsx(Fe,{small:!0,icon:"cross-2"})})})})}function th({className:t,children:e,style:n}){return d.jsx("div",{className:be("tlui-dialog__body",t),style:n,children:e})}function yw({className:t,children:e}){return d.jsx("div",{className:be("tlui-dialog__footer",t),children:e})}const Dm=C.forwardRef(function({className:e,label:n,icon:r,iconLeft:s,autoSelect:i=!1,autoFocus:o=!1,defaultValue:a,placeholder:l,onComplete:c,onValueChange:u,onCancel:h,onFocus:p,onBlur:f,shouldManuallyMaintainScrollPositionWhenFocused:v=!1,children:m,value:x},y){const S=G(),w=C.useRef(null);C.useImperativeHandle(y,()=>w.current);const P=Be(),E=C.useRef(a??""),M=C.useRef(a??""),[I,_]=C.useState(!1),D=C.useCallback(O=>{_(!0);const N=O.currentTarget;M.current=N.value,S.timers.requestAnimationFrame(()=>{i&&N.select()}),p==null||p()},[i,p,S.timers]),R=C.useCallback(O=>{const N=O.currentTarget.value;M.current=N,u==null||u(N)},[u]),$=C.useCallback(O=>{switch(O.key){case"Enter":{O.currentTarget.blur(),sn(O),c==null||c(O.currentTarget.value);break}case"Escape":{O.currentTarget.value=E.current,O.currentTarget.blur(),sn(O),h==null||h(O.currentTarget.value);break}}},[c,h]),U=C.useCallback(O=>{_(!1);const N=O.currentTarget.value;f==null||f(N)},[f]);return C.useEffect(()=>{if(!S.environment.isIos)return;const O=window.visualViewport;if(I&&v&&O){const N=()=>{var H;(H=w.current)==null||H.scrollIntoView({block:"center"})};return O.addEventListener("resize",N),O.addEventListener("scroll",N),S.timers.requestAnimationFrame(()=>{var H;(H=w.current)==null||H.scrollIntoView({block:"center"})}),()=>{O.removeEventListener("resize",N),O.removeEventListener("scroll",N)}}},[S,I,v]),d.jsxs("div",{draggable:!1,className:"tlui-input__wrapper",children:[m,n&&d.jsx("label",{children:P(n)}),s&&d.jsx(bi,{icon:s,className:"tlui-icon-left",small:!0}),d.jsx("input",{ref:w,className:be("tlui-input",e),type:"text",defaultValue:a,onKeyUp:$,onChange:R,onFocus:D,onBlur:U,autoFocus:o,placeholder:l,value:x}),r&&d.jsx(bi,{icon:r,small:!!n})]})}),QM=gn(function({onClose:e}){const n=G(),r=Be(),s=nw(),[i,o]=C.useState(null),[a,l]=C.useState(""),[c,u]=C.useState(null),[h,p]=C.useState(!1),f=C.useRef(-1);return d.jsxs(d.Fragment,{children:[d.jsxs(Mm,{children:[d.jsx(_m,{children:i?`${r("embed-dialog.title")} — ${i.title}`:r("embed-dialog.title")}),d.jsx(Am,{})]}),i?d.jsxs(d.Fragment,{children:[d.jsxs(th,{className:"tlui-embed-dialog__enter",children:[d.jsx(Dm,{className:"tlui-embed-dialog__input",label:"embed-dialog.url",placeholder:"http://example.com",autoFocus:!0,onValueChange:v=>{l(v);const m=Uo(v);u(m&&m.definition.type===i.type?m:null),p(!1),clearTimeout(f.current),f.current=n.timers.setTimeout(()=>p(!m),320)}}),a===""?d.jsxs("div",{className:"tlui-embed-dialog__instruction",children:[d.jsx("span",{children:r("embed-dialog.instruction")})," ",i.instructionLink&&d.jsxs("a",{target:"_blank",rel:"noopener noreferrer",href:i.instructionLink,className:"tlui-embed-dialog__instruction__link",children:["Learn more.",d.jsx(bi,{icon:"external-link",small:!0})]})]}):d.jsx("div",{className:"tlui-embed-dialog__warning",children:h?r("embed-dialog.invalid-url"):" "})]}),d.jsxs(yw,{className:"tlui-dialog__footer__actions",children:[d.jsx(Ce,{type:"normal",onClick:()=>{o(null),u(null),l("")},children:d.jsx(qt,{children:r("embed-dialog.back")})}),d.jsx("div",{className:"tlui-embed__spacer"}),d.jsx(Ce,{type:"normal",onClick:e,children:d.jsx(qt,{children:r("embed-dialog.cancel")})}),d.jsx(Ce,{type:"primary",disabled:!c,onClick:()=>{c&&(n.putExternalContent({type:"embed",url:a,point:n.getViewportPageBounds().center,embed:c.definition}),e())},children:d.jsx(qt,{children:r("embed-dialog.create")})})]})]}):d.jsx(d.Fragment,{children:d.jsx(th,{className:"tlui-embed-dialog__list",children:Ch.map(v=>d.jsxs(Ce,{type:"menu",onClick:()=>o(v),children:[d.jsx(qt,{children:v.title}),d.jsx("div",{className:"tlui-embed-dialog__item__image",style:{backgroundImage:`url(${s.embedIcons[v.type]})`}})]},v.type))})})]})});function JM(){const t=G(),e=C.useRef();return C.useEffect(()=>{const n=window.document.createElement("input");n.type="file",n.accept=PG,n.multiple=!0,e.current=n;async function r(s){const i=s.target.files;!i||i.length===0||(t.mark("insert media"),await t.putExternalContent({type:"files",files:Array.from(i),point:t.getViewportPageBounds().center,ignoreParent:!1}),n.value="")}return n.addEventListener("change",r),()=>{e.current=void 0,n.removeEventListener("change",r)}},[t]),C.useCallback(()=>{var n;(n=e.current)==null||n.click()},[e])}const e_=C.createContext(null);function vse({overrides:t,children:e}){const n=G(),r=An(),{addDialog:s}=Pl(),i=JM(),o=C.useMemo(()=>{const a=[{id:"select",label:"tool.select",icon:"tool-pointer",kbd:"v",readonlyOk:!0,onSelect(c){n.setCurrentTool("select"),r("select-tool",{source:c,id:"select"})}},{id:"hand",label:"tool.hand",icon:"tool-hand",kbd:"h",readonlyOk:!0,onSelect(c){n.setCurrentTool("hand"),r("select-tool",{source:c,id:"hand"})}},{id:"eraser",label:"tool.eraser",icon:"tool-eraser",kbd:"e",onSelect(c){n.setCurrentTool("eraser"),r("select-tool",{source:c,id:"eraser"})}},{id:"draw",label:"tool.draw",icon:"tool-pencil",kbd:"d,b,x",onSelect(c){n.setCurrentTool("draw"),r("select-tool",{source:c,id:"draw"})}},...[...Os.values].map(c=>({id:c,label:`tool.${c}`,meta:{geo:c},kbd:c==="rectangle"?"r":c==="ellipse"?"o":void 0,icon:"geo-"+c,onSelect(u){n.run(()=>{n.setStyleForNextShapes(Os,c),n.setCurrentTool("geo"),r("select-tool",{source:u,id:`geo-${c}`})})}})),{id:"arrow",label:"tool.arrow",icon:"tool-arrow",kbd:"a",onSelect(c){n.setCurrentTool("arrow"),r("select-tool",{source:c,id:"arrow"})}},{id:"line",label:"tool.line",icon:"tool-line",kbd:"l",onSelect(c){n.setCurrentTool("line"),r("select-tool",{source:c,id:"line"})}},{id:"frame",label:"tool.frame",icon:"tool-frame",kbd:"f",onSelect(c){n.setCurrentTool("frame"),r("select-tool",{source:c,id:"frame"})}},{id:"text",label:"tool.text",icon:"tool-text",kbd:"t",onSelect(c){n.setCurrentTool("text"),r("select-tool",{source:c,id:"text"})}},{id:"asset",label:"tool.asset",icon:"tool-media",kbd:"$u",onSelect(c){i(),r("select-tool",{source:c,id:"media"})}},{id:"note",label:"tool.note",icon:"tool-note",kbd:"n",onSelect(c){n.setCurrentTool("note"),r("select-tool",{source:c,id:"note"})}},{id:"laser",label:"tool.laser",readonlyOk:!0,icon:"tool-laser",kbd:"k",onSelect(c){n.setCurrentTool("laser"),r("select-tool",{source:c,id:"laser"})}},{id:"embed",label:"tool.embed",icon:"dot",onSelect(c){s({component:QM}),r("select-tool",{source:c,id:"embed"})}},{id:"highlight",label:"tool.highlight",icon:"tool-highlight",kbd:"!d",onSelect(c){n.setCurrentTool("highlight"),r("select-tool",{source:c,id:"highlight"})}}];a.push();const l=Object.fromEntries(a.map(c=>[c.id,c]));return t?t(n,l,{insertMedia:i}):l},[t,n,r,i,s]);return d.jsx(e_.Provider,{value:o,children:e})}function Fc(){const t=C.useContext(e_);if(!t)throw new Error("useTools must be used within a ToolProvider");return t}const t_=Ne.createContext(null);function Sse({forceMobile:t=!1,children:e}){const n=G(),r=J("breakpoint",()=>{const{width:s}=n.getViewportScreenBounds(),i=t?Wt.MOBILE_SM:Ly.length-1;for(let o=0;o<i;o++)if(s>Ly[o]&&s<=Ly[o+1])return o;return i},[n]);return d.jsx(t_.Provider,{value:r,children:e})}function or(){const t=C.useContext(t_);if(t===null)throw new Error("useBreakpoint must be used inside of the <BreakpointProvider /> component");return t}function xse(){const{addToast:t,removeToast:e,clearToasts:n}=Vs(),{addDialog:r,clearDialogs:s,removeDialog:i,updateDialog:o}=Pl(),l=or()<Wt.TABLET_SM,c=Be();return C.useMemo(()=>({addToast:t,removeToast:e,clearToasts:n,addDialog:r,clearDialogs:s,removeDialog:i,updateDialog:o,msg:c,isMobile:l}),[r,t,s,n,c,i,e,o,l])}function wse(t,e){const n={};for(const r of t)if(r.translations)for(const[s,i]of In(r.translations)){let o=n[s];o||(o=n[s]={}),Object.assign(o,i)}return{actions:(r,s)=>{for(const i of t)i.actions&&(s=i.actions(r,s,e));return s},tools:(r,s,i)=>{for(const o of t)o.tools&&(s=o.tools(r,s,{...e,...i}));return s},translations:n}}function n_(t){return C.useMemo(()=>t,t)}function bse(t){const e=n_(t==null?[]:Array.isArray(t)?t:[t]);return C.useMemo(()=>{const n={};for(const r of e)if(r.translations)for(const[s,i]of In(r.translations)){let o=n[s];o||(o=n[s]={}),Object.assign(o,i)}return n},[e])}function Cse(t){const e=xse(),n=n_(t==null?[]:Array.isArray(t)?t:[t]);return C.useMemo(()=>wse(n,e),[n,e])}function Pse(t,e){const n=Le(e.map(s=>t.getShape(s)).filter(s=>s&&t.isShapeOfType(s,"frame")));if(!n.length)return;const r=[];t.run(()=>{n.map(s=>{const i=t.getSortedChildIdsForParent(s.id);i.length&&(t.reparentShapes(i,s.parentId,s.index),r.push(...i))}),t.setSelectedShapes(r),t.deleteShapes(e)})}const kse=50;function Ise(t,e,n={}){const r=t.getShape(e);if(!r)return;const s=t.getSortedChildIdsForParent(r.id),i=Le(s.map(f=>t.getShape(f)));if(!i.length)return;const o=fe.FromPoints(i.flatMap(f=>{const v=t.getShapeGeometry(f.id);return t.getShapeLocalTransform(f).applyToPoints(v.vertices)})),{padding:a=kse}=n,l=o.w+2*a,c=o.h+2*a,u=a-o.minX,h=a-o.minY;if(u===0&&h===0&&r.props.w===l&&r.props.h===c)return;const p=new b(u,h).rot(r.rotation);t.run(()=>{const f=s.map(v=>{const m=t.getShape(v);return{id:m.id,type:m.type,x:m.x+u,y:m.y+h}});f.push({id:r.id,type:r.type,x:r.x-p.x,y:r.y-p.y,props:{w:l,h:c}}),t.updateShapes(f)})}function i8(t){return Vr.isValid(t)?{isValid:!0,hasProtocol:!0}:Vr.isValid("https://"+t)?{isValid:!0,hasProtocol:!1}:{isValid:!1,hasProtocol:!1}}const Ese=gn(function({onClose:e}){const r=G().getOnlySelectedShape();return r&&"url"in r.props&&typeof r.props.url=="string"?d.jsx(Tse,{onClose:e,selectedShape:r}):null}),Tse=gn(function({onClose:e,selectedShape:n}){const r=G(),s=Be(),i=C.useRef(null);C.useEffect(()=>{r.timers.requestAnimationFrame(()=>{var v;return(v=i.current)==null?void 0:v.focus()})},[r]);const o=C.useRef(n.props.url),[a,l]=C.useState(()=>{const v=i8(n.props.url),m=v.isValid===!0?v.hasProtocol?n.props.url:"https://"+n.props.url:"https://";return{actual:m,safe:m,valid:!0}}),c=C.useCallback(v=>{const m=v.replace(/https?:\/\/(https?:\/\/)/,(S,w)=>w),x=i8(m),y=x.isValid===!0?x.hasProtocol?m:"https://"+m:"https://";l({actual:m,safe:y,valid:x.isValid})},[]),u=C.useCallback(()=>{const v=r.getOnlySelectedShape();v&&(r.updateShapes([{id:v.id,type:v.type,props:{url:""}}]),e())},[r,e]),h=C.useCallback(()=>{const v=r.getOnlySelectedShape();v&&(v&&"url"in v.props&&v.props.url!==a.safe&&r.updateShapes([{id:v.id,type:v.type,props:{url:a.safe}}]),e())},[r,e,a]),p=C.useCallback(()=>{e()},[e]);if(!n)return e(),null;const f=o.current&&!a.valid;return d.jsxs(d.Fragment,{children:[d.jsxs(Mm,{children:[d.jsx(_m,{children:s("edit-link-dialog.title")}),d.jsx(Am,{})]}),d.jsx(th,{children:d.jsxs("div",{className:"tlui-edit-link-dialog",children:[d.jsx(Dm,{ref:i,className:"tlui-edit-link-dialog__input",label:"edit-link-dialog.url",autoFocus:!0,value:a.actual,onValueChange:c,onComplete:h,onCancel:p}),d.jsx("div",{children:a.valid?s("edit-link-dialog.detail"):s("edit-link-dialog.invalid-url")})]})}),d.jsxs(yw,{className:"tlui-dialog__footer__actions",children:[d.jsx(Ce,{type:"normal",onClick:p,onTouchEnd:p,children:d.jsx(qt,{children:s("edit-link-dialog.cancel")})}),f?d.jsx(Ce,{type:"danger",onTouchEnd:u,onClick:u,children:d.jsx(qt,{children:s("edit-link-dialog.clear")})}):d.jsx(Ce,{type:"primary",disabled:!a.valid,onTouchEnd:h,onClick:h,children:d.jsx(qt,{children:s("edit-link-dialog.save")})})]})]})});var vw={exports:{}};vw.exports;(function(t){var e=function(){var n=String.fromCharCode,r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",s="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+-$",i={};function o(l,c){if(!i[l]){i[l]={};for(var u=0;u<l.length;u++)i[l][l.charAt(u)]=u}return i[l][c]}var a={compressToBase64:function(l){if(l==null)return"";var c=a._compress(l,6,function(u){return r.charAt(u)});switch(c.length%4){default:case 0:return c;case 1:return c+"===";case 2:return c+"==";case 3:return c+"="}},decompressFromBase64:function(l){return l==null?"":l==""?null:a._decompress(l.length,32,function(c){return o(r,l.charAt(c))})},compressToUTF16:function(l){return l==null?"":a._compress(l,15,function(c){return n(c+32)})+" "},decompressFromUTF16:function(l){return l==null?"":l==""?null:a._decompress(l.length,16384,function(c){return l.charCodeAt(c)-32})},compressToUint8Array:function(l){for(var c=a.compress(l),u=new Uint8Array(c.length*2),h=0,p=c.length;h<p;h++){var f=c.charCodeAt(h);u[h*2]=f>>>8,u[h*2+1]=f%256}return u},decompressFromUint8Array:function(l){if(l==null)return a.decompress(l);for(var c=new Array(l.length/2),u=0,h=c.length;u<h;u++)c[u]=l[u*2]*256+l[u*2+1];var p=[];return c.forEach(function(f){p.push(n(f))}),a.decompress(p.join(""))},compressToEncodedURIComponent:function(l){return l==null?"":a._compress(l,6,function(c){return s.charAt(c)})},decompressFromEncodedURIComponent:function(l){return l==null?"":l==""?null:(l=l.replace(/ /g,"+"),a._decompress(l.length,32,function(c){return o(s,l.charAt(c))}))},compress:function(l){return a._compress(l,16,function(c){return n(c)})},_compress:function(l,c,u){if(l==null)return"";var h,p,f={},v={},m="",x="",y="",S=2,w=3,P=2,E=[],M=0,I=0,_;for(_=0;_<l.length;_+=1)if(m=l.charAt(_),Object.prototype.hasOwnProperty.call(f,m)||(f[m]=w++,v[m]=!0),x=y+m,Object.prototype.hasOwnProperty.call(f,x))y=x;else{if(Object.prototype.hasOwnProperty.call(v,y)){if(y.charCodeAt(0)<256){for(h=0;h<P;h++)M=M<<1,I==c-1?(I=0,E.push(u(M)),M=0):I++;for(p=y.charCodeAt(0),h=0;h<8;h++)M=M<<1|p&1,I==c-1?(I=0,E.push(u(M)),M=0):I++,p=p>>1}else{for(p=1,h=0;h<P;h++)M=M<<1|p,I==c-1?(I=0,E.push(u(M)),M=0):I++,p=0;for(p=y.charCodeAt(0),h=0;h<16;h++)M=M<<1|p&1,I==c-1?(I=0,E.push(u(M)),M=0):I++,p=p>>1}S--,S==0&&(S=Math.pow(2,P),P++),delete v[y]}else for(p=f[y],h=0;h<P;h++)M=M<<1|p&1,I==c-1?(I=0,E.push(u(M)),M=0):I++,p=p>>1;S--,S==0&&(S=Math.pow(2,P),P++),f[x]=w++,y=String(m)}if(y!==""){if(Object.prototype.hasOwnProperty.call(v,y)){if(y.charCodeAt(0)<256){for(h=0;h<P;h++)M=M<<1,I==c-1?(I=0,E.push(u(M)),M=0):I++;for(p=y.charCodeAt(0),h=0;h<8;h++)M=M<<1|p&1,I==c-1?(I=0,E.push(u(M)),M=0):I++,p=p>>1}else{for(p=1,h=0;h<P;h++)M=M<<1|p,I==c-1?(I=0,E.push(u(M)),M=0):I++,p=0;for(p=y.charCodeAt(0),h=0;h<16;h++)M=M<<1|p&1,I==c-1?(I=0,E.push(u(M)),M=0):I++,p=p>>1}S--,S==0&&(S=Math.pow(2,P),P++),delete v[y]}else for(p=f[y],h=0;h<P;h++)M=M<<1|p&1,I==c-1?(I=0,E.push(u(M)),M=0):I++,p=p>>1;S--,S==0&&(S=Math.pow(2,P),P++)}for(p=2,h=0;h<P;h++)M=M<<1|p&1,I==c-1?(I=0,E.push(u(M)),M=0):I++,p=p>>1;for(;;)if(M=M<<1,I==c-1){E.push(u(M));break}else I++;return E.join("")},decompress:function(l){return l==null?"":l==""?null:a._decompress(l.length,32768,function(c){return l.charCodeAt(c)})},_decompress:function(l,c,u){var h=[],p=4,f=4,v=3,m="",x=[],y,S,w,P,E,M,I,_={val:u(0),position:c,index:1};for(y=0;y<3;y+=1)h[y]=y;for(w=0,E=Math.pow(2,2),M=1;M!=E;)P=_.val&_.position,_.position>>=1,_.position==0&&(_.position=c,_.val=u(_.index++)),w|=(P>0?1:0)*M,M<<=1;switch(w){case 0:for(w=0,E=Math.pow(2,8),M=1;M!=E;)P=_.val&_.position,_.position>>=1,_.position==0&&(_.position=c,_.val=u(_.index++)),w|=(P>0?1:0)*M,M<<=1;I=n(w);break;case 1:for(w=0,E=Math.pow(2,16),M=1;M!=E;)P=_.val&_.position,_.position>>=1,_.position==0&&(_.position=c,_.val=u(_.index++)),w|=(P>0?1:0)*M,M<<=1;I=n(w);break;case 2:return""}for(h[3]=I,S=I,x.push(I);;){if(_.index>l)return"";for(w=0,E=Math.pow(2,v),M=1;M!=E;)P=_.val&_.position,_.position>>=1,_.position==0&&(_.position=c,_.val=u(_.index++)),w|=(P>0?1:0)*M,M<<=1;switch(I=w){case 0:for(w=0,E=Math.pow(2,8),M=1;M!=E;)P=_.val&_.position,_.position>>=1,_.position==0&&(_.position=c,_.val=u(_.index++)),w|=(P>0?1:0)*M,M<<=1;h[f++]=n(w),I=f-1,p--;break;case 1:for(w=0,E=Math.pow(2,16),M=1;M!=E;)P=_.val&_.position,_.position>>=1,_.position==0&&(_.position=c,_.val=u(_.index++)),w|=(P>0?1:0)*M,M<<=1;h[f++]=n(w),I=f-1,p--;break;case 2:return x.join("")}if(p==0&&(p=Math.pow(2,v),v++),h[I])m=h[I];else if(I===f)m=S+S.charAt(0);else return null;x.push(m),h[f++]=S+m.charAt(0),p--,S=m,p==0&&(p=Math.pow(2,v),v++)}}};return a}();t!=null?t.exports=e:typeof angular<"u"&&angular!=null&&angular.module("LZString",[]).factory("LZString",function(){return e})})(vw);var Mse=vw.exports;const r_=ga(Mse);async function _se(t,e,n){var y,S,w;const{elements:r,files:s}=e,i={shapes:[],bindings:[],rootShapeIds:[],assets:[],schema:t.store.schema.serialize()},o=new Map,a=new Map,l=t.getCurrentPageId(),c=new Map,u=[],h=new Set;r.forEach(P=>{if(c.set(P.id,ot()),P.boundElements!==null)for(const E of P.boundElements)E.type==="text"&&h.add(E.id)});let p=Kk;for(const P of r){if(h.has(P.id))continue;const E=c.get(P.id),M={id:E,typeName:"shape",parentId:l,index:p,x:P.x,y:P.y,rotation:0,isLocked:P.locked,opacity:Ase(P.opacity),meta:{}};switch(P.angle!==0&&a.set(E,P.angle),P.groupIds&&P.groupIds.length>0?o.has(P.groupIds[0])?(y=o.get(P.groupIds[0]))==null||y.push(E):o.set(P.groupIds[0],[E]):u.push(E),P.type){case"rectangle":case"ellipse":case"diamond":{let I="",_="middle";if(P.boundElements!==null){for(const R of P.boundElements)if(R.type==="text"){const $=r.find(U=>U.id===R.id);$&&(I=$.text,_=Nse[$.textAlign])}}const D=P.backgroundColor==="transparent"?P.strokeColor:P.backgroundColor;i.shapes.push({...M,type:"geo",props:{geo:P.type,url:P.link??"",w:P.width,h:P.height,size:X0[P.strokeWidth]??"draw",color:Du[D]??"black",text:I,align:_,dash:Z0(P),fill:$se(P)}});break}case"freedraw":{i.shapes.push({...M,type:"draw",props:{dash:Z0(P),size:X0[P.strokeWidth],color:Du[P.strokeColor]??"black",segments:[{type:"free",points:P.points.map(([I,_,D=.5])=>({x:I,y:_,z:D}))}]}});break}case"line":{if(P.points.slice().length<2)break;const _=Vd(P.points.length);i.shapes.push({...M,type:"line",props:{dash:Z0(P),size:X0[P.strokeWidth],color:Du[P.strokeColor]??"black",spline:P.roundness?"cubic":"line",points:{...Object.fromEntries(P.points.map(([D,R],$)=>{const U=_[$];return[U,{id:U,index:U,x:D,y:R}]}))}}});break}case"arrow":{let I="";if(P.boundElements!==null){for(const U of P.boundElements)if(U.type==="text"){const O=r.find(N=>N.id===U.id);O&&(I=O.text)}}const _=P.points[0],D=P.points[P.points.length-1],R=c.get((S=P.startBinding)==null?void 0:S.elementId),$=c.get((w=P.endBinding)==null?void 0:w.elementId);i.shapes.push({...M,type:"arrow",props:{text:I,bend:Fse(P,_,D),dash:Z0(P),size:X0[P.strokeWidth]??"m",color:Du[P.strokeColor]??"black",start:{x:_[0],y:_[1]},end:{x:D[0],y:D[1]},arrowheadEnd:o8[P.endArrowhead]??"none",arrowheadStart:o8[P.startArrowhead]??"none"}}),R&&i.bindings.push({id:Qa(),typeName:"binding",type:"arrow",fromId:E,toId:R,props:{terminal:"start",normalizedAnchor:{x:.5,y:.5},isPrecise:!1,isExact:!1},meta:{}}),$&&i.bindings.push({id:Qa(),typeName:"binding",type:"arrow",fromId:E,toId:$,props:{terminal:"end",normalizedAnchor:{x:.5,y:.5},isPrecise:!1,isExact:!1},meta:{}});break}case"text":{const{size:I,scale:_}=jse(P.fontSize);i.shapes.push({...M,type:"text",props:{size:I,scale:_,font:Rse[P.fontFamily]??"draw",color:Du[P.strokeColor]??"black",text:P.text,textAlign:zse[P.textAlign]}});break}case"image":{const I=s[P.fileId];if(!I)break;const _=Ga.createId();i.assets.push({id:_,typeName:"asset",type:"image",props:{w:P.width,h:P.height,fileSize:I.size,name:P.id??"Untitled",isAnimated:!1,mimeType:I.mimeType,src:I.dataURL},meta:{}}),i.shapes.push({...M,type:"image",props:{w:P.width,h:P.height,assetId:_}})}}p=js(p)}const f=n??(t.inputs.shiftKey?t.inputs.currentPagePoint:void 0);t.mark("paste"),t.putContentOntoCurrentPage(i,{point:f,select:!1,preserveIds:!0});for(const P of o.values())if(P.length>1){t.groupShapes(P);const E=t.getShape(P[0]);E!=null&&E.parentId&&fr(E.parentId)&&u.push(E.parentId)}for(const[P,E]of a)t.select(P),t.rotateShapesBy([P],E);const v=Le(u.map(P=>t.getShape(P))),m=fe.Common(v.map(P=>t.getShapePageBounds(P))),x=t.getViewportPageBounds().center;t.updateShapes(v.map(P=>{const E={x:(P.x??0)-(m.x+m.w/2),y:(P.y??0)-(m.y+m.h/2)};return{id:P.id,type:P.type,x:x.x+E.x,y:x.y+E.y}})),t.setSelectedShapes(u)}const Ase=t=>{const e=t/100;return e<.2?.1:e<.4?.25:e<.6?.5:e<.8?.75:1},X0={1:"s",2:"m",3:"l",4:"xl"},Dse={16:"s",20:"m",28:"l",36:"xl"};function jse(t){const e=Dse[t];return e?{size:e,scale:1}:t<16?{size:"s",scale:t/16}:t>36?{size:"xl",scale:t/36}:{size:"m",scale:1}}const Rse={1:"draw",2:"sans",3:"mono"},Du={"#ffffff":"grey","#000000":"black","#343a40":"black","#495057":"grey","#c92a2a":"red","#a61e4d":"light-red","#862e9c":"violet","#5f3dc4":"light-violet","#364fc7":"blue","#1864ab":"light-blue","#0b7285":"light-green","#087f5b":"light-green","#2b8a3e":"green","#5c940d":"light-green","#e67700":"yellow","#d9480f":"orange","#ced4da":"grey","#868e96":"grey","#fa5252":"light-red","#e64980":"red","#be4bdb":"light-violet","#7950f2":"violet","#4c6ef5":"blue","#228be6":"light-blue","#15aabf":"light-green","#12b886":"green","#40c057":"green","#82c91e":"light-green","#fab005":"yellow","#fd7e14":"orange","#212529":"grey"},Ose={solid:"draw",dashed:"dashed",dotted:"dotted"},Lse={"cross-hatch":"pattern",hachure:"pattern",solid:"solid"},Nse={left:"start",center:"middle",right:"end"},zse={left:"start",center:"middle",right:"end"},o8={arrow:"arrow",dot:"dot",triangle:"triangle",bar:"pipe"};function Fse(t,e,n){let r=0;if(t.points.length>2){const s=new b(e[0],e[1]),i=new b(n[0],n[1]),o=new b(t.points[1][0],t.points[1][1]),a=b.Sub(i,s),l=b.Per(a),c=b.Med(i,s),u=b.Sub(c,l),h=b.Add(c,l),p=b.NearestPointOnLineSegment(u,h,o,!1);r=b.Dist(p,c),b.Clockwise(p,i,c)&&(r*=-1)}return r}const Z0=t=>{let e=Ose[t.strokeStyle]??"draw";return e==="draw"&&t.roughness===0&&(e="solid"),e},$se=t=>t.backgroundColor==="transparent"?"none":Lse[t.fillStyle]??"solid";async function Bse(t,e,n,r){const i=(await Promise.all(e.map(async o=>await(await yi(o)).blob()))).map(o=>new File([o],"tldrawFile",{type:o.type}));t.mark("paste"),await t.putExternalContent({type:"files",files:i,point:n,ignoreParent:!1,sources:r}),e.forEach(o=>URL.revokeObjectURL(o))}function Use(t,e,n){const r=t.getSelectionPageBounds();t.mark("paste"),t.putContentOntoCurrentPage(e,{point:n,select:!0});const s=t.getSelectionPageBounds();r&&s&&(r!=null&&r.collides(s))&&(t.updateInstanceState({isChangingStyle:!0}),t.timers.setTimeout(()=>{t.updateInstanceState({isChangingStyle:!1})},150))}async function yS(t,e,n,r){return t.mark("paste"),await t.putExternalContent({type:"url",point:n,url:e,sources:r})}function Hse(t){const e=document.implementation.createHTMLDocument("");return e.documentElement.innerHTML=t.trim(),e.body.textContent||e.body.innerText||""}const Wse=t=>{try{const e=new URL(t);return e.protocol==="http:"||e.protocol==="https:"}catch{return!1}},Kse=t=>{const e=t.split(/[\n\s]/);for(const n of e)try{const r=new URL(n);if(!(r.protocol==="http:"||r.protocol==="https:"))return}catch{return}return uE(e)},Gse=t=>/^<svg/.test(t),Vse=["input","select","textarea"];function Ny(t){const{activeElement:e}=document;return t.getIsMenuOpen()||e&&(e.getAttribute("contenteditable")||Vse.indexOf(e.tagName.toLowerCase())>-1)}const qse=t=>t.types.find(e=>e.match(/^image\//)),zy=(t,e,n,r)=>{const s=Kse(e);if(s)for(const i of s)yS(t,i,n);else Wse(e)?yS(t,e,n):Gse(e)?(t.mark("paste"),t.putExternalContent({type:"svg-text",text:e,point:n,sources:r})):(t.mark("paste"),t.putExternalContent({type:"text",text:e,point:n,sources:r}))},Yse=async(t,e,n)=>{if(t.getEditingShapeId()!==null)return;if(!e)throw Error("No clipboard data");const r=[];for(const s of Object.values(e.items))switch(s.kind){case"file":{r.push({type:"file",source:new Promise(i=>i(s.getAsFile()))});break}case"string":{s.type==="text/html"?r.push({type:"html",source:new Promise(i=>s.getAsString(i))}):s.type==="text/plain"?r.push({type:"text",source:new Promise(i=>s.getAsString(i))}):r.push({type:s.type,source:new Promise(i=>s.getAsString(i))});break}}i_(t,r,n)},s_=async(t,e,n)=>{const r=[];for(const s of e){if(qse(s))for(const i of s.types)i.match(/^image\//)&&r.push({type:"blob",source:s.getType(i)});s.types.includes("text/html")&&r.push({type:"html",source:(async()=>{const i=await s.getType("text/html");return await Za.blobToText(i)})()}),s.types.includes("text/uri-list")&&r.push({type:"url",source:(async()=>{const i=await s.getType("text/uri-list");return await Za.blobToText(i)})()}),s.types.includes("text/plain")&&r.push({type:"text",source:(async()=>{const i=await s.getType("text/plain");return await Za.blobToText(i)})()})}return await i_(t,r,n)};async function i_(t,e,n){const r=e.filter(i=>(i.type==="file"||i.type==="blob")&&i.source!==null);if(r.length){const o=(await Promise.all(r.map(a=>a.source))).filter(Boolean).map(a=>URL.createObjectURL(a));return await Bse(t,o,n)}const s=await Promise.all(e.filter(i=>i.type!=="file").map(i=>new Promise(o=>{const a=i;if(a.type==="file"){o({type:"error",data:null,reason:"unexpected file"});return}a.source.then(l=>{var u;const c=(u=l.match(/<div data-tldraw[^>]*>(.*)<\/div>/))==null?void 0:u[1];if(c)try{const h=r_.decompressFromBase64(c);if(h===null){o({type:"error",data:h,reason:"found tldraw data comment but could not parse base64"});return}else{const p=JSON.parse(h);if(p.type!=="application/tldraw"&&o({type:"error",data:p,reason:`found tldraw data comment but JSON was of a different type: ${p.type}`}),typeof p.data=="string"){o({type:"error",data:p,reason:"found tldraw json but data was a string instead of a TLClipboardModel object"});return}o({type:"tldraw",data:p.data});return}}catch{o({type:"error",data:c,reason:"found tldraw json but data was a string instead of a TLClipboardModel object"});return}else{if(a.type==="html"){o({type:"text",data:l,subtype:"html"});return}if(a.type==="url"){o({type:"text",data:l,subtype:"url"});return}try{const h=JSON.parse(l);if(h.type==="excalidraw/clipboard"){o({type:"excalidraw",data:h});return}else{o({type:"text",data:l,subtype:"json"});return}}catch{o({type:"text",data:l,subtype:"text"});return}}o({type:"error",data:l,reason:"unhandled case"})})})));for(const i of s)if(i.type==="tldraw"){Use(t,i.data,n);return}for(const i of s)if(i.type==="excalidraw"){_se(t,i.data,n);return}for(const i of s)if(i.type==="text"&&i.subtype==="html"){const a=new DOMParser().parseFromString(i.data,"text/html").querySelector("body");if(a&&Array.from(a.children).filter(c=>c.nodeType===1).length===1&&a.firstElementChild&&a.firstElementChild.tagName==="A"&&a.firstElementChild.hasAttribute("href")&&a.firstElementChild.getAttribute("href")!==""){const c=a.firstElementChild.getAttribute("href");zy(t,c,n,s);return}if(!s.some(c=>c.type==="text"&&c.subtype!=="html")&&i.data.trim()){zy(t,Hse(i.data),n,s);return}}for(const i of s)if(i.type==="text"&&i.subtype==="url"){yS(t,i.data,n,s);return}for(const i of s)if(i.type==="text"&&i.subtype==="text"&&i.data.trim()){zy(t,i.data,n,s);return}}const mg=async t=>{var r;const e=await t.resolveAssetsInContent(t.getContentFromCurrentPage(t.getSelectedShapeIds()));if(!e){navigator&&navigator.clipboard&&navigator.clipboard.writeText("");return}const n=r_.compressToBase64(JSON.stringify({type:"application/tldraw",kind:"content",data:e}));if(!(typeof navigator>"u")){const s=e.shapes.map(i=>t.isShapeOfType(i,"text")||t.isShapeOfType(i,"geo")||t.isShapeOfType(i,"arrow")?i.props.text:t.isShapeOfType(i,"bookmark")||t.isShapeOfType(i,"embed")?i.props.url:null).filter(RG);if((r=navigator.clipboard)!=null&&r.write){const i=new Blob([`<div data-tldraw>${n}</div>`],{type:"text/html"});let o=s.join(" ");o===""&&(o=" "),navigator.clipboard.write([new ClipboardItem({"text/html":i,"text/plain":new Blob([o],{type:"text/plain"})})])}else navigator.clipboard.writeText&&navigator.clipboard.writeText(`<div data-tldraw>${n}</div>`)}};function Xse(){const t=G(),e=An(),n=C.useCallback(async function(o){t.getSelectedShapeIds().length!==0&&(await mg(t),e("copy",{source:o}))},[t,e]),r=C.useCallback(async function(o){t.getSelectedShapeIds().length!==0&&(await mg(t),t.deleteShapes(t.getSelectedShapeIds()),e("cut",{source:o}))},[t,e]),s=C.useCallback(async function(o,a,l){t.getEditingShapeId()===null&&(Array.isArray(o)&&o[0]instanceof ClipboardItem?(s_(t,o,l),e("paste",{source:"menu"})):navigator.clipboard.read().then(c=>{s(c,a,l)}))},[t,e]);return{copy:n,cut:r,paste:s}}function Zse(){const t=G(),e=An(),n=J("editor.isFocused",()=>t.getInstanceState().isFocused,[t]);C.useEffect(()=>{if(!n)return;const r=async l=>{t.getSelectedShapeIds().length===0||t.getEditingShapeId()!==null||Ny(t)||(Ve(l),await mg(t),e("copy",{source:"kbd"}))};async function s(l){t.getSelectedShapeIds().length===0||t.getEditingShapeId()!==null||Ny(t)||(Ve(l),await mg(t),t.deleteShapes(t.getSelectedShapeIds()),e("cut",{source:"kbd"}))}let i=!1;const o=l=>{l.button===1&&(i=!0,t.timers.requestAnimationFrame(()=>{i=!1}))},a=l=>{if(i){sn(l);return}if(t.getEditingShapeId()!==null||Ny(t))return;let c,u=!1;t.inputs.shiftKey&&(u=!0),t.user.getIsPasteAtCursorMode()&&(u=!u),u&&(c=t.inputs.currentPagePoint),l.clipboardData&&!t.inputs.shiftKey?Yse(t,l.clipboardData,c):navigator.clipboard.read().then(h=>{Array.isArray(h)&&h[0]instanceof ClipboardItem&&s_(t,h,c)}),Ve(l),e("paste",{source:"kbd"})};return document.addEventListener("copy",r),document.addEventListener("cut",s),document.addEventListener("paste",a),document.addEventListener("pointerup",o),()=>{document.removeEventListener("copy",r),document.removeEventListener("cut",s),document.removeEventListener("paste",a),document.removeEventListener("pointerup",o)}},[t,e,n])}async function o_(t,e,n){const{type:r,quality:s,scale:i,width:o,height:a}=n;let[l,c]=await NJ(o*i,a*i);l=Math.floor(l),c=Math.floor(c);const u=l/o,h=URL.createObjectURL(new Blob([e],{type:"image/svg+xml"})),p=await new Promise(v=>{const m=Ac();m.crossOrigin="anonymous",m.onload=async()=>{t.environment.isSafari&&await new Promise(S=>t.timers.setTimeout(S,250));const x=document.createElement("canvas"),y=x.getContext("2d");x.width=l,x.height=c,y.imageSmoothingEnabled=!0,y.imageSmoothingQuality="high",y.drawImage(m,0,0,l,c),URL.revokeObjectURL(h),v(x)},m.onerror=()=>{v(null)},m.src=h});if(!p)return null;const f=await new Promise(v=>p.toBlob(m=>{(!m||Vt.throwToBlob.get())&&v(null),v(m)},"image/"+r,s));if(!f)return null;if(r==="png"){const v=new DataView(await f.arrayBuffer());return si.setPhysChunk(v,u,{type:"image/"+r})}else return f}async function a_(t,e,n){const r=await t.getSvgString(e!=null&&e.length?e:[...t.getCurrentPageShapeIds()],{scale:1,background:t.getInstanceState().exportBackground,...n});if(!r)throw new Error("Could not construct SVG.");return r}async function vS(t,e,n,r={}){var s;switch(n){case"svg":return(s=await a_(t,e,r))==null?void 0:s.svg;case"json":{const i=await t.resolveAssetsInContent(t.getContentFromCurrentPage(e));return JSON.stringify(i)}default:Cn(n)}}async function l_({editor:t,ids:e,format:n,opts:r={}}){switch(n){case"svg":return new Blob([await vS(t,e,"svg",r)],{type:"text/plain"});case"json":return new Blob([await vS(t,e,"json",r)],{type:"text/plain"});case"jpeg":case"png":case"webp":{const s=await a_(t,e,r);if(!s)throw new Error("Could not construct image.");const i=await o_(t,s.svg,{type:n,quality:1,scale:2,width:s.width,height:s.height});if(!i)throw new Error("Could not construct image.");return i}default:Cn(n)}}const Qse={jpeg:"image/jpeg",png:"image/png",webp:"image/webp",json:"text/plain",svg:"text/plain"};function Jse(t,e,n,r={}){return{blobPromise:l_({editor:t,ids:e,format:n,opts:r}),mimeType:Qse[n]}}function eie(t,e,n="svg",r={}){if(!window.navigator.clipboard)return Promise.reject(new Error("Copy not supported"));if(window.navigator.clipboard.write){const{blobPromise:s,mimeType:i}=Jse(t,e,n,r);return window.navigator.clipboard.write([new ClipboardItem({[i]:s})]).catch(o=>(console.error(o),s.then(a=>window.navigator.clipboard.write([new ClipboardItem({[i]:a})]))))}switch(n){case"json":case"svg":return tie(async()=>vS(t,e,n,r));case"jpeg":case"png":throw new Error("Copy not supported");default:Cn(n)}}async function tie(t){var e,n;await((n=(e=navigator.clipboard)==null?void 0:e.writeText)==null?void 0:n.call(e,await t()))}function nie(){const t=G(),{addToast:e}=Vs(),n=Be();return C.useCallback((r,s="svg")=>{eie(t,r,s).catch(()=>{e({id:"copy-fail",severity:"warning",title:n("toast.error.copy-fail.title"),description:n("toast.error.copy-fail.desc")})})},[t,e,n])}async function rie(t,e,n="png",r,s={}){if(!r&&(r=`shapes at ${a8()}`,e.length===1)){const a=t.getShape(e[0]);t.isShapeOfType(a,"frame")?r=a.props.name??"frame":r=`${a.id.replace(/:/,"_")} at ${a8()}`}r+=`.${n}`;const i=await l_({editor:t,ids:e,format:n,opts:s}),o=new File([i],r,{type:i.type});sie(o)}function a8(){const t=new Date,e=String(t.getFullYear()).slice(2),n=String(t.getMonth()+1).padStart(2,"0"),r=String(t.getDate()).padStart(2,"0"),s=String(t.getHours()).padStart(2,"0"),i=String(t.getMinutes()).padStart(2,"0"),o=String(t.getSeconds()).padStart(2,"0");return`${e}-${n}-${r} ${s}.${i}.${o}`}function sie(t){const e=document.createElement("a"),n=URL.createObjectURL(t);e.href=n,e.download=t.name,e.click(),URL.revokeObjectURL(n)}function iie(){const t=G(),{addToast:e}=Vs(),n=Be();return C.useCallback((r,s="png",i)=>{rie(t,r,s,i,{scale:1,background:t.getInstanceState().exportBackground}).catch(o=>{console.error(o.message),e({id:"export-fail",title:n("toast.error.export-fail.title"),description:n("toast.error.export-fail.desc"),severity:"error"})})},[t,e,n])}async function oie(t,e,n){const r=Le(e.map(a=>{const l=t.getShape(a);if(!(!l||t.getShapeUtil(l.type).toSvg===void 0))return l}));if(r.length===0)return;if(r.length===1){const a=r[0];if(!a||t.isShapeOfType(a,"image"))return}const s=[];if(n!==void 0){const a=r.map(l=>({shape:l,bounds:t.getShapeMaskedPageBounds(l).clone().expandBy(n)}));for(let l=0;l<a.length;l++){const c=a[l];if(l===0){s[0]={shapes:[c.shape],bounds:c.bounds};continue}let u=!1;for(const h of s)if(h.bounds.includes(c.bounds)){h.shapes.push(c.shape),h.bounds.expand(c.bounds),u=!0;break}u||s.push({shapes:[c.shape],bounds:c.bounds})}}else{const a=fe.Common(r.map(l=>t.getShapeMaskedPageBounds(l)));s.push({shapes:r,bounds:a})}const i=t.options.flattenImageBoundsPadding;for(const a of s){n!==void 0&&a.bounds.expandBy(-n);const l=await t.getSvgString(a.shapes,{padding:i});if(!(l!=null&&l.svg))continue;const c=new Blob([l.svg],{type:"image/svg+xml"}),u=await t.getAssetForExternalContent({type:"file",file:new File([c],"asset.svg",{type:"image/svg+xml"})});u&&(a.asset=u)}const o=[];return zs(()=>{for(const a of s){const{asset:l,bounds:c,shapes:u}=a;if(!l)continue;const h=t.findCommonAncestor(u)??t.getCurrentPageId();if(!h)continue;let p="a1";for(const y of u)if(y.parentId===h){y.index>p&&(p=y.index);break}let f,v,m;if(fr(h)){const y=t.getShape(h);if(!y)continue;const S=t.getPointInShapeSpace(y,{x:c.x,y:c.y});m=t.getShapePageTransform(h).rotation(),S.sub(new b(i,i).rot(-m)),f=S.x,v=S.y}else f=c.x-i,v=c.y-i,m=0;t.deleteShapes(u),t.createAssets([{...l,id:l.id}]);const x=ot();t.createShape({id:x,type:"image",index:p,parentId:h,x:f,y:v,rotation:-m,props:{assetId:l.id,w:c.w+i*2,h:c.h+i*2}}),o.push(x)}}),o}function jm(){return G().store.props.collaboration!==void 0}function aie(){const t=G();return J("sync status",()=>{var e;return(e=t.store.props.collaboration)!=null&&e.status?t.store.props.collaboration.status.get():null},[t])}function lie(){const t=G(),e=C.useRef(null),n=C.useRef(null);return C.useCallback(async function(){const s=document.createElement("div"),i=document.createElement("style"),o=(y,S)=>{y&&(y.innerHTML=""),S&&document.head.contains(S)&&document.head.removeChild(S),y&&document.body.contains(y)&&document.body.removeChild(y)};o(e.current,n.current),e.current=s,n.current=i;const a=`tl-print-surface-${dt()}`;s.className=a,i.innerHTML=`
			.${a} {
				display: none;
			}

			.${a} svg {
				max-width: 100%;
				height: 100%;
				display: block;
			}

			@media print {				  
				html, body {
					min-height: 100%;
					height: 100%;
					margin: 0;
				}

				body {
					position: relative;
				}

				body > * {
					display: none;
				}

				.tldraw__editor {
					display: none;
				}

				.${a} {
					display: block !important;
					background: white;
					min-height: 100%;
					height: 100%;
					max-width: 100%;
				}

				.${a}__item {
					padding: 10mm;
					display: flex;
					min-height: 100%;
					flex-direction: column;
					page-break-after: always;
					position: relative;
					overflow: hidden;
					height: 100%;
				}

				.${a}__item__main {
					flex: 1;
					display: flex;
					align-items: center;
					justify-content: center;
					max-height: 100%;
				}

				.${a}__item__header {
					display: none;
				}

				.${a}__item__footer {
					display: none;
					text-align: right;
				}

				.${a}__item__footer__hide {
					display: none;
				}

				
			}

		`;const l=()=>{document.head.appendChild(i),document.body.appendChild(s)},c=()=>{t.once("tick",()=>{o(s,i)})};window.addEventListener("beforeprint",l),window.addEventListener("afterprint",c);function u(y,S,w){try{s.innerHTML+=`<div class="${a}__item">
        <div class="${a}__item__header">
          ${y.replace(/</g,"&lt;").replace(/>/g,"&gt;")}
        </div>
        <div class="${a}__item__main">
          ${w}
        </div>
        <div class="${a}__item__footer ${a}__item__footer__${S?"":"hide"}">
          ${S??""}
        </div>
      </div>`}catch(P){console.error(P)}}function h(){t.environment.isChromeForIos?(l(),window.print()):t.environment.isSafari?(l(),document.execCommand("print",!1)):window.print()}const p=t.getSelectedShapeIds(),f=t.getCurrentPageId(),v=t.getPages(),x={scale:1,background:!1,darkMode:!1,preserveAspectRatio:"xMidYMid meet"};if(t.getSelectedShapeIds().length>0){const y=await t.getSvgString(p,x);if(y){const S=v.find(w=>w.id===f);u(`tldraw — ${S==null?void 0:S.name}`,null,y.svg),h()}}else{const y=t.getCurrentPage(),S=await t.getSvgString(t.getSortedChildIdsForParent(y.id),x);S&&(u(`tldraw — ${y.name}`,null,S.svg),h())}window.removeEventListener("beforeprint",l),window.removeEventListener("afterprint",c)},[t])}const c_=C.createContext(null);function cie(t){return Object.fromEntries(t.map(e=>[e.id,e]))}function Fl(t,e){if(t.getSelectedShapes().length===0)return t.getDocumentSettings().name||e}function uie({overrides:t,children:e}){const n=G(),r=jm(),{addDialog:s,clearDialogs:i}=Pl(),{clearToasts:o,addToast:a}=Vs(),l=Be(),c=JM(),u=lie(),{cut:h,copy:p,paste:f}=Xse(),v=nie(),m=iie(),x=l("document.default-name"),y=An(),S=C.useMemo(()=>{function w(){return n.isIn("select")||(n.complete(),n.setCurrentTool("select")),!1}function P(){return n.isIn("select")&&n.getSelectedShapeIds().length>0}const E=[{id:"edit-link",label:"action.edit-link",icon:"link",onSelect(I){P()&&(w()||(y("edit-link",{source:I}),n.mark("edit-link"),s({component:Ese})))}},{id:"insert-embed",label:"action.insert-embed",kbd:"$i",onSelect(I){y("insert-embed",{source:I}),s({component:QM})}},{id:"insert-media",label:"action.insert-media",kbd:"$u",onSelect(I){y("insert-media",{source:I}),c()}},{id:"undo",label:"action.undo",icon:"undo",kbd:"$z",onSelect(I){y("undo",{source:I}),n.undo()}},{id:"redo",label:"action.redo",icon:"redo",kbd:"$!z",onSelect(I){y("redo",{source:I}),n.redo()}},{id:"export-as-svg",label:{default:"action.export-as-svg",menu:"action.export-as-svg.short","context-menu":"action.export-as-svg.short"},readonlyOk:!0,onSelect(I){let _=n.getSelectedShapeIds();_.length===0&&(_=Array.from(n.getCurrentPageShapeIds().values())),_.length!==0&&(y("export-as",{format:"svg",source:I}),m(_,"svg",Fl(n,x)))}},{id:"export-as-png",label:{default:"action.export-as-png",menu:"action.export-as-png.short","context-menu":"action.export-as-png.short"},readonlyOk:!0,onSelect(I){let _=n.getSelectedShapeIds();_.length===0&&(_=Array.from(n.getCurrentPageShapeIds().values())),_.length!==0&&(y("export-as",{format:"png",source:I}),m(_,"png",Fl(n,x)))}},{id:"export-as-json",label:{default:"action.export-as-json",menu:"action.export-as-json.short","context-menu":"action.export-as-json.short"},readonlyOk:!0,onSelect(I){let _=n.getSelectedShapeIds();_.length===0&&(_=Array.from(n.getCurrentPageShapeIds().values())),_.length!==0&&(y("export-as",{format:"json",source:I}),m(_,"json",Fl(n,x)))}},{id:"export-all-as-svg",label:{default:"action.export-all-as-svg",menu:"action.export-all-as-svg.short","context-menu":"action.export-all-as-svg.short"},readonlyOk:!0,onSelect(I){let _=n.getSelectedShapeIds();_.length===0&&(_=Array.from(n.getCurrentPageShapeIds().values())),_.length!==0&&(y("export-all-as",{format:"svg",source:I}),m(Array.from(n.getCurrentPageShapeIds()),"svg",Fl(n,x)))}},{id:"export-all-as-png",label:{default:"action.export-all-as-png",menu:"action.export-all-as-png.short","context-menu":"action.export-all-as-png.short"},readonlyOk:!0,onSelect(I){const _=Array.from(n.getCurrentPageShapeIds().values());_.length!==0&&(y("export-all-as",{format:"png",source:I}),m(_,"png",Fl(n,x)))}},{id:"export-all-as-json",label:{default:"action.export-all-as-json",menu:"action.export-all-as-json.short","context-menu":"action.export-all-as-json.short"},readonlyOk:!0,onSelect(I){const _=Array.from(n.getCurrentPageShapeIds().values());_.length!==0&&(y("export-all-as",{format:"json",source:I}),m(_,"json",Fl(n,x)))}},{id:"copy-as-svg",label:{default:"action.copy-as-svg",menu:"action.copy-as-svg.short","context-menu":"action.copy-as-svg.short"},kbd:"$!c",readonlyOk:!0,onSelect(I){let _=n.getSelectedShapeIds();_.length===0&&(_=Array.from(n.getCurrentPageShapeIds().values())),_.length!==0&&(y("copy-as",{format:"svg",source:I}),v(_,"svg"))}},{id:"copy-as-png",label:{default:"action.copy-as-png",menu:"action.copy-as-png.short","context-menu":"action.copy-as-png.short"},readonlyOk:!0,onSelect(I){let _=n.getSelectedShapeIds();_.length===0&&(_=Array.from(n.getCurrentPageShapeIds().values())),_.length!==0&&(y("copy-as",{format:"png",source:I}),v(_,"png"))}},{id:"copy-as-json",label:{default:"action.copy-as-json",menu:"action.copy-as-json.short","context-menu":"action.copy-as-json.short"},readonlyOk:!0,onSelect(I){let _=n.getSelectedShapeIds();_.length===0&&(_=Array.from(n.getCurrentPageShapeIds().values())),_.length!==0&&(y("copy-as",{format:"json",source:I}),v(_,"json"))}},{id:"toggle-auto-size",label:"action.toggle-auto-size",onSelect(I){if(!P()||w())return;y("toggle-auto-size",{source:I}),n.mark("toggling auto size");const _=n.getSelectedShapes().filter(D=>n.isShapeOfType(D,"text")&&D.props.autoSize===!1);n.updateShapes(_.map(D=>({id:D.id,type:D.type,props:{...D.props,w:8,autoSize:!0}}))),ft(n,_.map(D=>D.id))}},{id:"open-embed-link",label:"action.open-embed-link",readonlyOk:!0,onSelect(I){y("open-embed-link",{source:I});const _=n.getSelectedShapeIds(),D="No embed shapes selected";if(_.length!==1){console.error(D);return}const R=n.getShape(_[0]);if(!R||!n.isShapeOfType(R,"embed")){console.error(D);return}tJ(R.props.url,"_blank")}},{id:"select-zoom-tool",readonlyOk:!0,kbd:"z",onSelect(I){var _,D;if(((_=n.root.getCurrent())==null?void 0:_.id)!=="zoom"&&(y("zoom-tool",{source:I}),!(n.inputs.shiftKey||n.inputs.ctrlKey))){const R=n.root.getCurrent();R&&((D=R.getCurrent())==null?void 0:D.id)==="idle"&&n.setCurrentTool("zoom",{onInteractionEnd:R.id,maskAs:"zoom"})}}},{id:"convert-to-bookmark",label:"action.convert-to-bookmark",onSelect(I){P()&&(w()||n.run(()=>{y("convert-to-bookmark",{source:I});const _=n.getSelectedShapes(),D=[],R=[];for(const $ of _){if(!$||!n.isShapeOfType($,"embed")||!$.props.url)continue;const U=new b($.x,$.y);U.rot(-$.rotation),U.add(new b($.props.w/2-300/2,$.props.h/2-320/2)),U.rot($.rotation);const O={id:ot(),type:"bookmark",rotation:$.rotation,x:U.x,y:U.y,opacity:1,props:{url:$.props.url}};D.push(O),R.push($.id)}n.mark("convert shapes to bookmark"),n.deleteShapes(R),n.createShapes(D)}))}},{id:"convert-to-embed",label:"action.convert-to-embed",onSelect(I){P()&&(w()||(y("convert-to-embed",{source:I}),n.run(()=>{const _=n.getSelectedShapeIds(),D=Le(_.map(U=>n.getShape(U))),R=[],$=[];for(const U of D){if(!n.isShapeOfType(U,"bookmark"))continue;const{url:O}=U.props,N=Uo(U.props.url);if(!N||!N.definition)continue;const{width:H,height:Z}=N.definition,q=new b(U.x,U.y);q.rot(-U.rotation),q.add(new b(U.props.w/2-H/2,U.props.h/2-Z/2)),q.rot(U.rotation);const V={id:ot(),type:"embed",x:q.x,y:q.y,rotation:U.rotation,props:{url:O,w:H,h:Z}};R.push(V),$.push(U.id)}n.mark("convert shapes to embed"),n.deleteShapes($),n.createShapes(R)})))}},{id:"duplicate",kbd:"$d",label:"action.duplicate",icon:"duplicate",onSelect(I){if(!P()||w())return;y("duplicate-shapes",{source:I});const _=n.getInstanceState();let D,R;if(_.duplicateProps)D=_.duplicateProps.shapeIds,R=_.duplicateProps.offset;else{D=n.getSelectedShapeIds();const $=fe.Common(Le(D.map(U=>n.getShapePageBounds(U))));R=n.getCameraOptions().isLocked?{x:n.options.adjacentShapeMargin,y:n.options.adjacentShapeMargin}:{x:$.width+n.options.adjacentShapeMargin,y:0}}n.mark("duplicate shapes"),n.duplicateShapes(D,R),_.duplicateProps&&n.updateInstanceState({duplicateProps:{..._.duplicateProps,shapeIds:n.getSelectedShapeIds()}})}},{id:"ungroup",label:"action.ungroup",kbd:"$!g",icon:"ungroup",onSelect(I){P()&&(w()||(y("ungroup-shapes",{source:I}),n.mark("ungroup"),n.ungroupShapes(n.getSelectedShapeIds())))}},{id:"group",label:"action.group",kbd:"$g",icon:"group",onSelect(I){if(!P()||w())return;y("group-shapes",{source:I});const _=n.getOnlySelectedShape();_&&n.isShapeOfType(_,"group")?(n.mark("ungroup"),n.ungroupShapes(n.getSelectedShapeIds())):(n.mark("group"),n.groupShapes(n.getSelectedShapeIds()))}},{id:"remove-frame",label:"action.remove-frame",kbd:"$!f",onSelect(I){if(!P())return;y("remove-frame",{source:I});const _=n.getSelectedShapes();_.length>0&&_.every(D=>n.isShapeOfType(D,"frame"))&&(n.mark("remove-frame"),Pse(n,_.map(D=>D.id)))}},{id:"fit-frame-to-content",label:"action.fit-frame-to-content",onSelect(I){if(!P())return;y("fit-frame-to-content",{source:I});const _=n.getOnlySelectedShape();_&&n.isShapeOfType(_,"frame")&&(n.mark("fit-frame-to-content"),Ise(n,_.id))}},{id:"align-left",label:"action.align-left",kbd:"?A",icon:"align-left",onSelect(I){if(!P()||w())return;y("align-shapes",{operation:"left",source:I}),n.mark("align left");const _=n.getSelectedShapeIds();n.alignShapes(_,"left"),ft(n,_)}},{id:"align-center-horizontal",label:{default:"action.align-center-horizontal","context-menu":"action.align-center-horizontal.short"},kbd:"?H",icon:"align-center-horizontal",onSelect(I){if(!P()||w())return;y("align-shapes",{operation:"center-horizontal",source:I}),n.mark("align center horizontal");const _=n.getSelectedShapeIds();n.alignShapes(_,"center-horizontal"),ft(n,_)}},{id:"align-right",label:"action.align-right",kbd:"?D",icon:"align-right",onSelect(I){if(!P()||w())return;y("align-shapes",{operation:"right",source:I}),n.mark("align right");const _=n.getSelectedShapeIds();n.alignShapes(_,"right"),ft(n,_)}},{id:"align-center-vertical",label:{default:"action.align-center-vertical","context-menu":"action.align-center-vertical.short"},kbd:"?V",icon:"align-center-vertical",onSelect(I){if(!P()||w())return;y("align-shapes",{operation:"center-vertical",source:I}),n.mark("align center vertical");const _=n.getSelectedShapeIds();n.alignShapes(_,"center-vertical"),ft(n,_)}},{id:"align-top",label:"action.align-top",icon:"align-top",kbd:"?W",onSelect(I){if(!P()||w())return;y("align-shapes",{operation:"top",source:I}),n.mark("align top");const _=n.getSelectedShapeIds();n.alignShapes(_,"top"),ft(n,_)}},{id:"align-bottom",label:"action.align-bottom",icon:"align-bottom",kbd:"?S",onSelect(I){if(!P()||w())return;y("align-shapes",{operation:"bottom",source:I}),n.mark("align bottom");const _=n.getSelectedShapeIds();n.alignShapes(_,"bottom"),ft(n,_)}},{id:"distribute-horizontal",label:{default:"action.distribute-horizontal","context-menu":"action.distribute-horizontal.short"},icon:"distribute-horizontal",kbd:"?!h",onSelect(I){if(!P()||w())return;y("distribute-shapes",{operation:"horizontal",source:I}),n.mark("distribute horizontal");const _=n.getSelectedShapeIds();n.distributeShapes(_,"horizontal"),ft(n,_)}},{id:"distribute-vertical",label:{default:"action.distribute-vertical","context-menu":"action.distribute-vertical.short"},icon:"distribute-vertical",kbd:"?!V",onSelect(I){if(!P()||w())return;y("distribute-shapes",{operation:"vertical",source:I}),n.mark("distribute vertical");const _=n.getSelectedShapeIds();n.distributeShapes(_,"vertical"),ft(n,_)}},{id:"stretch-horizontal",label:{default:"action.stretch-horizontal","context-menu":"action.stretch-horizontal.short"},icon:"stretch-horizontal",onSelect(I){if(!P()||w())return;y("stretch-shapes",{operation:"horizontal",source:I}),n.mark("stretch horizontal");const _=n.getSelectedShapeIds();n.stretchShapes(_,"horizontal"),ft(n,_)}},{id:"stretch-vertical",label:{default:"action.stretch-vertical","context-menu":"action.stretch-vertical.short"},icon:"stretch-vertical",onSelect(I){if(!P()||w())return;y("stretch-shapes",{operation:"vertical",source:I}),n.mark("stretch vertical");const _=n.getSelectedShapeIds();n.stretchShapes(_,"vertical"),ft(n,_)}},{id:"flip-horizontal",label:{default:"action.flip-horizontal","context-menu":"action.flip-horizontal.short"},kbd:"!h",onSelect(I){if(!P()||w())return;y("flip-shapes",{operation:"horizontal",source:I}),n.mark("flip horizontal");const _=n.getSelectedShapeIds();n.flipShapes(_,"horizontal"),ft(n,_)}},{id:"flip-vertical",label:{default:"action.flip-vertical","context-menu":"action.flip-vertical.short"},kbd:"!v",onSelect(I){if(!P()||w())return;y("flip-shapes",{operation:"vertical",source:I}),n.mark("flip vertical");const _=n.getSelectedShapeIds();n.flipShapes(_,"vertical"),ft(n,_)}},{id:"pack",label:"action.pack",icon:"pack",onSelect(I){if(!P()||w())return;y("pack-shapes",{source:I}),n.mark("pack");const _=n.getSelectedShapeIds();n.packShapes(_,n.options.adjacentShapeMargin),ft(n,_)}},{id:"stack-vertical",label:{default:"action.stack-vertical","context-menu":"action.stack-vertical.short"},icon:"stack-vertical",onSelect(I){if(!P()||w())return;y("stack-shapes",{operation:"vertical",source:I}),n.mark("stack-vertical");const _=n.getSelectedShapeIds();n.stackShapes(_,"vertical",16),ft(n,_)}},{id:"stack-horizontal",label:{default:"action.stack-horizontal","context-menu":"action.stack-horizontal.short"},icon:"stack-horizontal",onSelect(I){if(!P()||w())return;y("stack-shapes",{operation:"horizontal",source:I}),n.mark("stack-horizontal");const _=n.getSelectedShapeIds();n.stackShapes(_,"horizontal",16),ft(n,_)}},{id:"bring-to-front",label:"action.bring-to-front",kbd:"]",icon:"bring-to-front",onSelect(I){P()&&(w()||(y("reorder-shapes",{operation:"toFront",source:I}),n.mark("bring to front"),n.bringToFront(n.getSelectedShapeIds())))}},{id:"bring-forward",label:"action.bring-forward",icon:"bring-forward",kbd:"?]",onSelect(I){P()&&(w()||(y("reorder-shapes",{operation:"forward",source:I}),n.mark("bring forward"),n.bringForward(n.getSelectedShapeIds())))}},{id:"send-backward",label:"action.send-backward",icon:"send-backward",kbd:"?[",onSelect(I){P()&&(w()||(y("reorder-shapes",{operation:"backward",source:I}),n.mark("send backward"),n.sendBackward(n.getSelectedShapeIds())))}},{id:"send-to-back",label:"action.send-to-back",icon:"send-to-back",kbd:"[",onSelect(I){P()&&(w()||(y("reorder-shapes",{operation:"toBack",source:I}),n.mark("send to back"),n.sendToBack(n.getSelectedShapeIds())))}},{id:"cut",label:"action.cut",kbd:"$x",onSelect(I){P()&&(w()||(n.mark("cut"),h(I)))}},{id:"copy",label:"action.copy",kbd:"$c",readonlyOk:!0,onSelect(I){P()&&(w()||p(I))}},{id:"paste",label:"action.paste",kbd:"$v",onSelect(I){var _;(_=navigator.clipboard)==null||_.read().then(D=>{f(D,I,I==="context-menu"?n.inputs.currentPagePoint:void 0)}).catch(()=>{a({title:l("action.paste-error-title"),description:l("action.paste-error-description"),severity:"error"})})}},{id:"select-all",label:"action.select-all",kbd:"$a",readonlyOk:!0,onSelect(I){n.run(()=>{w()||(y("select-all-shapes",{source:I}),n.mark("select all kbd"),n.selectAll())})}},{id:"select-none",label:"action.select-none",readonlyOk:!0,onSelect(I){P()&&(w()||(y("select-none-shapes",{source:I}),n.mark("select none"),n.selectNone()))}},{id:"delete",label:"action.delete",kbd:"⌫,del,backspace",icon:"trash",onSelect(I){P()&&(w()||(y("delete-shapes",{source:I}),n.mark("delete"),n.deleteShapes(n.getSelectedShapeIds())))}},{id:"rotate-cw",label:"action.rotate-cw",icon:"rotate-cw",onSelect(I){if(!P()||w())return;y("rotate-cw",{source:I}),n.mark("rotate-cw");const _=n.getSelectionRotation()%(vt/2),D=ea(_,0)||ea(_,vt/2),R=n.getSelectedShapeIds();n.rotateShapesBy(R,vt/2-(D?0:_)),ft(n,R)}},{id:"rotate-ccw",label:"action.rotate-ccw",icon:"rotate-ccw",onSelect(I){if(!P()||w())return;y("rotate-ccw",{source:I}),n.mark("rotate-ccw");const _=n.getSelectionRotation()%(vt/2),D=ea(_,0),R=n.getSelectedShapeIds();n.rotateShapesBy(R,D?-(vt/2):-_),ft(n,R)}},{id:"zoom-in",label:"action.zoom-in",kbd:"$=,=",readonlyOk:!0,onSelect(I){y("zoom-in",{source:I}),n.zoomIn(void 0,{animation:{duration:n.options.animationMediumMs}})}},{id:"zoom-out",label:"action.zoom-out",kbd:"$-,-",readonlyOk:!0,onSelect(I){y("zoom-out",{source:I}),n.zoomOut(void 0,{animation:{duration:n.options.animationMediumMs}})}},{id:"zoom-to-100",label:"action.zoom-to-100",icon:"reset-zoom",kbd:"!0",readonlyOk:!0,onSelect(I){y("reset-zoom",{source:I}),n.resetZoom(void 0,{animation:{duration:n.options.animationMediumMs}})}},{id:"zoom-to-fit",label:"action.zoom-to-fit",kbd:"!1",readonlyOk:!0,onSelect(I){y("zoom-to-fit",{source:I}),n.zoomToFit({animation:{duration:n.options.animationMediumMs}})}},{id:"zoom-to-selection",label:"action.zoom-to-selection",kbd:"!2",readonlyOk:!0,onSelect(I){P()&&(w()||(y("zoom-to-selection",{source:I}),n.zoomToSelection({animation:{duration:n.options.animationMediumMs}})))}},{id:"toggle-snap-mode",label:{default:"action.toggle-snap-mode",menu:"action.toggle-snap-mode.menu"},onSelect(I){y("toggle-snap-mode",{source:I}),n.user.updateUserPreferences({isSnapMode:!n.user.getIsSnapMode()})},checkbox:!0},{id:"toggle-dark-mode",label:{default:"action.toggle-dark-mode",menu:"action.toggle-dark-mode.menu"},kbd:"$/",readonlyOk:!0,onSelect(I){const _=n.user.getIsDarkMode()?"light":"dark";y("color-scheme",{source:I,value:_}),n.user.updateUserPreferences({colorScheme:_})},checkbox:!0},{id:"toggle-wrap-mode",label:{default:"action.toggle-wrap-mode",menu:"action.toggle-wrap-mode.menu"},readonlyOk:!0,onSelect(I){y("toggle-wrap-mode",{source:I}),n.user.updateUserPreferences({isWrapMode:!n.user.getIsWrapMode()})},checkbox:!0},{id:"toggle-dynamic-size-mode",label:{default:"action.toggle-dynamic-size-mode",menu:"action.toggle-dynamic-size-mode.menu"},readonlyOk:!1,onSelect(I){y("toggle-dynamic-size-mode",{source:I}),n.user.updateUserPreferences({isDynamicSizeMode:!n.user.getIsDynamicResizeMode()})},checkbox:!0},{id:"toggle-paste-at-cursor",label:{default:"action.toggle-paste-at-cursor",menu:"action.toggle-paste-at-cursor.menu"},readonlyOk:!1,onSelect(I){y("toggle-paste-at-cursor",{source:I}),n.user.updateUserPreferences({isPasteAtCursorMode:!n.user.getIsPasteAtCursorMode()})},checkbox:!0},{id:"toggle-reduce-motion",label:{default:"action.toggle-reduce-motion",menu:"action.toggle-reduce-motion.menu"},readonlyOk:!0,onSelect(I){y("toggle-reduce-motion",{source:I}),n.user.updateUserPreferences({animationSpeed:n.user.getAnimationSpeed()===0?1:0})},checkbox:!0},{id:"toggle-edge-scrolling",label:{default:"action.toggle-edge-scrolling",menu:"action.toggle-edge-scrolling.menu"},readonlyOk:!0,onSelect(I){y("toggle-edge-scrolling",{source:I}),n.user.updateUserPreferences({edgeScrollSpeed:n.user.getEdgeScrollSpeed()===0?1:0})},checkbox:!0},{id:"toggle-transparent",label:{default:"action.toggle-transparent",menu:"action.toggle-transparent.menu","context-menu":"action.toggle-transparent.context-menu"},readonlyOk:!0,onSelect(I){y("toggle-transparent",{source:I}),n.updateInstanceState({exportBackground:!n.getInstanceState().exportBackground})},checkbox:!0},{id:"toggle-tool-lock",label:{default:"action.toggle-tool-lock",menu:"action.toggle-tool-lock.menu"},kbd:"q",onSelect(I){y("toggle-tool-lock",{source:I}),n.updateInstanceState({isToolLocked:!n.getInstanceState().isToolLocked})},checkbox:!0},{id:"unlock-all",label:"action.unlock-all",onSelect(I){y("unlock-all",{source:I});const _=[];for(const D of n.getCurrentPageShapes())D.isLocked&&_.push({id:D.id,type:D.type,isLocked:!1});_.length>0&&n.updateShapes(_)}},{id:"toggle-focus-mode",label:{default:"action.toggle-focus-mode",menu:"action.toggle-focus-mode.menu"},readonlyOk:!0,kbd:"$.",checkbox:!0,onSelect(I){n.timers.requestAnimationFrame(()=>{n.run(()=>{y("toggle-focus-mode",{source:I}),i(),o(),n.updateInstanceState({isFocusMode:!n.getInstanceState().isFocusMode})})})}},{id:"toggle-grid",label:{default:"action.toggle-grid",menu:"action.toggle-grid.menu"},readonlyOk:!0,kbd:"$'",onSelect(I){y("toggle-grid-mode",{source:I}),n.updateInstanceState({isGridMode:!n.getInstanceState().isGridMode})},checkbox:!0},{id:"toggle-debug-mode",label:{default:"action.toggle-debug-mode",menu:"action.toggle-debug-mode.menu"},readonlyOk:!0,onSelect(I){y("toggle-debug-mode",{source:I}),n.updateInstanceState({isDebugMode:!n.getInstanceState().isDebugMode})},checkbox:!0},{id:"print",label:"action.print",kbd:"$p",readonlyOk:!0,onSelect(I){y("print",{source:I}),u()}},{id:"exit-pen-mode",label:"action.exit-pen-mode",icon:"cross-2",readonlyOk:!0,onSelect(I){y("exit-pen-mode",{source:I}),n.updateInstanceState({isPenMode:!1})}},{id:"stop-following",label:"action.stop-following",icon:"cross-2",readonlyOk:!0,onSelect(I){y("stop-following",{source:I}),n.stopFollowingUser()}},{id:"back-to-content",label:"action.back-to-content",icon:"arrow-left",readonlyOk:!0,onSelect(I){y("zoom-to-content",{source:I});const _=n.getSelectionPageBounds()??n.getCurrentPageBounds();_&&n.zoomToBounds(_,{targetZoom:Math.min(1,n.getZoomLevel()),animation:{duration:220}})}},{id:"toggle-lock",label:"action.toggle-lock",kbd:"!l",onSelect(I){n.mark("locking"),y("toggle-lock",{source:I}),n.toggleLock(n.getSelectedShapeIds())}},{id:"move-to-new-page",label:"context.pages.new-page",onSelect(I){const _=io.createId(),D=n.getSelectedShapeIds();n.run(()=>{n.mark("move_shapes_to_page"),n.createPage({name:l("page-menu.new-page-initial-name"),id:_}),n.moveShapesToPage(D,_)}),y("move-to-new-page",{source:I})}},{id:"select-white-color",label:"color-style.white",kbd:"?t",onSelect(I){const _=qr;n.run(()=>{n.mark("change-color"),n.isIn("select")&&n.setStyleForSelectedShapes(_,"white"),n.setStyleForNextShapes(_,"white")}),y("set-style",{source:I,id:_.id,value:"white"})}},{id:"select-fill-fill",label:"fill-style.fill",kbd:"?f",onSelect(I){const _=cl;n.run(()=>{n.mark("change-fill"),n.isIn("select")&&n.setStyleForSelectedShapes(_,"fill"),n.setStyleForNextShapes(_,"fill")}),y("set-style",{source:I,id:_.id,value:"fill"})}},{id:"flatten-to-image",label:"action.flatten-to-image",kbd:"!f",onSelect:async I=>{const _=n.getSelectedShapeIds();if(_.length===0)return;n.mark("flattening to image"),y("flatten-to-image",{source:I});const D=await oie(n,_,n.options.flattenImageBoundsExpand);D!=null&&D.length&&n.setSelectedShapes(D)}}];r&&E.push({id:"open-cursor-chat",label:"action.open-cursor-chat",readonlyOk:!0,kbd:"/",onSelect(I){y("open-cursor-chat",{source:I}),!n.getInstanceState().isCoarsePointer&&n.timers.requestAnimationFrame(()=>{n.updateInstanceState({isChatting:!0})})}});const M=cie(E);return t?t(n,M,void 0):M},[n,y,t,s,a,c,m,v,h,p,f,i,o,u,l,x,r]);return d.jsx(c_.Provider,{value:S,children:e})}function we(){const t=C.useContext(c_);if(!t)throw new Error("useTools must be used within a ToolProvider");return t}function nh(t,e){return t?typeof t=="string"?t:e?t[e]??t.default:void 0:void 0}const die=["top","right","bottom","left"],ci=Math.min,Nr=Math.max,yg=Math.round,Q0=Math.floor,ca=t=>({x:t,y:t}),hie={left:"right",right:"left",bottom:"top",top:"bottom"},pie={start:"end",end:"start"};function SS(t,e,n){return Nr(t,ci(e,n))}function oo(t,e){return typeof t=="function"?t(e):t}function ao(t){return t.split("-")[0]}function nu(t){return t.split("-")[1]}function Sw(t){return t==="x"?"y":"x"}function xw(t){return t==="y"?"height":"width"}function ua(t){return["top","bottom"].includes(ao(t))?"y":"x"}function ww(t){return Sw(ua(t))}function fie(t,e,n){n===void 0&&(n=!1);const r=nu(t),s=ww(t),i=xw(s);let o=s==="x"?r===(n?"end":"start")?"right":"left":r==="start"?"bottom":"top";return e.reference[i]>e.floating[i]&&(o=vg(o)),[o,vg(o)]}function gie(t){const e=vg(t);return[xS(t),e,xS(e)]}function xS(t){return t.replace(/start|end/g,e=>pie[e])}function mie(t,e,n){const r=["left","right"],s=["right","left"],i=["top","bottom"],o=["bottom","top"];switch(t){case"top":case"bottom":return n?e?s:r:e?r:s;case"left":case"right":return e?i:o;default:return[]}}function yie(t,e,n,r){const s=nu(t);let i=mie(ao(t),n==="start",r);return s&&(i=i.map(o=>o+"-"+s),e&&(i=i.concat(i.map(xS)))),i}function vg(t){return t.replace(/left|right|bottom|top/g,e=>hie[e])}function vie(t){return{top:0,right:0,bottom:0,left:0,...t}}function u_(t){return typeof t!="number"?vie(t):{top:t,right:t,bottom:t,left:t}}function Sg(t){const{x:e,y:n,width:r,height:s}=t;return{width:r,height:s,top:n,left:e,right:e+r,bottom:n+s,x:e,y:n}}function l8(t,e,n){let{reference:r,floating:s}=t;const i=ua(e),o=ww(e),a=xw(o),l=ao(e),c=i==="y",u=r.x+r.width/2-s.width/2,h=r.y+r.height/2-s.height/2,p=r[a]/2-s[a]/2;let f;switch(l){case"top":f={x:u,y:r.y-s.height};break;case"bottom":f={x:u,y:r.y+r.height};break;case"right":f={x:r.x+r.width,y:h};break;case"left":f={x:r.x-s.width,y:h};break;default:f={x:r.x,y:r.y}}switch(nu(e)){case"start":f[o]-=p*(n&&c?-1:1);break;case"end":f[o]+=p*(n&&c?-1:1);break}return f}const Sie=async(t,e,n)=>{const{placement:r="bottom",strategy:s="absolute",middleware:i=[],platform:o}=n,a=i.filter(Boolean),l=await(o.isRTL==null?void 0:o.isRTL(e));let c=await o.getElementRects({reference:t,floating:e,strategy:s}),{x:u,y:h}=l8(c,r,l),p=r,f={},v=0;for(let m=0;m<a.length;m++){const{name:x,fn:y}=a[m],{x:S,y:w,data:P,reset:E}=await y({x:u,y:h,initialPlacement:r,placement:p,strategy:s,middlewareData:f,rects:c,platform:o,elements:{reference:t,floating:e}});u=S??u,h=w??h,f={...f,[x]:{...f[x],...P}},E&&v<=50&&(v++,typeof E=="object"&&(E.placement&&(p=E.placement),E.rects&&(c=E.rects===!0?await o.getElementRects({reference:t,floating:e,strategy:s}):E.rects),{x:u,y:h}=l8(c,p,l)),m=-1)}return{x:u,y:h,placement:p,strategy:s,middlewareData:f}};async function rh(t,e){var n;e===void 0&&(e={});const{x:r,y:s,platform:i,rects:o,elements:a,strategy:l}=t,{boundary:c="clippingAncestors",rootBoundary:u="viewport",elementContext:h="floating",altBoundary:p=!1,padding:f=0}=oo(e,t),v=u_(f),x=a[p?h==="floating"?"reference":"floating":h],y=Sg(await i.getClippingRect({element:(n=await(i.isElement==null?void 0:i.isElement(x)))==null||n?x:x.contextElement||await(i.getDocumentElement==null?void 0:i.getDocumentElement(a.floating)),boundary:c,rootBoundary:u,strategy:l})),S=h==="floating"?{x:r,y:s,width:o.floating.width,height:o.floating.height}:o.reference,w=await(i.getOffsetParent==null?void 0:i.getOffsetParent(a.floating)),P=await(i.isElement==null?void 0:i.isElement(w))?await(i.getScale==null?void 0:i.getScale(w))||{x:1,y:1}:{x:1,y:1},E=Sg(i.convertOffsetParentRelativeRectToViewportRelativeRect?await i.convertOffsetParentRelativeRectToViewportRelativeRect({elements:a,rect:S,offsetParent:w,strategy:l}):S);return{top:(y.top-E.top+v.top)/P.y,bottom:(E.bottom-y.bottom+v.bottom)/P.y,left:(y.left-E.left+v.left)/P.x,right:(E.right-y.right+v.right)/P.x}}const xie=t=>({name:"arrow",options:t,async fn(e){const{x:n,y:r,placement:s,rects:i,platform:o,elements:a,middlewareData:l}=e,{element:c,padding:u=0}=oo(t,e)||{};if(c==null)return{};const h=u_(u),p={x:n,y:r},f=ww(s),v=xw(f),m=await o.getDimensions(c),x=f==="y",y=x?"top":"left",S=x?"bottom":"right",w=x?"clientHeight":"clientWidth",P=i.reference[v]+i.reference[f]-p[f]-i.floating[v],E=p[f]-i.reference[f],M=await(o.getOffsetParent==null?void 0:o.getOffsetParent(c));let I=M?M[w]:0;(!I||!await(o.isElement==null?void 0:o.isElement(M)))&&(I=a.floating[w]||i.floating[v]);const _=P/2-E/2,D=I/2-m[v]/2-1,R=ci(h[y],D),$=ci(h[S],D),U=R,O=I-m[v]-$,N=I/2-m[v]/2+_,H=SS(U,N,O),Z=!l.arrow&&nu(s)!=null&&N!==H&&i.reference[v]/2-(N<U?R:$)-m[v]/2<0,q=Z?N<U?N-U:N-O:0;return{[f]:p[f]+q,data:{[f]:H,centerOffset:N-H-q,...Z&&{alignmentOffset:q}},reset:Z}}}),wie=function(t){return t===void 0&&(t={}),{name:"flip",options:t,async fn(e){var n,r;const{placement:s,middlewareData:i,rects:o,initialPlacement:a,platform:l,elements:c}=e,{mainAxis:u=!0,crossAxis:h=!0,fallbackPlacements:p,fallbackStrategy:f="bestFit",fallbackAxisSideDirection:v="none",flipAlignment:m=!0,...x}=oo(t,e);if((n=i.arrow)!=null&&n.alignmentOffset)return{};const y=ao(s),S=ua(a),w=ao(a)===a,P=await(l.isRTL==null?void 0:l.isRTL(c.floating)),E=p||(w||!m?[vg(a)]:gie(a)),M=v!=="none";!p&&M&&E.push(...yie(a,m,v,P));const I=[a,...E],_=await rh(e,x),D=[];let R=((r=i.flip)==null?void 0:r.overflows)||[];if(u&&D.push(_[y]),h){const N=fie(s,o,P);D.push(_[N[0]],_[N[1]])}if(R=[...R,{placement:s,overflows:D}],!D.every(N=>N<=0)){var $,U;const N=((($=i.flip)==null?void 0:$.index)||0)+1,H=I[N];if(H)return{data:{index:N,overflows:R},reset:{placement:H}};let Z=(U=R.filter(q=>q.overflows[0]<=0).sort((q,V)=>q.overflows[1]-V.overflows[1])[0])==null?void 0:U.placement;if(!Z)switch(f){case"bestFit":{var O;const q=(O=R.filter(V=>{if(M){const Q=ua(V.placement);return Q===S||Q==="y"}return!0}).map(V=>[V.placement,V.overflows.filter(Q=>Q>0).reduce((Q,ne)=>Q+ne,0)]).sort((V,Q)=>V[1]-Q[1])[0])==null?void 0:O[0];q&&(Z=q);break}case"initialPlacement":Z=a;break}if(s!==Z)return{reset:{placement:Z}}}return{}}}};function c8(t,e){return{top:t.top-e.height,right:t.right-e.width,bottom:t.bottom-e.height,left:t.left-e.width}}function u8(t){return die.some(e=>t[e]>=0)}const bie=function(t){return t===void 0&&(t={}),{name:"hide",options:t,async fn(e){const{rects:n}=e,{strategy:r="referenceHidden",...s}=oo(t,e);switch(r){case"referenceHidden":{const i=await rh(e,{...s,elementContext:"reference"}),o=c8(i,n.reference);return{data:{referenceHiddenOffsets:o,referenceHidden:u8(o)}}}case"escaped":{const i=await rh(e,{...s,altBoundary:!0}),o=c8(i,n.floating);return{data:{escapedOffsets:o,escaped:u8(o)}}}default:return{}}}}};async function Cie(t,e){const{placement:n,platform:r,elements:s}=t,i=await(r.isRTL==null?void 0:r.isRTL(s.floating)),o=ao(n),a=nu(n),l=ua(n)==="y",c=["left","top"].includes(o)?-1:1,u=i&&l?-1:1,h=oo(e,t);let{mainAxis:p,crossAxis:f,alignmentAxis:v}=typeof h=="number"?{mainAxis:h,crossAxis:0,alignmentAxis:null}:{mainAxis:0,crossAxis:0,alignmentAxis:null,...h};return a&&typeof v=="number"&&(f=a==="end"?v*-1:v),l?{x:f*u,y:p*c}:{x:p*c,y:f*u}}const Pie=function(t){return t===void 0&&(t=0),{name:"offset",options:t,async fn(e){var n,r;const{x:s,y:i,placement:o,middlewareData:a}=e,l=await Cie(e,t);return o===((n=a.offset)==null?void 0:n.placement)&&(r=a.arrow)!=null&&r.alignmentOffset?{}:{x:s+l.x,y:i+l.y,data:{...l,placement:o}}}}},kie=function(t){return t===void 0&&(t={}),{name:"shift",options:t,async fn(e){const{x:n,y:r,placement:s}=e,{mainAxis:i=!0,crossAxis:o=!1,limiter:a={fn:x=>{let{x:y,y:S}=x;return{x:y,y:S}}},...l}=oo(t,e),c={x:n,y:r},u=await rh(e,l),h=ua(ao(s)),p=Sw(h);let f=c[p],v=c[h];if(i){const x=p==="y"?"top":"left",y=p==="y"?"bottom":"right",S=f+u[x],w=f-u[y];f=SS(S,f,w)}if(o){const x=h==="y"?"top":"left",y=h==="y"?"bottom":"right",S=v+u[x],w=v-u[y];v=SS(S,v,w)}const m=a.fn({...e,[p]:f,[h]:v});return{...m,data:{x:m.x-n,y:m.y-r}}}}},Iie=function(t){return t===void 0&&(t={}),{options:t,fn(e){const{x:n,y:r,placement:s,rects:i,middlewareData:o}=e,{offset:a=0,mainAxis:l=!0,crossAxis:c=!0}=oo(t,e),u={x:n,y:r},h=ua(s),p=Sw(h);let f=u[p],v=u[h];const m=oo(a,e),x=typeof m=="number"?{mainAxis:m,crossAxis:0}:{mainAxis:0,crossAxis:0,...m};if(l){const w=p==="y"?"height":"width",P=i.reference[p]-i.floating[w]+x.mainAxis,E=i.reference[p]+i.reference[w]-x.mainAxis;f<P?f=P:f>E&&(f=E)}if(c){var y,S;const w=p==="y"?"width":"height",P=["top","left"].includes(ao(s)),E=i.reference[h]-i.floating[w]+(P&&((y=o.offset)==null?void 0:y[h])||0)+(P?0:x.crossAxis),M=i.reference[h]+i.reference[w]+(P?0:((S=o.offset)==null?void 0:S[h])||0)-(P?x.crossAxis:0);v<E?v=E:v>M&&(v=M)}return{[p]:f,[h]:v}}}},Eie=function(t){return t===void 0&&(t={}),{name:"size",options:t,async fn(e){const{placement:n,rects:r,platform:s,elements:i}=e,{apply:o=()=>{},...a}=oo(t,e),l=await rh(e,a),c=ao(n),u=nu(n),h=ua(n)==="y",{width:p,height:f}=r.floating;let v,m;c==="top"||c==="bottom"?(v=c,m=u===(await(s.isRTL==null?void 0:s.isRTL(i.floating))?"start":"end")?"left":"right"):(m=c,v=u==="end"?"top":"bottom");const x=f-l.top-l.bottom,y=p-l.left-l.right,S=ci(f-l[v],x),w=ci(p-l[m],y),P=!e.middlewareData.shift;let E=S,M=w;if(h?M=u||P?ci(w,y):y:E=u||P?ci(S,x):x,P&&!u){const _=Nr(l.left,0),D=Nr(l.right,0),R=Nr(l.top,0),$=Nr(l.bottom,0);h?M=p-2*(_!==0||D!==0?_+D:Nr(l.left,l.right)):E=f-2*(R!==0||$!==0?R+$:Nr(l.top,l.bottom))}await o({...e,availableWidth:M,availableHeight:E});const I=await s.getDimensions(i.floating);return p!==I.width||f!==I.height?{reset:{rects:!0}}:{}}}};function ru(t){return d_(t)?(t.nodeName||"").toLowerCase():"#document"}function Kr(t){var e;return(t==null||(e=t.ownerDocument)==null?void 0:e.defaultView)||window}function yo(t){var e;return(e=(d_(t)?t.ownerDocument:t.document)||window.document)==null?void 0:e.documentElement}function d_(t){return t instanceof Node||t instanceof Kr(t).Node}function Bs(t){return t instanceof Element||t instanceof Kr(t).Element}function Ci(t){return t instanceof HTMLElement||t instanceof Kr(t).HTMLElement}function d8(t){return typeof ShadowRoot>"u"?!1:t instanceof ShadowRoot||t instanceof Kr(t).ShadowRoot}function Oh(t){const{overflow:e,overflowX:n,overflowY:r,display:s}=Us(t);return/auto|scroll|overlay|hidden|clip/.test(e+r+n)&&!["inline","contents"].includes(s)}function Tie(t){return["table","td","th"].includes(ru(t))}function Rm(t){return[":popover-open",":modal"].some(e=>{try{return t.matches(e)}catch{return!1}})}function bw(t){const e=Cw(),n=Bs(t)?Us(t):t;return n.transform!=="none"||n.perspective!=="none"||(n.containerType?n.containerType!=="normal":!1)||!e&&(n.backdropFilter?n.backdropFilter!=="none":!1)||!e&&(n.filter?n.filter!=="none":!1)||["transform","perspective","filter"].some(r=>(n.willChange||"").includes(r))||["paint","layout","strict","content"].some(r=>(n.contain||"").includes(r))}function Mie(t){let e=da(t);for(;Ci(e)&&!$c(e);){if(bw(e))return e;if(Rm(e))return null;e=da(e)}return null}function Cw(){return typeof CSS>"u"||!CSS.supports?!1:CSS.supports("-webkit-backdrop-filter","none")}function $c(t){return["html","body","#document"].includes(ru(t))}function Us(t){return Kr(t).getComputedStyle(t)}function Om(t){return Bs(t)?{scrollLeft:t.scrollLeft,scrollTop:t.scrollTop}:{scrollLeft:t.scrollX,scrollTop:t.scrollY}}function da(t){if(ru(t)==="html")return t;const e=t.assignedSlot||t.parentNode||d8(t)&&t.host||yo(t);return d8(e)?e.host:e}function h_(t){const e=da(t);return $c(e)?t.ownerDocument?t.ownerDocument.body:t.body:Ci(e)&&Oh(e)?e:h_(e)}function sh(t,e,n){var r;e===void 0&&(e=[]),n===void 0&&(n=!0);const s=h_(t),i=s===((r=t.ownerDocument)==null?void 0:r.body),o=Kr(s);if(i){const a=wS(o);return e.concat(o,o.visualViewport||[],Oh(s)?s:[],a&&n?sh(a):[])}return e.concat(s,sh(s,[],n))}function wS(t){return t.parent&&Object.getPrototypeOf(t.parent)?t.frameElement:null}function p_(t){const e=Us(t);let n=parseFloat(e.width)||0,r=parseFloat(e.height)||0;const s=Ci(t),i=s?t.offsetWidth:n,o=s?t.offsetHeight:r,a=yg(n)!==i||yg(r)!==o;return a&&(n=i,r=o),{width:n,height:r,$:a}}function Pw(t){return Bs(t)?t:t.contextElement}function bc(t){const e=Pw(t);if(!Ci(e))return ca(1);const n=e.getBoundingClientRect(),{width:r,height:s,$:i}=p_(e);let o=(i?yg(n.width):n.width)/r,a=(i?yg(n.height):n.height)/s;return(!o||!Number.isFinite(o))&&(o=1),(!a||!Number.isFinite(a))&&(a=1),{x:o,y:a}}const _ie=ca(0);function f_(t){const e=Kr(t);return!Cw()||!e.visualViewport?_ie:{x:e.visualViewport.offsetLeft,y:e.visualViewport.offsetTop}}function Aie(t,e,n){return e===void 0&&(e=!1),!n||e&&n!==Kr(t)?!1:e}function fl(t,e,n,r){e===void 0&&(e=!1),n===void 0&&(n=!1);const s=t.getBoundingClientRect(),i=Pw(t);let o=ca(1);e&&(r?Bs(r)&&(o=bc(r)):o=bc(t));const a=Aie(i,n,r)?f_(i):ca(0);let l=(s.left+a.x)/o.x,c=(s.top+a.y)/o.y,u=s.width/o.x,h=s.height/o.y;if(i){const p=Kr(i),f=r&&Bs(r)?Kr(r):r;let v=p,m=wS(v);for(;m&&r&&f!==v;){const x=bc(m),y=m.getBoundingClientRect(),S=Us(m),w=y.left+(m.clientLeft+parseFloat(S.paddingLeft))*x.x,P=y.top+(m.clientTop+parseFloat(S.paddingTop))*x.y;l*=x.x,c*=x.y,u*=x.x,h*=x.y,l+=w,c+=P,v=Kr(m),m=wS(v)}}return Sg({width:u,height:h,x:l,y:c})}function Die(t){let{elements:e,rect:n,offsetParent:r,strategy:s}=t;const i=s==="fixed",o=yo(r),a=e?Rm(e.floating):!1;if(r===o||a&&i)return n;let l={scrollLeft:0,scrollTop:0},c=ca(1);const u=ca(0),h=Ci(r);if((h||!h&&!i)&&((ru(r)!=="body"||Oh(o))&&(l=Om(r)),Ci(r))){const p=fl(r);c=bc(r),u.x=p.x+r.clientLeft,u.y=p.y+r.clientTop}return{width:n.width*c.x,height:n.height*c.y,x:n.x*c.x-l.scrollLeft*c.x+u.x,y:n.y*c.y-l.scrollTop*c.y+u.y}}function jie(t){return Array.from(t.getClientRects())}function g_(t){return fl(yo(t)).left+Om(t).scrollLeft}function Rie(t){const e=yo(t),n=Om(t),r=t.ownerDocument.body,s=Nr(e.scrollWidth,e.clientWidth,r.scrollWidth,r.clientWidth),i=Nr(e.scrollHeight,e.clientHeight,r.scrollHeight,r.clientHeight);let o=-n.scrollLeft+g_(t);const a=-n.scrollTop;return Us(r).direction==="rtl"&&(o+=Nr(e.clientWidth,r.clientWidth)-s),{width:s,height:i,x:o,y:a}}function Oie(t,e){const n=Kr(t),r=yo(t),s=n.visualViewport;let i=r.clientWidth,o=r.clientHeight,a=0,l=0;if(s){i=s.width,o=s.height;const c=Cw();(!c||c&&e==="fixed")&&(a=s.offsetLeft,l=s.offsetTop)}return{width:i,height:o,x:a,y:l}}function Lie(t,e){const n=fl(t,!0,e==="fixed"),r=n.top+t.clientTop,s=n.left+t.clientLeft,i=Ci(t)?bc(t):ca(1),o=t.clientWidth*i.x,a=t.clientHeight*i.y,l=s*i.x,c=r*i.y;return{width:o,height:a,x:l,y:c}}function h8(t,e,n){let r;if(e==="viewport")r=Oie(t,n);else if(e==="document")r=Rie(yo(t));else if(Bs(e))r=Lie(e,n);else{const s=f_(t);r={...e,x:e.x-s.x,y:e.y-s.y}}return Sg(r)}function m_(t,e){const n=da(t);return n===e||!Bs(n)||$c(n)?!1:Us(n).position==="fixed"||m_(n,e)}function Nie(t,e){const n=e.get(t);if(n)return n;let r=sh(t,[],!1).filter(a=>Bs(a)&&ru(a)!=="body"),s=null;const i=Us(t).position==="fixed";let o=i?da(t):t;for(;Bs(o)&&!$c(o);){const a=Us(o),l=bw(o);!l&&a.position==="fixed"&&(s=null),(i?!l&&!s:!l&&a.position==="static"&&!!s&&["absolute","fixed"].includes(s.position)||Oh(o)&&!l&&m_(t,o))?r=r.filter(u=>u!==o):s=a,o=da(o)}return e.set(t,r),r}function zie(t){let{element:e,boundary:n,rootBoundary:r,strategy:s}=t;const o=[...n==="clippingAncestors"?Rm(e)?[]:Nie(e,this._c):[].concat(n),r],a=o[0],l=o.reduce((c,u)=>{const h=h8(e,u,s);return c.top=Nr(h.top,c.top),c.right=ci(h.right,c.right),c.bottom=ci(h.bottom,c.bottom),c.left=Nr(h.left,c.left),c},h8(e,a,s));return{width:l.right-l.left,height:l.bottom-l.top,x:l.left,y:l.top}}function Fie(t){const{width:e,height:n}=p_(t);return{width:e,height:n}}function $ie(t,e,n){const r=Ci(e),s=yo(e),i=n==="fixed",o=fl(t,!0,i,e);let a={scrollLeft:0,scrollTop:0};const l=ca(0);if(r||!r&&!i)if((ru(e)!=="body"||Oh(s))&&(a=Om(e)),r){const h=fl(e,!0,i,e);l.x=h.x+e.clientLeft,l.y=h.y+e.clientTop}else s&&(l.x=g_(s));const c=o.left+a.scrollLeft-l.x,u=o.top+a.scrollTop-l.y;return{x:c,y:u,width:o.width,height:o.height}}function Fy(t){return Us(t).position==="static"}function p8(t,e){return!Ci(t)||Us(t).position==="fixed"?null:e?e(t):t.offsetParent}function y_(t,e){const n=Kr(t);if(Rm(t))return n;if(!Ci(t)){let s=da(t);for(;s&&!$c(s);){if(Bs(s)&&!Fy(s))return s;s=da(s)}return n}let r=p8(t,e);for(;r&&Tie(r)&&Fy(r);)r=p8(r,e);return r&&$c(r)&&Fy(r)&&!bw(r)?n:r||Mie(t)||n}const Bie=async function(t){const e=this.getOffsetParent||y_,n=this.getDimensions,r=await n(t.floating);return{reference:$ie(t.reference,await e(t.floating),t.strategy),floating:{x:0,y:0,width:r.width,height:r.height}}};function Uie(t){return Us(t).direction==="rtl"}const Hie={convertOffsetParentRelativeRectToViewportRelativeRect:Die,getDocumentElement:yo,getClippingRect:zie,getOffsetParent:y_,getElementRects:Bie,getClientRects:jie,getDimensions:Fie,getScale:bc,isElement:Bs,isRTL:Uie};function Wie(t,e){let n=null,r;const s=yo(t);function i(){var a;clearTimeout(r),(a=n)==null||a.disconnect(),n=null}function o(a,l){a===void 0&&(a=!1),l===void 0&&(l=1),i();const{left:c,top:u,width:h,height:p}=t.getBoundingClientRect();if(a||e(),!h||!p)return;const f=Q0(u),v=Q0(s.clientWidth-(c+h)),m=Q0(s.clientHeight-(u+p)),x=Q0(c),S={rootMargin:-f+"px "+-v+"px "+-m+"px "+-x+"px",threshold:Nr(0,ci(1,l))||1};let w=!0;function P(E){const M=E[0].intersectionRatio;if(M!==l){if(!w)return o();M?o(!1,M):r=setTimeout(()=>{o(!1,1e-7)},1e3)}w=!1}try{n=new IntersectionObserver(P,{...S,root:s.ownerDocument})}catch{n=new IntersectionObserver(P,S)}n.observe(t)}return o(!0),i}function Kie(t,e,n,r){r===void 0&&(r={});const{ancestorScroll:s=!0,ancestorResize:i=!0,elementResize:o=typeof ResizeObserver=="function",layoutShift:a=typeof IntersectionObserver=="function",animationFrame:l=!1}=r,c=Pw(t),u=s||i?[...c?sh(c):[],...sh(e)]:[];u.forEach(y=>{s&&y.addEventListener("scroll",n,{passive:!0}),i&&y.addEventListener("resize",n)});const h=c&&a?Wie(c,n):null;let p=-1,f=null;o&&(f=new ResizeObserver(y=>{let[S]=y;S&&S.target===c&&f&&(f.unobserve(e),cancelAnimationFrame(p),p=requestAnimationFrame(()=>{var w;(w=f)==null||w.observe(e)})),n()}),c&&!l&&f.observe(c),f.observe(e));let v,m=l?fl(t):null;l&&x();function x(){const y=fl(t);m&&(y.x!==m.x||y.y!==m.y||y.width!==m.width||y.height!==m.height)&&n(),m=y,v=requestAnimationFrame(x)}return n(),()=>{var y;u.forEach(S=>{s&&S.removeEventListener("scroll",n),i&&S.removeEventListener("resize",n)}),h==null||h(),(y=f)==null||y.disconnect(),f=null,l&&cancelAnimationFrame(v)}}const Gie=Pie,Vie=kie,qie=wie,Yie=Eie,Xie=bie,f8=xie,Zie=Iie,Qie=(t,e,n)=>{const r=new Map,s={platform:Hie,...n},i={...s.platform,_c:r};return Sie(t,e,{...s,platform:i})};var af=typeof document<"u"?C.useLayoutEffect:C.useEffect;function xg(t,e){if(t===e)return!0;if(typeof t!=typeof e)return!1;if(typeof t=="function"&&t.toString()===e.toString())return!0;let n,r,s;if(t&&e&&typeof t=="object"){if(Array.isArray(t)){if(n=t.length,n!==e.length)return!1;for(r=n;r--!==0;)if(!xg(t[r],e[r]))return!1;return!0}if(s=Object.keys(t),n=s.length,n!==Object.keys(e).length)return!1;for(r=n;r--!==0;)if(!{}.hasOwnProperty.call(e,s[r]))return!1;for(r=n;r--!==0;){const i=s[r];if(!(i==="_owner"&&t.$$typeof)&&!xg(t[i],e[i]))return!1}return!0}return t!==t&&e!==e}function v_(t){return typeof window>"u"?1:(t.ownerDocument.defaultView||window).devicePixelRatio||1}function g8(t,e){const n=v_(t);return Math.round(e*n)/n}function m8(t){const e=C.useRef(t);return af(()=>{e.current=t}),e}function Jie(t){t===void 0&&(t={});const{placement:e="bottom",strategy:n="absolute",middleware:r=[],platform:s,elements:{reference:i,floating:o}={},transform:a=!0,whileElementsMounted:l,open:c}=t,[u,h]=C.useState({x:0,y:0,strategy:n,placement:e,middlewareData:{},isPositioned:!1}),[p,f]=C.useState(r);xg(p,r)||f(r);const[v,m]=C.useState(null),[x,y]=C.useState(null),S=C.useCallback(q=>{q!==M.current&&(M.current=q,m(q))},[]),w=C.useCallback(q=>{q!==I.current&&(I.current=q,y(q))},[]),P=i||v,E=o||x,M=C.useRef(null),I=C.useRef(null),_=C.useRef(u),D=l!=null,R=m8(l),$=m8(s),U=C.useCallback(()=>{if(!M.current||!I.current)return;const q={placement:e,strategy:n,middleware:p};$.current&&(q.platform=$.current),Qie(M.current,I.current,q).then(V=>{const Q={...V,isPositioned:!0};O.current&&!xg(_.current,Q)&&(_.current=Q,xl.flushSync(()=>{h(Q)}))})},[p,e,n,$]);af(()=>{c===!1&&_.current.isPositioned&&(_.current.isPositioned=!1,h(q=>({...q,isPositioned:!1})))},[c]);const O=C.useRef(!1);af(()=>(O.current=!0,()=>{O.current=!1}),[]),af(()=>{if(P&&(M.current=P),E&&(I.current=E),P&&E){if(R.current)return R.current(P,E,U);U()}},[P,E,U,R,D]);const N=C.useMemo(()=>({reference:M,floating:I,setReference:S,setFloating:w}),[S,w]),H=C.useMemo(()=>({reference:P,floating:E}),[P,E]),Z=C.useMemo(()=>{const q={position:n,left:0,top:0};if(!H.floating)return q;const V=g8(H.floating,u.x),Q=g8(H.floating,u.y);return a?{...q,transform:"translate("+V+"px, "+Q+"px)",...v_(H.floating)>=1.5&&{willChange:"transform"}}:{position:n,left:V,top:Q}},[n,a,H.floating,u.x,u.y]);return C.useMemo(()=>({...u,update:U,refs:N,elements:H,floatingStyles:Z}),[u,U,N,H,Z])}const eoe=t=>{function e(n){return{}.hasOwnProperty.call(n,"current")}return{name:"arrow",options:t,fn(n){const{element:r,padding:s}=typeof t=="function"?t(n):t;return r&&e(r)?r.current!=null?f8({element:r.current,padding:s}).fn(n):{}:r?f8({element:r,padding:s}).fn(n):{}}}},toe=(t,e)=>({...Gie(t),options:[t,e]}),noe=(t,e)=>({...Vie(t),options:[t,e]}),roe=(t,e)=>({...Zie(t),options:[t,e]}),soe=(t,e)=>({...qie(t),options:[t,e]}),ioe=(t,e)=>({...Yie(t),options:[t,e]}),ooe=(t,e)=>({...Xie(t),options:[t,e]}),aoe=(t,e)=>({...eoe(t),options:[t,e]});var loe="Arrow",S_=C.forwardRef((t,e)=>{const{children:n,width:r=10,height:s=5,...i}=t;return d.jsx(Ye.svg,{...i,ref:e,width:r,height:s,viewBox:"0 0 30 10",preserveAspectRatio:"none",children:t.asChild?n:d.jsx("polygon",{points:"0,0 30,0 15,10"})})});S_.displayName=loe;var coe=S_;function x_(t){const[e,n]=C.useState(void 0);return la(()=>{if(t){n({width:t.offsetWidth,height:t.offsetHeight});const r=new ResizeObserver(s=>{if(!Array.isArray(s)||!s.length)return;const i=s[0];let o,a;if("borderBoxSize"in i){const l=i.borderBoxSize,c=Array.isArray(l)?l[0]:l;o=c.inlineSize,a=c.blockSize}else o=t.offsetWidth,a=t.offsetHeight;n({width:o,height:a})});return r.observe(t,{box:"border-box"}),()=>r.unobserve(t)}else n(void 0)},[t]),e}var kw="Popper",[w_,Lm]=Ei(kw),[uoe,b_]=w_(kw),C_=t=>{const{__scopePopper:e,children:n}=t,[r,s]=C.useState(null);return d.jsx(uoe,{scope:e,anchor:r,onAnchorChange:s,children:n})};C_.displayName=kw;var P_="PopperAnchor",k_=C.forwardRef((t,e)=>{const{__scopePopper:n,virtualRef:r,...s}=t,i=b_(P_,n),o=C.useRef(null),a=xt(e,o);return C.useEffect(()=>{i.onAnchorChange((r==null?void 0:r.current)||o.current)}),r?null:d.jsx(Ye.div,{...s,ref:a})});k_.displayName=P_;var Iw="PopperContent",[doe,hoe]=w_(Iw),I_=C.forwardRef((t,e)=>{var Ue,et,Ge,lt,nt,qn;const{__scopePopper:n,side:r="bottom",sideOffset:s=0,align:i="center",alignOffset:o=0,arrowPadding:a=0,avoidCollisions:l=!0,collisionBoundary:c=[],collisionPadding:u=0,sticky:h="partial",hideWhenDetached:p=!1,updatePositionStrategy:f="optimized",onPlaced:v,...m}=t,x=b_(Iw,n),[y,S]=C.useState(null),w=xt(e,en=>S(en)),[P,E]=C.useState(null),M=x_(P),I=(M==null?void 0:M.width)??0,_=(M==null?void 0:M.height)??0,D=r+(i!=="center"?"-"+i:""),R=typeof u=="number"?u:{top:0,right:0,bottom:0,left:0,...u},$=Array.isArray(c)?c:[c],U=$.length>0,O={padding:R,boundary:$.filter(foe),altBoundary:U},{refs:N,floatingStyles:H,placement:Z,isPositioned:q,middlewareData:V}=Jie({strategy:"fixed",placement:D,whileElementsMounted:(...en)=>Kie(...en,{animationFrame:f==="always"}),elements:{reference:x.anchor},middleware:[toe({mainAxis:s+_,alignmentAxis:o}),l&&noe({mainAxis:!0,crossAxis:!1,limiter:h==="partial"?roe():void 0,...O}),l&&soe({...O}),ioe({...O,apply:({elements:en,rects:an,availableWidth:Et,availableHeight:tn})=>{const{width:_r,height:qs}=an.reference,Ar=en.floating.style;Ar.setProperty("--radix-popper-available-width",`${Et}px`),Ar.setProperty("--radix-popper-available-height",`${tn}px`),Ar.setProperty("--radix-popper-anchor-width",`${_r}px`),Ar.setProperty("--radix-popper-anchor-height",`${qs}px`)}}),P&&aoe({element:P,padding:a}),goe({arrowWidth:I,arrowHeight:_}),p&&ooe({strategy:"referenceHidden",...O})]}),[Q,ne]=M_(Z),le=Mn(v);la(()=>{q&&(le==null||le())},[q,le]);const de=(Ue=V.arrow)==null?void 0:Ue.x,_e=(et=V.arrow)==null?void 0:et.y,je=((Ge=V.arrow)==null?void 0:Ge.centerOffset)!==0,[ce,tt]=C.useState();return la(()=>{y&&tt(window.getComputedStyle(y).zIndex)},[y]),d.jsx("div",{ref:N.setFloating,"data-radix-popper-content-wrapper":"",style:{...H,transform:q?H.transform:"translate(0, -200%)",minWidth:"max-content",zIndex:ce,"--radix-popper-transform-origin":[(lt=V.transformOrigin)==null?void 0:lt.x,(nt=V.transformOrigin)==null?void 0:nt.y].join(" "),...((qn=V.hide)==null?void 0:qn.referenceHidden)&&{visibility:"hidden",pointerEvents:"none"}},dir:t.dir,children:d.jsx(doe,{scope:n,placedSide:Q,onArrowChange:E,arrowX:de,arrowY:_e,shouldHideArrow:je,children:d.jsx(Ye.div,{"data-side":Q,"data-align":ne,...m,ref:w,style:{...m.style,animation:q?void 0:"none"}})})})});I_.displayName=Iw;var E_="PopperArrow",poe={top:"bottom",right:"left",bottom:"top",left:"right"},T_=C.forwardRef(function(e,n){const{__scopePopper:r,...s}=e,i=hoe(E_,r),o=poe[i.placedSide];return d.jsx("span",{ref:i.onArrowChange,style:{position:"absolute",left:i.arrowX,top:i.arrowY,[o]:0,transformOrigin:{top:"",right:"0 0",bottom:"center 0",left:"100% 0"}[i.placedSide],transform:{top:"translateY(100%)",right:"translateY(50%) rotate(90deg) translateX(-50%)",bottom:"rotate(180deg)",left:"translateY(50%) rotate(-90deg) translateX(50%)"}[i.placedSide],visibility:i.shouldHideArrow?"hidden":void 0},children:d.jsx(coe,{...s,ref:n,style:{...s.style,display:"block"}})})});T_.displayName=E_;function foe(t){return t!==null}var goe=t=>({name:"transformOrigin",options:t,fn(e){var x,y,S;const{placement:n,rects:r,middlewareData:s}=e,o=((x=s.arrow)==null?void 0:x.centerOffset)!==0,a=o?0:t.arrowWidth,l=o?0:t.arrowHeight,[c,u]=M_(n),h={start:"0%",center:"50%",end:"100%"}[u],p=(((y=s.arrow)==null?void 0:y.x)??0)+a/2,f=(((S=s.arrow)==null?void 0:S.y)??0)+l/2;let v="",m="";return c==="bottom"?(v=o?h:`${p}px`,m=`${-l}px`):c==="top"?(v=o?h:`${p}px`,m=`${r.floating.height+l}px`):c==="right"?(v=`${-l}px`,m=o?h:`${f}px`):c==="left"&&(v=`${r.floating.width+l}px`,m=o?h:`${f}px`),{data:{x:v,y:m}}}});function M_(t){const[e,n="center"]=t.split("-");return[e,n]}var Ew=C_,Tw=k_,__=I_,A_=T_,Mw="Popover",[D_,Vpe]=Ei(Mw,[Lm]),Lh=Lm(),[moe,ka]=D_(Mw),j_=t=>{const{__scopePopover:e,children:n,open:r,defaultOpen:s,onOpenChange:i,modal:o=!1}=t,a=Lh(e),l=C.useRef(null),[c,u]=C.useState(!1),[h=!1,p]=Pa({prop:r,defaultProp:s,onChange:i});return d.jsx(Ew,{...a,children:d.jsx(moe,{scope:e,contentId:Zi(),triggerRef:l,open:h,onOpenChange:p,onOpenToggle:C.useCallback(()=>p(f=>!f),[p]),hasCustomAnchor:c,onCustomAnchorAdd:C.useCallback(()=>u(!0),[]),onCustomAnchorRemove:C.useCallback(()=>u(!1),[]),modal:o,children:n})})};j_.displayName=Mw;var R_="PopoverAnchor",yoe=C.forwardRef((t,e)=>{const{__scopePopover:n,...r}=t,s=ka(R_,n),i=Lh(n),{onCustomAnchorAdd:o,onCustomAnchorRemove:a}=s;return C.useEffect(()=>(o(),()=>a()),[o,a]),d.jsx(Tw,{...i,...r,ref:e})});yoe.displayName=R_;var O_="PopoverTrigger",L_=C.forwardRef((t,e)=>{const{__scopePopover:n,...r}=t,s=ka(O_,n),i=Lh(n),o=xt(e,s.triggerRef),a=d.jsx(Ye.button,{type:"button","aria-haspopup":"dialog","aria-expanded":s.open,"aria-controls":s.contentId,"data-state":B_(s.open),...r,ref:o,onClick:ve(t.onClick,s.onOpenToggle)});return s.hasCustomAnchor?a:d.jsx(Tw,{asChild:!0,...i,children:a})});L_.displayName=O_;var _w="PopoverPortal",[voe,Soe]=D_(_w,{forceMount:void 0}),N_=t=>{const{__scopePopover:e,forceMount:n,children:r,container:s}=t,i=ka(_w,e);return d.jsx(voe,{scope:e,forceMount:n,children:d.jsx(Ks,{present:n||i.open,children:d.jsx(Rh,{asChild:!0,container:s,children:r})})})};N_.displayName=_w;var Bc="PopoverContent",z_=C.forwardRef((t,e)=>{const n=Soe(Bc,t.__scopePopover),{forceMount:r=n.forceMount,...s}=t,i=ka(Bc,t.__scopePopover);return d.jsx(Ks,{present:r||i.open,children:i.modal?d.jsx(xoe,{...s,ref:e}):d.jsx(woe,{...s,ref:e})})});z_.displayName=Bc;var xoe=C.forwardRef((t,e)=>{const n=ka(Bc,t.__scopePopover),r=C.useRef(null),s=xt(e,r),i=C.useRef(!1);return C.useEffect(()=>{const o=r.current;if(o)return lw(o)},[]),d.jsx(km,{as:hl,allowPinchZoom:!0,children:d.jsx(F_,{...t,ref:s,trapFocus:n.open,disableOutsidePointerEvents:!0,onCloseAutoFocus:ve(t.onCloseAutoFocus,o=>{var a;o.preventDefault(),i.current||(a=n.triggerRef.current)==null||a.focus()}),onPointerDownOutside:ve(t.onPointerDownOutside,o=>{const a=o.detail.originalEvent,l=a.button===0&&a.ctrlKey===!0,c=a.button===2||l;i.current=c},{checkForDefaultPrevented:!1}),onFocusOutside:ve(t.onFocusOutside,o=>o.preventDefault(),{checkForDefaultPrevented:!1})})})}),woe=C.forwardRef((t,e)=>{const n=ka(Bc,t.__scopePopover),r=C.useRef(!1),s=C.useRef(!1);return d.jsx(F_,{...t,ref:e,trapFocus:!1,disableOutsidePointerEvents:!1,onCloseAutoFocus:i=>{var o,a;(o=t.onCloseAutoFocus)==null||o.call(t,i),i.defaultPrevented||(r.current||(a=n.triggerRef.current)==null||a.focus(),i.preventDefault()),r.current=!1,s.current=!1},onInteractOutside:i=>{var l,c;(l=t.onInteractOutside)==null||l.call(t,i),i.defaultPrevented||(r.current=!0,i.detail.originalEvent.type==="pointerdown"&&(s.current=!0));const o=i.target;((c=n.triggerRef.current)==null?void 0:c.contains(o))&&i.preventDefault(),i.detail.originalEvent.type==="focusin"&&s.current&&i.preventDefault()}})}),F_=C.forwardRef((t,e)=>{const{__scopePopover:n,trapFocus:r,onOpenAutoFocus:s,onCloseAutoFocus:i,disableOutsidePointerEvents:o,onEscapeKeyDown:a,onPointerDownOutside:l,onFocusOutside:c,onInteractOutside:u,...h}=t,p=ka(Bc,n),f=Lh(n);return aw(),d.jsx(Cm,{asChild:!0,loop:!0,trapped:r,onMountAutoFocus:s,onUnmountAutoFocus:i,children:d.jsx(jh,{asChild:!0,disableOutsidePointerEvents:o,onInteractOutside:u,onEscapeKeyDown:a,onPointerDownOutside:l,onFocusOutside:c,onDismiss:()=>p.onOpenChange(!1),children:d.jsx(__,{"data-state":B_(p.open),role:"dialog",id:p.contentId,...f,...h,ref:e,style:{...h.style,"--radix-popover-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-popover-content-available-width":"var(--radix-popper-available-width)","--radix-popover-content-available-height":"var(--radix-popper-available-height)","--radix-popover-trigger-width":"var(--radix-popper-anchor-width)","--radix-popover-trigger-height":"var(--radix-popper-anchor-height)"}})})})}),$_="PopoverClose",boe=C.forwardRef((t,e)=>{const{__scopePopover:n,...r}=t,s=ka($_,n);return d.jsx(Ye.button,{type:"button",...r,ref:e,onClick:ve(t.onClick,()=>s.onOpenChange(!1))})});boe.displayName=$_;var Coe="PopoverArrow",Poe=C.forwardRef((t,e)=>{const{__scopePopover:n,...r}=t,s=Lh(n);return d.jsx(A_,{...s,...r,ref:e})});Poe.displayName=Coe;function B_(t){return t?"open":"closed"}var Aw=j_,Dw=L_,jw=N_,Rw=z_;function vo(t,e){const n=G(),r=C.useRef(!1),s=An(),i=C.useCallback(a=>{r.current=a,n.run(()=>{a?(n.complete(),n.addOpenMenu(t)):n.updateInstanceState({openMenus:n.getOpenMenus().filter(l=>!l.startsWith(t))}),e==null||e(a)})},[n,t,e]),o=J("is menu open",()=>n.getOpenMenus().includes(t),[n,t]);return C.useEffect(()=>(r.current&&(s("open-menu",{source:"unknown",id:t}),n.addOpenMenu(t)),()=>{r.current&&(n.deleteOpenMenu(t),n.getOpenMenus().forEach(a=>{a.startsWith(t)&&(s("close-menu",{source:"unknown",id:t}),n.deleteOpenMenu(a))}),r.current=!1)}),[n,t,s]),[o,i]}function Ow({id:t,children:e,onOpenChange:n,open:r}){const[s,i]=vo(t,n);return d.jsx(Aw,{onOpenChange:i,open:r||s,children:d.jsx("div",{className:"tlui-popover",children:e})})}function Lw({children:t}){return d.jsx(Dw,{asChild:!0,dir:"ltr",children:t})}function Nw({side:t,children:e,align:n="center",sideOffset:r=8,alignOffset:s=0}){const i=mn();return d.jsx(jw,{container:i,children:d.jsx(Rw,{className:"tlui-popover__content",side:t,sideOffset:r,align:n,alignOffset:s,dir:"ltr",children:e})})}const U_=C.createContext(null);function Nm(){const t=C.useContext(U_);if(!t)throw new Error("useTldrawUiMenuContext must be used within a TldrawUiMenuContextProvider");return t}function Ss({type:t,sourceId:e,children:n}){return d.jsx(U_.Provider,{value:{type:t,sourceId:e},children:n})}function koe(t){return t.getSelectedShapeIds().map(r=>t.getShape(r)).filter(r=>{if(!r)return!1;if(t.isShapeOfType(r,"arrow")){const s=vr(t,r);if(s.start||s.end)return!1}return!0})}const H_=()=>{const t=G();return J("threeStackableItems",()=>koe(t).length>2,[t])},So=()=>{const t=G();return J("isInSelectState",()=>t.isIn("select"),[t])},W_=()=>{const t=G();return J("allow group",()=>{const e=t.getSelectedShapes();if(e.length<2)return!1;for(const n of e)if(t.isShapeOfType(n,"arrow")){const r=vr(t,n);if(r.start&&!e.some(s=>s.id===r.start.toId)||r.end&&!e.some(s=>s.id===r.end.toId))return!1}return!0},[t])},K_=()=>{const t=G();return J("allowUngroup",()=>t.getSelectedShapeIds().some(e=>{var n;return((n=t.getShape(e))==null?void 0:n.type)==="group"}),[t])},Ioe=typeof window<"u"&&"navigator"in window&&!!navigator.clipboard&&!!navigator.clipboard.read;function G_(t,e){const n=G();return J("selectedShapes",()=>n.getSelectedShapes().length>=t,[n,t,e])}function ar(t,e){const n=G();return J("selectedShapes",()=>{const r=n.getSelectedShapes().filter(s=>!n.isShapeOrAncestorLocked(s)).length;return t===void 0?r:r>=t},[n])}function Eoe(){const t=G();return J("showAutoSizeToggle",()=>{const e=t.getSelectedShapes();return e.length===1&&t.isShapeOfType(e[0],"text")&&e[0].props.autoSize===!1},[t])}function V_(){const t=G();return J("hasLinkShapeSelected",()=>{const e=t.getOnlySelectedShape();return!!(e&&e.type!=="embed"&&"url"in e.props&&!e.isLocked)},[t])}function Toe(){const t=G();return J("onlyFlippableShape",()=>{const e=t.getOnlySelectedShape();return e&&(t.isShapeOfType(e,"group")||t.isShapeOfType(e,"image")||t.isShapeOfType(e,"arrow")||t.isShapeOfType(e,"line")||t.isShapeOfType(e,"draw"))},[t])}function q_(){const t=G();return J("useCanRedo",()=>t.getCanRedo(),[t])}function Y_(){const t=G();return J("useCanUndo",()=>t.getCanUndo(),[t])}var Moe=C.createContext(void 0);function zw(t){const e=C.useContext(Moe);return t||e||"ltr"}var $y="rovingFocusGroup.onEntryFocus",_oe={bubbles:!1,cancelable:!0},zm="RovingFocusGroup",[bS,X_,Aoe]=Im(zm),[Doe,Z_]=Ei(zm,[Aoe]),[joe,Roe]=Doe(zm),Q_=C.forwardRef((t,e)=>d.jsx(bS.Provider,{scope:t.__scopeRovingFocusGroup,children:d.jsx(bS.Slot,{scope:t.__scopeRovingFocusGroup,children:d.jsx(Ooe,{...t,ref:e})})}));Q_.displayName=zm;var Ooe=C.forwardRef((t,e)=>{const{__scopeRovingFocusGroup:n,orientation:r,loop:s=!1,dir:i,currentTabStopId:o,defaultCurrentTabStopId:a,onCurrentTabStopIdChange:l,onEntryFocus:c,preventScrollOnEntryFocus:u=!1,...h}=t,p=C.useRef(null),f=xt(e,p),v=zw(i),[m=null,x]=Pa({prop:o,defaultProp:a,onChange:l}),[y,S]=C.useState(!1),w=Mn(c),P=X_(n),E=C.useRef(!1),[M,I]=C.useState(0);return C.useEffect(()=>{const _=p.current;if(_)return _.addEventListener($y,w),()=>_.removeEventListener($y,w)},[w]),d.jsx(joe,{scope:n,orientation:r,dir:v,loop:s,currentTabStopId:m,onItemFocus:C.useCallback(_=>x(_),[x]),onItemShiftTab:C.useCallback(()=>S(!0),[]),onFocusableItemAdd:C.useCallback(()=>I(_=>_+1),[]),onFocusableItemRemove:C.useCallback(()=>I(_=>_-1),[]),children:d.jsx(Ye.div,{tabIndex:y||M===0?-1:0,"data-orientation":r,...h,ref:f,style:{outline:"none",...t.style},onMouseDown:ve(t.onMouseDown,()=>{E.current=!0}),onFocus:ve(t.onFocus,_=>{const D=!E.current;if(_.target===_.currentTarget&&D&&!y){const R=new CustomEvent($y,_oe);if(_.currentTarget.dispatchEvent(R),!R.defaultPrevented){const $=P().filter(Z=>Z.focusable),U=$.find(Z=>Z.active),O=$.find(Z=>Z.id===m),H=[U,O,...$].filter(Boolean).map(Z=>Z.ref.current);tA(H,u)}}E.current=!1}),onBlur:ve(t.onBlur,()=>S(!1))})})}),J_="RovingFocusGroupItem",eA=C.forwardRef((t,e)=>{const{__scopeRovingFocusGroup:n,focusable:r=!0,active:s=!1,tabStopId:i,...o}=t,a=Zi(),l=i||a,c=Roe(J_,n),u=c.currentTabStopId===l,h=X_(n),{onFocusableItemAdd:p,onFocusableItemRemove:f}=c;return C.useEffect(()=>{if(r)return p(),()=>f()},[r,p,f]),d.jsx(bS.ItemSlot,{scope:n,id:l,focusable:r,active:s,children:d.jsx(Ye.span,{tabIndex:u?0:-1,"data-orientation":c.orientation,...o,ref:e,onMouseDown:ve(t.onMouseDown,v=>{r?c.onItemFocus(l):v.preventDefault()}),onFocus:ve(t.onFocus,()=>c.onItemFocus(l)),onKeyDown:ve(t.onKeyDown,v=>{if(v.key==="Tab"&&v.shiftKey){c.onItemShiftTab();return}if(v.target!==v.currentTarget)return;const m=zoe(v,c.orientation,c.dir);if(m!==void 0){if(v.metaKey||v.ctrlKey||v.altKey||v.shiftKey)return;v.preventDefault();let y=h().filter(S=>S.focusable).map(S=>S.ref.current);if(m==="last")y.reverse();else if(m==="prev"||m==="next"){m==="prev"&&y.reverse();const S=y.indexOf(v.currentTarget);y=c.loop?Foe(y,S+1):y.slice(S+1)}setTimeout(()=>tA(y))}})})})});eA.displayName=J_;var Loe={ArrowLeft:"prev",ArrowUp:"prev",ArrowRight:"next",ArrowDown:"next",PageUp:"first",Home:"first",PageDown:"last",End:"last"};function Noe(t,e){return e!=="rtl"?t:t==="ArrowLeft"?"ArrowRight":t==="ArrowRight"?"ArrowLeft":t}function zoe(t,e,n){const r=Noe(t.key,n);if(!(e==="vertical"&&["ArrowLeft","ArrowRight"].includes(r))&&!(e==="horizontal"&&["ArrowUp","ArrowDown"].includes(r)))return Loe[r]}function tA(t,e=!1){const n=document.activeElement;for(const r of t)if(r===n||(r.focus({preventScroll:e}),document.activeElement!==n))return}function Foe(t,e){return t.map((n,r)=>t[(e+r)%t.length])}var $oe=Q_,Boe=eA,CS=["Enter"," "],Uoe=["ArrowDown","PageUp","Home"],nA=["ArrowUp","PageDown","End"],Hoe=[...Uoe,...nA],Woe={ltr:[...CS,"ArrowRight"],rtl:[...CS,"ArrowLeft"]},Koe={ltr:["ArrowLeft"],rtl:["ArrowRight"]},Nh="Menu",[ih,Goe,Voe]=Im(Nh),[kl,Fm]=Ei(Nh,[Voe,Lm,Z_]),zh=Lm(),rA=Z_(),[sA,Ia]=kl(Nh),[qoe,Fh]=kl(Nh),iA=t=>{const{__scopeMenu:e,open:n=!1,children:r,dir:s,onOpenChange:i,modal:o=!0}=t,a=zh(e),[l,c]=C.useState(null),u=C.useRef(!1),h=Mn(i),p=zw(s);return C.useEffect(()=>{const f=()=>{u.current=!0,document.addEventListener("pointerdown",v,{capture:!0,once:!0}),document.addEventListener("pointermove",v,{capture:!0,once:!0})},v=()=>u.current=!1;return document.addEventListener("keydown",f,{capture:!0}),()=>{document.removeEventListener("keydown",f,{capture:!0}),document.removeEventListener("pointerdown",v,{capture:!0}),document.removeEventListener("pointermove",v,{capture:!0})}},[]),d.jsx(Ew,{...a,children:d.jsx(sA,{scope:e,open:n,onOpenChange:h,content:l,onContentChange:c,children:d.jsx(qoe,{scope:e,onClose:C.useCallback(()=>h(!1),[h]),isUsingKeyboardRef:u,dir:p,modal:o,children:r})})})};iA.displayName=Nh;var Yoe="MenuAnchor",Fw=C.forwardRef((t,e)=>{const{__scopeMenu:n,...r}=t,s=zh(n);return d.jsx(Tw,{...s,...r,ref:e})});Fw.displayName=Yoe;var $w="MenuPortal",[Xoe,oA]=kl($w,{forceMount:void 0}),aA=t=>{const{__scopeMenu:e,forceMount:n,children:r,container:s}=t,i=Ia($w,e);return d.jsx(Xoe,{scope:e,forceMount:n,children:d.jsx(Ks,{present:n||i.open,children:d.jsx(Rh,{asChild:!0,container:s,children:r})})})};aA.displayName=$w;var gs="MenuContent",[Zoe,Bw]=kl(gs),lA=C.forwardRef((t,e)=>{const n=oA(gs,t.__scopeMenu),{forceMount:r=n.forceMount,...s}=t,i=Ia(gs,t.__scopeMenu),o=Fh(gs,t.__scopeMenu);return d.jsx(ih.Provider,{scope:t.__scopeMenu,children:d.jsx(Ks,{present:r||i.open,children:d.jsx(ih.Slot,{scope:t.__scopeMenu,children:o.modal?d.jsx(Qoe,{...s,ref:e}):d.jsx(Joe,{...s,ref:e})})})})}),Qoe=C.forwardRef((t,e)=>{const n=Ia(gs,t.__scopeMenu),r=C.useRef(null),s=xt(e,r);return C.useEffect(()=>{const i=r.current;if(i)return lw(i)},[]),d.jsx(Uw,{...t,ref:s,trapFocus:n.open,disableOutsidePointerEvents:n.open,disableOutsideScroll:!0,onFocusOutside:ve(t.onFocusOutside,i=>i.preventDefault(),{checkForDefaultPrevented:!1}),onDismiss:()=>n.onOpenChange(!1)})}),Joe=C.forwardRef((t,e)=>{const n=Ia(gs,t.__scopeMenu);return d.jsx(Uw,{...t,ref:e,trapFocus:!1,disableOutsidePointerEvents:!1,disableOutsideScroll:!1,onDismiss:()=>n.onOpenChange(!1)})}),Uw=C.forwardRef((t,e)=>{const{__scopeMenu:n,loop:r=!1,trapFocus:s,onOpenAutoFocus:i,onCloseAutoFocus:o,disableOutsidePointerEvents:a,onEntryFocus:l,onEscapeKeyDown:c,onPointerDownOutside:u,onFocusOutside:h,onInteractOutside:p,onDismiss:f,disableOutsideScroll:v,...m}=t,x=Ia(gs,n),y=Fh(gs,n),S=zh(n),w=rA(n),P=Goe(n),[E,M]=C.useState(null),I=C.useRef(null),_=xt(e,I,x.onContentChange),D=C.useRef(0),R=C.useRef(""),$=C.useRef(0),U=C.useRef(null),O=C.useRef("right"),N=C.useRef(0),H=v?km:C.Fragment,Z=v?{as:hl,allowPinchZoom:!0}:void 0,q=Q=>{var Ue,et;const ne=R.current+Q,le=P().filter(Ge=>!Ge.disabled),de=document.activeElement,_e=(Ue=le.find(Ge=>Ge.ref.current===de))==null?void 0:Ue.textValue,je=le.map(Ge=>Ge.textValue),ce=dae(je,ne,_e),tt=(et=le.find(Ge=>Ge.textValue===ce))==null?void 0:et.ref.current;(function Ge(lt){R.current=lt,window.clearTimeout(D.current),lt!==""&&(D.current=window.setTimeout(()=>Ge(""),1e3))})(ne),tt&&setTimeout(()=>tt.focus())};C.useEffect(()=>()=>window.clearTimeout(D.current),[]),aw();const V=C.useCallback(Q=>{var le,de;return O.current===((le=U.current)==null?void 0:le.side)&&pae(Q,(de=U.current)==null?void 0:de.area)},[]);return d.jsx(Zoe,{scope:n,searchRef:R,onItemEnter:C.useCallback(Q=>{V(Q)&&Q.preventDefault()},[V]),onItemLeave:C.useCallback(Q=>{var ne;V(Q)||((ne=I.current)==null||ne.focus(),M(null))},[V]),onTriggerLeave:C.useCallback(Q=>{V(Q)&&Q.preventDefault()},[V]),pointerGraceTimerRef:$,onPointerGraceIntentChange:C.useCallback(Q=>{U.current=Q},[]),children:d.jsx(H,{...Z,children:d.jsx(Cm,{asChild:!0,trapped:s,onMountAutoFocus:ve(i,Q=>{var ne;Q.preventDefault(),(ne=I.current)==null||ne.focus({preventScroll:!0})}),onUnmountAutoFocus:o,children:d.jsx(jh,{asChild:!0,disableOutsidePointerEvents:a,onEscapeKeyDown:c,onPointerDownOutside:u,onFocusOutside:h,onInteractOutside:p,onDismiss:f,children:d.jsx($oe,{asChild:!0,...w,dir:y.dir,orientation:"vertical",loop:r,currentTabStopId:E,onCurrentTabStopIdChange:M,onEntryFocus:ve(l,Q=>{y.isUsingKeyboardRef.current||Q.preventDefault()}),preventScrollOnEntryFocus:!0,children:d.jsx(__,{role:"menu","aria-orientation":"vertical","data-state":kA(x.open),"data-radix-menu-content":"",dir:y.dir,...S,...m,ref:_,style:{outline:"none",...m.style},onKeyDown:ve(m.onKeyDown,Q=>{const le=Q.target.closest("[data-radix-menu-content]")===Q.currentTarget,de=Q.ctrlKey||Q.altKey||Q.metaKey,_e=Q.key.length===1;le&&(Q.key==="Tab"&&Q.preventDefault(),!de&&_e&&q(Q.key));const je=I.current;if(Q.target!==je||!Hoe.includes(Q.key))return;Q.preventDefault();const tt=P().filter(Ue=>!Ue.disabled).map(Ue=>Ue.ref.current);nA.includes(Q.key)&&tt.reverse(),cae(tt)}),onBlur:ve(t.onBlur,Q=>{Q.currentTarget.contains(Q.target)||(window.clearTimeout(D.current),R.current="")}),onPointerMove:ve(t.onPointerMove,oh(Q=>{const ne=Q.target,le=N.current!==Q.clientX;if(Q.currentTarget.contains(ne)&&le){const de=Q.clientX>N.current?"right":"left";O.current=de,N.current=Q.clientX}}))})})})})})})});lA.displayName=gs;var eae="MenuGroup",Hw=C.forwardRef((t,e)=>{const{__scopeMenu:n,...r}=t;return d.jsx(Ye.div,{role:"group",...r,ref:e})});Hw.displayName=eae;var tae="MenuLabel",cA=C.forwardRef((t,e)=>{const{__scopeMenu:n,...r}=t;return d.jsx(Ye.div,{...r,ref:e})});cA.displayName=tae;var wg="MenuItem",y8="menu.itemSelect",$m=C.forwardRef((t,e)=>{const{disabled:n=!1,onSelect:r,...s}=t,i=C.useRef(null),o=Fh(wg,t.__scopeMenu),a=Bw(wg,t.__scopeMenu),l=xt(e,i),c=C.useRef(!1),u=()=>{const h=i.current;if(!n&&h){const p=new CustomEvent(y8,{bubbles:!0,cancelable:!0});h.addEventListener(y8,f=>r==null?void 0:r(f),{once:!0}),ow(h,p),p.defaultPrevented?c.current=!1:o.onClose()}};return d.jsx(uA,{...s,ref:l,disabled:n,onClick:ve(t.onClick,u),onPointerDown:h=>{var p;(p=t.onPointerDown)==null||p.call(t,h),c.current=!0},onPointerUp:ve(t.onPointerUp,h=>{var p;c.current||(p=h.currentTarget)==null||p.click()}),onKeyDown:ve(t.onKeyDown,h=>{const p=a.searchRef.current!=="";n||p&&h.key===" "||CS.includes(h.key)&&(h.currentTarget.click(),h.preventDefault())})})});$m.displayName=wg;var uA=C.forwardRef((t,e)=>{const{__scopeMenu:n,disabled:r=!1,textValue:s,...i}=t,o=Bw(wg,n),a=rA(n),l=C.useRef(null),c=xt(e,l),[u,h]=C.useState(!1),[p,f]=C.useState("");return C.useEffect(()=>{const v=l.current;v&&f((v.textContent??"").trim())},[i.children]),d.jsx(ih.ItemSlot,{scope:n,disabled:r,textValue:s??p,children:d.jsx(Boe,{asChild:!0,...a,focusable:!r,children:d.jsx(Ye.div,{role:"menuitem","data-highlighted":u?"":void 0,"aria-disabled":r||void 0,"data-disabled":r?"":void 0,...i,ref:c,onPointerMove:ve(t.onPointerMove,oh(v=>{r?o.onItemLeave(v):(o.onItemEnter(v),v.defaultPrevented||v.currentTarget.focus({preventScroll:!0}))})),onPointerLeave:ve(t.onPointerLeave,oh(v=>o.onItemLeave(v))),onFocus:ve(t.onFocus,()=>h(!0)),onBlur:ve(t.onBlur,()=>h(!1))})})})}),nae="MenuCheckboxItem",dA=C.forwardRef((t,e)=>{const{checked:n=!1,onCheckedChange:r,...s}=t;return d.jsx(mA,{scope:t.__scopeMenu,checked:n,children:d.jsx($m,{role:"menuitemcheckbox","aria-checked":bg(n)?"mixed":n,...s,ref:e,"data-state":Gw(n),onSelect:ve(s.onSelect,()=>r==null?void 0:r(bg(n)?!0:!n),{checkForDefaultPrevented:!1})})})});dA.displayName=nae;var hA="MenuRadioGroup",[rae,sae]=kl(hA,{value:void 0,onValueChange:()=>{}}),pA=C.forwardRef((t,e)=>{const{value:n,onValueChange:r,...s}=t,i=Mn(r);return d.jsx(rae,{scope:t.__scopeMenu,value:n,onValueChange:i,children:d.jsx(Hw,{...s,ref:e})})});pA.displayName=hA;var fA="MenuRadioItem",gA=C.forwardRef((t,e)=>{const{value:n,...r}=t,s=sae(fA,t.__scopeMenu),i=n===s.value;return d.jsx(mA,{scope:t.__scopeMenu,checked:i,children:d.jsx($m,{role:"menuitemradio","aria-checked":i,...r,ref:e,"data-state":Gw(i),onSelect:ve(r.onSelect,()=>{var o;return(o=s.onValueChange)==null?void 0:o.call(s,n)},{checkForDefaultPrevented:!1})})})});gA.displayName=fA;var Ww="MenuItemIndicator",[mA,iae]=kl(Ww,{checked:!1}),yA=C.forwardRef((t,e)=>{const{__scopeMenu:n,forceMount:r,...s}=t,i=iae(Ww,n);return d.jsx(Ks,{present:r||bg(i.checked)||i.checked===!0,children:d.jsx(Ye.span,{...s,ref:e,"data-state":Gw(i.checked)})})});yA.displayName=Ww;var oae="MenuSeparator",vA=C.forwardRef((t,e)=>{const{__scopeMenu:n,...r}=t;return d.jsx(Ye.div,{role:"separator","aria-orientation":"horizontal",...r,ref:e})});vA.displayName=oae;var aae="MenuArrow",SA=C.forwardRef((t,e)=>{const{__scopeMenu:n,...r}=t,s=zh(n);return d.jsx(A_,{...s,...r,ref:e})});SA.displayName=aae;var Kw="MenuSub",[lae,xA]=kl(Kw),wA=t=>{const{__scopeMenu:e,children:n,open:r=!1,onOpenChange:s}=t,i=Ia(Kw,e),o=zh(e),[a,l]=C.useState(null),[c,u]=C.useState(null),h=Mn(s);return C.useEffect(()=>(i.open===!1&&h(!1),()=>h(!1)),[i.open,h]),d.jsx(Ew,{...o,children:d.jsx(sA,{scope:e,open:r,onOpenChange:h,content:c,onContentChange:u,children:d.jsx(lae,{scope:e,contentId:Zi(),triggerId:Zi(),trigger:a,onTriggerChange:l,children:n})})})};wA.displayName=Kw;var rd="MenuSubTrigger",bA=C.forwardRef((t,e)=>{const n=Ia(rd,t.__scopeMenu),r=Fh(rd,t.__scopeMenu),s=xA(rd,t.__scopeMenu),i=Bw(rd,t.__scopeMenu),o=C.useRef(null),{pointerGraceTimerRef:a,onPointerGraceIntentChange:l}=i,c={__scopeMenu:t.__scopeMenu},u=C.useCallback(()=>{o.current&&window.clearTimeout(o.current),o.current=null},[]);return C.useEffect(()=>u,[u]),C.useEffect(()=>{const h=a.current;return()=>{window.clearTimeout(h),l(null)}},[a,l]),d.jsx(Fw,{asChild:!0,...c,children:d.jsx(uA,{id:s.triggerId,"aria-haspopup":"menu","aria-expanded":n.open,"aria-controls":s.contentId,"data-state":kA(n.open),...t,ref:bm(e,s.onTriggerChange),onClick:h=>{var p;(p=t.onClick)==null||p.call(t,h),!(t.disabled||h.defaultPrevented)&&(h.currentTarget.focus(),n.open||n.onOpenChange(!0))},onPointerMove:ve(t.onPointerMove,oh(h=>{i.onItemEnter(h),!h.defaultPrevented&&!t.disabled&&!n.open&&!o.current&&(i.onPointerGraceIntentChange(null),o.current=window.setTimeout(()=>{n.onOpenChange(!0),u()},100))})),onPointerLeave:ve(t.onPointerLeave,oh(h=>{var f,v;u();const p=(f=n.content)==null?void 0:f.getBoundingClientRect();if(p){const m=(v=n.content)==null?void 0:v.dataset.side,x=m==="right",y=x?-5:5,S=p[x?"left":"right"],w=p[x?"right":"left"];i.onPointerGraceIntentChange({area:[{x:h.clientX+y,y:h.clientY},{x:S,y:p.top},{x:w,y:p.top},{x:w,y:p.bottom},{x:S,y:p.bottom}],side:m}),window.clearTimeout(a.current),a.current=window.setTimeout(()=>i.onPointerGraceIntentChange(null),300)}else{if(i.onTriggerLeave(h),h.defaultPrevented)return;i.onPointerGraceIntentChange(null)}})),onKeyDown:ve(t.onKeyDown,h=>{var f;const p=i.searchRef.current!=="";t.disabled||p&&h.key===" "||Woe[r.dir].includes(h.key)&&(n.onOpenChange(!0),(f=n.content)==null||f.focus(),h.preventDefault())})})})});bA.displayName=rd;var CA="MenuSubContent",PA=C.forwardRef((t,e)=>{const n=oA(gs,t.__scopeMenu),{forceMount:r=n.forceMount,...s}=t,i=Ia(gs,t.__scopeMenu),o=Fh(gs,t.__scopeMenu),a=xA(CA,t.__scopeMenu),l=C.useRef(null),c=xt(e,l);return d.jsx(ih.Provider,{scope:t.__scopeMenu,children:d.jsx(Ks,{present:r||i.open,children:d.jsx(ih.Slot,{scope:t.__scopeMenu,children:d.jsx(Uw,{id:a.contentId,"aria-labelledby":a.triggerId,...s,ref:c,align:"start",side:o.dir==="rtl"?"left":"right",disableOutsidePointerEvents:!1,disableOutsideScroll:!1,trapFocus:!1,onOpenAutoFocus:u=>{var h;o.isUsingKeyboardRef.current&&((h=l.current)==null||h.focus()),u.preventDefault()},onCloseAutoFocus:u=>u.preventDefault(),onFocusOutside:ve(t.onFocusOutside,u=>{u.target!==a.trigger&&i.onOpenChange(!1)}),onEscapeKeyDown:ve(t.onEscapeKeyDown,u=>{o.onClose(),u.preventDefault()}),onKeyDown:ve(t.onKeyDown,u=>{var f;const h=u.currentTarget.contains(u.target),p=Koe[o.dir].includes(u.key);h&&p&&(i.onOpenChange(!1),(f=a.trigger)==null||f.focus(),u.preventDefault())})})})})})});PA.displayName=CA;function kA(t){return t?"open":"closed"}function bg(t){return t==="indeterminate"}function Gw(t){return bg(t)?"indeterminate":t?"checked":"unchecked"}function cae(t){const e=document.activeElement;for(const n of t)if(n===e||(n.focus(),document.activeElement!==e))return}function uae(t,e){return t.map((n,r)=>t[(e+r)%t.length])}function dae(t,e,n){const s=e.length>1&&Array.from(e).every(c=>c===e[0])?e[0]:e,i=n?t.indexOf(n):-1;let o=uae(t,Math.max(i,0));s.length===1&&(o=o.filter(c=>c!==n));const l=o.find(c=>c.toLowerCase().startsWith(s.toLowerCase()));return l!==n?l:void 0}function hae(t,e){const{x:n,y:r}=t;let s=!1;for(let i=0,o=e.length-1;i<e.length;o=i++){const a=e[i].x,l=e[i].y,c=e[o].x,u=e[o].y;l>r!=u>r&&n<(c-a)*(r-l)/(u-l)+a&&(s=!s)}return s}function pae(t,e){if(!e)return!1;const n={x:t.clientX,y:t.clientY};return hae(n,e)}function oh(t){return e=>e.pointerType==="mouse"?t(e):void 0}var IA=iA,EA=Fw,TA=aA,MA=lA,_A=Hw,AA=cA,DA=$m,jA=dA,RA=pA,OA=gA,LA=yA,NA=vA,zA=SA,FA=wA,$A=bA,BA=PA,Vw="ContextMenu",[fae,qpe]=Ei(Vw,[Fm]),Gn=Fm(),[gae,UA]=fae(Vw),HA=t=>{const{__scopeContextMenu:e,children:n,onOpenChange:r,dir:s,modal:i=!0}=t,[o,a]=C.useState(!1),l=Gn(e),c=Mn(r),u=C.useCallback(h=>{a(h),c(h)},[c]);return d.jsx(gae,{scope:e,open:o,onOpenChange:u,modal:i,children:d.jsx(IA,{...l,dir:s,open:o,onOpenChange:u,modal:i,children:n})})};HA.displayName=Vw;var WA="ContextMenuTrigger",KA=C.forwardRef((t,e)=>{const{__scopeContextMenu:n,disabled:r=!1,...s}=t,i=UA(WA,n),o=Gn(n),a=C.useRef({x:0,y:0}),l=C.useRef({getBoundingClientRect:()=>DOMRect.fromRect({width:0,height:0,...a.current})}),c=C.useRef(0),u=C.useCallback(()=>window.clearTimeout(c.current),[]),h=p=>{a.current={x:p.clientX,y:p.clientY},i.onOpenChange(!0)};return C.useEffect(()=>u,[u]),C.useEffect(()=>void(r&&u()),[r,u]),d.jsxs(d.Fragment,{children:[d.jsx(EA,{...o,virtualRef:l}),d.jsx(Ye.span,{"data-state":i.open?"open":"closed","data-disabled":r?"":void 0,...s,ref:e,style:{WebkitTouchCallout:"none",...t.style},onContextMenu:r?t.onContextMenu:ve(t.onContextMenu,p=>{u(),h(p),p.preventDefault()}),onPointerDown:r?t.onPointerDown:ve(t.onPointerDown,J0(p=>{u(),c.current=window.setTimeout(()=>h(p),700)})),onPointerMove:r?t.onPointerMove:ve(t.onPointerMove,J0(u)),onPointerCancel:r?t.onPointerCancel:ve(t.onPointerCancel,J0(u)),onPointerUp:r?t.onPointerUp:ve(t.onPointerUp,J0(u))})]})});KA.displayName=WA;var mae="ContextMenuPortal",qw=t=>{const{__scopeContextMenu:e,...n}=t,r=Gn(e);return d.jsx(TA,{...r,...n})};qw.displayName=mae;var GA="ContextMenuContent",VA=C.forwardRef((t,e)=>{const{__scopeContextMenu:n,...r}=t,s=UA(GA,n),i=Gn(n),o=C.useRef(!1);return d.jsx(MA,{...i,...r,ref:e,side:"right",sideOffset:2,align:"start",onCloseAutoFocus:a=>{var l;(l=t.onCloseAutoFocus)==null||l.call(t,a),!a.defaultPrevented&&o.current&&a.preventDefault(),o.current=!1},onInteractOutside:a=>{var l;(l=t.onInteractOutside)==null||l.call(t,a),!a.defaultPrevented&&!s.modal&&(o.current=!0)},style:{...t.style,"--radix-context-menu-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-context-menu-content-available-width":"var(--radix-popper-available-width)","--radix-context-menu-content-available-height":"var(--radix-popper-available-height)","--radix-context-menu-trigger-width":"var(--radix-popper-anchor-width)","--radix-context-menu-trigger-height":"var(--radix-popper-anchor-height)"}})});VA.displayName=GA;var yae="ContextMenuGroup",qA=C.forwardRef((t,e)=>{const{__scopeContextMenu:n,...r}=t,s=Gn(n);return d.jsx(_A,{...s,...r,ref:e})});qA.displayName=yae;var vae="ContextMenuLabel",Sae=C.forwardRef((t,e)=>{const{__scopeContextMenu:n,...r}=t,s=Gn(n);return d.jsx(AA,{...s,...r,ref:e})});Sae.displayName=vae;var xae="ContextMenuItem",YA=C.forwardRef((t,e)=>{const{__scopeContextMenu:n,...r}=t,s=Gn(n);return d.jsx(DA,{...s,...r,ref:e})});YA.displayName=xae;var wae="ContextMenuCheckboxItem",XA=C.forwardRef((t,e)=>{const{__scopeContextMenu:n,...r}=t,s=Gn(n);return d.jsx(jA,{...s,...r,ref:e})});XA.displayName=wae;var bae="ContextMenuRadioGroup",Cae=C.forwardRef((t,e)=>{const{__scopeContextMenu:n,...r}=t,s=Gn(n);return d.jsx(RA,{...s,...r,ref:e})});Cae.displayName=bae;var Pae="ContextMenuRadioItem",kae=C.forwardRef((t,e)=>{const{__scopeContextMenu:n,...r}=t,s=Gn(n);return d.jsx(OA,{...s,...r,ref:e})});kae.displayName=Pae;var Iae="ContextMenuItemIndicator",Eae=C.forwardRef((t,e)=>{const{__scopeContextMenu:n,...r}=t,s=Gn(n);return d.jsx(LA,{...s,...r,ref:e})});Eae.displayName=Iae;var Tae="ContextMenuSeparator",Mae=C.forwardRef((t,e)=>{const{__scopeContextMenu:n,...r}=t,s=Gn(n);return d.jsx(NA,{...s,...r,ref:e})});Mae.displayName=Tae;var _ae="ContextMenuArrow",Aae=C.forwardRef((t,e)=>{const{__scopeContextMenu:n,...r}=t,s=Gn(n);return d.jsx(zA,{...s,...r,ref:e})});Aae.displayName=_ae;var Dae="ContextMenuSub",ZA=t=>{const{__scopeContextMenu:e,children:n,onOpenChange:r,open:s,defaultOpen:i}=t,o=Gn(e),[a,l]=Pa({prop:s,defaultProp:i,onChange:r});return d.jsx(FA,{...o,open:a,onOpenChange:l,children:n})};ZA.displayName=Dae;var jae="ContextMenuSubTrigger",QA=C.forwardRef((t,e)=>{const{__scopeContextMenu:n,...r}=t,s=Gn(n);return d.jsx($A,{...s,...r,ref:e})});QA.displayName=jae;var Rae="ContextMenuSubContent",JA=C.forwardRef((t,e)=>{const{__scopeContextMenu:n,...r}=t,s=Gn(n);return d.jsx(BA,{...s,...r,ref:e,style:{...t.style,"--radix-context-menu-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-context-menu-content-available-width":"var(--radix-popper-available-width)","--radix-context-menu-content-available-height":"var(--radix-popper-available-height)","--radix-context-menu-trigger-width":"var(--radix-popper-anchor-width)","--radix-context-menu-trigger-height":"var(--radix-popper-anchor-height)"}})});JA.displayName=Rae;function J0(t){return e=>e.pointerType!=="mouse"?t(e):void 0}var Oae=HA,Lae=KA,Nae=qw,zae=VA,Fae=XA;const eD=typeof window>"u"?!1:window.navigator.userAgent.toLowerCase().indexOf("mac")>-1,$ae=eD?"⌘":"Ctrl",Bae=eD?"⌥":"Alt";function tD(t){return t.split(",")[0].split("").map(e=>{const n=e.replace(/\$/g,$ae).replace(/\?/g,Bae).replace(/!/g,"⇧");return n[0].toUpperCase()+n.slice(1)})}function PS(t){return"— "+tD(t).join(" ")}function Uae(t){return d.jsx("svg",{width:16,height:16,viewBox:"0 0 16 16",...t,children:d.jsxs("g",{strokeWidth:2,fill:"none",fillRule:"evenodd",children:[d.jsx("circle",{strokeOpacity:.25,cx:8,cy:8,r:7,stroke:"currentColor"}),d.jsx("path",{strokeLinecap:"round",d:"M15 8c0-4.5-4.5-7-7-7",stroke:"currentColor",children:d.jsx("animateTransform",{attributeName:"transform",type:"rotate",from:"0 8 8",to:"360 8 8",dur:"1s",repeatCount:"indefinite"})})]})})}var Yw="DropdownMenu",[Hae,Ype]=Ei(Yw,[Fm]),Vn=Fm(),[Wae,nD]=Hae(Yw),rD=t=>{const{__scopeDropdownMenu:e,children:n,dir:r,open:s,defaultOpen:i,onOpenChange:o,modal:a=!0}=t,l=Vn(e),c=C.useRef(null),[u=!1,h]=Pa({prop:s,defaultProp:i,onChange:o});return d.jsx(Wae,{scope:e,triggerId:Zi(),triggerRef:c,contentId:Zi(),open:u,onOpenChange:h,onOpenToggle:C.useCallback(()=>h(p=>!p),[h]),modal:a,children:d.jsx(IA,{...l,open:u,onOpenChange:h,dir:r,modal:a,children:n})})};rD.displayName=Yw;var sD="DropdownMenuTrigger",iD=C.forwardRef((t,e)=>{const{__scopeDropdownMenu:n,disabled:r=!1,...s}=t,i=nD(sD,n),o=Vn(n);return d.jsx(EA,{asChild:!0,...o,children:d.jsx(Ye.button,{type:"button",id:i.triggerId,"aria-haspopup":"menu","aria-expanded":i.open,"aria-controls":i.open?i.contentId:void 0,"data-state":i.open?"open":"closed","data-disabled":r?"":void 0,disabled:r,...s,ref:bm(e,i.triggerRef),onPointerDown:ve(t.onPointerDown,a=>{!r&&a.button===0&&a.ctrlKey===!1&&(i.onOpenToggle(),i.open||a.preventDefault())}),onKeyDown:ve(t.onKeyDown,a=>{r||(["Enter"," "].includes(a.key)&&i.onOpenToggle(),a.key==="ArrowDown"&&i.onOpenChange(!0),["Enter"," ","ArrowDown"].includes(a.key)&&a.preventDefault())})})})});iD.displayName=sD;var Kae="DropdownMenuPortal",oD=t=>{const{__scopeDropdownMenu:e,...n}=t,r=Vn(e);return d.jsx(TA,{...r,...n})};oD.displayName=Kae;var aD="DropdownMenuContent",lD=C.forwardRef((t,e)=>{const{__scopeDropdownMenu:n,...r}=t,s=nD(aD,n),i=Vn(n),o=C.useRef(!1);return d.jsx(MA,{id:s.contentId,"aria-labelledby":s.triggerId,...i,...r,ref:e,onCloseAutoFocus:ve(t.onCloseAutoFocus,a=>{var l;o.current||(l=s.triggerRef.current)==null||l.focus(),o.current=!1,a.preventDefault()}),onInteractOutside:ve(t.onInteractOutside,a=>{const l=a.detail.originalEvent,c=l.button===0&&l.ctrlKey===!0,u=l.button===2||c;(!s.modal||u)&&(o.current=!0)}),style:{...t.style,"--radix-dropdown-menu-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-dropdown-menu-content-available-width":"var(--radix-popper-available-width)","--radix-dropdown-menu-content-available-height":"var(--radix-popper-available-height)","--radix-dropdown-menu-trigger-width":"var(--radix-popper-anchor-width)","--radix-dropdown-menu-trigger-height":"var(--radix-popper-anchor-height)"}})});lD.displayName=aD;var Gae="DropdownMenuGroup",cD=C.forwardRef((t,e)=>{const{__scopeDropdownMenu:n,...r}=t,s=Vn(n);return d.jsx(_A,{...s,...r,ref:e})});cD.displayName=Gae;var Vae="DropdownMenuLabel",qae=C.forwardRef((t,e)=>{const{__scopeDropdownMenu:n,...r}=t,s=Vn(n);return d.jsx(AA,{...s,...r,ref:e})});qae.displayName=Vae;var Yae="DropdownMenuItem",uD=C.forwardRef((t,e)=>{const{__scopeDropdownMenu:n,...r}=t,s=Vn(n);return d.jsx(DA,{...s,...r,ref:e})});uD.displayName=Yae;var Xae="DropdownMenuCheckboxItem",dD=C.forwardRef((t,e)=>{const{__scopeDropdownMenu:n,...r}=t,s=Vn(n);return d.jsx(jA,{...s,...r,ref:e})});dD.displayName=Xae;var Zae="DropdownMenuRadioGroup",Qae=C.forwardRef((t,e)=>{const{__scopeDropdownMenu:n,...r}=t,s=Vn(n);return d.jsx(RA,{...s,...r,ref:e})});Qae.displayName=Zae;var Jae="DropdownMenuRadioItem",ele=C.forwardRef((t,e)=>{const{__scopeDropdownMenu:n,...r}=t,s=Vn(n);return d.jsx(OA,{...s,...r,ref:e})});ele.displayName=Jae;var tle="DropdownMenuItemIndicator",nle=C.forwardRef((t,e)=>{const{__scopeDropdownMenu:n,...r}=t,s=Vn(n);return d.jsx(LA,{...s,...r,ref:e})});nle.displayName=tle;var rle="DropdownMenuSeparator",sle=C.forwardRef((t,e)=>{const{__scopeDropdownMenu:n,...r}=t,s=Vn(n);return d.jsx(NA,{...s,...r,ref:e})});sle.displayName=rle;var ile="DropdownMenuArrow",ole=C.forwardRef((t,e)=>{const{__scopeDropdownMenu:n,...r}=t,s=Vn(n);return d.jsx(zA,{...s,...r,ref:e})});ole.displayName=ile;var ale=t=>{const{__scopeDropdownMenu:e,children:n,open:r,onOpenChange:s,defaultOpen:i}=t,o=Vn(e),[a=!1,l]=Pa({prop:r,defaultProp:i,onChange:s});return d.jsx(FA,{...o,open:a,onOpenChange:l,children:n})},lle="DropdownMenuSubTrigger",hD=C.forwardRef((t,e)=>{const{__scopeDropdownMenu:n,...r}=t,s=Vn(n);return d.jsx($A,{...s,...r,ref:e})});hD.displayName=lle;var cle="DropdownMenuSubContent",pD=C.forwardRef((t,e)=>{const{__scopeDropdownMenu:n,...r}=t,s=Vn(n);return d.jsx(BA,{...s,...r,ref:e,style:{...t.style,"--radix-dropdown-menu-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-dropdown-menu-content-available-width":"var(--radix-popper-available-width)","--radix-dropdown-menu-content-available-height":"var(--radix-popper-available-height)","--radix-dropdown-menu-trigger-width":"var(--radix-popper-anchor-width)","--radix-dropdown-menu-trigger-height":"var(--radix-popper-anchor-height)"}})});pD.displayName=cle;var Xw=rD,Zw=iD,Bm=oD,Qw=lD,ule=cD,dle=uD,hle=dD,ple=ale,fle=hD,gle=pD;function gl({id:t,children:e,modal:n=!1,debugOpen:r=!1}){const[s,i]=vo(t);return d.jsx(Xw,{open:r||s,dir:"ltr",modal:n,onOpenChange:i,children:e})}function ml({children:t,...e}){return d.jsx(Zw,{dir:"ltr",asChild:!0,onTouchEnd:n=>Ve(n),...e,children:t})}function yl({side:t="bottom",align:e="start",sideOffset:n=8,alignOffset:r=8,children:s}){const i=mn();return d.jsx(Bm,{container:i,children:d.jsx(Qw,{className:"tlui-menu",side:t,sideOffset:n,align:e,alignOffset:r,collisionPadding:4,children:s})})}function mle({id:t,children:e}){const[n,r]=vo(t);return d.jsx(ple,{open:n,onOpenChange:r,children:e})}function yle({id:t,label:e,title:n,disabled:r}){return d.jsx(fle,{dir:"ltr",asChild:!0,disabled:r,children:d.jsxs(Ce,{"data-testid":t,type:"menu",className:"tlui-menu__submenu__trigger",disabled:r,title:n,children:[d.jsx(qt,{children:e}),d.jsx(Fe,{icon:"chevron-right",small:!0})]})})}function vle({id:t,alignOffset:e=-1,sideOffset:n=-4,size:r="small",children:s}){const i=mn();return d.jsx(Bm,{container:i,children:d.jsx(gle,{"data-testid":t,className:"tlui-menu tlui-menu__submenu__content",alignOffset:e,sideOffset:n,collisionPadding:4,"data-size":r,children:s})})}function Sle({children:t}){return d.jsx(ule,{dir:"ltr",className:"tlui-menu__group",children:t})}function ah({noClose:t,children:e}){return d.jsx(dle,{dir:"ltr",asChild:!0,onClick:t?Ve:void 0,children:e})}function bd({children:t,visibleOnMobileLayout:e=!1}){const n=or();return!e&&n<Wt.MOBILE?null:d.jsx("kbd",{className:"tlui-kbd",children:tD(t).map((r,s)=>d.jsx("span",{children:r},s))})}function X({disabled:t=!1,spinner:e=!1,readonlyOk:n=!1,id:r,kbd:s,label:i,icon:o,onSelect:a,noClose:l,isSelected:c}){const{type:u,sourceId:h}=Nm(),p=Be(),[f,v]=C.useState(!1);if(mo()&&!n)return null;const x=nh(i,u),y=s?PS(s):void 0,S=x?p(x):void 0,w=S&&y?`${S} ${y}`:S;switch(u){case"menu":return d.jsx(ah,{children:d.jsxs(Ce,{type:"menu","data-testid":`${h}.${r}`,disabled:t,title:w,onClick:P=>{l&&Ve(P),f?v(!1):a(h)},children:[d.jsx(qt,{children:S}),s&&d.jsx(bd,{children:s})]})});case"context-menu":return t?null:d.jsxs(YA,{dir:"ltr",title:w,draggable:!1,className:"tlui-button tlui-button__menu","data-testid":`${h}.${r}`,onSelect:P=>{l&&Ve(P),f?v(!1):a(h)},children:[d.jsx("span",{className:"tlui-button__label",draggable:!1,children:S}),s&&d.jsx(bd,{children:s}),e&&d.jsx(Uae,{})]});case"panel":return d.jsxs(Ce,{"data-testid":`${h}.${r}`,type:"menu",title:w,disabled:t,onClick:()=>a(h),children:[d.jsx(qt,{children:S}),o&&d.jsx(Fe,{icon:o})]});case"small-icons":case"icons":return d.jsx(Ce,{"data-testid":`${h}.${r}`,type:"icon",title:w,disabled:t,onClick:()=>a(h),children:d.jsx(Fe,{icon:o,small:u==="small-icons"})});case"keyboard-shortcuts":return s?d.jsxs("div",{className:"tlui-shortcuts-dialog__key-pair","data-testid":`${h}.${r}`,children:[d.jsx("div",{className:"tlui-shortcuts-dialog__key-pair__key",children:S}),d.jsx("div",{className:"tlui-shortcuts-dialog__key-pair__value",children:d.jsx(bd,{visibleOnMobileLayout:!0,children:s})})]}):(console.warn(`Menu item '${i}' isn't shown in the keyboard shortcuts dialog because it doesn't have a keyboard shortcut.`),null);case"helper-buttons":return d.jsxs(Ce,{type:"low",onClick:()=>a(h),children:[d.jsx(Fe,{icon:o}),d.jsx(qt,{children:S})]});case"toolbar":return d.jsx(Ce,{type:"tool","data-testid":`tools.${r}`,"aria-label":x,"data-value":r,onClick:()=>a("toolbar"),title:w,onTouchStart:P=>{Ve(P),a("toolbar")},role:"radio","aria-checked":c?"true":"false",children:d.jsx(Fe,{icon:o})});case"toolbar-overflow":return d.jsx(ah,{"aria-label":i,children:d.jsx(Ce,{type:"icon",className:"tlui-button-grid__button",onClick:()=>{a("toolbar")},"data-testid":`tools.more.${r}`,title:w,role:"radio","aria-checked":c?"true":"false","data-value":r,children:d.jsx(Fe,{icon:o})})});default:throw Cn(u)}}function xle(){return d.jsxs(d.Fragment,{children:[d.jsx(wle,{}),d.jsx(ble,{}),d.jsx(Cle,{}),d.jsx(Ple,{}),d.jsx(kle,{}),d.jsx(Tle,{}),d.jsx(Mle,{}),d.jsx(_le,{})]})}function wle(){const t=we(),e=ar(2),n=So(),r=e&&n;return d.jsxs(d.Fragment,{children:[d.jsx(X,{...t["align-left"],disabled:!r}),d.jsx(X,{...t["align-center-horizontal"],disabled:!r}),d.jsx(X,{...t["align-right"],disabled:!r}),d.jsx(X,{...t["stretch-horizontal"],disabled:!r}),d.jsx(X,{...t["align-top"],disabled:!r}),d.jsx(X,{...t["align-center-vertical"],disabled:!r}),d.jsx(X,{...t["align-bottom"],disabled:!r}),d.jsx(X,{...t["stretch-vertical"],disabled:!r})]})}function ble(){const t=we(),e=ar(3),n=So(),r=e&&n;return d.jsxs(d.Fragment,{children:[d.jsx(X,{...t["distribute-horizontal"],disabled:!r}),d.jsx(X,{...t["distribute-vertical"],disabled:!r})]})}function Cle(){const t=we(),e=H_(),n=So(),r=e&&n;return d.jsxs(d.Fragment,{children:[d.jsx(X,{...t["stack-horizontal"],disabled:!r}),d.jsx(X,{...t["stack-vertical"],disabled:!r})]})}function Ple(){const t=we(),e=ar(1),n=So(),r=e&&n;return d.jsxs(d.Fragment,{children:[d.jsx(X,{...t["send-to-back"],disabled:!r}),d.jsx(X,{...t["send-backward"],disabled:!r}),d.jsx(X,{...t["bring-forward"],disabled:!r}),d.jsx(X,{...t["bring-to-front"],disabled:!r})]})}function kle(){return or()<Wt.TABLET_SM?d.jsx(Ile,{}):d.jsx(Ele,{})}function Ile(){const t=we(),e=G(),n=J("zoom is 1",()=>e.getZoomLevel()===1,[e]);return d.jsx(X,{...t["zoom-to-100"],disabled:n})}function Ele(){const t=we(),e=ar(1),n=So(),r=e&&n;return d.jsx(X,{...t["rotate-ccw"],disabled:!r})}function Tle(){const t=we(),e=ar(1),n=So(),r=e&&n;return d.jsx(X,{...t["rotate-cw"],disabled:!r})}function Mle(){const t=we(),e=V_(),n=So(),r=e&&n;return d.jsx(X,{...t["edit-link"],disabled:!r})}function _le(){const t=W_(),e=K_();return t?d.jsx(v8,{}):e?d.jsx(Ale,{}):d.jsx(v8,{})}function v8(){const t=we(),e=ar(2),n=So(),r=e&&n;return d.jsx(X,{...t.group,disabled:!r})}function Ale(){const t=we();return d.jsx(X,{...t.ungroup})}const Dle=C.memo(function({children:e}){const n=Be(),r=or(),s=mo(),i=G(),o=J("should display quick actions when in readonly",()=>i.isInAny("hand","zoom"),[i]),a=e??d.jsx(xle,{});if(!(s&&!o))return d.jsxs(Ow,{id:"actions-menu",children:[d.jsx(Lw,{children:d.jsx(Ce,{type:"icon","data-testid":"actions-menu.button",title:n("actions-menu.title"),children:d.jsx(Fe,{icon:"dots-vertical",small:!0})})}),d.jsx(Nw,{side:r>=Wt.TABLET?"bottom":"top",sideOffset:6,children:d.jsx("div",{className:"tlui-actions-menu tlui-buttons__grid","data-testid":"actions-menu.content",children:d.jsx(Ss,{type:"icons",sourceId:"actions-menu",children:a})})})]})});function Tr({id:t,kbd:e,label:n,readonlyOk:r,onSelect:s,toggle:i=!1,disabled:o=!1,checked:a=!1}){const{type:l,sourceId:c}=Nm(),u=mo(),h=Be();if(u&&!r)return null;const p=nh(n,l),f=p?h(p):void 0;switch(l){case"menu":return d.jsxs(hle,{dir:"ltr",className:"tlui-button tlui-button__menu tlui-button__checkbox",title:f,onSelect:v=>{s==null||s(c),Ve(v)},disabled:o,checked:a,children:[d.jsx(bi,{small:!0,icon:i?a?"toggle-on":"toggle-off":a?"check":"none"}),f&&d.jsx("span",{className:"tlui-button__label",draggable:!1,children:f}),e&&d.jsx(bd,{children:e})]});case"context-menu":return d.jsxs(Fae,{className:"tlui-button tlui-button__menu tlui-button__checkbox",dir:"ltr",title:f,onSelect:v=>{s(c),Ve(v)},disabled:o,checked:a,children:[d.jsx(bi,{small:!0,icon:i?a?"toggle-on":"toggle-off":a?"check":"none"}),f&&d.jsx("span",{className:"tlui-button__label",draggable:!1,children:f}),e&&d.jsx(bd,{children:e})]},t);default:return null}}function Ae({id:t,label:e,children:n}){const{type:r,sourceId:s}=Nm(),i=Be(),o=nh(e,r),a=o?i(o):void 0;switch(r){case"panel":return d.jsx("div",{className:"tlui-menu__group","data-testid":`${s}-group.${t}`,children:n});case"menu":return d.jsx(Sle,{"data-testid":`${s}-group.${t}`,children:n});case"context-menu":return d.jsx(qA,{dir:"ltr",className:"tlui-menu__group","data-testid":`${s}-group.${t}`,children:n});case"keyboard-shortcuts":return d.jsxs("div",{className:"tlui-shortcuts-dialog__group","data-testid":`${s}-group.${t}`,children:[d.jsx("h2",{className:"tlui-shortcuts-dialog__group__title",children:a}),d.jsx("div",{className:"tlui-shortcuts-dialog__group__content",children:n})]});default:return n}}function lr({id:t,disabled:e=!1,label:n,size:r="small",children:s}){const{type:i,sourceId:o}=Nm(),a=mn(),l=Be(),c=n?typeof n=="string"?n:n[i]??n.default:void 0,u=c?l(c):void 0;switch(i){case"menu":return d.jsxs(mle,{id:`${o}-sub.${t}`,children:[d.jsx(yle,{id:`${o}-sub.${u?u.toLowerCase()+"-button":""}`,disabled:e,label:u,title:u}),d.jsx(vle,{id:`${o}-sub.${u?u.toLowerCase()+"-content":""}`,size:r,children:s})]});case"context-menu":return e?null:d.jsxs(jle,{id:`${o}-sub.${t}`,children:[d.jsx(QA,{dir:"ltr",disabled:e,asChild:!0,children:d.jsxs(Ce,{"data-testid":`${o}-sub-trigger.${t}`,type:"menu",className:"tlui-menu__submenu__trigger",children:[d.jsx(qt,{children:u}),d.jsx(Fe,{icon:"chevron-right",small:!0})]})}),d.jsx(qw,{container:a,children:d.jsx(JA,{"data-testid":`${o}-sub-content.${t}`,className:"tlui-menu tlui-menu__submenu__content",alignOffset:-1,sideOffset:-4,collisionPadding:4,"data-size":r,children:s})})]});default:return s}}function jle({id:t,children:e}){const[n,r]=vo(t);return d.jsx(ZA,{open:n,onOpenChange:r,children:e})}function fD(){const t=we();return Eoe()?d.jsx(X,{...t["toggle-auto-size"]}):null}function gD(){const t=we();return V_()?d.jsx(X,{...t["edit-link"]}):null}function Rle(){const t=we();return ar(1)?d.jsx(X,{...t.duplicate}):null}function mD(){const t=we(),e=G();return J("should display flatten option",()=>{if(e.getSelectedShapeIds().length===0)return!1;const s=e.getOnlySelectedShape();return!(s&&e.isShapeOfType(s,"image"))},[e])?d.jsx(X,{...t["flatten-to-image"]}):null}function yD(){const t=we();return W_()?d.jsx(X,{...t.group}):null}function vD(){const t=we();return K_()?d.jsx(X,{...t.ungroup}):null}function SD(){const t=G(),e=we();return J("allow unframe",()=>{const r=t.getSelectedShapes();return r.length===0?!1:r.every(s=>t.isShapeOfType(s,"frame"))},[t])?d.jsx(X,{...e["remove-frame"]}):null}function xD(){const t=G(),e=we();return J("allow fit frame to content",()=>{const r=t.getOnlySelectedShape();return r?t.isShapeOfType(r,"frame")&&t.getSortedChildIdsForParent(r).length>0:!1},[t])?d.jsx(X,{...e["fit-frame-to-content"]}):null}function wD(){const t=G(),e=we();return J("selected shapes",()=>t.getSelectedShapes().length>0,[t])?d.jsx(X,{...e["toggle-lock"]}):null}function Jw(){const t=we(),e=G(),n=J("isTransparentBg",()=>!e.getInstanceState().exportBackground,[e]);return d.jsx(Tr,{...t["toggle-transparent"],checked:n,toggle:!0})}function Ole(){const t=G(),e=we(),n=J("any shapes",()=>t.getCurrentPageShapeIds().size>0,[t]);return d.jsx(X,{...e["unlock-all"],disabled:!n})}function bD(){const t=G(),e=J("zoomed to 100",()=>t.getZoomLevel()===1,[t]),n=we();return d.jsx(X,{...n["zoom-to-100"],noClose:!0,disabled:e})}function CD(){const t=G(),e=J("has shapes",()=>t.getCurrentPageShapeIds().size>0,[t]),n=we();return d.jsx(X,{...n["zoom-to-fit"],disabled:!e,"data-testid":"minimap.zoom-menu.zoom-to-fit",noClose:!0})}function PD(){const t=G(),e=J("has shapes",()=>t.getSelectedShapeIds().length>0,[t]),n=we();return d.jsx(X,{...n["zoom-to-selection"],disabled:!e,"data-testid":"minimap.zoom-menu.zoom-to-selection",noClose:!0})}function kD(){return d.jsxs(Ae,{id:"clipboard",children:[d.jsx(Nle,{}),d.jsx(zle,{}),d.jsx(Fle,{}),d.jsx(Rle,{}),d.jsx($le,{})]})}function Lle(){var r;const t=G(),e=we(),n=J("atLeastOneShapeOnPage",()=>t.getCurrentPageShapeIds().size>0,[t]);return d.jsxs(lr,{id:"copy-as",label:"context-menu.copy-as",size:"small",disabled:!n,children:[d.jsxs(Ae,{id:"copy-as-group",children:[d.jsx(X,{...e["copy-as-svg"]}),!!((r=window.navigator.clipboard)!=null&&r.write)&&d.jsx(X,{...e["copy-as-png"]}),d.jsx(X,{...e["copy-as-json"]})]}),d.jsx(Ae,{id:"copy-as-bg",children:d.jsx(Jw,{})})]})}function Nle(){const t=we(),e=ar(1);return d.jsx(X,{...t.cut,disabled:!e})}function zle(){const t=we(),e=G_(1);return d.jsx(X,{...t.copy,disabled:!e})}function Fle(){const t=we(),e=Ioe;return d.jsx(X,{...t.paste,disabled:!e})}function ID(){const t=G(),e=we();return J("atLeastOneShapeOnPage",()=>t.getCurrentPageShapeIds().size>0,[t])?d.jsxs(Ae,{id:"conversions",children:[d.jsx(Lle,{}),d.jsxs(lr,{id:"export-as",label:"context-menu.export-as",size:"small",children:[d.jsxs(Ae,{id:"export-as-group",children:[d.jsx(X,{...e["export-as-svg"]}),d.jsx(X,{...e["export-as-png"]}),d.jsx(X,{...e["export-as-json"]})]}),d.jsx(Ae,{id:"export-as-bg",children:d.jsx(Jw,{})})]})]}):null}function ED(){const t=we(),e=G(),n=J("atLeastOneShapeOnPage",()=>e.getCurrentPageShapeIds().size>0,[e]);return d.jsx(X,{...t["select-all"],disabled:!n})}function $le(){const t=we(),e=ar(1);return d.jsx(X,{...t.delete,disabled:!e})}function Ble(){return G_(1)?d.jsxs(lr,{id:"edit",label:"context-menu.edit",size:"small",children:[d.jsx(yD,{}),d.jsx(vD,{}),d.jsx(mD,{}),d.jsx(gD,{}),d.jsx(xD,{}),d.jsx(SD,{}),d.jsx(MD,{}),d.jsx(TD,{}),d.jsx(fD,{}),d.jsx(wD,{})]}):null}function Ule(){const t=ar(2),e=Toe(),n=we();return t||e?d.jsxs(lr,{id:"arrange",label:"context-menu.arrange",size:"small",children:[t&&d.jsxs(Ae,{id:"align",children:[d.jsx(X,{...n["align-left"]}),d.jsx(X,{...n["align-center-horizontal"]}),d.jsx(X,{...n["align-right"]}),d.jsx(X,{...n["align-top"]}),d.jsx(X,{...n["align-center-vertical"]}),d.jsx(X,{...n["align-bottom"]})]}),d.jsx(Hle,{}),t&&d.jsxs(Ae,{id:"stretch",children:[d.jsx(X,{...n["stretch-horizontal"]}),d.jsx(X,{...n["stretch-vertical"]})]}),(t||e)&&d.jsxs(Ae,{id:"flip",children:[d.jsx(X,{...n["flip-horizontal"]}),d.jsx(X,{...n["flip-vertical"]})]}),d.jsx(Wle,{})]}):null}function Hle(){const t=we();return ar(3)?d.jsxs(Ae,{id:"distribute",children:[d.jsx(X,{...t["distribute-horizontal"]}),d.jsx(X,{...t["distribute-vertical"]})]}):null}function Wle(){const t=we(),e=ar(2),n=H_();return e?d.jsxs(Ae,{id:"order",children:[d.jsx(X,{...t.pack}),n&&d.jsx(X,{...t["stack-horizontal"]}),n&&d.jsx(X,{...t["stack-vertical"]})]}):null}function Kle(){const t=we();return ar(1)?d.jsx(lr,{id:"reorder",label:"context-menu.reorder",size:"small",children:d.jsxs(Ae,{id:"reorder",children:[d.jsx(X,{...t["bring-to-front"]}),d.jsx(X,{...t["bring-forward"]}),d.jsx(X,{...t["send-backward"]}),d.jsx(X,{...t["send-to-back"]})]})}):null}function Gle(){const t=G(),e=J("pages",()=>t.getPages(),[t]),n=J("current page id",()=>t.getCurrentPageId(),[t]),{addToast:r}=Vs(),s=we(),i=An();return ar(1)?d.jsxs(lr,{id:"move-to-page",label:"context-menu.move-to-page",size:"small",children:[d.jsx(Ae,{id:"pages",children:e.map(a=>d.jsx(X,{id:a.id,disabled:n===a.id,label:a.name,onSelect:()=>{t.mark("move_shapes_to_page"),t.moveShapesToPage(t.getSelectedShapeIds(),a.id);const l=t.getPage(a.id);l&&r({title:"Changed Page",description:`Moved to ${l.name}.`,actions:[{label:"Go Back",type:"primary",onClick:()=>{t.mark("change-page"),t.setCurrentPage(n)}}]}),i("move-to-page",{source:"context-menu"})}},a.id))}),d.jsx(Ae,{id:"new-page",children:d.jsx(X,{...s["move-to-new-page"]})})]}):null}function TD(){const t=G(),e=we();return J("oneEmbedSelected",()=>{const r=t.getOnlySelectedShape();return r?!!(t.isShapeOfType(r,"embed")&&r.props.url&&!t.isShapeOrAncestorLocked(r)):!1},[t])?d.jsx(X,{...e["convert-to-bookmark"]}):null}function MD(){const t=G(),e=we();return J("oneEmbeddableBookmarkSelected",()=>{const r=t.getOnlySelectedShape();return r?!!(t.isShapeOfType(r,"bookmark")&&r.props.url&&Uo(r.props.url)&&!t.isShapeOrAncestorLocked(r)):!1},[t])?d.jsx(X,{...e["convert-to-embed"]}):null}function Vle(){const t=we(),e=G(),n=J("isSnapMode",()=>e.user.getIsSnapMode(),[e]);return d.jsx(Tr,{...t["toggle-snap-mode"],checked:n})}function qle(){const t=we(),e=G(),n=J("isToolLock",()=>e.getInstanceState().isToolLocked,[e]);return d.jsx(Tr,{...t["toggle-tool-lock"],checked:n})}function Yle(){const t=we(),e=G(),n=J("isGridMode",()=>e.getInstanceState().isGridMode,[e]);return d.jsx(Tr,{...t["toggle-grid"],checked:n})}function Xle(){const t=we(),e=G(),n=J("isWrapMode",()=>e.user.getIsWrapMode(),[e]);return d.jsx(Tr,{...t["toggle-wrap-mode"],checked:n})}function Zle(){const t=we(),e=G(),n=J("isFocusMode",()=>e.getInstanceState().isFocusMode,[e]);return d.jsx(Tr,{...t["toggle-focus-mode"],checked:n})}function Qle(){const t=we(),e=G(),n=J("edgeScrollSpeed",()=>e.user.getEdgeScrollSpeed(),[e]);return d.jsx(Tr,{...t["toggle-edge-scrolling"],checked:n===1})}function Jle(){const t=we(),e=G(),n=J("animationSpeed",()=>e.user.getAnimationSpeed(),[e]);return d.jsx(Tr,{...t["toggle-reduce-motion"],checked:n===0})}function ece(){const t=we(),e=G(),n=J("isDebugMode",()=>e.getInstanceState().isDebugMode,[e]);return d.jsx(Tr,{...t["toggle-debug-mode"],checked:n})}function tce(){const t=we(),e=G(),n=J("dynamic resize",()=>e.user.getIsDynamicResizeMode(),[e]);return d.jsx(Tr,{...t["toggle-dynamic-size-mode"],checked:n})}function nce(){const t=we(),e=G(),n=J("paste at cursor",()=>e.user.getIsPasteAtCursorMode(),[e]);return d.jsx(Tr,{...t["toggle-paste-at-cursor"],checked:n})}function rce(){const t=G(),e=we();return J("show cursor chat",()=>t.getCurrentToolId()==="select"&&!t.getInstanceState().isCoarsePointer,[t])?d.jsx(X,{...e["open-cursor-chat"]}):null}function sce(){const t=G(),e=jm();return J("isSelectToolActive",()=>t.getCurrentToolId()==="select",[t])?d.jsxs(d.Fragment,{children:[e&&d.jsx(rce,{}),d.jsxs(Ae,{id:"modify",children:[d.jsx(Ble,{}),d.jsx(Ule,{}),d.jsx(Kle,{}),d.jsx(Gle,{})]}),d.jsx(kD,{}),d.jsx(ID,{}),d.jsx(Ae,{id:"select-all",children:d.jsx(ED,{})})]}):null}const ice=C.memo(function({children:e}){const n=G(),{Canvas:r}=_t(),s=C.useCallback(c=>{if(c){if(n.getInstanceState().isCoarsePointer){const u=n.getSelectedShapes(),{inputs:{currentPagePoint:h}}=n,p=n.getShapesAtPoint(h);if(!n.getSelectedShapes().length||!p.some(f=>u.includes(f))){const f=p.filter(v=>n.isShapeOrAncestorLocked(v));f.length&&n.select(...f.map(v=>v.id))}}}else{const u=n.getOnlySelectedShape();u&&n.isShapeOrAncestorLocked(u)&&n.setSelectedShapes([])}},[n]),i=mn(),[o,a]=vo("context menu",s),l=e??d.jsx(sce,{});return d.jsxs(Oae,{dir:"ltr",onOpenChange:a,modal:!1,children:[d.jsx(Lae,{onContextMenu:void 0,dir:"ltr",children:r?d.jsx(r,{}):null}),o&&d.jsx(Nae,{container:i,children:d.jsx(zae,{className:"tlui-menu scrollable","data-testid":"context-menu",alignOffset:-4,collisionPadding:4,onContextMenu:Ve,children:d.jsx(Ss,{type:"context-menu",sourceId:"context-menu",children:l})})})]})}),oce=2e3,ace=5e3,lce=gn(function(){const e=G(),{isChatting:n,chatMessage:r}=e.getInstanceState(),s=C.useRef(-1),[i,o]=C.useState("");return C.useEffect(()=>{if(!n&&r||n){const l=n?ace:oce;s.current=e.timers.setTimeout(()=>{e.updateInstanceState({chatMessage:"",isChatting:!1}),o(""),e.focus()},l)}return()=>{clearTimeout(s.current)}},[e,r,n]),n?d.jsx(uce,{value:i,setValue:o,chatMessage:r}):r.trim()?d.jsx(cce,{chatMessage:r}):null});function _D(t){const e=G();C.useLayoutEffect(()=>{var o;if(!t.current)return;const{x:r,y:s}=e.inputs.currentScreenPoint;(o=t.current)==null||o.style.setProperty("transform",`translate(${r}px, ${s}px)`);function i(a){var u;const{minX:l,minY:c}=e.getViewportScreenBounds();(u=t.current)==null||u.style.setProperty("transform",`translate(${a.clientX-l}px, ${a.clientY-c}px)`)}return window.addEventListener("pointermove",i),()=>{window.removeEventListener("pointermove",i)}},[t,e])}const cce=({chatMessage:t})=>{const e=G(),n=C.useRef(null);return _D(n),d.jsx("div",{ref:n,className:"tl-cursor-chat tl-cursor-chat__bubble",style:{backgroundColor:e.user.getColor()},children:t})},uce=gn(function({chatMessage:e,value:n,setValue:r}){const s=G(),i=Be(),o=C.useRef(null),a=e||i("cursor-chat.type-to-chat");_D(o),C.useLayoutEffect(()=>{const p=o.current;if(!p)return;const f=s.textMeasure.measureText(n||a,{fontFamily:"var(--font-body)",fontSize:12,fontWeight:"500",fontStyle:"normal",maxWidth:null,lineHeight:1,padding:"6px"});p.style.setProperty("width",f.w+"px")},[s,n,a]),C.useLayoutEffect(()=>{const p=s.timers.requestAnimationFrame(()=>{var f;(f=o.current)==null||f.focus()});return()=>{cancelAnimationFrame(p)}},[s]);const l=C.useCallback(()=>{s.updateInstanceState({isChatting:!1}),s.focus()},[s]),c=C.useCallback(p=>{const{value:f}=p.target;r(f.slice(0,64)),s.updateInstanceState({chatMessage:f})},[s,r]),u=C.useCallback(p=>{const f=o.current;if(!f)return;const{value:v}=f;switch(p.key){case"Enter":{if(Ve(p),p.stopPropagation(),!v){l();return}r("");break}case"Escape":{Ve(p),p.stopPropagation(),l();break}}},[l,r]),h=C.useCallback(p=>{p.stopPropagation()},[]);return d.jsx("input",{ref:o,className:"tl-cursor-chat",style:{backgroundColor:s.user.getColor()},onBlur:l,onChange:c,onKeyDown:u,onPaste:h,value:n,placeholder:a,spellCheck:!1})});function kS({checked:t}){return d.jsx(bi,{icon:t?"check":"none",className:"tlui-button__icon",small:!0})}function dce(){const t=G(),{addToast:e}=Vs(),{addDialog:n}=Pl(),[r,s]=Ne.useState(!1);return d.jsxs(d.Fragment,{children:[d.jsxs(Ae,{id:"items",children:[d.jsx(X,{id:"add-toast",onSelect:()=>{e({id:dt(),title:"Something good happened",description:"Hey, attend to this thing over here. It might be important!",keepOpen:!0,severity:"success"}),e({id:dt(),title:"Something happened",description:"Hey, attend to this thing over here. It might be important!",keepOpen:!0,severity:"info",actions:[{label:"Primary",type:"primary",onClick:()=>{}},{label:"Normal",type:"normal",onClick:()=>{}},{label:"Danger",type:"danger",onClick:()=>{}}]}),e({id:dt(),title:"Something maybe bad happened",description:"Hey, attend to this thing over here. It might be important!",keepOpen:!0,severity:"warning",actions:[{label:"Primary",type:"primary",onClick:()=>{}},{label:"Normal",type:"normal",onClick:()=>{}},{label:"Danger",type:"danger",onClick:()=>{}}]}),e({id:dt(),title:"Something bad happened",severity:"error",keepOpen:!0})},label:"Show toast"}),d.jsx(X,{id:"show-dialog",label:"Show dialog",onSelect:()=>{n({component:({onClose:i})=>d.jsx(fce,{displayDontShowAgain:!0,onCancel:()=>i(),onContinue:()=>i()}),onClose:()=>{}})}}),d.jsx(X,{id:"create-shapes",label:"Create 100 shapes",onSelect:()=>gce(t,100)}),d.jsx(X,{id:"count-nodes",label:"Count shapes / nodes",onSelect:()=>{var a;const i=t.getSelectedShapes(),o=i.length===0?t.getRenderingShapes():i;window.alert(`Shapes ${o.length}, DOM nodes:${(a=document.querySelector(".tl-shapes").querySelectorAll("*"))==null?void 0:a.length}`)}}),(()=>{if(r)throw Error("oh no!");return null})(),d.jsx(X,{id:"throw-error",onSelect:()=>s(!0),label:"Throw error"}),d.jsx(X,{id:"hard-reset",onSelect:vE,label:"Hard reset"})]}),d.jsxs(Ae,{id:"flags",children:[d.jsx(hce,{}),d.jsx(pce,{})]})]})}function hce(){const t=Object.values(Vt);return t.length?d.jsx(lr,{id:"debug flags",label:"Debug Flags",children:d.jsx(Ae,{id:"debug flags",children:t.map(e=>d.jsx(AD,{flag:e},e.name))})}):null}function pce(){const t=Object.values(y4);return t.length?d.jsx(lr,{id:"feature flags",label:"Feature Flags",children:d.jsx(Ae,{id:"feature flags",children:t.map(e=>d.jsx(AD,{flag:e},e.name))})}):null}function fce({title:t="title",body:e="hello hello hello",cancel:n="Cancel",confirm:r="Continue",displayDontShowAgain:s=!1,onCancel:i,onContinue:o}){const[a,l]=Ne.useState(!1);return d.jsxs(d.Fragment,{children:[d.jsxs(Mm,{children:[d.jsx(_m,{children:t}),d.jsx(Am,{})]}),d.jsx(th,{style:{maxWidth:350},children:e}),d.jsxs(yw,{className:"tlui-dialog__footer__actions",children:[s&&d.jsxs(Ce,{type:"normal",onClick:()=>l(!a),style:{marginRight:"auto"},children:[d.jsx(kS,{checked:a}),d.jsx(qt,{children:"Don’t show again"})]}),d.jsx(Ce,{type:"normal",onClick:i,children:d.jsx(qt,{children:n})}),d.jsx(Ce,{type:"primary",onClick:async()=>o(),children:d.jsx(qt,{children:r})})]})]})}const AD=gn(function({flag:e,onChange:n}){const r=e.get();return d.jsx(Tr,{id:e.name,title:e.name,label:e.name.replace(/([a-z0-9])([A-Z])/g,s=>`${s[0]} ${s[1].toLowerCase()}`).replace(/^[a-z]/,s=>s.toUpperCase()),checked:r,onSelect:()=>{e.set(!r),n==null||n(!r)}})});let S8=0;function gce(t,e){const n=Array(e),r=Math.floor(Math.sqrt(e));for(let s=0;s<e;s++)S8++,n[s]={id:ot("box"+S8),type:"geo",x:s%r*132,y:Math.floor(s/r)*132};t.run(()=>{t.createShapes(n).setSelectedShapes(n.map(s=>s.id))})}function mce({children:t}){const e=t??d.jsx(dce,{});return d.jsxs(gl,{id:"debug",children:[d.jsx(ml,{children:d.jsx(Ce,{type:"icon",title:"Debug menu",children:d.jsx(Fe,{icon:"dots-horizontal"})})}),d.jsx(yl,{side:"top",align:"end",alignOffset:0,children:d.jsx(Ss,{type:"menu",sourceId:"debug-panel",children:e})})]})}const yce=C.memo(function(){const{DebugMenu:e}=Ta();return d.jsxs("div",{className:"tlui-debug-panel",children:[d.jsx(Sce,{}),d.jsx(xce,{}),e&&d.jsx(e,{})]})});function vce(t=!0){const[e,n]=C.useState(0),r=G();C.useEffect(()=>{if(!t)return;const s=()=>n(i=>i+1);return r.on("tick",s),()=>{r.off("tick",s)}},[r,t])}const Sce=gn(function(){vce();const e=G(),n=e.getPath(),r=e.getHoveredShape(),s=e.getOnlySelectedShape(),i=n==="select.idle"||!n.includes("select.")?r:s,o=i&&n.includes("select.")?` / ${i.type||""}${"geo"in i.props?" / "+i.props.geo:""} / [${b.ToInt(e.getPointInShapeSpace(i,e.inputs.currentPagePoint))}]`:"",a=n.startsWith("select.")&&!n.includes(".idle")?` / [${b.ToInt(e.inputs.originPagePoint)}] → [${b.ToInt(e.inputs.currentPagePoint)}] = ${b.Dist(e.inputs.originPagePoint,e.inputs.currentPagePoint).toFixed(0)}`:"";return d.jsx("div",{className:"tlui-debug-panel__current-state",children:`${n}${o}${a}`})});function xce(){const t=G(),e=J("show_fps",()=>Vt.showFps.get(),[Vt]),n=C.useRef(null);return C.useEffect(()=>{if(!e)return;const r=250;let s=0,i=-1,o=performance.now(),a=0,l=0,c=!1;function u(){if(l++,a=performance.now()-o,a>r){const h=Math.round(l*(r/a)*(1e3/r));h>s&&(s=h);const p=s*.75;(h<p&&!c||h>=p&&c)&&(c=!c),n.current.innerHTML=`FPS ${h.toString()}`,n.current.className="tlui-debug-panel__fps"+(c?" tlui-debug-panel__fps__slow":""),a-=r,l=0,o=performance.now()}i=t.timers.requestAnimationFrame(u)}return u(),()=>{cancelAnimationFrame(i)}},[e,t]),e?d.jsx("div",{ref:n}):null}const wce=C.memo(function(){const e=or(),{MainMenu:n,QuickActions:r,ActionsMenu:s,PageMenu:i}=Ta();return!n&&!i&&e<6?null:d.jsx("div",{className:"tlui-menu-zone",children:d.jsxs("div",{className:"tlui-buttons__horizontal",children:[n&&d.jsx(n,{}),i&&d.jsx(i,{}),e<6?null:d.jsxs(d.Fragment,{children:[r&&d.jsx(r,{}),s&&d.jsx(s,{})]})]})})});function bce(){const t=G(),e=we(),[n,r]=C.useState(!1),s=C.useRef(!1);return Jo("toggle showback to content",()=>{const i=s.current,o=t.getCurrentPageShapeIds();let a=!1;o.size&&(a=o.size===t.getCulledShapes().size),i!==a&&(r(a),s.current=a)},[t]),n?d.jsx(X,{...e["back-to-content"],onSelect:()=>{e["back-to-content"].onSelect("helper-buttons"),r(!1)}}):null}function Cce(){const t=G(),e=we();return J("is pen mode",()=>t.getInstanceState().isPenMode,[t])?d.jsx(X,{...e["exit-pen-mode"]}):null}function Pce(){const t=G(),e=we();return J("is following user",()=>!!t.getInstanceState().followingUserId,[t])?d.jsx(X,{...e["stop-following"]}):null}function kce(){return d.jsxs(d.Fragment,{children:[d.jsx(Cce,{}),d.jsx(bce,{}),d.jsx(Pce,{})]})}function Ice({children:t}){const e=t??d.jsx(kce,{});return d.jsx("div",{className:"tlui-helper-buttons",children:d.jsx(Ss,{type:"helper-buttons",sourceId:"helper-buttons",children:e})})}function DD(){const t=we(),e=Fc(),n=jm();return d.jsxs(d.Fragment,{children:[d.jsxs(Ae,{label:"shortcuts-dialog.tools",id:"tools",children:[d.jsx(X,{...t["toggle-tool-lock"]}),d.jsx(X,{...t["insert-media"]}),d.jsx(X,{...e.select}),d.jsx(X,{...e.draw}),d.jsx(X,{...e.eraser}),d.jsx(X,{...e.hand}),d.jsx(X,{...e.rectangle}),d.jsx(X,{...e.ellipse}),d.jsx(X,{...e.arrow}),d.jsx(X,{...e.line}),d.jsx(X,{...e.text}),d.jsx(X,{...e.frame}),d.jsx(X,{...e.note}),d.jsx(X,{...e.laser})]}),d.jsxs(Ae,{label:"shortcuts-dialog.preferences",id:"preferences",children:[d.jsx(X,{...t["toggle-dark-mode"]}),d.jsx(X,{...t["toggle-focus-mode"]}),d.jsx(X,{...t["toggle-grid"]})]}),d.jsxs(Ae,{label:"shortcuts-dialog.edit",id:"edit",children:[d.jsx(X,{...t.undo}),d.jsx(X,{...t.redo}),d.jsx(X,{...t.cut}),d.jsx(X,{...t.copy}),d.jsx(X,{...t.paste}),d.jsx(X,{...t["select-all"]}),d.jsx(X,{...t.delete}),d.jsx(X,{...t.duplicate})]}),d.jsxs(Ae,{label:"shortcuts-dialog.view",id:"view",children:[d.jsx(X,{...t["zoom-in"]}),d.jsx(X,{...t["zoom-out"]}),d.jsx(X,{...t["zoom-to-100"]}),d.jsx(X,{...t["zoom-to-fit"]}),d.jsx(X,{...t["zoom-to-selection"]})]}),d.jsxs(Ae,{label:"shortcuts-dialog.transform",id:"transform",children:[d.jsx(X,{...t["bring-to-front"]}),d.jsx(X,{...t["bring-forward"]}),d.jsx(X,{...t["send-backward"]}),d.jsx(X,{...t["send-to-back"]}),d.jsx(X,{...t.group}),d.jsx(X,{...t.ungroup}),d.jsx(X,{...t["flip-horizontal"]}),d.jsx(X,{...t["flip-vertical"]}),d.jsx(X,{...t["align-top"]}),d.jsx(X,{...t["align-center-vertical"]}),d.jsx(X,{...t["align-bottom"]}),d.jsx(X,{...t["align-left"]}),d.jsx(X,{...t["align-center-horizontal"]}),d.jsx(X,{...t["align-right"]})]}),n&&d.jsx(Ae,{label:"shortcuts-dialog.collaboration",id:"collaboration",children:d.jsx(X,{...t["open-cursor-chat"]})})]})}const jD=C.memo(function({children:e}){const n=Be(),r=or(),s=e??d.jsx(DD,{});return d.jsxs(d.Fragment,{children:[d.jsxs(Mm,{className:"tlui-shortcuts-dialog__header",children:[d.jsx(_m,{children:n("shortcuts-dialog.title")}),d.jsx(Am,{})]}),d.jsx(th,{className:be("tlui-shortcuts-dialog__body",{"tlui-shortcuts-dialog__body__mobile":r<=Wt.MOBILE_XS,"tlui-shortcuts-dialog__body__tablet":r<=Wt.TABLET}),children:d.jsx(Ss,{type:"keyboard-shortcuts",sourceId:"kbd",children:s})}),d.jsx("div",{className:"tlui-dialog__scrim"})]})}),Ece=[{colorScheme:"light",label:"theme.light"},{colorScheme:"dark",label:"theme.dark"},{colorScheme:"system",label:"theme.system"}];function Tce(){const t=G(),e=An(),n=J("colorScheme",()=>t.user.getUserPreferences().colorScheme??t.user.getIsDarkMode()?"dark":"light",[t]);return d.jsx(lr,{id:"help menu color-scheme",label:"menu.theme",children:d.jsx(Ae,{id:"languages",children:Ece.map(({colorScheme:r,label:s})=>d.jsx(Tr,{id:`color-scheme-${r}`,label:s,checked:r===n,onSelect:()=>{t.user.updateUserPreferences({colorScheme:r}),e("color-scheme",{source:"menu",value:r})}},r))})})}function RD(){const t=G(),e=An(),n=J("locale",()=>t.user.getLocale(),[t]);return d.jsx(lr,{id:"help menu language",label:"menu.language",children:d.jsx(Ae,{id:"languages",children:Zd.map(({locale:r,label:s})=>d.jsx(Tr,{id:`language-${r}`,title:r,label:s,checked:r===n,onSelect:()=>{t.user.updateUserPreferences({locale:r}),e("change-language",{source:"menu",locale:r})}},r))})})}function Mce(){return d.jsxs(d.Fragment,{children:[d.jsx(RD,{}),d.jsx(OD,{})]})}function OD(){const{KeyboardShortcutsDialog:t}=Ta(),{addDialog:e}=Pl();return t?d.jsx(X,{id:"keyboard-shortcuts-button",label:"help-menu.keyboard-shortcuts",readonlyOk:!0,onSelect:()=>{e({component:t})}}):null}function LD(){return d.jsxs(d.Fragment,{children:[d.jsx(Ace,{}),d.jsx(Oce,{}),d.jsx(_ce,{}),d.jsx(Lce,{}),d.jsx(zce,{}),d.jsx(Nce,{})]})}function _ce(){const t=we();return d.jsxs(lr,{id:"export-all-as",label:"context-menu.export-all-as",size:"small",children:[d.jsxs(Ae,{id:"export-all-as-group",children:[d.jsx(X,{...t["export-all-as-svg"]}),d.jsx(X,{...t["export-all-as-png"]}),d.jsx(X,{...t["export-all-as-json"]})]}),d.jsx(Ae,{id:"export-all-as-bg",children:d.jsx(Jw,{})})]})}function Ace(){const t=G(),e=J("isSelectToolActive",()=>t.getCurrentToolId()==="select",[t]);return d.jsxs(lr,{id:"edit",label:"menu.edit",disabled:!e,children:[d.jsx(Rce,{}),d.jsx(kD,{}),d.jsx(ID,{}),d.jsx(Dce,{}),d.jsx(jce,{}),d.jsx(Ae,{id:"select-all",children:d.jsx(ED,{})})]})}function Dce(){return d.jsxs(Ae,{id:"misc",children:[d.jsx(yD,{}),d.jsx(vD,{}),d.jsx(gD,{}),d.jsx(fD,{}),d.jsx(SD,{}),d.jsx(xD,{}),d.jsx(MD,{}),d.jsx(TD,{}),d.jsx(mD,{})]})}function jce(){return d.jsxs(Ae,{id:"lock",children:[d.jsx(wD,{}),d.jsx(Ole,{})]})}function Rce(){const t=we(),e=Y_(),n=q_();return d.jsxs(Ae,{id:"undo-redo",children:[d.jsx(X,{...t.undo,disabled:!e}),d.jsx(X,{...t.redo,disabled:!n})]})}function Oce(){const t=we();return d.jsx(lr,{id:"view",label:"menu.view",children:d.jsxs(Ae,{id:"view-actions",children:[d.jsx(X,{...t["zoom-in"]}),d.jsx(X,{...t["zoom-out"]}),d.jsx(bD,{}),d.jsx(CD,{}),d.jsx(PD,{})]})})}function Lce(){const t=we();return d.jsxs(Ae,{id:"extras",children:[d.jsx(X,{...t["insert-embed"]}),d.jsx(X,{...t["insert-media"]})]})}function Nce(){function t(e){window.open(e,"_blank")}return d.jsx(Ae,{id:"help",children:d.jsx(lr,{id:"help",label:"menu.help",children:d.jsxs(Ae,{id:"help-actions",children:[d.jsx(OD,{}),d.jsx(X,{id:"about",label:"help-menu.docs",icon:"external-link",readonlyOk:!0,onSelect:()=>{t("https://tldraw.dev")}})]})})})}function zce(){return d.jsx(Ae,{id:"preferences",children:d.jsxs(lr,{id:"preferences",label:"menu.preferences",children:[d.jsxs(Ae,{id:"preferences-actions",children:[d.jsx(Vle,{}),d.jsx(qle,{}),d.jsx(Yle,{}),d.jsx(Xle,{}),d.jsx(Zle,{}),d.jsx(Qle,{}),d.jsx(Jle,{}),d.jsx(tce,{}),d.jsx(nce,{}),d.jsx(ece,{})]}),d.jsx(Ae,{id:"color-scheme",children:d.jsx(Tce,{})}),d.jsx(Ae,{id:"language",children:d.jsx(RD,{})})]})})}const ND=C.memo(function({children:e}){const n=mn(),[r,s]=vo("main menu"),i=Be(),o=e??d.jsx(LD,{});return d.jsxs(Xw,{dir:"ltr",open:r,onOpenChange:s,modal:!1,children:[d.jsx(Zw,{asChild:!0,dir:"ltr",children:d.jsx(Ce,{type:"icon","data-testid":"main-menu.button",title:i("menu.title"),children:d.jsx(Fe,{icon:"menu",small:!0})})}),d.jsx(Bm,{container:n,children:d.jsx(Qw,{className:"tlui-menu",side:"bottom",align:"start",collisionPadding:4,alignOffset:0,sideOffset:6,children:d.jsx(Ss,{type:"menu",sourceId:"main-menu",children:o})})})]})}),By={};function ju(t){if(By[t])return By[t];const n=document.createElement("canvas").getContext("2d");n.fillStyle=t,n.fillRect(0,0,1,1);const[r,s,i,o]=n.getImageData(0,0,1,1).data,a=new Float32Array([r/255,s/255,i/255,o/255]);return By[t]=a,a}const lf=10,zD=4*6*lf+12+4*12;function Ul(t,{center:e,radius:n,numArcSegments:r=20,startAngle:s=0,endAngle:i=it,offset:o=0}){const a=(i-s)/r;let l=o;for(let c=s;c<i;c+=a)t[l++]=e.x,t[l++]=e.y,t[l++]=e.x+Math.cos(c)*n,t[l++]=e.y+Math.sin(c)*n,t[l++]=e.x+Math.cos(c+a)*n,t[l++]=e.y+Math.sin(c+a)*n;return t}function Hl(t,e,n,r,s,i){t[e++]=n,t[e++]=r,t[e++]=n,t[e++]=r+i,t[e++]=n+s,t[e++]=r,t[e++]=n+s,t[e++]=r,t[e++]=n,t[e++]=r+i,t[e++]=n+s,t[e++]=r+i}function Fce(t,e,n){const r=lf;n=Math.min(n,Math.min(e.w,e.h)/2);const s=fe.ExpandBy(e,-n);if(s.w<=0||s.h<=0)return Ul(t,{center:e.center,radius:n,numArcSegments:lf*4}),lf*4*6;let i=0;return Hl(t,i,s.minX,s.minY,s.w,s.h),i+=12,Hl(t,i,s.minX,e.minY,s.w,n),i+=12,Hl(t,i,s.maxX,s.minY,n,s.h),i+=12,Hl(t,i,s.minX,s.maxY,s.w,n),i+=12,Hl(t,i,e.minX,s.minY,n,s.h),i+=12,Ul(t,{numArcSegments:r,offset:i,center:s.point,radius:n,startAngle:Qe,endAngle:Qe*1.5}),i+=r*6,Ul(t,{numArcSegments:r,offset:i,center:b.Add(s.point,new b(s.w,0)),radius:n,startAngle:Qe*1.5,endAngle:it}),i+=r*6,Ul(t,{numArcSegments:r,offset:i,center:b.Add(s.point,s.size),radius:n,startAngle:0,endAngle:vt}),i+=r*6,Ul(t,{numArcSegments:r,offset:i,center:b.Add(s.point,new b(0,s.h)),radius:n,startAngle:vt,endAngle:Qe}),zD}function $ce(t){if(!t)throw new Error("Canvas element not found");const e=t.getContext("webgl2",{premultipliedAlpha:!1});if(!e)throw new Error("Failed to get webgl2 context");const n=`#version 300 es
  precision mediump float;
  
  in vec2 shapeVertexPosition;

	uniform vec4 canvasPageBounds;

	// taken (with thanks) from
	// https://webglfundamentals.org/webgl/lessons/webgl-2d-matrices.html
  void main() {
		// convert the position from pixels to 0.0 to 1.0
		vec2 zeroToOne = (shapeVertexPosition - canvasPageBounds.xy) / canvasPageBounds.zw;
	
		// convert from 0->1 to 0->2
		vec2 zeroToTwo = zeroToOne * 2.0;
	
		// convert from 0->2 to -1->+1 (clipspace)
		vec2 clipSpace = zeroToTwo - 1.0;
	
		gl_Position = vec4(clipSpace * vec2(1, -1), 0, 1);
  }`,r=e.createShader(e.VERTEX_SHADER);if(!r)throw new Error("Failed to create vertex shader");if(e.shaderSource(r,n),e.compileShader(r),!e.getShaderParameter(r,e.COMPILE_STATUS))throw new Error("Failed to compile vertex shader");const s=`#version 300 es
  precision mediump float;
  
	uniform vec4 fillColor;
  out vec4 outputColor;

  void main() {
	outputColor = fillColor;
  }`,i=e.createShader(e.FRAGMENT_SHADER);if(!i)throw new Error("Failed to create fragment shader");if(e.shaderSource(i,s),e.compileShader(i),!e.getShaderParameter(i,e.COMPILE_STATUS))throw new Error("Failed to compile fragment shader");const o=e.createProgram();if(!o)throw new Error("Failed to create program");if(e.attachShader(o,r),e.attachShader(o,i),e.linkProgram(o),!e.getProgramParameter(o,e.LINK_STATUS))throw new Error("Failed to link program");e.useProgram(o);const a=e.getAttribLocation(o,"shapeVertexPosition");if(a<0)throw new Error("Failed to get shapeVertexPosition attribute location");e.enableVertexAttribArray(a);const l=e.getUniformLocation(o,"canvasPageBounds"),c=e.getUniformLocation(o,"fillColor");if(!e.createBuffer())throw new Error("Failed to create buffer");if(!e.createBuffer())throw new Error("Failed to create buffer");return{context:e,selectedShapes:ep(e,1024),unselectedShapes:ep(e,4096),viewport:ep(e,zD),collaborators:ep(e,1024),prepareTriangles(p,f){e.bindBuffer(e.ARRAY_BUFFER,p.buffer),e.bufferData(e.ARRAY_BUFFER,p.vertices,e.STATIC_DRAW,0,f),e.enableVertexAttribArray(a),e.vertexAttribPointer(a,2,e.FLOAT,!1,0,0)},drawTrianglesTransparently(p){e.enable(e.BLEND),e.blendFunc(e.SRC_ALPHA,e.ONE_MINUS_SRC_ALPHA),e.drawArrays(e.TRIANGLES,0,p/2),e.disable(e.BLEND)},drawTriangles(p){e.drawArrays(e.TRIANGLES,0,p/2)},setFillColor(p){e.uniform4fv(c,p)},setCanvasPageBounds(p){e.uniform4fv(l,p)}}}function ep(t,e){const n=t.createBuffer();if(!n)throw new Error("Failed to create buffer");return{buffer:n,vertices:new Float32Array(e)}}function x8(t,e,n){let r=t.vertices.length;for(;r<e+n.length;)r*=2;if(r!=t.vertices.length){const s=new Float32Array(r);s.set(t.vertices),t.vertices=s}t.vertices.set(n,e)}var Bce=Object.defineProperty,Uce=Object.getOwnPropertyDescriptor,Ea=(t,e,n,r)=>{for(var s=Uce(e,n),i=t.length-1,o;i>=0;i--)(o=t[i])&&(s=o(e,n,s)||s);return s&&Bce(e,n,s),s};class xo{constructor(e,n,r){g(this,"disposables",[]);g(this,"close",()=>this.disposables.forEach(e=>e()));g(this,"gl");g(this,"shapeGeometryCache");g(this,"colors");g(this,"id",dt());g(this,"canvasBoundingClientRect",Qt("canvasBoundingClientRect",new fe));g(this,"originPagePoint",new b);g(this,"originPageCenter",new b);g(this,"isInViewport",!1);g(this,"getMinimapPagePoint",(e,n)=>{const r=this.getCanvasPageBounds(),s=this.getCanvasScreenBounds();let i=e-s.x,o=n-s.y;return i*=r.width/s.width,o*=r.height/s.height,i+=r.minX,o+=r.minY,new b(i,o,1)});g(this,"minimapScreenPointToPagePoint",(e,n,r=!1,s=!1)=>{const{editor:i}=this,o=i.getViewportPageBounds();let{x:a,y:l}=this.getMinimapPagePoint(e,n);if(s){const c=this.editor.getCurrentPageBounds()??new fe,u=c.minX-o.width/2,h=c.maxX+o.width/2,p=c.minY-o.height/2,f=c.maxY+o.height/2,v=Math.max(0,u+o.width-a),m=Math.max(0,-(h-o.width-a)),x=Math.max(0,p+o.height-l),y=Math.max(0,-(f-o.height-l));a+=(v-m)/2,l+=(x-y)/2,a=cn(a,u,h),l=cn(l,p,f)}if(r){const{originPagePoint:c}=this,u=Math.abs(a-c.x),h=Math.abs(l-c.y);u>h?l=c.y:a=c.x}return new b(a,l)});g(this,"render",()=>{const e=this.gl.context,n=this.getCanvasSize();this.gl.setCanvasPageBounds(this.getCanvasPageBoundsArray()),this.elem.width=n.x,this.elem.height=n.y,e.viewport(0,0,n.x,n.y),e.clearColor(this.colors.background[0],this.colors.background[1],this.colors.background[2],1),e.clear(e.COLOR_BUFFER_BIT);const r=new Set(this.editor.getSelectedShapeIds()),s=this.colors;let i=0,o=0;const a=this.editor.getCurrentPageShapeIdsSorted();for(let l=0,c=a.length;l<c;l++){const u=a[l],h=this.shapeGeometryCache.get(u);if(!h)continue;const p=h.length;r.has(u)?(x8(this.gl.selectedShapes,i,h),i+=p):(x8(this.gl.unselectedShapes,o,h),o+=p)}this.drawShapes(this.gl.unselectedShapes,o,s.shapeFill),this.drawShapes(this.gl.selectedShapes,i,s.selectFill),this.drawViewport(),this.drawCollaborators()});this.editor=e,this.elem=n,this.container=r,this.gl=$ce(n),this.shapeGeometryCache=e.store.createComputedCache("webgl-geometry",s=>{const i=e.getShapeMaskedPageBounds(s.id);if(!i)return null;const o=new Float32Array(12);return Hl(o,0,i.x,i.y,i.w,i.h),o}),this.colors=this._getColors(),this.disposables.push(this._listenForCanvasResize(),ba("minimap render",this.render))}_getColors(){const e=getComputedStyle(this.editor.getContainer());return{shapeFill:ju(e.getPropertyValue("--color-text-3").trim()),selectFill:ju(e.getPropertyValue("--color-selected").trim()),viewportFill:ju(e.getPropertyValue("--color-muted-1").trim()),background:ju(e.getPropertyValue("--color-low").trim())}}updateColors(){this.colors=this._getColors()}getDpr(){return this.editor.getInstanceState().devicePixelRatio}getContentPageBounds(){const e=this.editor.getViewportPageBounds(),n=this.editor.getCurrentPageBounds();return n?fe.Expand(n,e):e}getContentScreenBounds(){const e=this.getContentPageBounds(),n=this.editor.pageToScreen(e.point),r=this.editor.pageToScreen(new b(e.maxX,e.maxY));return new fe(n.x,n.y,r.x-n.x,r.y-n.y)}_getCanvasBoundingRect(){const{x:e,y:n,width:r,height:s}=this.elem.getBoundingClientRect();return new fe(e,n,r,s)}getCanvasScreenBounds(){return this.canvasBoundingClientRect.get()}_listenForCanvasResize(){const e=new ResizeObserver(()=>{const n=this._getCanvasBoundingRect();this.canvasBoundingClientRect.set(n)});return e.observe(this.elem),e.observe(this.container),()=>e.disconnect()}getCanvasSize(){const e=this.canvasBoundingClientRect.get(),n=this.getDpr();return new b(e.width*n,e.height*n)}getCanvasClientPosition(){return this.canvasBoundingClientRect.get().point}getCanvasPageBounds(){const e=this.getCanvasScreenBounds(),n=this.getContentPageBounds(),r=e.width/e.height;let s=n.width,i=s/r;i<n.height&&(i=n.height,s=i*r);const o=new fe(0,0,s,i);return o.center=n.center,o}getZoom(){return this.getCanvasPageBounds().width/this.getCanvasScreenBounds().width}getCanvasPageBoundsArray(){const{x:e,y:n,w:r,h:s}=this.getCanvasPageBounds();return new Float32Array([e,n,r,s])}drawShapes(e,n,r){this.gl.prepareTriangles(e,n),this.gl.setFillColor(r),this.gl.drawTriangles(n)}drawViewport(){const e=this.editor.getViewportPageBounds(),n=Fce(this.gl.viewport.vertices,e,4*this.getZoom());this.gl.prepareTriangles(this.gl.viewport,n),this.gl.setFillColor(this.colors.viewportFill),this.gl.drawTrianglesTransparently(n),this.editor.environment.isSafari&&(this.gl.drawTrianglesTransparently(n),this.gl.drawTrianglesTransparently(n),this.gl.drawTrianglesTransparently(n))}drawCollaborators(){const e=this.editor.getCollaboratorsOnCurrentPage();if(!e.length)return;const n=20,r=n*6,s=r*e.length;this.gl.collaborators.vertices.length<s&&(this.gl.collaborators.vertices=new Float32Array(s));const i=this.gl.collaborators.vertices;let o=0;const a=this.getZoom();for(const{cursor:l}of e)Ul(i,{center:b.From(l),radius:3*a,offset:o,numArcSegments:n}),o+=r;this.gl.prepareTriangles(this.gl.collaborators,s),o=0;for(const{color:l}of e)this.gl.setFillColor(ju(l)),this.gl.context.drawArrays(this.gl.context.TRIANGLES,o/2,r/2),o+=r}}Ea([ee],xo.prototype,"getDpr");Ea([ee],xo.prototype,"getContentPageBounds");Ea([ee],xo.prototype,"getContentScreenBounds");Ea([ee],xo.prototype,"getCanvasSize");Ea([ee],xo.prototype,"getCanvasClientPosition");Ea([ee],xo.prototype,"getCanvasPageBounds");Ea([ee],xo.prototype,"getZoom");Ea([ee],xo.prototype,"getCanvasPageBoundsArray");function Hce(){const t=G(),e=mn(),n=C.useRef(null),r=C.useRef(!1),s=C.useRef();C.useEffect(()=>{try{const u=new xo(t,n.current,e);return s.current=u,s.current.close}catch(u){t.annotateError(u,{origin:"minimap",willCrashApp:!1}),t.timers.setTimeout(()=>{throw u})}},[t,e]);const i=C.useCallback(u=>{if(!t.getCurrentPageShapeIds().size||!s.current)return;const h=s.current.minimapScreenPointToPagePoint(u.clientX,u.clientY,!1,!1),p=s.current.minimapScreenPointToPagePoint(u.clientX,u.clientY,!1,!0);s.current.originPagePoint.setTo(p),s.current.originPageCenter.setTo(t.getViewportPageBounds().center),t.centerOnPoint(h,{animation:{duration:t.options.animationMediumMs}})},[t]),o=C.useCallback(u=>{if(!s.current)return;const h=u.currentTarget;if(kh(h,u),!t.getCurrentPageShapeIds().size)return;r.current=!0,s.current.isInViewport=!1;const p=s.current.minimapScreenPointToPagePoint(u.clientX,u.clientY,!1,!1),f=t.getViewportPageBounds(),v=s.current.getContentPageBounds();if(new fe(v.x-f.width/2,v.y-f.height/2,v.width+f.width,v.height+f.height).containsPoint(p)&&!f.containsPoint(p)){s.current.isInViewport=f.containsPoint(p);const y=b.Sub(f.center,f.point),S=b.Add(p,y);s.current.originPagePoint.setTo(S),s.current.originPageCenter.setTo(p),t.centerOnPoint(p,{animation:{duration:t.options.animationMediumMs}})}else{const y=s.current.minimapScreenPointToPagePoint(u.clientX,u.clientY,!1,!0);s.current.isInViewport=f.containsPoint(y),s.current.originPagePoint.setTo(y),s.current.originPageCenter.setTo(f.center)}function x(y){h&&Ih(h,y),r.current=!1,document.body.removeEventListener("pointerup",x)}document.body.addEventListener("pointerup",x)},[t]),a=C.useCallback(u=>{if(!s.current)return;const h=s.current.minimapScreenPointToPagePoint(u.clientX,u.clientY,u.shiftKey,!0);if(r.current){if(s.current.isInViewport){const m=s.current.originPagePoint.clone().sub(s.current.originPageCenter);t.centerOnPoint(b.Sub(h,m));return}t.centerOnPoint(h)}const p=s.current.getMinimapPagePoint(u.clientX,u.clientY),f=t.pageToScreen(p),v={type:"pointer",target:"canvas",name:"pointer_move",...wr(u),point:f,isPen:t.getInstanceState().isPenMode};t.dispatch(v)},[t]),l=C.useCallback(u=>{const h=oE(u);t.dispatch({type:"wheel",name:"wheel",delta:h,point:new b(u.clientX,u.clientY),shiftKey:u.shiftKey,altKey:u.altKey,ctrlKey:u.metaKey||u.ctrlKey})},[t]),c=Dh();return C.useEffect(()=>{t.timers.setTimeout(()=>{var u,h;(u=s.current)==null||u.updateColors(),(h=s.current)==null||h.render()})},[c,t]),d.jsx("div",{className:"tlui-minimap",children:d.jsx("canvas",{role:"img","aria-label":"minimap",ref:n,className:"tlui-minimap__canvas",onDoubleClick:i,onPointerMove:a,onPointerDown:o,onWheel:l})})}function Wce(t,e){const[n,r]=Ne.useState(e);Ne.useLayoutEffect(()=>{const i=p4(t);if(i)try{r(JSON.parse(i))}catch{console.error(`Could not restore value ${t} from local storage.`)}},[t]);const s=Ne.useCallback(i=>{r(o=>{const a=typeof i=="function"?i(o):i;return f4(t,JSON.stringify(a)),a})},[t]);return[n,s]}const Kce=C.memo(function(){const e=we(),n=Be(),r=or(),[s,i]=Wce("minimap",!0),o=C.useCallback(()=>{i(c=>!c)},[i]),{ZoomMenu:a,Minimap:l}=Ta();return r<Wt.MOBILE?null:d.jsxs("div",{className:"tlui-navigation-panel",children:[d.jsx("div",{className:"tlui-buttons__horizontal",children:a&&r<Wt.TABLET?d.jsx(a,{}):s?d.jsxs(d.Fragment,{children:[a&&d.jsx(a,{}),l&&d.jsx(Ce,{type:"icon","data-testid":"minimap.toggle-button",title:n("navigation-zone.toggle-minimap"),className:"tlui-navigation-panel__toggle",onClick:o,children:d.jsx(Fe,{icon:s?"chevrons-ne":"chevrons-sw"})})]}):d.jsxs(d.Fragment,{children:[d.jsx(Ce,{type:"icon","data-testid":"minimap.zoom-out",title:`${n(nh(e["zoom-out"].label))} ${PS(e["zoom-out"].kbd)}`,onClick:()=>e["zoom-out"].onSelect("navigation-zone"),children:d.jsx(Fe,{icon:"minus"})}),a&&d.jsx(a,{}),d.jsx(Ce,{type:"icon","data-testid":"minimap.zoom-in",title:`${n(nh(e["zoom-in"].label))} ${PS(e["zoom-in"].kbd)}`,onClick:()=>e["zoom-in"].onSelect("navigation-zone"),children:d.jsx(Fe,{icon:"plus"})}),l&&d.jsx(Ce,{type:"icon","data-testid":"minimap.toggle-button",title:n("navigation-zone.toggle-minimap"),className:"tlui-navigation-panel__toggle",onClick:o,children:d.jsx(Fe,{icon:s?"chevrons-ne":"chevrons-sw"})})]})}),l&&r>=Wt.TABLET&&!s&&d.jsx(l,{})]})}),Gce=function({name:e,id:n,isCurrentPage:r}){const s=G(),i=An(),o=C.useRef(null),a=C.useCallback(()=>{s.mark("rename page")},[s]),l=C.useCallback(c=>{s.renamePage(n,c||"New Page"),i("rename-page",{source:"page-menu"})},[s,n,i]);return d.jsx(Dm,{className:"tlui-page-menu__item__input",ref:c=>o.current=c,defaultValue:e,onValueChange:l,onFocus:a,shouldManuallyMaintainScrollPositionWhenFocused:!0,autoFocus:r,autoSelect:!0})},IS=(t,e,n,r,s)=>{let i;const o=t.getPages(),a=n>r?o[r-1]:o[r],l=n>r?o[r]:o[r+1];a&&!l?i=js(a.index):!a&&l?i=EG(o[0].index):i=Gd(a.index,l.index),i!==o[n].index&&(t.mark("moving page"),t.updatePage({id:e,index:i}),s("move-page",{source:"page-menu"}))},w8=gn(function({index:e,listSize:n,item:r,onRename:s}){const i=G(),o=Be(),a=i.getPages(),l=An(),c=C.useCallback(()=>{i.mark("creating page");const f=io.createId();i.duplicatePage(r.id,f),l("duplicate-page",{source:"page-menu"})},[i,r,l]),u=C.useCallback(()=>{IS(i,r.id,e,e-1,l)},[i,r,e,l]),h=C.useCallback(()=>{IS(i,r.id,e,e+1,l)},[i,r,e,l]),p=C.useCallback(()=>{i.mark("deleting page"),i.deletePage(r.id),l("delete-page",{source:"page-menu"})},[i,r,l]);return d.jsxs(gl,{id:`page item submenu ${e}`,children:[d.jsx(ml,{children:d.jsx(Ce,{type:"icon",title:o("page-menu.submenu.title"),children:d.jsx(Fe,{icon:"dots-vertical"})})}),d.jsx(yl,{alignOffset:0,side:"right",sideOffset:-4,children:d.jsxs(Ss,{type:"menu",sourceId:"page-menu",children:[d.jsxs(Ae,{id:"modify",children:[s&&d.jsx(X,{id:"rename",label:"page-menu.submenu.rename",onSelect:s}),d.jsx(X,{id:"duplicate",label:"page-menu.submenu.duplicate-page",onSelect:c,disabled:a.length>=i.options.maxPages}),e>0&&d.jsx(X,{id:"move-up",onSelect:u,label:"page-menu.submenu.move-up"}),e<n-1&&d.jsx(X,{id:"move-down",label:"page-menu.submenu.move-down",onSelect:h})]}),n>1&&d.jsx(Ae,{id:"delete",children:d.jsx(X,{id:"delete",onSelect:p,label:"page-menu.submenu.delete"})})]})})]})}),Vce=C.memo(function(){const e=G(),n=An(),r=Be(),s=or(),i=C.useCallback(()=>y(!1),[]),[o,a]=vo("page-menu",i),l=36,c=C.useRef(null),u=J("pages",()=>e.getPages(),[e]),h=J("currentPage",()=>e.getCurrentPage(),[e]),p=J("currentPageId",()=>e.getCurrentPageId(),[e]),f=mo(),v=J("maxPageCountReached",()=>e.getPages().length>=e.options.maxPages,[e]),m=J("isCoarsePointer",()=>e.getInstanceState().isCoarsePointer,[e]),[x,y]=C.useState(!1),S=C.useCallback(()=>{f||y(O=>!O)},[f]),w=C.useRef({isPointing:!1,status:"idle",pointing:null,startY:0,startIndex:0,dragIndex:0}),[P,E]=C.useState(Object.fromEntries(u.map((O,N)=>[O.id,{y:N*l,offsetY:0,isSelected:!1}])));C.useLayoutEffect(()=>{E(Object.fromEntries(u.map((O,N)=>[O.id,{y:N*l,offsetY:0,isSelected:!1}])))},[l,u]),C.useEffect(()=>{o&&e.timers.requestAnimationFrame(()=>{const O=document.querySelector(`[data-testid="page-menu-item-${p}"]`);if(O){const N=c.current;if(!N)return;const H=O.offsetTop,Z=N.scrollTop;H<Z&&N.scrollTo({top:H});const q=H+l,V=N.scrollTop+N.offsetHeight;q>V&&N.scrollTo({top:q-N.offsetHeight})}})},[l,p,o,e]);const M=C.useCallback(O=>{const{clientY:N,currentTarget:H}=O,{dataset:{id:Z,index:q}}=H;if(!Z||!q)return;const V=w.current;kh(O.currentTarget,O),V.status="pointing",V.pointing={id:Z,index:+q};const ne=P[Z].y;V.startY=N,V.startIndex=Math.max(0,Math.min(Math.round(ne/l),u.length-1))},[l,u.length,P]),I=C.useCallback(O=>{const N=w.current;if(N.status==="pointing"){const{clientY:H}=O,Z=H-N.startY;Math.abs(Z)>5&&(N.status="dragging")}if(N.status==="dragging"){const{clientY:H}=O,Z=H-N.startY,q=P[N.pointing.id],{startIndex:V,pointing:Q}=N,ne=q.y+Z,le=Math.max(0,Math.min(Math.round(ne/l),u.length-1)),de={...P};if(de[Q.id]={y:q.y,offsetY:Z,isSelected:!0},le!==N.dragIndex){N.dragIndex=le;for(let _e=0;_e<u.length;_e++){const je=u[_e];if(je.id===N.pointing.id)continue;let{y:ce}=de[je.id];le===V?ce=_e*l:le<V?le<=_e&&_e<V?ce=(_e+1)*l:ce=_e*l:le>V&&(le>=_e&&_e>V?ce=(_e-1)*l:ce=_e*l),ce!==de[je.id].y&&(de[je.id]={y:ce,offsetY:0,isSelected:!0})}}E(de)}},[l,u,P]),_=C.useCallback(O=>{const N=w.current;if(N.status==="dragging"){const{id:H,index:Z}=N.pointing;IS(e,H,Z,N.dragIndex,n)}Ih(O.currentTarget,O),N.status="idle"},[e,n]),D=C.useCallback(O=>{const N=w.current;O.key==="Escape"&&(N.status==="dragging"&&E(Object.fromEntries(u.map((H,Z)=>[H.id,{y:Z*l,offsetY:0,isSelected:!1}]))),N.status="idle")},[l,u]),R=C.useCallback(()=>{f||(e.run(()=>{e.mark("creating page");const O=io.createId();e.createPage({name:r("page-menu.new-page-initial-name"),id:O}),e.setCurrentPage(O),y(!0)}),n("new-page",{source:"page-menu"}))},[e,r,f,n]),$=C.useCallback(O=>{e.setCurrentPage(O),n("change-page",{source:"page-menu"})},[e,n]),U=C.useCallback((O,N)=>{e.renamePage(O,N),n("rename-page",{source:"page-menu"})},[e,n]);return d.jsxs(Ow,{id:"pages",onOpenChange:a,open:o,children:[d.jsx(Lw,{"data-testid":"main.page-menu",children:d.jsxs(Ce,{type:"menu",title:h.name,"data-testid":"page-menu.button",className:"tlui-page-menu__trigger",children:[d.jsx("div",{className:"tlui-page-menu__name",children:h.name}),d.jsx(Fe,{icon:"chevron-down",small:!0})]})}),d.jsx(Nw,{side:"bottom",align:"start",sideOffset:6,children:d.jsxs("div",{className:"tlui-page-menu__wrapper",children:[d.jsxs("div",{className:"tlui-page-menu__header",children:[d.jsx("div",{className:"tlui-page-menu__header__title",children:r("page-menu.title")}),!f&&d.jsxs("div",{className:"tlui-buttons__horizontal",children:[d.jsx(Ce,{type:"icon","data-testid":"page-menu.edit",title:r(x?"page-menu.edit-done":"page-menu.edit-start"),onClick:S,children:d.jsx(Fe,{icon:x?"check":"edit"})}),d.jsx(Ce,{type:"icon","data-testid":"page-menu.create",title:r(v?"page-menu.max-page-count-reached":"page-menu.create-new-page"),disabled:v,onClick:R,children:d.jsx(Fe,{icon:"plus"})})]})]}),d.jsx("div",{"data-testid":"page-menu.list",className:"tlui-page-menu__list tlui-menu__group",style:{height:l*u.length+4},ref:c,children:u.map((O,N)=>{const H=P[O.id]??{position:N*40,offsetY:0};return x?d.jsxs("div",{"data-testid":"page-menu.item",className:"tlui-page_menu__item__sortable",style:{zIndex:O.id===h.id?888:N,transform:`translate(0px, ${H.y+H.offsetY}px)`},children:[d.jsx(Ce,{type:"icon",tabIndex:-1,className:"tlui-page_menu__item__sortable__handle",onPointerDown:M,onPointerUp:_,onPointerMove:I,onKeyDown:D,"data-id":O.id,"data-index":N,children:d.jsx(Fe,{icon:"drag-handle-dots"})}),s<Wt.TABLET_SM&&m?d.jsxs(Ce,{type:"normal",className:"tlui-page-menu__item__button",onClick:()=>{const Z=window.prompt("Rename page",O.name);Z&&Z!==O.name&&U(O.id,Z)},onDoubleClick:S,children:[d.jsx(kS,{checked:O.id===h.id}),d.jsx(qt,{children:O.name})]}):d.jsx("div",{className:"tlui-page_menu__item__sortable__title",style:{height:l},children:d.jsx(Gce,{id:O.id,name:O.name,isCurrentPage:O.id===h.id})}),!f&&d.jsx("div",{className:"tlui-page_menu__item__submenu","data-isediting":x,children:d.jsx(w8,{index:N,item:O,listSize:u.length})})]},O.id+"_editing"):d.jsxs("div",{"data-testid":"page-menu.item",className:"tlui-page-menu__item",children:[d.jsxs(Ce,{type:"normal",className:"tlui-page-menu__item__button",onClick:()=>$(O.id),onDoubleClick:S,title:r("page-menu.go-to-page"),children:[d.jsx(kS,{checked:O.id===h.id}),d.jsx(qt,{children:O.name})]}),!f&&d.jsx("div",{className:"tlui-page_menu__item__submenu",children:d.jsx(w8,{index:N,item:O,listSize:u.length,onRename:()=>{if(e.environment.isIos){const Z=window.prompt("Rename page",O.name);Z&&Z!==O.name&&U(O.id,Z)}else y(!0),p!==O.id&&$(O.id)}})})]},O.id)})})]})})]})});function qce(){const t=we(),e=G(),n=Y_(),r=q_(),s=ar(1),i=mo(),o=J("should display quick actions",()=>e.isInAny("select","hand","zoom"),[e]),a=So(),l=s&&a;if(!(i&&!o))return d.jsxs(d.Fragment,{children:[d.jsx(X,{...t.undo,disabled:!n}),d.jsx(X,{...t.redo,disabled:!r}),d.jsx(X,{...t.delete,disabled:!l}),d.jsx(X,{...t.duplicate,disabled:!l})]})}const Yce=C.memo(function({children:e}){const n=e??d.jsx(qce,{});return d.jsx(Ss,{type:"small-icons",sourceId:"quick-actions",children:n})});function Xce({userId:t}){const e=cm(t);return e?d.jsx("div",{className:"tlui-people-menu__avatar",style:{backgroundColor:e.color},children:e.userName==="New User"?"":e.userName[0]??""},t):null}const Zce=gn(function({userId:e}){const n=G(),r=Be(),s=An(),i=cm(e),o=C.useCallback(()=>{n.getInstanceState().followingUserId===e?(n.stopFollowingUser(),s("stop-following",{source:"people-menu"})):(n.startFollowingUser(e),s("start-following",{source:"people-menu"}))},[n,e,s]),a=(i==null?void 0:i.followingUserId)===n.user.getId(),l=n.getInstanceState().followingUserId===e;return i?d.jsxs("div",{className:"tlui-people-menu__item tlui-buttons__horizontal",children:[d.jsxs(Ce,{type:"menu",className:"tlui-people-menu__item__button",onClick:()=>n.zoomToUser(e),onDoubleClick:o,children:[d.jsx(bi,{icon:"color",color:i.color}),d.jsx("div",{className:"tlui-people-menu__name",children:i.userName??"New User"})]}),d.jsx(Ce,{type:"icon",className:"tlui-people-menu__item__follow",title:r(a?"people-menu.leading":l?"people-menu.following":"people-menu.follow"),onClick:o,disabled:a,"data-active":l||a,children:d.jsx(Fe,{icon:a?"leading":l?"following":"follow"})})]}):null});function Qce({count:t}){return d.jsx("div",{className:"tlui-people-menu__more",children:"+"+Math.abs(t)})}const Jce=gn(function(){const e=G(),n=mn(),r=Be(),s=An(),i=C.useRef(!1),[o,a]=C.useState(!1),l=C.useCallback(m=>{a(m)},[]),c=e.user.getColor(),u=C.useCallback(m=>{e.user.updateUserPreferences({color:m}),s("set-color",{source:"people-menu"})},[e,s]),{handleButtonClick:h,handleButtonPointerDown:p,handleButtonPointerEnter:f,handleButtonPointerUp:v}=Ne.useMemo(()=>{const m=()=>{i.current=!1,window.removeEventListener("pointerup",m)};return{handleButtonClick:P=>{const{id:E}=P.currentTarget.dataset;E&&c!==E&&u(E)},handleButtonPointerDown:P=>{const{id:E}=P.currentTarget.dataset;E&&(u(E),i.current=!0,window.addEventListener("pointerup",m))},handleButtonPointerEnter:P=>{if(!i.current)return;const{id:E}=P.currentTarget.dataset;E&&u(E)},handleButtonPointerUp:P=>{const{id:E}=P.currentTarget.dataset;E&&u(E)}}},[c,u]);return d.jsxs(Aw,{onOpenChange:l,open:o,children:[d.jsx(Dw,{dir:"ltr",asChild:!0,children:d.jsx(Ce,{type:"icon",className:"tlui-people-menu__user__color",style:{color:e.user.getColor()},title:r("people-menu.change-color"),children:d.jsx(Fe,{icon:"color"})})}),d.jsx(jw,{container:n,children:d.jsx(Rw,{dir:"ltr",className:"tlui-menu tlui-people-menu__user__color-picker",align:"start",side:"left",sideOffset:8,children:d.jsx("div",{className:"tlui-buttons__grid",children:G2.map(m=>d.jsx(Ce,{type:"icon","data-id":m,"data-testid":m,"aria-label":m,"data-state":c===m?"hinted":void 0,title:m,className:"tlui-button-grid__button",style:{color:m},onPointerEnter:f,onPointerDown:p,onPointerUp:v,onClick:h,children:d.jsx(Fe,{icon:"color"})},m))})})})]})});function eue(){const t=G(),e=An(),n=J("userName",()=>t.user.getName(),[]),r=Be(),s=C.useRef(n),i=C.useRef(n),[o,a]=C.useState(!1),l=C.useCallback(()=>{a(h=>!h)},[]),c=C.useCallback(h=>{i.current=h,t.user.updateUserPreferences({name:h})},[t]),u=C.useCallback(()=>{s.current!==i.current&&(e("change-user-name",{source:"people-menu"}),s.current=i.current)},[e]);return d.jsxs("div",{className:"tlui-people-menu__user",children:[d.jsx(Jce,{}),o?d.jsx(Dm,{className:"tlui-people-menu__user__input",defaultValue:n,onValueChange:c,onComplete:l,onCancel:l,onBlur:u,shouldManuallyMaintainScrollPositionWhenFocused:!0,autoFocus:!0,autoSelect:!0}):d.jsxs(d.Fragment,{children:[d.jsx("div",{className:"tlui-people-menu__user__name",onDoubleClick:()=>{o||a(!0)},children:n}),n==="New User"?d.jsx("div",{className:"tlui-people-menu__user__label",children:r("people-menu.user")}):null]}),d.jsx(Ce,{type:"icon",className:"tlui-people-menu__user__edit","data-testid":"people-menu.change-name",title:r("people-menu.change-name"),onClick:l,children:d.jsx(Fe,{icon:o?"check":"edit"})})]})}const tue=gn(function({children:e}){const n=Be(),r=mn(),s=G(),i=dE(),o=J("user",()=>s.user.getColor(),[s]),a=J("user",()=>s.user.getName(),[s]),[l,c]=vo("people menu");return d.jsxs(Aw,{onOpenChange:c,open:l,children:[d.jsx(Dw,{dir:"ltr",asChild:!0,children:d.jsxs("button",{className:"tlui-people-menu__avatars-button",title:n("people-menu.title"),children:[i.length>5&&d.jsx(Qce,{count:i.length-5}),d.jsxs("div",{className:"tlui-people-menu__avatars",children:[i.slice(-5).map(u=>d.jsx(Xce,{userId:u},u)),d.jsx("div",{className:"tlui-people-menu__avatar",style:{backgroundColor:o},children:a==="New User"?"":a[0]??""})]})]})}),d.jsx(jw,{container:r,children:d.jsx(Rw,{dir:"ltr",className:"tlui-menu",align:"end",side:"bottom",sideOffset:2,alignOffset:-5,children:d.jsxs("div",{className:"tlui-people-menu__wrapper",children:[d.jsx("div",{className:"tlui-people-menu__section",children:d.jsx(eue,{})}),i.length>0&&d.jsx("div",{className:"tlui-people-menu__section",children:i.map(u=>d.jsx(Zce,{userId:u},u+"_presence"))}),e]})})})]})});function nue(){return d.jsx("div",{className:"tlui-share-zone",draggable:!1,children:d.jsx(tue,{})})}const rue=Object.freeze([qr,ll,cl,Si]);function FD(t=rue){const e=G();return J("getRelevantStyles",()=>{var i;const n=new q2(e.getSharedStyles()),r=!!((i=e.root.getCurrent())!=null&&i.shapeType),s=e.isIn("select")&&e.getSelectedShapeIds().length>0;if(n.size===0&&e.isIn("select")&&e.getSelectedShapeIds().length===0)for(const o of t)n.applyValue(o,e.getStyleForNextShape(o));return r||s||n.size>0?n:null},[e])}const ds={color:[{value:"black",icon:"color"},{value:"grey",icon:"color"},{value:"light-violet",icon:"color"},{value:"violet",icon:"color"},{value:"blue",icon:"color"},{value:"light-blue",icon:"color"},{value:"yellow",icon:"color"},{value:"orange",icon:"color"},{value:"green",icon:"color"},{value:"light-green",icon:"color"},{value:"light-red",icon:"color"},{value:"red",icon:"color"}],fill:[{value:"none",icon:"fill-none"},{value:"semi",icon:"fill-semi"},{value:"solid",icon:"fill-solid"},{value:"pattern",icon:"fill-pattern"}],dash:[{value:"draw",icon:"dash-draw"},{value:"dashed",icon:"dash-dashed"},{value:"dotted",icon:"dash-dotted"},{value:"solid",icon:"dash-solid"}],size:[{value:"s",icon:"size-small"},{value:"m",icon:"size-medium"},{value:"l",icon:"size-large"},{value:"xl",icon:"size-extra-large"}],font:[{value:"draw",icon:"font-draw"},{value:"sans",icon:"font-sans"},{value:"serif",icon:"font-serif"},{value:"mono",icon:"font-mono"}],textAlign:[{value:"start",icon:"text-align-left"},{value:"middle",icon:"text-align-center"},{value:"end",icon:"text-align-right"}],horizontalAlign:[{value:"start",icon:"horizontal-align-start"},{value:"middle",icon:"horizontal-align-middle"},{value:"end",icon:"horizontal-align-end"}],verticalAlign:[{value:"start",icon:"vertical-align-start"},{value:"middle",icon:"vertical-align-middle"},{value:"end",icon:"vertical-align-end"}],geo:[{value:"rectangle",icon:"geo-rectangle"},{value:"ellipse",icon:"geo-ellipse"},{value:"triangle",icon:"geo-triangle"},{value:"diamond",icon:"geo-diamond"},{value:"star",icon:"geo-star"},{value:"pentagon",icon:"geo-pentagon"},{value:"hexagon",icon:"geo-hexagon"},{value:"octagon",icon:"geo-octagon"},{value:"rhombus",icon:"geo-rhombus"},{value:"rhombus-2",icon:"geo-rhombus-2"},{value:"oval",icon:"geo-oval"},{value:"trapezoid",icon:"geo-trapezoid"},{value:"arrow-left",icon:"geo-arrow-left"},{value:"arrow-up",icon:"geo-arrow-up"},{value:"arrow-down",icon:"geo-arrow-down"},{value:"arrow-right",icon:"geo-arrow-right"},{value:"cloud",icon:"geo-cloud"},{value:"x-box",icon:"geo-x-box"},{value:"check-box",icon:"geo-check-box"},{value:"heart",icon:"geo-heart"}],arrowheadStart:[{value:"none",icon:"arrowhead-none"},{value:"arrow",icon:"arrowhead-arrow"},{value:"triangle",icon:"arrowhead-triangle"},{value:"square",icon:"arrowhead-square"},{value:"dot",icon:"arrowhead-dot"},{value:"diamond",icon:"arrowhead-diamond"},{value:"inverted",icon:"arrowhead-triangle-inverted"},{value:"bar",icon:"arrowhead-bar"}],arrowheadEnd:[{value:"none",icon:"arrowhead-none"},{value:"arrow",icon:"arrowhead-arrow"},{value:"triangle",icon:"arrowhead-triangle"},{value:"square",icon:"arrowhead-square"},{value:"dot",icon:"arrowhead-dot"},{value:"diamond",icon:"arrowhead-diamond"},{value:"inverted",icon:"arrowhead-triangle-inverted"},{value:"bar",icon:"arrowhead-bar"}],spline:[{value:"line",icon:"spline-line"},{value:"cubic",icon:"spline-cubic"}]},Va=C.memo(function(e){const{uiType:n,items:r,title:s,style:i,value:o,onValueChange:a,theme:l}=e,c=G(),u=Be(),h=C.useRef(!1),p=C.useRef(null),{handleButtonClick:f,handleButtonPointerDown:v,handleButtonPointerEnter:m,handleButtonPointerUp:x}=C.useMemo(()=>{const y=()=>{h.current=!1,window.removeEventListener("pointerup",y);const M=p.current;M&&["TEXTAREA","INPUT"].includes(M.nodeName)&&M.focus(),p.current=null};return{handleButtonClick:M=>{const{id:I}=M.currentTarget.dataset;o.type==="shared"&&o.value===I||(c.mark("point picker item"),a(i,I))},handleButtonPointerDown:M=>{const{id:I}=M.currentTarget.dataset;c.mark("point picker item"),a(i,I),h.current=!0,p.current=document.activeElement,window.addEventListener("pointerup",y)},handleButtonPointerEnter:M=>{if(!h.current)return;const{id:I}=M.currentTarget.dataset;a(i,I)},handleButtonPointerUp:M=>{const{id:I}=M.currentTarget.dataset;o.type==="shared"&&o.value===I||a(i,I)}}},[o,c,a,i]);return d.jsx("div",{"data-testid":`style.${n}`,className:be("tlui-buttons__grid"),children:r.map(y=>d.jsx(Ce,{type:"icon","data-id":y.value,"data-testid":`style.${n}.${y.value}`,"aria-label":y.value,"data-state":o.type==="shared"&&o.value===y.value?"hinted":void 0,title:s+" — "+u(`${n}-style.${y.value}`),className:be("tlui-button-grid__button"),style:i===qr?{color:l[y.value].solid}:void 0,onPointerEnter:m,onPointerDown:v,onPointerUp:x,onClick:f,children:d.jsx(Fe,{icon:y.icon})},y.value))})});function $D(t,[e,n]){return Math.min(n,Math.max(e,t))}function sue(t){const e=C.useRef({value:t,previous:t});return C.useMemo(()=>(e.current.value!==t&&(e.current.previous=e.current.value,e.current.value=t),e.current.previous),[t])}var BD=["PageUp","PageDown"],UD=["ArrowUp","ArrowDown","ArrowLeft","ArrowRight"],HD={"from-left":["Home","PageDown","ArrowDown","ArrowLeft"],"from-right":["Home","PageDown","ArrowDown","ArrowRight"],"from-bottom":["Home","PageDown","ArrowDown","ArrowLeft"],"from-top":["Home","PageDown","ArrowUp","ArrowLeft"]},su="Slider",[ES,iue,oue]=Im(su),[WD,Xpe]=Ei(su,[oue]),[aue,Um]=WD(su),KD=C.forwardRef((t,e)=>{const{name:n,min:r=0,max:s=100,step:i=1,orientation:o="horizontal",disabled:a=!1,minStepsBetweenThumbs:l=0,defaultValue:c=[r],value:u,onValueChange:h=()=>{},onValueCommit:p=()=>{},inverted:f=!1,...v}=t,m=C.useRef(new Set),x=C.useRef(0),S=o==="horizontal"?lue:cue,[w=[],P]=Pa({prop:u,defaultProp:c,onChange:R=>{var U;(U=[...m.current][x.current])==null||U.focus(),h(R)}}),E=C.useRef(w);function M(R){const $=fue(w,R);D(R,$)}function I(R){D(R,x.current)}function _(){const R=E.current[x.current];w[x.current]!==R&&p(w)}function D(R,$,{commit:U}={commit:!1}){const O=vue(i),N=Sue(Math.round((R-r)/i)*i+r,O),H=$D(N,[r,s]);P((Z=[])=>{const q=hue(Z,H,$);if(yue(q,l*i)){x.current=q.indexOf(H);const V=String(q)!==String(Z);return V&&U&&p(q),V?q:Z}else return Z})}return d.jsx(aue,{scope:t.__scopeSlider,name:n,disabled:a,min:r,max:s,valueIndexToChangeRef:x,thumbs:m.current,values:w,orientation:o,children:d.jsx(ES.Provider,{scope:t.__scopeSlider,children:d.jsx(ES.Slot,{scope:t.__scopeSlider,children:d.jsx(S,{"aria-disabled":a,"data-disabled":a?"":void 0,...v,ref:e,onPointerDown:ve(v.onPointerDown,()=>{a||(E.current=w)}),min:r,max:s,inverted:f,onSlideStart:a?void 0:M,onSlideMove:a?void 0:I,onSlideEnd:a?void 0:_,onHomeKeyDown:()=>!a&&D(r,0,{commit:!0}),onEndKeyDown:()=>!a&&D(s,w.length-1,{commit:!0}),onStepKeyDown:({event:R,direction:$})=>{if(!a){const N=BD.includes(R.key)||R.shiftKey&&UD.includes(R.key)?10:1,H=x.current,Z=w[H],q=i*N*$;D(Z+q,H,{commit:!0})}}})})})})});KD.displayName=su;var[GD,VD]=WD(su,{startEdge:"left",endEdge:"right",size:"width",direction:1}),lue=C.forwardRef((t,e)=>{const{min:n,max:r,dir:s,inverted:i,onSlideStart:o,onSlideMove:a,onSlideEnd:l,onStepKeyDown:c,...u}=t,[h,p]=C.useState(null),f=xt(e,w=>p(w)),v=C.useRef(),m=zw(s),x=m==="ltr",y=x&&!i||!x&&i;function S(w){const P=v.current||h.getBoundingClientRect(),E=[0,P.width],I=eb(E,y?[n,r]:[r,n]);return v.current=P,I(w-P.left)}return d.jsx(GD,{scope:t.__scopeSlider,startEdge:y?"left":"right",endEdge:y?"right":"left",direction:y?1:-1,size:"width",children:d.jsx(qD,{dir:m,"data-orientation":"horizontal",...u,ref:f,style:{...u.style,"--radix-slider-thumb-transform":"translateX(-50%)"},onSlideStart:w=>{const P=S(w.clientX);o==null||o(P)},onSlideMove:w=>{const P=S(w.clientX);a==null||a(P)},onSlideEnd:()=>{v.current=void 0,l==null||l()},onStepKeyDown:w=>{const E=HD[y?"from-left":"from-right"].includes(w.key);c==null||c({event:w,direction:E?-1:1})}})})}),cue=C.forwardRef((t,e)=>{const{min:n,max:r,inverted:s,onSlideStart:i,onSlideMove:o,onSlideEnd:a,onStepKeyDown:l,...c}=t,u=C.useRef(null),h=xt(e,u),p=C.useRef(),f=!s;function v(m){const x=p.current||u.current.getBoundingClientRect(),y=[0,x.height],w=eb(y,f?[r,n]:[n,r]);return p.current=x,w(m-x.top)}return d.jsx(GD,{scope:t.__scopeSlider,startEdge:f?"bottom":"top",endEdge:f?"top":"bottom",size:"height",direction:f?1:-1,children:d.jsx(qD,{"data-orientation":"vertical",...c,ref:h,style:{...c.style,"--radix-slider-thumb-transform":"translateY(50%)"},onSlideStart:m=>{const x=v(m.clientY);i==null||i(x)},onSlideMove:m=>{const x=v(m.clientY);o==null||o(x)},onSlideEnd:()=>{p.current=void 0,a==null||a()},onStepKeyDown:m=>{const y=HD[f?"from-bottom":"from-top"].includes(m.key);l==null||l({event:m,direction:y?-1:1})}})})}),qD=C.forwardRef((t,e)=>{const{__scopeSlider:n,onSlideStart:r,onSlideMove:s,onSlideEnd:i,onHomeKeyDown:o,onEndKeyDown:a,onStepKeyDown:l,...c}=t,u=Um(su,n);return d.jsx(Ye.span,{...c,ref:e,onKeyDown:ve(t.onKeyDown,h=>{h.key==="Home"?(o(h),h.preventDefault()):h.key==="End"?(a(h),h.preventDefault()):BD.concat(UD).includes(h.key)&&(l(h),h.preventDefault())}),onPointerDown:ve(t.onPointerDown,h=>{const p=h.target;p.setPointerCapture(h.pointerId),h.preventDefault(),u.thumbs.has(p)?p.focus():r(h)}),onPointerMove:ve(t.onPointerMove,h=>{h.target.hasPointerCapture(h.pointerId)&&s(h)}),onPointerUp:ve(t.onPointerUp,h=>{const p=h.target;p.hasPointerCapture(h.pointerId)&&(p.releasePointerCapture(h.pointerId),i(h))})})}),YD="SliderTrack",XD=C.forwardRef((t,e)=>{const{__scopeSlider:n,...r}=t,s=Um(YD,n);return d.jsx(Ye.span,{"data-disabled":s.disabled?"":void 0,"data-orientation":s.orientation,...r,ref:e})});XD.displayName=YD;var TS="SliderRange",ZD=C.forwardRef((t,e)=>{const{__scopeSlider:n,...r}=t,s=Um(TS,n),i=VD(TS,n),o=C.useRef(null),a=xt(e,o),l=s.values.length,c=s.values.map(p=>JD(p,s.min,s.max)),u=l>1?Math.min(...c):0,h=100-Math.max(...c);return d.jsx(Ye.span,{"data-orientation":s.orientation,"data-disabled":s.disabled?"":void 0,...r,ref:a,style:{...t.style,[i.startEdge]:u+"%",[i.endEdge]:h+"%"}})});ZD.displayName=TS;var MS="SliderThumb",QD=C.forwardRef((t,e)=>{const n=iue(t.__scopeSlider),[r,s]=C.useState(null),i=xt(e,a=>s(a)),o=C.useMemo(()=>r?n().findIndex(a=>a.ref.current===r):-1,[n,r]);return d.jsx(uue,{...t,ref:i,index:o})}),uue=C.forwardRef((t,e)=>{const{__scopeSlider:n,index:r,name:s,...i}=t,o=Um(MS,n),a=VD(MS,n),[l,c]=C.useState(null),u=xt(e,S=>c(S)),h=l?!!l.closest("form"):!0,p=x_(l),f=o.values[r],v=f===void 0?0:JD(f,o.min,o.max),m=pue(r,o.values.length),x=p==null?void 0:p[a.size],y=x?gue(x,v,a.direction):0;return C.useEffect(()=>{if(l)return o.thumbs.add(l),()=>{o.thumbs.delete(l)}},[l,o.thumbs]),d.jsxs("span",{style:{transform:"var(--radix-slider-thumb-transform)",position:"absolute",[a.startEdge]:`calc(${v}% + ${y}px)`},children:[d.jsx(ES.ItemSlot,{scope:t.__scopeSlider,children:d.jsx(Ye.span,{role:"slider","aria-label":t["aria-label"]||m,"aria-valuemin":o.min,"aria-valuenow":f,"aria-valuemax":o.max,"aria-orientation":o.orientation,"data-orientation":o.orientation,"data-disabled":o.disabled?"":void 0,tabIndex:o.disabled?void 0:0,...i,ref:u,style:f===void 0?{display:"none"}:t.style,onFocus:ve(t.onFocus,()=>{o.valueIndexToChangeRef.current=r})})}),h&&d.jsx(due,{name:s??(o.name?o.name+(o.values.length>1?"[]":""):void 0),value:f},r)]})});QD.displayName=MS;var due=t=>{const{value:e,...n}=t,r=C.useRef(null),s=sue(e);return C.useEffect(()=>{const i=r.current,o=window.HTMLInputElement.prototype,l=Object.getOwnPropertyDescriptor(o,"value").set;if(s!==e&&l){const c=new Event("input",{bubbles:!0});l.call(i,e),i.dispatchEvent(c)}},[s,e]),d.jsx("input",{style:{display:"none"},...n,ref:r,defaultValue:e})};function hue(t=[],e,n){const r=[...t];return r[n]=e,r.sort((s,i)=>s-i)}function JD(t,e,n){const i=100/(n-e)*(t-e);return $D(i,[0,100])}function pue(t,e){return e>2?`Value ${t+1} of ${e}`:e===2?["Minimum","Maximum"][t]:void 0}function fue(t,e){if(t.length===1)return 0;const n=t.map(s=>Math.abs(s-e)),r=Math.min(...n);return n.indexOf(r)}function gue(t,e,n){const r=t/2,i=eb([0,50],[0,r]);return(r-i(e)*n)*n}function mue(t){return t.slice(0,-1).map((e,n)=>t[n+1]-e)}function yue(t,e){if(e>0){const n=mue(t);return Math.min(...n)>=e}return!0}function eb(t,e){return n=>{if(t[0]===t[1]||e[0]===e[1])return e[0];const r=(e[1]-e[0])/(t[1]-t[0]);return e[0]+r*(n-t[0])}}function vue(t){return(String(t).split(".")[1]||"").length}function Sue(t,e){const n=Math.pow(10,e);return Math.round(t*n)/n}var xue=KD,wue=XD,bue=ZD,Cue=QD;const Pue=C.memo(function(e){const{title:n,steps:r,value:s,label:i,onValueChange:o}=e,a=G(),l=Be(),c=C.useCallback(p=>{o(p[0])},[o]),u=C.useCallback(()=>{a.mark("click slider")},[a]),h=C.useCallback(()=>{s&&o(s)},[s,o]);return d.jsx("div",{className:"tlui-slider__container",children:d.jsxs(xue,{"data-testid":e["data-testid"],className:"tlui-slider","area-label":"Opacity",dir:"ltr",min:0,max:r,step:1,value:s?[s]:void 0,onPointerDown:u,onValueChange:c,onPointerUp:h,title:n+" — "+l(i),children:[d.jsx(wue,{className:"tlui-slider__track",dir:"ltr",children:s!==null&&d.jsx(bue,{className:"tlui-slider__range",dir:"ltr"})}),s!==null&&d.jsx(Cue,{className:"tlui-slider__thumb",dir:"ltr"})]})})});function kue({label:t,uiTypeA:e,uiTypeB:n,labelA:r,labelB:s,itemsA:i,itemsB:o,styleA:a,styleB:l,valueA:c,valueB:u,onValueChange:h}){const p=Be(),f=C.useMemo(()=>{var m;return((m=i.find(x=>c.type==="shared"&&c.value===x.value))==null?void 0:m.icon)??"mixed"},[i,c]),v=C.useMemo(()=>{var m;return((m=o.find(x=>u.type==="shared"&&u.value===x.value))==null?void 0:m.icon)??"mixed"},[o,u]);return c===void 0&&u===void 0?null:d.jsxs("div",{className:"tlui-style-panel__double-select-picker",children:[d.jsx("div",{title:p(t),className:"tlui-style-panel__double-select-picker-label",children:p(t)}),d.jsxs("div",{className:"tlui-buttons__horizontal",children:[d.jsxs(gl,{id:`style panel ${e} A`,children:[d.jsx(ml,{children:d.jsx(Ce,{type:"icon","data-testid":`style.${e}`,title:p(r)+" — "+(c===null||c.type==="mixed"?p("style-panel.mixed"):p(`${e}-style.${c.value}`)),children:d.jsx(Fe,{icon:f,small:!0,invertIcon:!0})})}),d.jsx(yl,{side:"left",align:"center",sideOffset:80,alignOffset:0,children:d.jsx("div",{className:"tlui-buttons__grid",children:i.map((m,x)=>d.jsx(ah,{"data-testid":`style.${e}.${m.value}`,children:d.jsx(Ce,{type:"icon",onClick:()=>h(a,m.value),title:`${p(r)} — ${p(`${e}-style.${m.value}`)}`,children:d.jsx(Fe,{icon:m.icon,invertIcon:!0})},m.value)},x))})})]}),d.jsxs(gl,{id:`style panel ${n}`,children:[d.jsx(ml,{children:d.jsx(Ce,{type:"icon","data-testid":`style.${n}`,title:p(s)+" — "+(u===null||u.type==="mixed"?p("style-panel.mixed"):p(`${n}-style.${u.value}`)),children:d.jsx(Fe,{icon:v,small:!0})})}),d.jsx(yl,{side:"left",align:"center",sideOffset:116,alignOffset:0,children:d.jsx("div",{className:"tlui-buttons__grid",children:o.map(m=>d.jsx(ah,{children:d.jsx(Ce,{type:"icon",title:`${p(s)} — ${p(`${n}-style.${m.value}`)}`,"data-testid":`style.${n}.${m.value}`,onClick:()=>h(l,m.value),children:d.jsx(Fe,{icon:m.icon})})},m.value))})})]})]})]})}const Iue=C.memo(kue);function Eue({id:t,label:e,uiType:n,style:r,items:s,type:i,value:o,onValueChange:a}){const l=Be(),c=G(),u=C.useMemo(()=>{var f;return(f=s.find(v=>o.type==="shared"&&v.value===o.value))==null?void 0:f.icon},[s,o]),h=o.type==="mixed"?l("style-panel.mixed"):l(`${n}-style.${o.value}`),p=e?l(e):"";return d.jsxs(gl,{id:`style panel ${t}`,children:[d.jsx(ml,{children:d.jsxs(Ce,{type:i,"data-testid":`style.${n}`,title:h,children:[d.jsx(qt,{children:p}),d.jsx(Fe,{icon:u??"mixed"})]})}),d.jsx(yl,{side:"left",align:"center",alignOffset:0,children:d.jsx("div",{className:"tlui-buttons__grid",children:s.map(f=>d.jsx(ah,{children:d.jsx(Ce,{type:"icon","data-testid":`style.${n}.${f.value}`,title:l(`${n}-style.${f.value}`),onClick:()=>{c.mark("select style dropdown item"),a(r,f.value)},children:d.jsx(Fe,{icon:f.icon})})},f.value))})})]})}const tb=C.memo(Eue);function Tue({styles:t}){const e=Dh();if(!t)return null;const n=t.get(Os),r=t.get(eg),s=t.get(Jf),i=t.get(rg),o=t.get(vi),a=n===void 0,l=r===void 0&&s===void 0,c=i===void 0,u=o===void 0,h=go({isDarkMode:e});return d.jsxs(d.Fragment,{children:[d.jsx(Mue,{theme:h,styles:t}),!u&&d.jsx(_ue,{theme:h,styles:t}),!(a&&l&&c)&&d.jsxs("div",{className:"tlui-style-panel__section","aria-label":"style panel styles",children:[d.jsx(Aue,{styles:t}),d.jsx(jue,{styles:t}),d.jsx(Due,{styles:t})]})]})}function $h(){const t=G(),e=An();return Ne.useMemo(()=>function(r,s){t.run(()=>{t.isIn("select")&&t.setStyleForSelectedShapes(r,s),t.setStyleForNextShapes(r,s),t.updateInstanceState({isChangingStyle:!0})}),e("set-style",{source:"style-panel",id:r.id,value:s})},[t,e])}function Mue({styles:t,theme:e}){const n=Be(),r=G(),s=$h(),i=t.get(qr),o=t.get(cl),a=t.get(ll),l=t.get(Si),c=o!==void 0||a!==void 0||l!==void 0;return d.jsxs(d.Fragment,{children:[d.jsxs("div",{tabIndex:-1,className:"tlui-style-panel__section__common","aria-label":"style panel styles","data-testid":"style.panel",children:[i===void 0?null:d.jsx(Va,{title:n("style-panel.color"),uiType:"color",style:qr,items:ds.color,value:i,onValueChange:s,theme:e}),d.jsx(Rue,{})]}),c&&d.jsxs("div",{className:"tlui-style-panel__section","aria-label":"style panel styles",children:[o===void 0?null:d.jsx(Va,{title:n("style-panel.fill"),uiType:"fill",style:cl,items:ds.fill,value:o,onValueChange:s,theme:e}),a===void 0?null:d.jsx(Va,{title:n("style-panel.dash"),uiType:"dash",style:ll,items:ds.dash,value:a,onValueChange:s,theme:e}),l===void 0?null:d.jsx(Va,{title:n("style-panel.size"),uiType:"size",style:Si,items:ds.size,value:l,onValueChange:(u,h)=>{s(u,h);const p=r.getSelectedShapeIds();p.length>0&&ft(r,p)},theme:e})]})]})}function _ue({theme:t,styles:e}){const n=Be(),r=$h(),s=e.get(vi),i=e.get(B2),o=e.get(tg),a=e.get(ng);return s===void 0&&o===void 0?null:d.jsxs("div",{className:"tlui-style-panel__section","aria-label":"style panel text",children:[s===void 0?null:d.jsx(Va,{title:n("style-panel.font"),uiType:"font",style:vi,items:ds.font,value:s,onValueChange:r,theme:t}),i===void 0?null:d.jsxs("div",{className:"tlui-style-panel__row",children:[d.jsx(Va,{title:n("style-panel.align"),uiType:"align",style:B2,items:ds.textAlign,value:i,onValueChange:r,theme:t}),d.jsx("div",{className:"tlui-style-panel__row__extra-button",children:d.jsx(Ce,{type:"icon",title:n("style-panel.vertical-align"),"data-testid":"vertical-align",disabled:!0,children:d.jsx(Fe,{icon:"vertical-align-middle"})})})]}),o===void 0?null:d.jsxs("div",{className:"tlui-style-panel__row",children:[d.jsx(Va,{title:n("style-panel.align"),uiType:"align",style:tg,items:ds.horizontalAlign,value:o,onValueChange:r,theme:t}),d.jsx("div",{className:"tlui-style-panel__row__extra-button",children:a===void 0?d.jsx(Ce,{type:"icon",title:n("style-panel.vertical-align"),"data-testid":"vertical-align",disabled:!0,children:d.jsx(Fe,{icon:"vertical-align-middle"})}):d.jsx(tb,{type:"icon",id:"geo-vertical-alignment",uiType:"verticalAlign",style:ng,items:ds.verticalAlign,value:a,onValueChange:r})})]})]})}function Aue({styles:t}){const e=$h(),n=t.get(Os);return n===void 0?null:d.jsx(tb,{id:"geo",type:"menu",label:"style-panel.geo",uiType:"geo",style:Os,items:ds.geo,value:n,onValueChange:e})}function Due({styles:t}){const e=$h(),n=t.get(rg);return n===void 0?null:d.jsx(tb,{id:"spline",type:"menu",label:"style-panel.spline",uiType:"spline",style:rg,items:ds.spline,value:n,onValueChange:e})}function jue({styles:t}){const e=$h(),n=t.get(eg),r=t.get(Jf);return!n||!r?null:d.jsx(Iue,{label:"style-panel.arrowheads",uiTypeA:"arrowheadStart",styleA:Jf,itemsA:ds.arrowheadStart,valueA:r,uiTypeB:"arrowheadEnd",styleB:eg,itemsB:ds.arrowheadEnd,valueB:n,onValueChange:e,labelA:"style-panel.arrowhead-start",labelB:"style-panel.arrowhead-end"})}const Ru=[.1,.25,.5,.75,1];function Rue(){const t=G(),e=J("opacity",()=>t.getSharedOpacity(),[t]),n=An(),r=Be(),s=Ne.useCallback(o=>{const a=Ru[o];t.run(()=>{t.isIn("select")&&t.setOpacityForSelectedShapes(a),t.setOpacityForNextShapes(a),t.updateInstanceState({isChangingStyle:!0})}),n("set-style",{source:"style-panel",id:"opacity",value:o})},[t,n]);if(e===void 0)return null;const i=e.type==="mixed"?-1:Ru.indexOf(fG(Ru,o=>Math.abs(o-e.value)));return d.jsx(Pue,{"data-testid":"style.opacity",value:i>=0?i:Ru.length-1,label:e.type==="mixed"?"style-panel.mixed":`opacity-style.${e.value}`,onValueChange:s,steps:Ru.length-1,title:r("style-panel.opacity")})}const Oue=C.memo(function({isMobile:e,children:n}){const r=G(),s=FD(),i=C.useCallback(()=>{e||r.updateInstanceState({isChangingStyle:!1})},[r,e]),o=n??d.jsx(Tue,{styles:s});return d.jsx("div",{className:be("tlui-style-panel",{"tlui-style-panel__wrapper":!e}),"data-ismobile":e,onPointerLeave:i,children:o})});function Lue(){const t=G(),e=Be(),n=FD(),r=n==null?void 0:n.get(qr),s=go({isDarkMode:t.user.getIsDarkMode()}),i=((r==null?void 0:r.type)==="shared"?s[r.value]:s.black).solid,o=J("disable style panel",()=>t.isInAny("hand","zoom","eraser","laser"),[t]),a=C.useCallback(c=>{c||t.updateInstanceState({isChangingStyle:!1})},[t]),{StylePanel:l}=Ta();return l?d.jsxs(Ow,{id:"mobile style menu",onOpenChange:a,children:[d.jsx(Lw,{children:d.jsx(Ce,{type:"tool","data-testid":"mobile-styles.button",style:{color:o?"var(--color-muted-1)":i},title:e("style-panel.title"),disabled:o,children:d.jsx(Fe,{icon:o?"blob":(r==null?void 0:r.type)==="mixed"?"mixed":"blob"})})}),d.jsx(Nw,{side:"top",align:"end",children:l&&d.jsx(l,{isMobile:!0})})]}):null}function ej(){return d.jsxs(d.Fragment,{children:[d.jsx(Nue,{}),d.jsx(zue,{}),d.jsx(Fue,{}),d.jsx($ue,{}),d.jsx(Bue,{}),d.jsx(Uue,{}),d.jsx(Hue,{}),d.jsx(Wue,{}),d.jsx(Kue,{}),d.jsx(Gue,{}),d.jsx(que,{}),d.jsx(Vue,{}),d.jsx(Zue,{}),d.jsx(ede,{}),d.jsx(Yue,{}),d.jsx(Jue,{}),d.jsx(Que,{}),d.jsx(Xue,{}),d.jsx(tde,{}),d.jsx(nde,{}),d.jsx(rde,{}),d.jsx(sde,{}),d.jsx(ide,{}),d.jsx(ode,{}),d.jsx(ade,{}),d.jsx(lde,{}),d.jsx(ude,{}),d.jsx(cde,{})]})}function tj(t){var r;const e=G(),n=(r=t.meta)==null?void 0:r.geo;return J("is tool selected",()=>{const s=e.getCurrentToolId(),i=e.getSharedStyles().getAsKnownValue(Os);return n?s==="geo"&&i===n:s===t.id},[e,t.id,n])}function pt({tool:t}){const e=Fc(),n=tj(e[t]);return d.jsx(X,{...e[t],isSelected:n})}function Nue(){return d.jsx(pt,{tool:"select"})}function zue(){return d.jsx(pt,{tool:"hand"})}function Fue(){return d.jsx(pt,{tool:"draw"})}function $ue(){return d.jsx(pt,{tool:"eraser"})}function Bue(){return d.jsx(pt,{tool:"arrow"})}function Uue(){return d.jsx(pt,{tool:"text"})}function Hue(){return d.jsx(pt,{tool:"note"})}function Wue(){const t=Fc();return d.jsx(X,{...t.asset})}function Kue(){return d.jsx(pt,{tool:"rectangle"})}function Gue(){return d.jsx(pt,{tool:"ellipse"})}function Vue(){return d.jsx(pt,{tool:"diamond"})}function que(){return d.jsx(pt,{tool:"triangle"})}function Yue(){return d.jsx(pt,{tool:"rhombus"})}function Xue(){return d.jsx(pt,{tool:"heart"})}function Zue(){return d.jsx(pt,{tool:"hexagon"})}function Que(){return d.jsx(pt,{tool:"cloud"})}function Jue(){return d.jsx(pt,{tool:"star"})}function ede(){return d.jsx(pt,{tool:"oval"})}function tde(){return d.jsx(pt,{tool:"x-box"})}function nde(){return d.jsx(pt,{tool:"check-box"})}function rde(){return d.jsx(pt,{tool:"arrow-left"})}function sde(){return d.jsx(pt,{tool:"arrow-up"})}function ide(){return d.jsx(pt,{tool:"arrow-down"})}function ode(){return d.jsx(pt,{tool:"arrow-right"})}function ade(){return d.jsx(pt,{tool:"line"})}function lde(){return d.jsx(pt,{tool:"highlight"})}function cde(){return d.jsx(pt,{tool:"frame"})}function ude(){return d.jsx(pt,{tool:"laser"})}const Uy=typeof navigator<"u"?navigator.userAgent.toLowerCase().indexOf("firefox")>0:!1;function Hy(t,e,n,r){t.addEventListener?t.addEventListener(e,n,r):t.attachEvent&&t.attachEvent("on".concat(e),n)}function Ou(t,e,n,r){t.removeEventListener?t.removeEventListener(e,n,r):t.detachEvent&&t.detachEvent("on".concat(e),n)}function nj(t,e){const n=e.slice(0,e.length-1);for(let r=0;r<n.length;r++)n[r]=t[n[r].toLowerCase()];return n}function rj(t){typeof t!="string"&&(t=""),t=t.replace(/\s/g,"");const e=t.split(",");let n=e.lastIndexOf("");for(;n>=0;)e[n-1]+=",",e.splice(n,1),n=e.lastIndexOf("");return e}function dde(t,e){const n=t.length>=e.length?t:e,r=t.length>=e.length?e:t;let s=!0;for(let i=0;i<n.length;i++)r.indexOf(n[i])===-1&&(s=!1);return s}const lh={backspace:8,"⌫":8,tab:9,clear:12,enter:13,"↩":13,return:13,esc:27,escape:27,space:32,left:37,up:38,right:39,down:40,del:46,delete:46,ins:45,insert:45,home:36,end:35,pageup:33,pagedown:34,capslock:20,num_0:96,num_1:97,num_2:98,num_3:99,num_4:100,num_5:101,num_6:102,num_7:103,num_8:104,num_9:105,num_multiply:106,num_add:107,num_enter:108,num_subtract:109,num_decimal:110,num_divide:111,"⇪":20,",":188,".":190,"/":191,"`":192,"-":Uy?173:189,"=":Uy?61:187,";":Uy?59:186,"'":222,"[":219,"]":221,"\\":220},Pi={"⇧":16,shift:16,"⌥":18,alt:18,option:18,"⌃":17,ctrl:17,control:17,"⌘":91,cmd:91,command:91},_S={16:"shiftKey",18:"altKey",17:"ctrlKey",91:"metaKey",shiftKey:16,ctrlKey:17,altKey:18,metaKey:91},Sn={16:!1,18:!1,17:!1,91:!1},zt={};for(let t=1;t<20;t++)lh["f".concat(t)]=111+t;let gt=[],Cd=null,sj="all";const zi=new Map,Bh=t=>lh[t.toLowerCase()]||Pi[t.toLowerCase()]||t.toUpperCase().charCodeAt(0),hde=t=>Object.keys(lh).find(e=>lh[e]===t),pde=t=>Object.keys(Pi).find(e=>Pi[e]===t);function ij(t){sj=t||"all"}function ch(){return sj||"all"}function fde(){return gt.slice(0)}function gde(){return gt.map(t=>hde(t)||pde(t)||String.fromCharCode(t))}function mde(){const t=[];return Object.keys(zt).forEach(e=>{zt[e].forEach(n=>{let{key:r,scope:s,mods:i,shortcut:o}=n;t.push({scope:s,shortcut:o,mods:i,keys:r.split("+").map(a=>Bh(a))})})}),t}function yde(t){const e=t.target||t.srcElement,{tagName:n}=e;let r=!0;const s=n==="INPUT"&&!["checkbox","radio","range","button","file","reset","submit","color"].includes(e.type);return(e.isContentEditable||(s||n==="TEXTAREA"||n==="SELECT")&&!e.readOnly)&&(r=!1),r}function vde(t){return typeof t=="string"&&(t=Bh(t)),gt.indexOf(t)!==-1}function Sde(t,e){let n,r;t||(t=ch());for(const s in zt)if(Object.prototype.hasOwnProperty.call(zt,s))for(n=zt[s],r=0;r<n.length;)n[r].scope===t?n.splice(r,1).forEach(o=>{let{element:a}=o;return nb(a)}):r++;ch()===t&&ij(e||"all")}function xde(t){let e=t.keyCode||t.which||t.charCode;const n=gt.indexOf(e);if(n>=0&&gt.splice(n,1),t.key&&t.key.toLowerCase()==="meta"&&gt.splice(0,gt.length),(e===93||e===224)&&(e=91),e in Sn){Sn[e]=!1;for(const r in Pi)Pi[r]===e&&(br[r]=!1)}}function oj(t){if(typeof t>"u")Object.keys(zt).forEach(s=>{Array.isArray(zt[s])&&zt[s].forEach(i=>tp(i)),delete zt[s]}),nb(null);else if(Array.isArray(t))t.forEach(s=>{s.key&&tp(s)});else if(typeof t=="object")t.key&&tp(t);else if(typeof t=="string"){for(var e=arguments.length,n=new Array(e>1?e-1:0),r=1;r<e;r++)n[r-1]=arguments[r];let[s,i]=n;typeof s=="function"&&(i=s,s=""),tp({key:t,scope:s,method:i,splitKey:"+"})}}const tp=t=>{let{key:e,scope:n,method:r,splitKey:s="+"}=t;rj(e).forEach(o=>{const a=o.split(s),l=a.length,c=a[l-1],u=c==="*"?"*":Bh(c);if(!zt[u])return;n||(n=ch());const h=l>1?nj(Pi,a):[],p=[];zt[u]=zt[u].filter(f=>{const m=(r?f.method===r:!0)&&f.scope===n&&dde(f.mods,h);return m&&p.push(f.element),!m}),p.forEach(f=>nb(f))})};function b8(t,e,n,r){if(e.element!==r)return;let s;if(e.scope===n||e.scope==="all"){s=e.mods.length>0;for(const i in Sn)Object.prototype.hasOwnProperty.call(Sn,i)&&(!Sn[i]&&e.mods.indexOf(+i)>-1||Sn[i]&&e.mods.indexOf(+i)===-1)&&(s=!1);(e.mods.length===0&&!Sn[16]&&!Sn[18]&&!Sn[17]&&!Sn[91]||s||e.shortcut==="*")&&(e.keys=[],e.keys=e.keys.concat(gt),e.method(t,e)===!1&&(t.preventDefault?t.preventDefault():t.returnValue=!1,t.stopPropagation&&t.stopPropagation(),t.cancelBubble&&(t.cancelBubble=!0)))}}function C8(t,e){const n=zt["*"];let r=t.keyCode||t.which||t.charCode;if(!br.filter.call(this,t))return;if((r===93||r===224)&&(r=91),gt.indexOf(r)===-1&&r!==229&&gt.push(r),["ctrlKey","altKey","shiftKey","metaKey"].forEach(a=>{const l=_S[a];t[a]&&gt.indexOf(l)===-1?gt.push(l):!t[a]&&gt.indexOf(l)>-1?gt.splice(gt.indexOf(l),1):a==="metaKey"&&t[a]&&gt.length===3&&(t.ctrlKey||t.shiftKey||t.altKey||(gt=gt.slice(gt.indexOf(l))))}),r in Sn){Sn[r]=!0;for(const a in Pi)Pi[a]===r&&(br[a]=!0);if(!n)return}for(const a in Sn)Object.prototype.hasOwnProperty.call(Sn,a)&&(Sn[a]=t[_S[a]]);t.getModifierState&&!(t.altKey&&!t.ctrlKey)&&t.getModifierState("AltGraph")&&(gt.indexOf(17)===-1&&gt.push(17),gt.indexOf(18)===-1&&gt.push(18),Sn[17]=!0,Sn[18]=!0);const s=ch();if(n)for(let a=0;a<n.length;a++)n[a].scope===s&&(t.type==="keydown"&&n[a].keydown||t.type==="keyup"&&n[a].keyup)&&b8(t,n[a],s,e);if(!(r in zt))return;const i=zt[r],o=i.length;for(let a=0;a<o;a++)if((t.type==="keydown"&&i[a].keydown||t.type==="keyup"&&i[a].keyup)&&i[a].key){const l=i[a],{splitKey:c}=l,u=l.key.split(c),h=[];for(let p=0;p<u.length;p++)h.push(Bh(u[p]));h.sort().join("")===gt.sort().join("")&&b8(t,l,s,e)}}function br(t,e,n){gt=[];const r=rj(t);let s=[],i="all",o=document,a=0,l=!1,c=!0,u="+",h=!1,p=!1;for(n===void 0&&typeof e=="function"&&(n=e),Object.prototype.toString.call(e)==="[object Object]"&&(e.scope&&(i=e.scope),e.element&&(o=e.element),e.keyup&&(l=e.keyup),e.keydown!==void 0&&(c=e.keydown),e.capture!==void 0&&(h=e.capture),typeof e.splitKey=="string"&&(u=e.splitKey),e.single===!0&&(p=!0)),typeof e=="string"&&(i=e),p&&oj(t,i);a<r.length;a++)t=r[a].split(u),s=[],t.length>1&&(s=nj(Pi,t)),t=t[t.length-1],t=t==="*"?"*":Bh(t),t in zt||(zt[t]=[]),zt[t].push({keyup:l,keydown:c,scope:i,mods:s,shortcut:r[a],method:n,key:r[a],splitKey:u,element:o});if(typeof o<"u"&&window){if(!zi.has(o)){const f=function(){let m=arguments.length>0&&arguments[0]!==void 0?arguments[0]:window.event;return C8(m,o)},v=function(){let m=arguments.length>0&&arguments[0]!==void 0?arguments[0]:window.event;C8(m,o),xde(m)};zi.set(o,{keydownListener:f,keyupListenr:v,capture:h}),Hy(o,"keydown",f,h),Hy(o,"keyup",v,h)}if(!Cd){const f=()=>{gt=[]};Cd={listener:f,capture:h},Hy(window,"focus",f,h)}}}function wde(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:"all";Object.keys(zt).forEach(n=>{zt[n].filter(s=>s.scope===e&&s.shortcut===t).forEach(s=>{s&&s.method&&s.method()})})}function nb(t){const e=Object.values(zt).flat();if(e.findIndex(r=>{let{element:s}=r;return s===t})<0){const{keydownListener:r,keyupListenr:s,capture:i}=zi.get(t)||{};r&&s&&(Ou(t,"keyup",s,i),Ou(t,"keydown",r,i),zi.delete(t))}if((e.length<=0||zi.size<=0)&&(Object.keys(zi).forEach(s=>{const{keydownListener:i,keyupListenr:o,capture:a}=zi.get(s)||{};i&&o&&(Ou(s,"keyup",o,a),Ou(s,"keydown",i,a),zi.delete(s))}),zi.clear(),Object.keys(zt).forEach(s=>delete zt[s]),Cd)){const{listener:s,capture:i}=Cd;Ou(window,"focus",s,i),Cd=null}}const Wy={getPressedKeyString:gde,setScope:ij,getScope:ch,deleteScope:Sde,getPressedKeyCodes:fde,getAllKeyCodes:mde,isPressed:vde,filter:yde,trigger:wde,unbind:oj,keyMap:lh,modifier:Pi,modifierMap:_S};for(const t in Wy)Object.prototype.hasOwnProperty.call(Wy,t)&&(br[t]=Wy[t]);if(typeof window<"u"){const t=window.hotkeys;br.noConflict=e=>(e&&window.hotkeys===br&&(window.hotkeys=t),br),window.hotkeys=br}const P8=["copy","cut","paste","asset"];function bde(){const t=G(),e=mo(),n=we(),r=Fc(),s=J("is focused",()=>t.getInstanceState().isFocused,[t]);C.useEffect(()=>{if(!s)return;const i=new Array,o=(l,c)=>{br(l,{element:document.body},c),i.push(()=>{br.unbind(l,c)})},a=(l,c)=>{br(l,{element:document.body,keyup:!0,keydown:!1},c),i.push(()=>{br.unbind(l,c)})};for(const l of Object.values(n))l.kbd&&(e&&!l.readonlyOk||P8.includes(l.id)||o(k8(l.kbd),c=>{sd(t)||(Ve(c),l.onSelect("kbd"))}));for(const l of Object.values(r))!l.kbd||!l.readonlyOk&&t.getInstanceState().isReadonly||P8.includes(l.id)||o(k8(l.kbd),c=>{sd(t)||(Ve(c),l.onSelect("kbd"))});return o(",",l=>{if(sd(t)||t.inputs.keys.has("Comma"))return;Ve(l),t.focus(),t.inputs.keys.add("Comma");const{x:c,y:u,z:h}=t.inputs.currentScreenPoint,p={type:"pointer",name:"pointer_down",point:{x:c,y:u,z:h},shiftKey:l.shiftKey,altKey:l.altKey,ctrlKey:l.metaKey||l.ctrlKey,pointerId:0,button:0,isPen:t.getInstanceState().isPenMode,target:"canvas"};t.dispatch(p)}),a(",",l=>{if(sd(t)||!t.inputs.keys.has("Comma"))return;t.inputs.keys.delete("Comma");const{x:c,y:u,z:h}=t.inputs.currentScreenPoint,p={type:"pointer",name:"pointer_up",point:{x:c,y:u,z:h},shiftKey:l.shiftKey,altKey:l.altKey,ctrlKey:l.metaKey||l.ctrlKey,pointerId:0,button:0,isPen:t.getInstanceState().isPenMode,target:"canvas"};t.dispatch(p)}),()=>{i.forEach(l=>l())}},[n,r,e,t,s])}function k8(t){return Cde(t).map(e=>{let n="";const r=e.split("");return r.length===1?n=r[0]:r[0]==="!"?n=`shift+${r[1]}`:r[0]==="?"?r.length===3&&r[1]==="!"?n=`alt+shift+${r[2]}`:n=`alt+${r[1]}`:r[0]==="$"?r[1]==="!"?n=`cmd+shift+${r[2]},ctrl+shift+${r[2]}`:r[1]==="?"?n=`cmd+⌥+${r[2]},ctrl+alt+${r[2]}`:n=`cmd+${r[1]},ctrl+${r[1]}`:n=e,n}).join(",")}function Cde(t){typeof t!="string"&&(t=""),t=t.replace(/\s/g,"");const e=t.split(",");let n=e.lastIndexOf("");for(;n>=0;)e[n-1]+=",",e.splice(n,1),n=e.lastIndexOf("");return e}function sd(t){return t.getIsMenuOpen()||t.getEditingShapeId()!==null||t.getCrashingError()}const Pde=C.createContext(!1);function kde({children:t}){const e=G(),n=pE(),r=or(),s=Be(),i=Math.min(8,5+r),[o,a]=C.useState(0),l=C.useRef(null),[c,u]=C.useState(null),h=C.useMemo(()=>{const f=c?`:not([data-value="${c}"])`:"";return`
			#${n}_main > *:nth-child(n + ${i+(c?1:2)})${f} {
				display: none;
			}
			#${n}_more > *:nth-child(-n + ${i}) {
				display: none;
			}
        `},[c,n,i]),p=HE(()=>{if(!l.current)return;const f=Array.from(l.current.children);a(f.length),f.findIndex(x=>x.getAttribute("data-value")===c)<=i&&u(null);const m=Array.from(l.current.children).findIndex(x=>x.getAttribute("aria-checked")==="true");m!==-1&&m>=i&&u(f[m].getAttribute("data-value"))});return C.useLayoutEffect(()=>{p()}),C.useLayoutEffect(()=>{if(!l.current)return;const f=new MutationObserver(p);return f.observe(l.current,{childList:!0,subtree:!0,attributeFilter:["data-value","aria-checked"]}),()=>{f.disconnect()}},[p]),C.useEffect(()=>{const f=[["1",0],["2",1],["3",2],["4",3],["5",4],["6",5],["7",6],["8",7],["9",8],["0",9]];for(const[v,m]of f)br(v,x=>{var w;if(sd(e))return;Ve(x);const S=Array.from(((w=l.current)==null?void 0:w.children)??[]).filter(P=>!(P instanceof HTMLElement)||P.tagName.toLowerCase()!=="button"?!1:!!(P.offsetWidth||P.offsetHeight))[m];S&&S.click()});return()=>{br.unbind("1,2,3,4,5,6,7,8,9,0")}},[e]),d.jsxs(d.Fragment,{children:[d.jsx("style",{children:h}),d.jsxs("div",{className:be("tlui-toolbar__tools",{"tlui-toolbar__tools__mobile":r<Wt.TABLET_SM}),role:"radiogroup",children:[d.jsx("div",{id:`${n}_main`,ref:l,className:"tlui-toolbar__tools__list",children:d.jsx(Ss,{type:"toolbar",sourceId:"toolbar",children:t})}),o>i+1&&d.jsx(Pde.Provider,{value:!0,children:d.jsxs(gl,{id:"toolbar overflow",modal:!1,children:[d.jsx(ml,{children:d.jsx(Ce,{title:s("tool-panel.more"),type:"tool",className:"tlui-toolbar__overflow","data-testid":"tools.more-button",children:d.jsx(Fe,{icon:"chevron-up"})})}),d.jsx(yl,{side:"top",align:"center",children:d.jsx("div",{className:"tlui-buttons__grid","data-testid":"tools.more-content",id:`${n}_more`,children:d.jsx(Ss,{type:"toolbar-overflow",sourceId:"toolbar",children:t})})})]})})]})]})}function Ide({activeToolId:t}){const e=G(),n=or(),r=Be(),s=J("is tool locked",()=>e.getInstanceState().isToolLocked,[e]),i=J("current tool",()=>e.getCurrentTool(),[e]);return!t||!i.isLockable?null:d.jsx(Ce,{type:"normal",title:r("action.toggle-tool-lock"),"data-testid":"tool-lock",className:be("tlui-toolbar__lock-button",{"tlui-toolbar__lock-button__mobile":n<Wt.TABLET_SM}),onClick:()=>e.updateInstanceState({isToolLocked:!s}),children:d.jsx(Fe,{icon:s?"lock":"unlock",small:!0})})}const aj=C.memo(function({children:e}){const n=G(),r=or(),s=mo(),i=J("current tool id",()=>n.getCurrentToolId(),[n]),{ActionsMenu:o,QuickActions:a}=Ta();return d.jsx("div",{className:"tlui-toolbar",children:d.jsxs("div",{className:"tlui-toolbar__inner",children:[d.jsxs("div",{className:"tlui-toolbar__left",children:[!s&&d.jsxs("div",{className:"tlui-toolbar__extras",children:[r<Wt.TABLET&&d.jsxs("div",{className:"tlui-toolbar__extras__controls tlui-buttons__horizontal",children:[a&&d.jsx(a,{}),o&&d.jsx(o,{})]}),d.jsx(Ide,{activeToolId:i})]}),d.jsx(kde,{children:e??d.jsx(ej,{})})]}),r<Wt.TABLET_SM&&!s&&d.jsx("div",{className:"tlui-toolbar__tools",children:d.jsx(Lue,{})})]})})});function Ede(){const t=Be();return d.jsxs("div",{className:be("tlui-offline-indicator"),children:[t("status.offline"),d.jsx(bi,{"aria-label":"offline",icon:"status-offline",small:!0})]})}function Tde({maxWidth:t=420,ignoreRightWidth:e=0,stylePanelWidth:n=148,marginBetweenZones:r=12,squeezeAmount:s=52,children:i}){const o=C.useRef(null),a=or(),l=C.useCallback(()=>{const c=o.current;if(!c)return;const u=c.parentElement.parentElement,h=u.querySelector(".tlui-layout__top__left"),p=u.querySelector(".tlui-layout__top__right"),f=u.offsetWidth,v=h.offsetWidth,m=p.offsetWidth,x=c.offsetWidth-e;let y=(f-x)/2;f%2!==0&&(y-=.5);const S=v+r,w=c.offsetLeft,P=Math.min(f-m-v-2*r,t),E=Math.max(y,S)-w;p.offsetWidth>n&&a<=6?c.style.setProperty("max-width",P-s+"px"):c.style.setProperty("max-width",P+"px"),c.style.setProperty("transform",`translate(${E}px, 0px)`)},[a,e,r,t,s,n]);return C.useLayoutEffect(()=>{const c=o.current;if(!c)return;const u=c.parentElement.parentElement,h=u.querySelector(".tlui-layout__top__left"),p=u.querySelector(".tlui-layout__top__right"),f=new ResizeObserver(l);return f.observe(h),f.observe(p),f.observe(u),f.observe(c),l(),()=>{f.disconnect()}},[l]),C.useLayoutEffect(()=>{l()}),d.jsx("div",{ref:o,className:"tlui-top-panel__container",children:i})}function Mde(){const t=aie()==="offline";return d.jsx(Tde,{children:t&&d.jsx(Ede,{})})}function _de(){const t=we();return d.jsxs(d.Fragment,{children:[d.jsx(X,{...t["zoom-in"],noClose:!0}),d.jsx(X,{...t["zoom-out"],noClose:!0}),d.jsx(bD,{}),d.jsx(CD,{}),d.jsx(PD,{})]})}const Ade=C.memo(function({children:e}){const n=mn(),[r,s]=vo("zoom menu"),i=e??d.jsx(_de,{});return d.jsxs(Xw,{dir:"ltr",open:r,onOpenChange:s,modal:!1,children:[d.jsx(Zw,{asChild:!0,dir:"ltr",children:d.jsx(Dde,{})}),d.jsx(Bm,{container:n,children:d.jsx(Qw,{className:"tlui-menu",side:"top",align:"start",alignOffset:0,sideOffset:8,collisionPadding:4,children:d.jsx(Ss,{type:"menu",sourceId:"zoom-menu",children:i})})})]})}),Dde=C.forwardRef(function(e,n){const r=G(),s=or(),i=J("zoom",()=>r.getZoomLevel(),[r]),o=Be(),a=C.useCallback(()=>{r.resetZoom(r.getViewportScreenCenter(),{animation:{duration:r.options.animationMediumMs}})},[r]);return d.jsx(Ce,{ref:n,...e,type:"icon",title:`${o("navigation-zone.zoom")}`,"data-testid":"minimap.zoom-menu-button",className:s<Wt.TABLET_SM?"tlui-zoom-menu__button":"tlui-zoom-menu__button__pct",onDoubleClick:a,icon:s<Wt.MOBILE?"zoom-in":void 0,children:s<Wt.MOBILE?null:d.jsxs("span",{style:{flexGrow:0,textAlign:"center"},children:[Math.floor(i*100),"%"]})})}),lj=C.createContext(null);function jde({overrides:t={},children:e}){const n=Mh(t),r=jm();return d.jsx(lj.Provider,{value:C.useMemo(()=>({ContextMenu:ice,ActionsMenu:Dle,HelpMenu:null,ZoomMenu:Ade,MainMenu:ND,Minimap:Hce,StylePanel:Oue,PageMenu:Vce,NavigationPanel:Kce,Toolbar:aj,KeyboardShortcutsDialog:jD,QuickActions:Yce,HelperButtons:Ice,DebugPanel:yce,DebugMenu:mce,MenuPanel:wce,SharePanel:r?nue:null,CursorChatBubble:r?lce:null,TopPanel:r?Mde:null,...n}),[n,r]),children:e})}function Ta(){const t=C.useContext(lj);if(!t)throw new Error("useTldrawUiComponents must be used within a TldrawUiComponentsProvider");return t}function Rde({overrides:t,components:e,assetUrls:n,onUiEvent:r,forceMobile:s,children:i}){return d.jsx(Mte,{assetUrls:yse(n),children:d.jsx(Dte,{overrides:bse(t),children:d.jsx(Ore,{onEvent:r,children:d.jsx(use,{children:d.jsx(Lre,{children:d.jsx(Sse,{forceMobile:s,children:d.jsx(jde,{overrides:e,children:d.jsx(Ode,{overrides:t,children:i})})})})})})})})}function Ode({overrides:t,children:e}){const n=Cse(t);return d.jsx(uie,{overrides:n.actions,children:d.jsx(vse,{overrides:n.tools,children:e})})}function Lde(){const t=G(),{addToast:e}=Vs();C.useEffect(()=>{function n({name:r,count:s}){e({title:"Maximum Shapes Reached",description:`You've reached the maximum number of shapes allowed on ${r} (${s}). Please delete some shapes or move to a different page to continue.`,severity:"warning"})}return t.addListener("max-shapes",n),()=>{t.removeListener("max-shapes",n)}},[t,e])}const Nde=Ne.memo(function({renderDebugMenuItems:e,children:n,hideUi:r,components:s,...i}){return d.jsx(Rde,{...i,components:s,children:d.jsx(zde,{hideUi:r,renderDebugMenuItems:e,children:n})})}),zde=Ne.memo(function({children:e,hideUi:n,...r}){return d.jsxs(d.Fragment,{children:[e,n?null:d.jsx(Fde,{...r})]})}),Fde=Ne.memo(function(){const e=G(),n=Be(),r=or(),s=mo(),i=J("focus",()=>e.getInstanceState().isFocusMode,[e]),o=J("debug",()=>e.getInstanceState().isDebugMode,[e]),{SharePanel:a,TopPanel:l,MenuPanel:c,StylePanel:u,Toolbar:h,HelpMenu:p,NavigationPanel:f,HelperButtons:v,DebugPanel:m,CursorChatBubble:x}=Ta();bde(),Zse(),Lde();const{"toggle-focus-mode":y}=we();return d.jsxs("div",{className:be("tlui-layout",{"tlui-layout__mobile":r<Wt.TABLET_SM}),"data-breakpoint":r,children:[i?d.jsx("div",{className:"tlui-layout__top",children:d.jsx(Ce,{type:"icon",className:"tlui-focus-button",title:n("focus-mode.toggle-focus-mode"),onClick:()=>y.onSelect("menu"),children:d.jsx(Fe,{icon:"dot"})})}):d.jsxs(d.Fragment,{children:[d.jsxs("div",{className:"tlui-layout__top",children:[d.jsxs("div",{className:"tlui-layout__top__left",children:[c&&d.jsx(c,{}),v&&d.jsx(v,{})]}),d.jsx("div",{className:"tlui-layout__top__center",children:l&&d.jsx(l,{})}),d.jsxs("div",{className:"tlui-layout__top__right",children:[a&&d.jsx(a,{}),u&&r>=Wt.TABLET_SM&&!s&&d.jsx(u,{})]})]}),d.jsxs("div",{className:"tlui-layout__bottom",children:[d.jsxs("div",{className:"tlui-layout__bottom__main",children:[f&&d.jsx(f,{}),h&&d.jsx(h,{}),p&&d.jsx(p,{})]}),o&&m&&d.jsx(m,{})]})]}),d.jsx(fse,{}),d.jsx(Fre,{}),d.jsx(gse,{}),d.jsx($re,{}),x&&d.jsx(x,{})]})});async function $de(t,e){const{url:n,style:r="normal",weight:s="500",display:i,featureSettings:o,stretch:a,unicodeRange:l,variant:c,format:u}=e,h={style:r,weight:s,display:i,featureSettings:o,stretch:a,unicodeRange:l,variant:c},p=new FontFace(t,`url(${n})`,h);return await p.load(),document.fonts.add(p),p.$$_url=n,p.$$_fontface=`
@font-face {
	font-family: ${p.family};
	font-stretch: ${p.stretch};
	font-weight: ${p.weight};
	font-style: ${p.style};
	src: url("${n}") format("${u}")
}`,p}const np=(t,e)=>{const[n,r]=C.useState(2);return C.useEffect(()=>{let s=!1;return r(2),$de(t,e).then(()=>{s||r(0)}).catch(i=>{s||(console.error(i),r(1))}),()=>{s=!0}},[t,e]),n};function Bde(t){return{draw:{url:t.fonts.draw,format:t.fonts.draw.split(".").pop()},serif:{url:t.fonts.serif,format:t.fonts.serif.split(".").pop()},sansSerif:{url:t.fonts.sansSerif,format:t.fonts.sansSerif.split(".").pop()},monospace:{url:t.fonts.monospace,format:t.fonts.monospace.split(".").pop()}}}function cj(t){const e=C.useMemo(()=>Bde(t),[t]),n=[np("tldraw_draw",e.draw),np("tldraw_serif",e.serif),np("tldraw_sans",e.sansSerif),np("tldraw_mono",e.monospace)];return{error:n.some(r=>r===1),done:!n.some(r=>r===2)}}function Ude(t){const{children:e,maxImageDimension:n,maxAssetSize:r,acceptedImageMimeTypes:s,acceptedVideoMimeTypes:i,onMount:o,components:a={},shapeUtils:l=[],bindingUtils:c=[],tools:u=[],...h}=t,p=Mh(a),f=C.useMemo(()=>({Scribble:o7,ShapeIndicators:hJ,CollaboratorScribble:o7,SelectionForeground:cJ,SelectionBackground:aJ,Handles:nJ,...p}),[p]),v=Sd(l),m=C.useMemo(()=>[...rw,...v],[v]),x=Sd(c),y=C.useMemo(()=>[...rT,...x],[x]),S=Sd(u),w=C.useMemo(()=>[...sne,...hee,...S],[S]),P=ZM(h.assetUrls),{done:E,error:M}=cj(P);return M?d.jsx(JE,{children:"Could not load assets. Please refresh the page."}):E?d.jsx(BQ,{initialState:"select",...h,components:f,shapeUtils:m,bindingUtils:y,tools:w,children:d.jsxs(Nde,{...h,components:f,children:[d.jsx(Hde,{maxImageDimension:n,maxAssetSize:r,acceptedImageMimeTypes:s,acceptedVideoMimeTypes:i,onMount:o}),e]})}):d.jsx(W4,{children:d.jsx(A4,{})})}function Hde({maxImageDimension:t=5e3,maxAssetSize:e=10*1024*1024,acceptedImageMimeTypes:n=d4,acceptedVideoMimeTypes:r=Fk,onMount:s}){const i=G(),o=Vs(),a=Be();eT(()=>{const u=[];return u.push(Ute(i)),qJ(i,{maxImageDimension:t,maxAssetSize:e,acceptedImageMimeTypes:n,acceptedVideoMimeTypes:r},{toasts:o,msg:a}),u.push(i.store.props.onMount(i)),u.push(s==null?void 0:s(i)),()=>{u.forEach(h=>h==null?void 0:h())}});const{Canvas:l}=_t(),{ContextMenu:c}=Ta();return c?d.jsx(c,{}):l?d.jsx(l,{}):null}C.memo(function(e){const[n,r]=C.useState(null),[s,i]=C.useState(null),o=Sd(e.shapeUtils??[]),a=C.useMemo(()=>[...rw,...o],[o]),l=Sd(e.bindingUtils??[]),c=C.useMemo(()=>[...rT,...l],[l]),u=VQ({snapshot:e.snapshot,shapeUtils:a}),h=ZM(),{done:p,error:f}=cj(h),{pageId:v,bounds:m,scale:x,background:y,padding:S,darkMode:w,preserveAspectRatio:P,format:E="svg",licenseKey:M}=e;return C.useLayoutEffect(()=>{if(!s||!u||!p)return;let I=!1;const _=document.createElement("div");s.appendChild(_),s.classList.add("tl-container","tl-theme__light");const D=new he({store:u,shapeUtils:a,bindingUtils:c,tools:[],getContainer:()=>_,licenseKey:M});v&&D.setCurrentPage(v);const R=D.getCurrentPageShapeIds();async function $(){const U=await D.getSvgString([...R],{bounds:m,scale:x,background:y,padding:S,darkMode:w,preserveAspectRatio:P});if(U&&!I){if(E==="svg"){if(!I){const O=new Blob([U.svg],{type:"image/svg+xml"}),N=URL.createObjectURL(O);r(N)}}else if(E==="png"){const O=await o_(D,U.svg,{type:E,quality:1,scale:2,width:U.width,height:U.height});if(O&&!I){const N=URL.createObjectURL(O);r(N)}}}D.dispose()}return $(),()=>{I=!0}},[E,s,u,a,c,v,m,x,y,S,w,P,p,f,M]),f?d.jsx(JE,{children:"Could not load assets."}):p?d.jsx("div",{ref:i,style:{position:"relative",width:"100%",height:"100%"},children:n&&d.jsx("img",{src:n,referrerPolicy:"strict-origin-when-cross-origin",style:{width:"100%",height:"100%"}})}):d.jsx(W4,{children:d.jsx(A4,{})})});C.memo(function({children:e}){const n=Be(),r=or(),s=e??d.jsx(Mce,{});return r<Wt.MOBILE?null:d.jsx("div",{className:"tlui-help-menu",children:d.jsxs(gl,{id:"help menu",children:[d.jsx(ml,{children:d.jsx(Ce,{type:"help",title:n("help-menu.title"),"data-testid":"help-menu.button",children:d.jsx(Fe,{icon:"question-mark",small:!0})})}),d.jsx(yl,{side:"top",align:"end",alignOffset:0,sideOffset:8,children:d.jsx(Ss,{type:"menu",sourceId:"help-menu",children:s})})]})})});const Wde=$e({schemaVersion:Kn(1),storeVersion:_p,recordVersions:Zf(De,$e({version:_p,subTypeVersions:Zf(De,_p).optional(),subTypeKey:De.optional()}))}),Kde=$e({schemaVersion:Kn(2),sequences:Zf(De,_p)});$e({tldrawFileFormatVersion:nV,schema:rV("schemaVersion",{1:Wde,2:Kde}),records:wn($e({id:De,typeName:De}).allowUnknownProperties())});const Gde=1024*1024,Vde=4,qde=Gde/Vde;function Yde(t,e=qde){if(t.length<e)return[t];{const n=[];let r=0,s=t.length;for(;s>0;){const i=`${r}_`,o=Math.max(Math.min(e-i.length,s),1);n.unshift(i+t.slice(s-o,s)),s-=o,r++}return n}}let Xde=(t=21)=>crypto.getRandomValues(new Uint8Array(t)).reduce((e,n)=>(n&=63,n<36?e+=n.toString(36):n<62?e+=(n-26).toString(36).toUpperCase():n>62?e+="-":e+="_",e),"");const $i={Put:"put",Patch:"patch",Remove:"remove"},Zde=t=>{let e=null;for(const[n,r]of In(t.added))e||(e={}),e[n]=[$i.Put,r];for(const[n,r]of Rt(t.updated)){const s=uj(n,r);s&&(e||(e={}),e[r.id]=[$i.Patch,s])}for(const n of Object.keys(t.removed))e||(e={}),e[n]=[$i.Remove];return e},Bn={Put:"put",Delete:"delete",Append:"append",Patch:"patch"};function uj(t,e){return rb(t,e,new Set(["props"]))}function rb(t,e,n){if(t===e)return null;let r=null;for(const s of Object.keys(t)){if(!(s in e)){r||(r={}),r[s]=[Bn.Delete];continue}const i=t[s],o=e[s];if(!il(i,o))if(n!=null&&n.has(s)&&i&&o){const a=rb(i,o);a&&(r||(r={}),r[s]=[Bn.Patch,a])}else if(Array.isArray(o)&&Array.isArray(i)){const a=dj(i,o);a&&(r||(r={}),r[s]=a)}else r||(r={}),r[s]=[Bn.Put,o]}for(const s of Object.keys(e))s in t||(r||(r={}),r[s]=[Bn.Put,e[s]]);return r}function Qde(t,e){if(Object.is(t,e))return null;if(Array.isArray(t)&&Array.isArray(e))return dj(t,e);if(!t||!e||typeof t!="object"||typeof e!="object")return il(t,e)?null:[Bn.Put,e];{const n=rb(t,e);return n?[Bn.Patch,n]:null}}function dj(t,e){if(Object.is(t,e))return null;if(t.length===e.length){const n=Math.max(t.length/5,1),r=[];for(let i=0;i<t.length;i++)if(!il(t[i],e[i])&&(r.push(i),r.length>n))return[Bn.Put,e];if(r.length===0)return null;const s={};for(const i of r){const o=t[i],a=e[i];if(!o||!a)s[i]=[Bn.Put,a];else if(typeof o=="object"&&typeof a=="object"){const l=Qde(o,a);l&&(s[i]=l)}else s[i]=[Bn.Put,a]}return[Bn.Patch,s]}for(let n=0;n<t.length;n++)if(!il(t[n],e[n]))return[Bn.Put,e];return[Bn.Append,e.slice(t.length),t.length]}function hj(t,e){if(!t||typeof t!="object")return t;const n=Array.isArray(t);let r;const s=(i,o)=>{r||(n?r=[...t]:r={...t}),n?r[Number(i)]=o:r[i]=o};for(const[i,o]of Object.entries(e))switch(o[0]){case Bn.Put:{const a=o[1];il(t[i],a)||s(i,a);break}case Bn.Append:{const a=o[1],l=o[2],c=t[i];Array.isArray(c)&&c.length===l&&s(i,[...c,...a]);break}case Bn.Patch:{if(t[i]&&typeof t[i]=="object"){const a=o[1],l=hj(t[i],a);l!==t[i]&&s(i,l)}break}case Bn.Delete:i in t&&(r||(n?(console.error("Can't delete array item yet (this should never happen)"),r=[...t]):r={...t}),delete r[i])}return r??t}function I8(t,e){const n=setInterval(t,e);return()=>clearInterval(n)}const Jde=6;function ehe(){return Jde}const the={ClientTooOld:"clientTooOld",ServerTooOld:"serverTooOld",InvalidRecord:"invalidRecord",InvalidOperation:"invalidOperation",RoomNotFound:"roomNotFound"},pj={NOT_FOUND:4099},AS=5e3,nhe=AS*2;class rhe{constructor(e){g(this,"lastServerClock",0);g(this,"lastServerInteractionTimestamp",Date.now());g(this,"pendingPushRequests",[]);g(this,"speculativeChanges",{added:{},updated:{},removed:{}});g(this,"disposables",[]);g(this,"store");g(this,"socket");g(this,"presenceState");g(this,"isConnectedToRoom",!1);g(this,"clientClock",0);g(this,"onAfterConnect");g(this,"onSyncError");g(this,"isDebugging",!1);g(this,"presenceType");g(this,"didCancel");g(this,"latestConnectRequestId",null);g(this,"incomingDiffBuffer",[]);g(this,"handleServerEvent",e=>{switch(this.debug("received server event",e),this.lastServerInteractionTimestamp=Date.now(),e.type){case"connect":this.didReconnect(e);break;case"error":console.error("Server error",e.error),console.error("Restarting socket"),this.socket.restart();break;case"patch":case"push_result":if(!this.isConnectedToRoom)break;this.incomingDiffBuffer.push(e),this.scheduleRebase();break;case"data":if(!this.isConnectedToRoom)break;this.incomingDiffBuffer.push(...e.data),this.scheduleRebase();break;case"incompatibility_error":this.onSyncError(e.reason);break;case"pong":break;default:Cn(e)}});g(this,"lastPushedPresenceState",null);g(this,"flushPendingPushRequests",s6(()=>{if(this.debug("flushing pending push requests",{isConnectedToRoom:this.isConnectedToRoom,pendingPushRequests:this.pendingPushRequests}),!(!this.isConnectedToRoom||this.store.isPossiblyCorrupted())){for(const e of this.pendingPushRequests)if(!e.sent){if(this.socket.connectionStatus!=="online")return;this.socket.sendMessage(e.request),e.sent=!0}}}));g(this,"rebase",()=>{var n;if(this.store._flushHistory(),this.incomingDiffBuffer.length===0)return;const e=this.incomingDiffBuffer;this.incomingDiffBuffer=[];try{this.store.mergeRemoteChanges(()=>{this.store.applyDiff(qd(this.speculativeChanges),{runCallbacks:!1});for(const r of e){if(r.type==="patch"){this.applyNetworkDiff(r.diff,!0);continue}if(this.pendingPushRequests.length===0)throw new Error("Received push_result but there are no pending push requests");if(this.pendingPushRequests[0].request.clientClock!==r.clientClock)throw new Error("Received push_result for a push request that is not at the front of the queue");if(r.action==="discard")this.pendingPushRequests.shift();else if(r.action==="commit"){const{request:s}=this.pendingPushRequests.shift();"diff"in s&&s.diff&&this.applyNetworkDiff(s.diff,!0)}else this.applyNetworkDiff(r.action.rebaseWithDiff,!0),this.pendingPushRequests.shift()}try{this.speculativeChanges=this.store.extractingChanges(()=>{for(const{request:r}of this.pendingPushRequests)!("diff"in r)||!r.diff||this.applyNetworkDiff(r.diff,!0)})}catch(r){console.error(r),this.speculativeChanges={added:{},updated:{},removed:{}},this.resetConnection()}}),this.store.ensureStoreIsUsable(),this.lastServerClock=((n=e.at(-1))==null?void 0:n.serverClock)??this.lastServerClock}catch(r){console.error(r),this.store.ensureStoreIsUsable(),this.resetConnection()}});g(this,"scheduleRebase",s6(this.rebase));if(this.didCancel=e.didCancel,this.presenceType=e.store.scopedTypes.presence.values().next().value,!this.presenceType||e.store.scopedTypes.presence.size>1)throw new Error("Store must have exactly one presence type");typeof window<"u"&&(window.tlsync=this),this.store=e.store,this.socket=e.socket,this.onAfterConnect=e.onAfterConnect,this.onSyncError=e.onSyncError;let n=!1;this.presenceState=e.presence,this.disposables.push(this.store.listen(({changes:r})=>{var s;if((s=this.didCancel)!=null&&s.call(this))return this.close();this.debug("received store changes",{changes:r}),this.push(r)},{source:"user",scope:"document"}),this.socket.onReceiveMessage(r=>{var s;if((s=this.didCancel)!=null&&s.call(this))return this.close();this.debug("received message from server",r),this.handleServerEvent(r),n||(n=!0,r.type==="error"?e.onLoadError(r.error):e.onLoad(this))}),this.socket.onStatusChange(r=>{var s;if((s=this.didCancel)!=null&&s.call(this))return this.close();this.debug("socket status changed",r),r==="online"?this.sendConnectMessage():(this.resetConnection(),r==="error"&&!n&&(n=!0,e.onLoadError(new Error("socket error"))))}),I8(()=>{var r;if((r=this.didCancel)!=null&&r.call(this))return this.close();if(this.debug("ping loop",{isConnectedToRoom:this.isConnectedToRoom}),!!this.isConnectedToRoom)try{this.socket.sendMessage({type:"ping"})}catch(s){console.warn("ping failed, resetting",s),this.resetConnection()}},AS),I8(()=>{var s;if((s=this.didCancel)!=null&&s.call(this))return this.close();if(this.debug("health check loop",{isConnectedToRoom:this.isConnectedToRoom}),!this.isConnectedToRoom)return;const r=Date.now()-this.lastServerInteractionTimestamp;if(r<nhe){this.debug("health check passed",{timeSinceLastServerInteraction:r});return}console.warn("Haven't heard from the server in a while, resetting connection..."),this.resetConnection()},AS*2)),this.presenceState&&this.disposables.push(ba("pushPresence",()=>{var r;if((r=this.didCancel)!=null&&r.call(this))return this.close();this.pushPresence(this.presenceState.get())})),this.socket.connectionStatus==="online"&&this.sendConnectMessage()}debug(...e){this.isDebugging&&console.debug(...e)}sendConnectMessage(){if(this.isConnectedToRoom){console.error("sendConnectMessage called while already connected");return}this.debug("sending connect message"),this.latestConnectRequestId=Xde(),this.socket.sendMessage({type:"connect",connectRequestId:this.latestConnectRequestId,schema:this.store.schema.serialize(),protocolVersion:ehe(),lastServerClock:this.lastServerClock})}resetConnection(e=!1){this.debug("resetting connection"),e&&(this.lastServerClock=0),this.store.mergeRemoteChanges(()=>{this.store.remove(Object.keys(this.store.serialize("presence")))}),this.lastPushedPresenceState=null,this.isConnectedToRoom=!1,this.pendingPushRequests=[],this.incomingDiffBuffer=[],this.socket.connectionStatus==="online"&&this.socket.restart()}didReconnect(e){if(this.debug("did reconnect",e),e.connectRequestId===this.latestConnectRequestId){if(this.latestConnectRequestId=null,this.isConnectedToRoom){console.error("didReconnect called while already connected"),this.resetConnection(!0);return}if(this.pendingPushRequests.length>0){console.error("pendingPushRequests should already be empty when we reconnect"),this.resetConnection(!0);return}zs(()=>{var r;const n=this.speculativeChanges;this.speculativeChanges={added:{},updated:{},removed:{}},this.store.mergeRemoteChanges(()=>{const s={},i=e.hydrationType==="wipe_all";i||this.store.applyDiff(qd(n),{runCallbacks:!1});for(const[a,l]of In(this.store.serialize("all")))(i&&this.store.scopedTypes.document.has(l.typeName)||l.typeName===this.presenceType)&&(s[a]=[$i.Remove]);this.applyNetworkDiff({...s,...e.diff},!0),this.isConnectedToRoom=!0;const o=this.store.filterChangesByScope(this.store.extractingChanges(()=>{this.store.applyDiff(n)}),"document");o&&this.push(o)}),this.store.ensureStoreIsUsable(),(r=this.onAfterConnect)==null||r.call(this,this,!1)}),this.lastServerClock=e.serverClock}}close(){var e,n,r,s;this.debug("closing"),this.disposables.forEach(i=>i()),(n=(e=this.flushPendingPushRequests).cancel)==null||n.call(e),(s=(r=this.scheduleRebase).cancel)==null||s.call(r)}pushPresence(e){if(this.store._flushHistory(),!this.isConnectedToRoom)return;let n;if(!this.lastPushedPresenceState&&e)n=[$i.Put,e];else if(this.lastPushedPresenceState&&e){const i=uj(this.lastPushedPresenceState,e);i&&(n=[$i.Patch,i])}if(!n)return;this.lastPushedPresenceState=e;const r=this.pendingPushRequests.at(-1);if(r&&!r.sent&&!r.request.presence){r.request.presence=n;return}const s={type:"push",clientClock:this.clientClock++,presence:n};s&&(this.pendingPushRequests.push({request:s,sent:!1}),this.flushPendingPushRequests())}push(e){this.debug("push",e);const n=Zde(e);if(!n||(this.speculativeChanges=nm([this.speculativeChanges,e]),!this.isConnectedToRoom))return;const r={type:"push",diff:n,clientClock:this.clientClock++};this.pendingPushRequests.push({request:r,sent:!1}),this.flushPendingPushRequests()}applyNetworkDiff(e,n){this.debug("applyNetworkDiff",e);const r={added:{},updated:{},removed:{}};let s=!1;for(const[i,o]of In(e))if(o[0]===$i.Put){const a=this.store.get(i);a&&!il(a,o[1])?(s=!0,r.updated[i]=[a,o[1]]):(s=!0,r.added[i]=o[1])}else if(o[0]===$i.Patch){const a=this.store.get(i);if(!a)continue;const l=hj(a,o[1]);s=!0,r.updated[i]=[a,l]}else o[0]===$i.Remove&&this.store.has(i)&&(s=!0,r.removed[i]=this.store.get(i));s&&this.store.applyDiff(r,{runCallbacks:n})}}function rp(t,e,n){return t.addEventListener(e,n),()=>{t.removeEventListener(e,n)}}function kt(...t){if(typeof window<"u"&&window.__tldraw_socket_debug){const e=new Date;console.log(`${e.getHours()}:${e.getMinutes()}:${e.getSeconds()}.${e.getMilliseconds()}`,...t)}}class she{constructor(e){g(this,"_ws",null);g(this,"isDisposed",!1);g(this,"_reconnectManager");g(this,"_connectionStatus",Qt("websocket connection status","initial"));g(this,"messageListeners",new Set);g(this,"statusListeners",new Set);this._reconnectManager=new che(this,e)}close(){var e;this.isDisposed=!0,this._reconnectManager.close(),(e=this._ws)==null||e.close()}_handleConnect(){kt("handleConnect"),this._connectionStatus.set("online"),this.statusListeners.forEach(e=>e("online")),this._reconnectManager.connected()}_handleDisconnect(e,n,r){kt("handleDisconnect",{currentStatus:this.connectionStatus,closeCode:n,reason:e});let s;switch(e){case"closed":if(n===pj.NOT_FOUND){s="error";break}s="offline";break;case"error":s="error";break;case"manual":s="offline";break}n===1006&&!r&&NG("Could not open WebSocket connection. This might be because you're trying to load a URL that doesn't support websockets. Check the URL you're trying to connect to."),this.connectionStatus!==s&&!(s==="error"&&this.connectionStatus==="offline")&&(this._connectionStatus.set(s),this.statusListeners.forEach(i=>i(s,n))),this._reconnectManager.disconnected()}_setNewSocket(e){var r;We(!this.isDisposed,"Tried to set a new websocket on a disposed socket"),We(this._ws===null||this._ws.readyState===WebSocket.CLOSED||this._ws.readyState===WebSocket.CLOSING,`Tried to set a new websocket in when the existing one was ${(r=this._ws)==null?void 0:r.readyState}`);let n=!1;e.onopen=()=>{kt("ws.onopen"),We(this._ws===e,"sockets must only be orphaned when they are CLOSING or CLOSED, so they can't open"),n=!0,this._handleConnect()},e.onclose=s=>{kt("ws.onclose",s),this._ws===e?this._handleDisconnect("closed",s.code,n):kt("ignoring onclose for an orphaned socket")},e.onerror=s=>{kt("ws.onerror",s),this._ws===e?this._handleDisconnect("error"):kt("ignoring onerror for an orphaned socket")},e.onmessage=s=>{We(this._ws===e,"sockets must only be orphaned when they are CLOSING or CLOSED, so they can't receive messages");const i=JSON.parse(s.data.toString());this.messageListeners.forEach(o=>o(i))},this._ws=e}_closeSocket(){this._ws!==null&&(this._ws.close(),this._ws=null,this._handleDisconnect("manual"))}get connectionStatus(){const e=this._connectionStatus.get();return e==="initial"?"offline":e}sendMessage(e){if(We(!this.isDisposed,"Tried to send message on a disposed socket"),!!this._ws)if(this.connectionStatus==="online"){const n=Yde(JSON.stringify(e));for(const r of n)this._ws.send(r)}else console.warn("Tried to send message while "+this.connectionStatus)}onReceiveMessage(e){return We(!this.isDisposed,"Tried to add message listener on a disposed socket"),this.messageListeners.add(e),()=>{this.messageListeners.delete(e)}}onStatusChange(e){return We(!this.isDisposed,"Tried to add status listener on a disposed socket"),this.statusListeners.add(e),()=>{this.statusListeners.delete(e)}}restart(){We(!this.isDisposed,"Tried to restart a disposed socket"),kt("restarting"),this._closeSocket(),this._reconnectManager.maybeReconnected()}}const Lu=500,ihe=2e3,ohe=1e3,ahe=1e3*60*5,lhe=1.5,E8=1e3;class che{constructor(e,n){g(this,"isDisposed",!1);g(this,"disposables",[()=>{this.reconnectTimeout&&clearTimeout(this.reconnectTimeout),this.recheckConnectingTimeout&&clearTimeout(this.recheckConnectingTimeout)}]);g(this,"reconnectTimeout",null);g(this,"recheckConnectingTimeout",null);g(this,"lastAttemptStart",null);g(this,"intendedDelay",Lu);g(this,"state");this.socketAdapter=e,this.getUri=n,this.subscribeToReconnectHints(),this.disposables.push(rp(window,"offline",()=>{kt("window went offline"),this.socketAdapter._closeSocket()})),this.state="pendingAttempt",this.intendedDelay=Lu,this.scheduleAttempt()}subscribeToReconnectHints(){if(this.disposables.push(rp(window,"online",()=>{kt("window went online"),this.maybeReconnected()}),rp(document,"visibilitychange",()=>{document.hidden||(kt("document became visible"),this.maybeReconnected())})),Object.prototype.hasOwnProperty.call(navigator,"connection")){const e=navigator.connection;this.disposables.push(rp(e,"change",()=>{kt("navigator.connection change"),this.maybeReconnected()}))}}scheduleAttempt(){We(this.state==="pendingAttempt"),kt("scheduling a connection attempt"),Promise.resolve(this.getUri()).then(e=>{var n;this.state!=="pendingAttempt"||this.isDisposed||(We(((n=this.socketAdapter._ws)==null?void 0:n.readyState)!==WebSocket.OPEN,"There should be no connection attempts while already connected"),this.lastAttemptStart=Date.now(),this.socketAdapter._setNewSocket(new WebSocket(uhe(e))),this.state="pendingAttemptResult")})}getMaxDelay(){return document.hidden?ahe:ihe}getMinDelay(){return document.hidden?ohe:Lu}clearReconnectTimeout(){this.reconnectTimeout&&(clearTimeout(this.reconnectTimeout),this.reconnectTimeout=null)}clearRecheckConnectingTimeout(){this.recheckConnectingTimeout&&(clearTimeout(this.recheckConnectingTimeout),this.recheckConnectingTimeout=null)}maybeReconnected(){var e,n;if(kt("ReconnectManager.maybeReconnected"),this.clearRecheckConnectingTimeout(),((e=this.socketAdapter._ws)==null?void 0:e.readyState)===WebSocket.OPEN){kt("ReconnectManager.maybeReconnected: already connected");return}if(((n=this.socketAdapter._ws)==null?void 0:n.readyState)===WebSocket.CONNECTING){kt("ReconnectManager.maybeReconnected: connecting"),We(this.lastAttemptStart,"ReadyState=CONNECTING without lastAttemptStart should be impossible");const r=Date.now()-this.lastAttemptStart;r<E8?(kt("ReconnectManager.maybeReconnected: connecting, rechecking later"),this.recheckConnectingTimeout=setTimeout(()=>this.maybeReconnected(),E8-r)):(kt("ReconnectManager.maybeReconnected: connecting, but for too long, retry now"),this.clearRecheckConnectingTimeout(),this.socketAdapter._closeSocket());return}kt("ReconnectManager.maybeReconnected: closing/closed/null, retry now"),this.intendedDelay=Lu,this.disconnected()}disconnected(){var e,n;if(kt("ReconnectManager.disconnected"),((e=this.socketAdapter._ws)==null?void 0:e.readyState)!==WebSocket.OPEN&&((n=this.socketAdapter._ws)==null?void 0:n.readyState)!==WebSocket.CONNECTING){kt("ReconnectManager.disconnected: websocket is not OPEN or CONNECTING"),this.clearReconnectTimeout();let r;this.state==="connected"?(this.intendedDelay=this.getMinDelay(),r=this.intendedDelay):r=this.lastAttemptStart!==null?this.lastAttemptStart+this.intendedDelay-Date.now():0,r>0?(kt("ReconnectManager.disconnected: delaying, delayLeft",r),this.state="delay",this.reconnectTimeout=setTimeout(()=>this.disconnected(),r)):(this.state="pendingAttempt",this.intendedDelay=Math.min(this.getMaxDelay(),Math.max(this.getMinDelay(),this.intendedDelay)*lhe),kt("ReconnectManager.disconnected: attempting a connection, next delay",this.intendedDelay),this.scheduleAttempt())}}connected(){var e;kt("ReconnectManager.connected"),((e=this.socketAdapter._ws)==null?void 0:e.readyState)===WebSocket.OPEN&&(kt("ReconnectManager.connected: websocket is OPEN"),this.state="connected",this.clearReconnectTimeout(),this.intendedDelay=Lu)}close(){this.disposables.forEach(e=>e()),this.isDisposed=!0}}function uhe(t){return t.replace(/^http(s)?:/,"ws$1:")}class T8 extends Error{constructor(n){super(`remote sync error: ${n}`);g(this,"name","RemoteSyncError");this.reason=n}}const sp="multiplayer.client";function dhe(t){const[e,n]=U4(null),{uri:r,roomId:s="default",assets:i,onMount:o,trackAnalyticsEvent:a,userInfo:l,...c}=t,u=qQ(c),h=Mh(l),p=hq("userAtom",h);return C.useEffect(()=>{p.set(h)},[h,p]),C.useEffect(()=>{const f=dt(),v=ee("userPreferences",()=>{const P=p.get(),E=(ZW(P)?P.get():P)??R4();return{id:E.id,color:E.color??Is.color,name:E.name??Is.name}}),m=new she(async()=>{const P=new URL(r);if(P.searchParams.has("sessionId"))throw new Error('useSync. "sessionId" is a reserved query param name. Please use a different name');if(P.searchParams.has("storeId"))throw new Error('useSync. "storeId" is a reserved query param name. Please use a different name');return P.searchParams.set("sessionId",Jd),P.searchParams.set("storeId",f),P.toString()});m.onStatusChange((P,E)=>{if(P==="error"&&E===pj.NOT_FOUND){a==null||a(sp,{name:"room-not-found",roomId:s}),n({error:new T8(the.RoomNotFound)}),w.close(),m.close();return}});let x=!1;const y=ee("collaboration status",()=>m.connectionStatus==="error"?"offline":m.connectionStatus),S=eh({id:f,schema:u,assets:i,onMount:o,collaboration:{status:y}}),w=new rhe({store:S,socket:m,didCancel:()=>x,onLoad(P){a==null||a(sp,{name:"load",roomId:s}),n({readyClient:P})},onLoadError(P){a==null||a(sp,{name:"load-error",roomId:s}),console.error(P),n({error:P})},onSyncError(P){a==null||a(sp,{name:"sync-error",roomId:s,reason:P}),n({error:new T8(P)})},onAfterConnect(){S.ensureStoreIsUsable()},presence:LV(v)(S)});return()=>{x=!0,w.close(),m.close(),n(null)}},[i,o,p,s,u,n,a,r]),J("remote synced store",()=>{if(!e)return{status:"loading"};if(e.error)return{status:"error",error:e.error};if(!e.readyClient)return{status:"loading"};const f=e.readyClient.socket.connectionStatus;return{status:"synced-remote",connectionStatus:f==="error"?"offline":f,store:e.readyClient.store}},[e])}var hhe={};function fj(t){try{return t()}catch{return}}fj(()=>"https://demo.tldraw.xyz");fj(()=>hhe.TLDRAW_IMAGE_URL);const phe={tools(t,e){return e.card={id:"card",icon:"sigma-icon",label:"Card",kbd:"c",onSelect:()=>{t.setCurrentTool("card")}},e}},fhe={Toolbar:t=>{const e=Fc(),n=tj(e.card);return d.jsxs(aj,{...t,children:[d.jsx(ej,{}),d.jsx(X,{...e.card,isSelected:n})]})},KeyboardShortcutsDialog:t=>{const e=Fc();return d.jsxs(jD,{...t,children:[d.jsx(DD,{}),d.jsx(X,{...e.card})]})}},Tg=class Tg extends xd{constructor(){super(...arguments),this.shapeType="card"}};Tg.id="card",Tg.initial="idle";let DS=Tg;const ghe={w:ke,h:ke,text:De};class Lr{constructor(e,n,r){this.lexer=void 0,this.start=void 0,this.end=void 0,this.lexer=e,this.start=n,this.end=r}static range(e,n){return n?!e||!e.loc||!n.loc||e.loc.lexer!==n.loc.lexer?null:new Lr(e.loc.lexer,e.loc.start,n.loc.end):e&&e.loc}}class ms{constructor(e,n){this.text=void 0,this.loc=void 0,this.noexpand=void 0,this.treatAsRelax=void 0,this.text=e,this.loc=n}range(e,n){return new ms(n,Lr.range(this,e))}}class ie{constructor(e,n){this.name=void 0,this.position=void 0,this.length=void 0,this.rawMessage=void 0;var r="KaTeX parse error: "+e,s,i,o=n&&n.loc;if(o&&o.start<=o.end){var a=o.lexer.input;s=o.start,i=o.end,s===a.length?r+=" at end of input: ":r+=" at position "+(s+1)+": ";var l=a.slice(s,i).replace(/[^]/g,"$&̲"),c;s>15?c="…"+a.slice(s-15,s):c=a.slice(0,s);var u;i+15<a.length?u=a.slice(i,i+15)+"…":u=a.slice(i),r+=c+l+u}var h=new Error(r);return h.name="ParseError",h.__proto__=ie.prototype,h.position=s,s!=null&&i!=null&&(h.length=i-s),h.rawMessage=e,h}}ie.prototype.__proto__=Error.prototype;var mhe=function(e,n){return e.indexOf(n)!==-1},yhe=function(e,n){return e===void 0?n:e},vhe=/([A-Z])/g,She=function(e){return e.replace(vhe,"-$1").toLowerCase()},xhe={"&":"&amp;",">":"&gt;","<":"&lt;",'"':"&quot;","'":"&#x27;"},whe=/[&><"']/g;function bhe(t){return String(t).replace(whe,e=>xhe[e])}var gj=function t(e){return e.type==="ordgroup"||e.type==="color"?e.body.length===1?t(e.body[0]):e:e.type==="font"?t(e.body):e},Che=function(e){var n=gj(e);return n.type==="mathord"||n.type==="textord"||n.type==="atom"},Phe=function(e){if(!e)throw new Error("Expected non-null, but got "+String(e));return e},khe=function(e){var n=/^[\x00-\x20]*([^\\/#?]*?)(:|&#0*58|&#x0*3a|&colon)/i.exec(e);return n?n[2]!==":"||!/^[a-zA-Z][a-zA-Z0-9+\-.]*$/.test(n[1])?null:n[1].toLowerCase():"_relative"},Pe={contains:mhe,deflt:yhe,escape:bhe,hyphenate:She,getBaseElem:gj,isCharacterBox:Che,protocolFromUrl:khe},cf={displayMode:{type:"boolean",description:"Render math in display mode, which puts the math in display style (so \\int and \\sum are large, for example), and centers the math on the page on its own line.",cli:"-d, --display-mode"},output:{type:{enum:["htmlAndMathml","html","mathml"]},description:"Determines the markup language of the output.",cli:"-F, --format <type>"},leqno:{type:"boolean",description:"Render display math in leqno style (left-justified tags)."},fleqn:{type:"boolean",description:"Render display math flush left."},throwOnError:{type:"boolean",default:!0,cli:"-t, --no-throw-on-error",cliDescription:"Render errors (in the color given by --error-color) instead of throwing a ParseError exception when encountering an error."},errorColor:{type:"string",default:"#cc0000",cli:"-c, --error-color <color>",cliDescription:"A color string given in the format 'rgb' or 'rrggbb' (no #). This option determines the color of errors rendered by the -t option.",cliProcessor:t=>"#"+t},macros:{type:"object",cli:"-m, --macro <def>",cliDescription:"Define custom macro of the form '\\foo:expansion' (use multiple -m arguments for multiple macros).",cliDefault:[],cliProcessor:(t,e)=>(e.push(t),e)},minRuleThickness:{type:"number",description:"Specifies a minimum thickness, in ems, for fraction lines, `\\sqrt` top lines, `{array}` vertical lines, `\\hline`, `\\hdashline`, `\\underline`, `\\overline`, and the borders of `\\fbox`, `\\boxed`, and `\\fcolorbox`.",processor:t=>Math.max(0,t),cli:"--min-rule-thickness <size>",cliProcessor:parseFloat},colorIsTextColor:{type:"boolean",description:"Makes \\color behave like LaTeX's 2-argument \\textcolor, instead of LaTeX's one-argument \\color mode change.",cli:"-b, --color-is-text-color"},strict:{type:[{enum:["warn","ignore","error"]},"boolean","function"],description:"Turn on strict / LaTeX faithfulness mode, which throws an error if the input uses features that are not supported by LaTeX.",cli:"-S, --strict",cliDefault:!1},trust:{type:["boolean","function"],description:"Trust the input, enabling all HTML features such as \\url.",cli:"-T, --trust"},maxSize:{type:"number",default:1/0,description:"If non-zero, all user-specified sizes, e.g. in \\rule{500em}{500em}, will be capped to maxSize ems. Otherwise, elements and spaces can be arbitrarily large",processor:t=>Math.max(0,t),cli:"-s, --max-size <n>",cliProcessor:parseInt},maxExpand:{type:"number",default:1e3,description:"Limit the number of macro expansions to the specified number, to prevent e.g. infinite macro loops. If set to Infinity, the macro expander will try to fully expand as in LaTeX.",processor:t=>Math.max(0,t),cli:"-e, --max-expand <n>",cliProcessor:t=>t==="Infinity"?1/0:parseInt(t)},globalGroup:{type:"boolean",cli:!1}};function Ihe(t){if(t.default)return t.default;var e=t.type,n=Array.isArray(e)?e[0]:e;if(typeof n!="string")return n.enum[0];switch(n){case"boolean":return!1;case"string":return"";case"number":return 0;case"object":return{}}}class sb{constructor(e){this.displayMode=void 0,this.output=void 0,this.leqno=void 0,this.fleqn=void 0,this.throwOnError=void 0,this.errorColor=void 0,this.macros=void 0,this.minRuleThickness=void 0,this.colorIsTextColor=void 0,this.strict=void 0,this.trust=void 0,this.maxSize=void 0,this.maxExpand=void 0,this.globalGroup=void 0,e=e||{};for(var n in cf)if(cf.hasOwnProperty(n)){var r=cf[n];this[n]=e[n]!==void 0?r.processor?r.processor(e[n]):e[n]:Ihe(r)}}reportNonstrict(e,n,r){var s=this.strict;if(typeof s=="function"&&(s=s(e,n,r)),!(!s||s==="ignore")){if(s===!0||s==="error")throw new ie("LaTeX-incompatible input and strict mode is set to 'error': "+(n+" ["+e+"]"),r);s==="warn"?typeof console<"u"&&console.warn("LaTeX-incompatible input and strict mode is set to 'warn': "+(n+" ["+e+"]")):typeof console<"u"&&console.warn("LaTeX-incompatible input and strict mode is set to "+("unrecognized '"+s+"': "+n+" ["+e+"]"))}}useStrictBehavior(e,n,r){var s=this.strict;if(typeof s=="function")try{s=s(e,n,r)}catch{s="error"}return!s||s==="ignore"?!1:s===!0||s==="error"?!0:s==="warn"?(typeof console<"u"&&console.warn("LaTeX-incompatible input and strict mode is set to 'warn': "+(n+" ["+e+"]")),!1):(typeof console<"u"&&console.warn("LaTeX-incompatible input and strict mode is set to "+("unrecognized '"+s+"': "+n+" ["+e+"]")),!1)}isTrusted(e){if(e.url&&!e.protocol){var n=Pe.protocolFromUrl(e.url);if(n==null)return!1;e.protocol=n}var r=typeof this.trust=="function"?this.trust(e):this.trust;return!!r}}class To{constructor(e,n,r){this.id=void 0,this.size=void 0,this.cramped=void 0,this.id=e,this.size=n,this.cramped=r}sup(){return ni[Ehe[this.id]]}sub(){return ni[The[this.id]]}fracNum(){return ni[Mhe[this.id]]}fracDen(){return ni[_he[this.id]]}cramp(){return ni[Ahe[this.id]]}text(){return ni[Dhe[this.id]]}isTight(){return this.size>=2}}var ib=0,Cg=1,Cc=2,Qi=3,uh=4,hs=5,Uc=6,Qn=7,ni=[new To(ib,0,!1),new To(Cg,0,!0),new To(Cc,1,!1),new To(Qi,1,!0),new To(uh,2,!1),new To(hs,2,!0),new To(Uc,3,!1),new To(Qn,3,!0)],Ehe=[uh,hs,uh,hs,Uc,Qn,Uc,Qn],The=[hs,hs,hs,hs,Qn,Qn,Qn,Qn],Mhe=[Cc,Qi,uh,hs,Uc,Qn,Uc,Qn],_he=[Qi,Qi,hs,hs,Qn,Qn,Qn,Qn],Ahe=[Cg,Cg,Qi,Qi,hs,hs,Qn,Qn],Dhe=[ib,Cg,Cc,Qi,Cc,Qi,Cc,Qi],Te={DISPLAY:ni[ib],TEXT:ni[Cc],SCRIPT:ni[uh],SCRIPTSCRIPT:ni[Uc]},jS=[{name:"latin",blocks:[[256,591],[768,879]]},{name:"cyrillic",blocks:[[1024,1279]]},{name:"armenian",blocks:[[1328,1423]]},{name:"brahmic",blocks:[[2304,4255]]},{name:"georgian",blocks:[[4256,4351]]},{name:"cjk",blocks:[[12288,12543],[19968,40879],[65280,65376]]},{name:"hangul",blocks:[[44032,55215]]}];function jhe(t){for(var e=0;e<jS.length;e++)for(var n=jS[e],r=0;r<n.blocks.length;r++){var s=n.blocks[r];if(t>=s[0]&&t<=s[1])return n.name}return null}var uf=[];jS.forEach(t=>t.blocks.forEach(e=>uf.push(...e)));function mj(t){for(var e=0;e<uf.length;e+=2)if(t>=uf[e]&&t<=uf[e+1])return!0;return!1}var $l=80,Rhe=function(e,n){return"M95,"+(622+e+n)+`
c-2.7,0,-7.17,-2.7,-13.5,-8c-5.8,-5.3,-9.5,-10,-9.5,-14
c0,-2,0.3,-3.3,1,-4c1.3,-2.7,23.83,-20.7,67.5,-54
c44.2,-33.3,65.8,-50.3,66.5,-51c1.3,-1.3,3,-2,5,-2c4.7,0,8.7,3.3,12,10
s173,378,173,378c0.7,0,35.3,-71,104,-213c68.7,-142,137.5,-285,206.5,-429
c69,-144,104.5,-217.7,106.5,-221
l`+e/2.075+" -"+e+`
c5.3,-9.3,12,-14,20,-14
H400000v`+(40+e)+`H845.2724
s-225.272,467,-225.272,467s-235,486,-235,486c-2.7,4.7,-9,7,-19,7
c-6,0,-10,-1,-12,-3s-194,-422,-194,-422s-65,47,-65,47z
M`+(834+e)+" "+n+"h400000v"+(40+e)+"h-400000z"},Ohe=function(e,n){return"M263,"+(601+e+n)+`c0.7,0,18,39.7,52,119
c34,79.3,68.167,158.7,102.5,238c34.3,79.3,51.8,119.3,52.5,120
c340,-704.7,510.7,-1060.3,512,-1067
l`+e/2.084+" -"+e+`
c4.7,-7.3,11,-11,19,-11
H40000v`+(40+e)+`H1012.3
s-271.3,567,-271.3,567c-38.7,80.7,-84,175,-136,283c-52,108,-89.167,185.3,-111.5,232
c-22.3,46.7,-33.8,70.3,-34.5,71c-4.7,4.7,-12.3,7,-23,7s-12,-1,-12,-1
s-109,-253,-109,-253c-72.7,-168,-109.3,-252,-110,-252c-10.7,8,-22,16.7,-34,26
c-22,17.3,-33.3,26,-34,26s-26,-26,-26,-26s76,-59,76,-59s76,-60,76,-60z
M`+(1001+e)+" "+n+"h400000v"+(40+e)+"h-400000z"},Lhe=function(e,n){return"M983 "+(10+e+n)+`
l`+e/3.13+" -"+e+`
c4,-6.7,10,-10,18,-10 H400000v`+(40+e)+`
H1013.1s-83.4,268,-264.1,840c-180.7,572,-277,876.3,-289,913c-4.7,4.7,-12.7,7,-24,7
s-12,0,-12,0c-1.3,-3.3,-3.7,-11.7,-7,-25c-35.3,-125.3,-106.7,-373.3,-214,-744
c-10,12,-21,25,-33,39s-32,39,-32,39c-6,-5.3,-15,-14,-27,-26s25,-30,25,-30
c26.7,-32.7,52,-63,76,-91s52,-60,52,-60s208,722,208,722
c56,-175.3,126.3,-397.3,211,-666c84.7,-268.7,153.8,-488.2,207.5,-658.5
c53.7,-170.3,84.5,-266.8,92.5,-289.5z
M`+(1001+e)+" "+n+"h400000v"+(40+e)+"h-400000z"},Nhe=function(e,n){return"M424,"+(2398+e+n)+`
c-1.3,-0.7,-38.5,-172,-111.5,-514c-73,-342,-109.8,-513.3,-110.5,-514
c0,-2,-10.7,14.3,-32,49c-4.7,7.3,-9.8,15.7,-15.5,25c-5.7,9.3,-9.8,16,-12.5,20
s-5,7,-5,7c-4,-3.3,-8.3,-7.7,-13,-13s-13,-13,-13,-13s76,-122,76,-122s77,-121,77,-121
s209,968,209,968c0,-2,84.7,-361.7,254,-1079c169.3,-717.3,254.7,-1077.7,256,-1081
l`+e/4.223+" -"+e+`c4,-6.7,10,-10,18,-10 H400000
v`+(40+e)+`H1014.6
s-87.3,378.7,-272.6,1166c-185.3,787.3,-279.3,1182.3,-282,1185
c-2,6,-10,9,-24,9
c-8,0,-12,-0.7,-12,-2z M`+(1001+e)+" "+n+`
h400000v`+(40+e)+"h-400000z"},zhe=function(e,n){return"M473,"+(2713+e+n)+`
c339.3,-1799.3,509.3,-2700,510,-2702 l`+e/5.298+" -"+e+`
c3.3,-7.3,9.3,-11,18,-11 H400000v`+(40+e)+`H1017.7
s-90.5,478,-276.2,1466c-185.7,988,-279.5,1483,-281.5,1485c-2,6,-10,9,-24,9
c-8,0,-12,-0.7,-12,-2c0,-1.3,-5.3,-32,-16,-92c-50.7,-293.3,-119.7,-693.3,-207,-1200
c0,-1.3,-5.3,8.7,-16,30c-10.7,21.3,-21.3,42.7,-32,64s-16,33,-16,33s-26,-26,-26,-26
s76,-153,76,-153s77,-151,77,-151c0.7,0.7,35.7,202,105,604c67.3,400.7,102,602.7,104,
606zM`+(1001+e)+" "+n+"h400000v"+(40+e)+"H1017.7z"},Fhe=function(e){var n=e/2;return"M400000 "+e+" H0 L"+n+" 0 l65 45 L145 "+(e-80)+" H400000z"},$he=function(e,n,r){var s=r-54-n-e;return"M702 "+(e+n)+"H400000"+(40+e)+`
H742v`+s+`l-4 4-4 4c-.667.7 -2 1.5-4 2.5s-4.167 1.833-6.5 2.5-5.5 1-9.5 1
h-12l-28-84c-16.667-52-96.667 -294.333-240-727l-212 -643 -85 170
c-4-3.333-8.333-7.667-13 -13l-13-13l77-155 77-156c66 199.333 139 419.667
219 661 l218 661zM702 `+n+"H400000v"+(40+e)+"H742z"},Bhe=function(e,n,r){n=1e3*n;var s="";switch(e){case"sqrtMain":s=Rhe(n,$l);break;case"sqrtSize1":s=Ohe(n,$l);break;case"sqrtSize2":s=Lhe(n,$l);break;case"sqrtSize3":s=Nhe(n,$l);break;case"sqrtSize4":s=zhe(n,$l);break;case"sqrtTall":s=$he(n,$l,r)}return s},Uhe=function(e,n){switch(e){case"⎜":return"M291 0 H417 V"+n+" H291z M291 0 H417 V"+n+" H291z";case"∣":return"M145 0 H188 V"+n+" H145z M145 0 H188 V"+n+" H145z";case"∥":return"M145 0 H188 V"+n+" H145z M145 0 H188 V"+n+" H145z"+("M367 0 H410 V"+n+" H367z M367 0 H410 V"+n+" H367z");case"⎟":return"M457 0 H583 V"+n+" H457z M457 0 H583 V"+n+" H457z";case"⎢":return"M319 0 H403 V"+n+" H319z M319 0 H403 V"+n+" H319z";case"⎥":return"M263 0 H347 V"+n+" H263z M263 0 H347 V"+n+" H263z";case"⎪":return"M384 0 H504 V"+n+" H384z M384 0 H504 V"+n+" H384z";case"⏐":return"M312 0 H355 V"+n+" H312z M312 0 H355 V"+n+" H312z";case"‖":return"M257 0 H300 V"+n+" H257z M257 0 H300 V"+n+" H257z"+("M478 0 H521 V"+n+" H478z M478 0 H521 V"+n+" H478z");default:return""}},M8={doubleleftarrow:`M262 157
l10-10c34-36 62.7-77 86-123 3.3-8 5-13.3 5-16 0-5.3-6.7-8-20-8-7.3
 0-12.2.5-14.5 1.5-2.3 1-4.8 4.5-7.5 10.5-49.3 97.3-121.7 169.3-217 216-28
 14-57.3 25-88 33-6.7 2-11 3.8-13 5.5-2 1.7-3 4.2-3 7.5s1 5.8 3 7.5
c2 1.7 6.3 3.5 13 5.5 68 17.3 128.2 47.8 180.5 91.5 52.3 43.7 93.8 96.2 124.5
 157.5 9.3 8 15.3 12.3 18 13h6c12-.7 18-4 18-10 0-2-1.7-7-5-15-23.3-46-52-87
-86-123l-10-10h399738v-40H218c328 0 0 0 0 0l-10-8c-26.7-20-65.7-43-117-69 2.7
-2 6-3.7 10-5 36.7-16 72.3-37.3 107-64l10-8h399782v-40z
m8 0v40h399730v-40zm0 194v40h399730v-40z`,doublerightarrow:`M399738 392l
-10 10c-34 36-62.7 77-86 123-3.3 8-5 13.3-5 16 0 5.3 6.7 8 20 8 7.3 0 12.2-.5
 14.5-1.5 2.3-1 4.8-4.5 7.5-10.5 49.3-97.3 121.7-169.3 217-216 28-14 57.3-25 88
-33 6.7-2 11-3.8 13-5.5 2-1.7 3-4.2 3-7.5s-1-5.8-3-7.5c-2-1.7-6.3-3.5-13-5.5-68
-17.3-128.2-47.8-180.5-91.5-52.3-43.7-93.8-96.2-124.5-157.5-9.3-8-15.3-12.3-18
-13h-6c-12 .7-18 4-18 10 0 2 1.7 7 5 15 23.3 46 52 87 86 123l10 10H0v40h399782
c-328 0 0 0 0 0l10 8c26.7 20 65.7 43 117 69-2.7 2-6 3.7-10 5-36.7 16-72.3 37.3
-107 64l-10 8H0v40zM0 157v40h399730v-40zm0 194v40h399730v-40z`,leftarrow:`M400000 241H110l3-3c68.7-52.7 113.7-120
 135-202 4-14.7 6-23 6-25 0-7.3-7-11-21-11-8 0-13.2.8-15.5 2.5-2.3 1.7-4.2 5.8
-5.5 12.5-1.3 4.7-2.7 10.3-4 17-12 48.7-34.8 92-68.5 130S65.3 228.3 18 247
c-10 4-16 7.7-18 11 0 8.7 6 14.3 18 17 47.3 18.7 87.8 47 121.5 85S196 441.3 208
 490c.7 2 1.3 5 2 9s1.2 6.7 1.5 8c.3 1.3 1 3.3 2 6s2.2 4.5 3.5 5.5c1.3 1 3.3
 1.8 6 2.5s6 1 10 1c14 0 21-3.7 21-11 0-2-2-10.3-6-25-20-79.3-65-146.7-135-202
 l-3-3h399890zM100 241v40h399900v-40z`,leftbrace:`M6 548l-6-6v-35l6-11c56-104 135.3-181.3 238-232 57.3-28.7 117
-45 179-50h399577v120H403c-43.3 7-81 15-113 26-100.7 33-179.7 91-237 174-2.7
 5-6 9-10 13-.7 1-7.3 1-20 1H6z`,leftbraceunder:`M0 6l6-6h17c12.688 0 19.313.3 20 1 4 4 7.313 8.3 10 13
 35.313 51.3 80.813 93.8 136.5 127.5 55.688 33.7 117.188 55.8 184.5 66.5.688
 0 2 .3 4 1 18.688 2.7 76 4.3 172 5h399450v120H429l-6-1c-124.688-8-235-61.7
-331-161C60.687 138.7 32.312 99.3 7 54L0 41V6z`,leftgroup:`M400000 80
H435C64 80 168.3 229.4 21 260c-5.9 1.2-18 0-18 0-2 0-3-1-3-3v-38C76 61 257 0
 435 0h399565z`,leftgroupunder:`M400000 262
H435C64 262 168.3 112.6 21 82c-5.9-1.2-18 0-18 0-2 0-3 1-3 3v38c76 158 257 219
 435 219h399565z`,leftharpoon:`M0 267c.7 5.3 3 10 7 14h399993v-40H93c3.3
-3.3 10.2-9.5 20.5-18.5s17.8-15.8 22.5-20.5c50.7-52 88-110.3 112-175 4-11.3 5
-18.3 3-21-1.3-4-7.3-6-18-6-8 0-13 .7-15 2s-4.7 6.7-8 16c-42 98.7-107.3 174.7
-196 228-6.7 4.7-10.7 8-12 10-1.3 2-2 5.7-2 11zm100-26v40h399900v-40z`,leftharpoonplus:`M0 267c.7 5.3 3 10 7 14h399993v-40H93c3.3-3.3 10.2-9.5
 20.5-18.5s17.8-15.8 22.5-20.5c50.7-52 88-110.3 112-175 4-11.3 5-18.3 3-21-1.3
-4-7.3-6-18-6-8 0-13 .7-15 2s-4.7 6.7-8 16c-42 98.7-107.3 174.7-196 228-6.7 4.7
-10.7 8-12 10-1.3 2-2 5.7-2 11zm100-26v40h399900v-40zM0 435v40h400000v-40z
m0 0v40h400000v-40z`,leftharpoondown:`M7 241c-4 4-6.333 8.667-7 14 0 5.333.667 9 2 11s5.333
 5.333 12 10c90.667 54 156 130 196 228 3.333 10.667 6.333 16.333 9 17 2 .667 5
 1 9 1h5c10.667 0 16.667-2 18-6 2-2.667 1-9.667-3-21-32-87.333-82.667-157.667
-152-211l-3-3h399907v-40zM93 281 H400000 v-40L7 241z`,leftharpoondownplus:`M7 435c-4 4-6.3 8.7-7 14 0 5.3.7 9 2 11s5.3 5.3 12
 10c90.7 54 156 130 196 228 3.3 10.7 6.3 16.3 9 17 2 .7 5 1 9 1h5c10.7 0 16.7
-2 18-6 2-2.7 1-9.7-3-21-32-87.3-82.7-157.7-152-211l-3-3h399907v-40H7zm93 0
v40h399900v-40zM0 241v40h399900v-40zm0 0v40h399900v-40z`,lefthook:`M400000 281 H103s-33-11.2-61-33.5S0 197.3 0 164s14.2-61.2 42.5
-83.5C70.8 58.2 104 47 142 47 c16.7 0 25 6.7 25 20 0 12-8.7 18.7-26 20-40 3.3
-68.7 15.7-86 37-10 12-15 25.3-15 40 0 22.7 9.8 40.7 29.5 54 19.7 13.3 43.5 21
 71.5 23h399859zM103 281v-40h399897v40z`,leftlinesegment:`M40 281 V428 H0 V94 H40 V241 H400000 v40z
M40 281 V428 H0 V94 H40 V241 H400000 v40z`,leftmapsto:`M40 281 V448H0V74H40V241H400000v40z
M40 281 V448H0V74H40V241H400000v40z`,leftToFrom:`M0 147h400000v40H0zm0 214c68 40 115.7 95.7 143 167h22c15.3 0 23
-.3 23-1 0-1.3-5.3-13.7-16-37-18-35.3-41.3-69-70-101l-7-8h399905v-40H95l7-8
c28.7-32 52-65.7 70-101 10.7-23.3 16-35.7 16-37 0-.7-7.7-1-23-1h-22C115.7 265.3
 68 321 0 361zm0-174v-40h399900v40zm100 154v40h399900v-40z`,longequal:`M0 50 h400000 v40H0z m0 194h40000v40H0z
M0 50 h400000 v40H0z m0 194h40000v40H0z`,midbrace:`M200428 334
c-100.7-8.3-195.3-44-280-108-55.3-42-101.7-93-139-153l-9-14c-2.7 4-5.7 8.7-9 14
-53.3 86.7-123.7 153-211 199-66.7 36-137.3 56.3-212 62H0V214h199568c178.3-11.7
 311.7-78.3 403-201 6-8 9.7-12 11-12 .7-.7 6.7-1 18-1s17.3.3 18 1c1.3 0 5 4 11
 12 44.7 59.3 101.3 106.3 170 141s145.3 54.3 229 60h199572v120z`,midbraceunder:`M199572 214
c100.7 8.3 195.3 44 280 108 55.3 42 101.7 93 139 153l9 14c2.7-4 5.7-8.7 9-14
 53.3-86.7 123.7-153 211-199 66.7-36 137.3-56.3 212-62h199568v120H200432c-178.3
 11.7-311.7 78.3-403 201-6 8-9.7 12-11 12-.7.7-6.7 1-18 1s-17.3-.3-18-1c-1.3 0
-5-4-11-12-44.7-59.3-101.3-106.3-170-141s-145.3-54.3-229-60H0V214z`,oiintSize1:`M512.6 71.6c272.6 0 320.3 106.8 320.3 178.2 0 70.8-47.7 177.6
-320.3 177.6S193.1 320.6 193.1 249.8c0-71.4 46.9-178.2 319.5-178.2z
m368.1 178.2c0-86.4-60.9-215.4-368.1-215.4-306.4 0-367.3 129-367.3 215.4 0 85.8
60.9 214.8 367.3 214.8 307.2 0 368.1-129 368.1-214.8z`,oiintSize2:`M757.8 100.1c384.7 0 451.1 137.6 451.1 230 0 91.3-66.4 228.8
-451.1 228.8-386.3 0-452.7-137.5-452.7-228.8 0-92.4 66.4-230 452.7-230z
m502.4 230c0-111.2-82.4-277.2-502.4-277.2s-504 166-504 277.2
c0 110 84 276 504 276s502.4-166 502.4-276z`,oiiintSize1:`M681.4 71.6c408.9 0 480.5 106.8 480.5 178.2 0 70.8-71.6 177.6
-480.5 177.6S202.1 320.6 202.1 249.8c0-71.4 70.5-178.2 479.3-178.2z
m525.8 178.2c0-86.4-86.8-215.4-525.7-215.4-437.9 0-524.7 129-524.7 215.4 0
85.8 86.8 214.8 524.7 214.8 438.9 0 525.7-129 525.7-214.8z`,oiiintSize2:`M1021.2 53c603.6 0 707.8 165.8 707.8 277.2 0 110-104.2 275.8
-707.8 275.8-606 0-710.2-165.8-710.2-275.8C311 218.8 415.2 53 1021.2 53z
m770.4 277.1c0-131.2-126.4-327.6-770.5-327.6S248.4 198.9 248.4 330.1
c0 130 128.8 326.4 772.7 326.4s770.5-196.4 770.5-326.4z`,rightarrow:`M0 241v40h399891c-47.3 35.3-84 78-110 128
-16.7 32-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20
 11 8 0 13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7
 39-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85
-40.5-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5
-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67
 151.7 139 205zm0 0v40h399900v-40z`,rightbrace:`M400000 542l
-6 6h-17c-12.7 0-19.3-.3-20-1-4-4-7.3-8.3-10-13-35.3-51.3-80.8-93.8-136.5-127.5
s-117.2-55.8-184.5-66.5c-.7 0-2-.3-4-1-18.7-2.7-76-4.3-172-5H0V214h399571l6 1
c124.7 8 235 61.7 331 161 31.3 33.3 59.7 72.7 85 118l7 13v35z`,rightbraceunder:`M399994 0l6 6v35l-6 11c-56 104-135.3 181.3-238 232-57.3
 28.7-117 45-179 50H-300V214h399897c43.3-7 81-15 113-26 100.7-33 179.7-91 237
-174 2.7-5 6-9 10-13 .7-1 7.3-1 20-1h17z`,rightgroup:`M0 80h399565c371 0 266.7 149.4 414 180 5.9 1.2 18 0 18 0 2 0
 3-1 3-3v-38c-76-158-257-219-435-219H0z`,rightgroupunder:`M0 262h399565c371 0 266.7-149.4 414-180 5.9-1.2 18 0 18
 0 2 0 3 1 3 3v38c-76 158-257 219-435 219H0z`,rightharpoon:`M0 241v40h399993c4.7-4.7 7-9.3 7-14 0-9.3
-3.7-15.3-11-18-92.7-56.7-159-133.7-199-231-3.3-9.3-6-14.7-8-16-2-1.3-7-2-15-2
-10.7 0-16.7 2-18 6-2 2.7-1 9.7 3 21 15.3 42 36.7 81.8 64 119.5 27.3 37.7 58
 69.2 92 94.5zm0 0v40h399900v-40z`,rightharpoonplus:`M0 241v40h399993c4.7-4.7 7-9.3 7-14 0-9.3-3.7-15.3-11
-18-92.7-56.7-159-133.7-199-231-3.3-9.3-6-14.7-8-16-2-1.3-7-2-15-2-10.7 0-16.7
 2-18 6-2 2.7-1 9.7 3 21 15.3 42 36.7 81.8 64 119.5 27.3 37.7 58 69.2 92 94.5z
m0 0v40h399900v-40z m100 194v40h399900v-40zm0 0v40h399900v-40z`,rightharpoondown:`M399747 511c0 7.3 6.7 11 20 11 8 0 13-.8 15-2.5s4.7-6.8
 8-15.5c40-94 99.3-166.3 178-217 13.3-8 20.3-12.3 21-13 5.3-3.3 8.5-5.8 9.5
-7.5 1-1.7 1.5-5.2 1.5-10.5s-2.3-10.3-7-15H0v40h399908c-34 25.3-64.7 57-92 95
-27.3 38-48.7 77.7-64 119-3.3 8.7-5 14-5 16zM0 241v40h399900v-40z`,rightharpoondownplus:`M399747 705c0 7.3 6.7 11 20 11 8 0 13-.8
 15-2.5s4.7-6.8 8-15.5c40-94 99.3-166.3 178-217 13.3-8 20.3-12.3 21-13 5.3-3.3
 8.5-5.8 9.5-7.5 1-1.7 1.5-5.2 1.5-10.5s-2.3-10.3-7-15H0v40h399908c-34 25.3
-64.7 57-92 95-27.3 38-48.7 77.7-64 119-3.3 8.7-5 14-5 16zM0 435v40h399900v-40z
m0-194v40h400000v-40zm0 0v40h400000v-40z`,righthook:`M399859 241c-764 0 0 0 0 0 40-3.3 68.7-15.7 86-37 10-12 15-25.3
 15-40 0-22.7-9.8-40.7-29.5-54-19.7-13.3-43.5-21-71.5-23-17.3-1.3-26-8-26-20 0
-13.3 8.7-20 26-20 38 0 71 11.2 99 33.5 0 0 7 5.6 21 16.7 14 11.2 21 33.5 21
 66.8s-14 61.2-42 83.5c-28 22.3-61 33.5-99 33.5L0 241z M0 281v-40h399859v40z`,rightlinesegment:`M399960 241 V94 h40 V428 h-40 V281 H0 v-40z
M399960 241 V94 h40 V428 h-40 V281 H0 v-40z`,rightToFrom:`M400000 167c-70.7-42-118-97.7-142-167h-23c-15.3 0-23 .3-23
 1 0 1.3 5.3 13.7 16 37 18 35.3 41.3 69 70 101l7 8H0v40h399905l-7 8c-28.7 32
-52 65.7-70 101-10.7 23.3-16 35.7-16 37 0 .7 7.7 1 23 1h23c24-69.3 71.3-125 142
-167z M100 147v40h399900v-40zM0 341v40h399900v-40z`,twoheadleftarrow:`M0 167c68 40
 115.7 95.7 143 167h22c15.3 0 23-.3 23-1 0-1.3-5.3-13.7-16-37-18-35.3-41.3-69
-70-101l-7-8h125l9 7c50.7 39.3 85 86 103 140h46c0-4.7-6.3-18.7-19-42-18-35.3
-40-67.3-66-96l-9-9h399716v-40H284l9-9c26-28.7 48-60.7 66-96 12.7-23.333 19
-37.333 19-42h-46c-18 54-52.3 100.7-103 140l-9 7H95l7-8c28.7-32 52-65.7 70-101
 10.7-23.333 16-35.7 16-37 0-.7-7.7-1-23-1h-22C115.7 71.3 68 127 0 167z`,twoheadrightarrow:`M400000 167
c-68-40-115.7-95.7-143-167h-22c-15.3 0-23 .3-23 1 0 1.3 5.3 13.7 16 37 18 35.3
 41.3 69 70 101l7 8h-125l-9-7c-50.7-39.3-85-86-103-140h-46c0 4.7 6.3 18.7 19 42
 18 35.3 40 67.3 66 96l9 9H0v40h399716l-9 9c-26 28.7-48 60.7-66 96-12.7 23.333
-19 37.333-19 42h46c18-54 52.3-100.7 103-140l9-7h125l-7 8c-28.7 32-52 65.7-70
 101-10.7 23.333-16 35.7-16 37 0 .7 7.7 1 23 1h22c27.3-71.3 75-127 143-167z`,tilde1:`M200 55.538c-77 0-168 73.953-177 73.953-3 0-7
-2.175-9-5.437L2 97c-1-2-2-4-2-6 0-4 2-7 5-9l20-12C116 12 171 0 207 0c86 0
 114 68 191 68 78 0 168-68 177-68 4 0 7 2 9 5l12 19c1 2.175 2 4.35 2 6.525 0
 4.35-2 7.613-5 9.788l-19 13.05c-92 63.077-116.937 75.308-183 76.128
-68.267.847-113-73.952-191-73.952z`,tilde2:`M344 55.266c-142 0-300.638 81.316-311.5 86.418
-8.01 3.762-22.5 10.91-23.5 5.562L1 120c-1-2-1-3-1-4 0-5 3-9 8-10l18.4-9C160.9
 31.9 283 0 358 0c148 0 188 122 331 122s314-97 326-97c4 0 8 2 10 7l7 21.114
c1 2.14 1 3.21 1 4.28 0 5.347-3 9.626-7 10.696l-22.3 12.622C852.6 158.372 751
 181.476 676 181.476c-149 0-189-126.21-332-126.21z`,tilde3:`M786 59C457 59 32 175.242 13 175.242c-6 0-10-3.457
-11-10.37L.15 138c-1-7 3-12 10-13l19.2-6.4C378.4 40.7 634.3 0 804.3 0c337 0
 411.8 157 746.8 157 328 0 754-112 773-112 5 0 10 3 11 9l1 14.075c1 8.066-.697
 16.595-6.697 17.492l-21.052 7.31c-367.9 98.146-609.15 122.696-778.15 122.696
 -338 0-409-156.573-744-156.573z`,tilde4:`M786 58C457 58 32 177.487 13 177.487c-6 0-10-3.345
-11-10.035L.15 143c-1-7 3-12 10-13l22-6.7C381.2 35 637.15 0 807.15 0c337 0 409
 177 744 177 328 0 754-127 773-127 5 0 10 3 11 9l1 14.794c1 7.805-3 13.38-9
 14.495l-20.7 5.574c-366.85 99.79-607.3 139.372-776.3 139.372-338 0-409
 -175.236-744-175.236z`,vec:`M377 20c0-5.333 1.833-10 5.5-14S391 0 397 0c4.667 0 8.667 1.667 12 5
3.333 2.667 6.667 9 10 19 6.667 24.667 20.333 43.667 41 57 7.333 4.667 11
10.667 11 18 0 6-1 10-3 12s-6.667 5-14 9c-28.667 14.667-53.667 35.667-75 63
-1.333 1.333-3.167 3.5-5.5 6.5s-4 4.833-5 5.5c-1 .667-2.5 1.333-4.5 2s-4.333 1
-7 1c-4.667 0-9.167-1.833-13.5-5.5S337 184 337 178c0-12.667 15.667-32.333 47-59
H213l-171-1c-8.667-6-13-12.333-13-19 0-4.667 4.333-11.333 13-20h359
c-16-25.333-24-45-24-59z`,widehat1:`M529 0h5l519 115c5 1 9 5 9 10 0 1-1 2-1 3l-4 22
c-1 5-5 9-11 9h-2L532 67 19 159h-2c-5 0-9-4-11-9l-5-22c-1-6 2-12 8-13z`,widehat2:`M1181 0h2l1171 176c6 0 10 5 10 11l-2 23c-1 6-5 10
-11 10h-1L1182 67 15 220h-1c-6 0-10-4-11-10l-2-23c-1-6 4-11 10-11z`,widehat3:`M1181 0h2l1171 236c6 0 10 5 10 11l-2 23c-1 6-5 10
-11 10h-1L1182 67 15 280h-1c-6 0-10-4-11-10l-2-23c-1-6 4-11 10-11z`,widehat4:`M1181 0h2l1171 296c6 0 10 5 10 11l-2 23c-1 6-5 10
-11 10h-1L1182 67 15 340h-1c-6 0-10-4-11-10l-2-23c-1-6 4-11 10-11z`,widecheck1:`M529,159h5l519,-115c5,-1,9,-5,9,-10c0,-1,-1,-2,-1,-3l-4,-22c-1,
-5,-5,-9,-11,-9h-2l-512,92l-513,-92h-2c-5,0,-9,4,-11,9l-5,22c-1,6,2,12,8,13z`,widecheck2:`M1181,220h2l1171,-176c6,0,10,-5,10,-11l-2,-23c-1,-6,-5,-10,
-11,-10h-1l-1168,153l-1167,-153h-1c-6,0,-10,4,-11,10l-2,23c-1,6,4,11,10,11z`,widecheck3:`M1181,280h2l1171,-236c6,0,10,-5,10,-11l-2,-23c-1,-6,-5,-10,
-11,-10h-1l-1168,213l-1167,-213h-1c-6,0,-10,4,-11,10l-2,23c-1,6,4,11,10,11z`,widecheck4:`M1181,340h2l1171,-296c6,0,10,-5,10,-11l-2,-23c-1,-6,-5,-10,
-11,-10h-1l-1168,273l-1167,-273h-1c-6,0,-10,4,-11,10l-2,23c-1,6,4,11,10,11z`,baraboveleftarrow:`M400000 620h-399890l3 -3c68.7 -52.7 113.7 -120 135 -202
c4 -14.7 6 -23 6 -25c0 -7.3 -7 -11 -21 -11c-8 0 -13.2 0.8 -15.5 2.5
c-2.3 1.7 -4.2 5.8 -5.5 12.5c-1.3 4.7 -2.7 10.3 -4 17c-12 48.7 -34.8 92 -68.5 130
s-74.2 66.3 -121.5 85c-10 4 -16 7.7 -18 11c0 8.7 6 14.3 18 17c47.3 18.7 87.8 47
121.5 85s56.5 81.3 68.5 130c0.7 2 1.3 5 2 9s1.2 6.7 1.5 8c0.3 1.3 1 3.3 2 6
s2.2 4.5 3.5 5.5c1.3 1 3.3 1.8 6 2.5s6 1 10 1c14 0 21 -3.7 21 -11
c0 -2 -2 -10.3 -6 -25c-20 -79.3 -65 -146.7 -135 -202l-3 -3h399890z
M100 620v40h399900v-40z M0 241v40h399900v-40zM0 241v40h399900v-40z`,rightarrowabovebar:`M0 241v40h399891c-47.3 35.3-84 78-110 128-16.7 32
-27.7 63.7-33 95 0 1.3-.2 2.7-.5 4-.3 1.3-.5 2.3-.5 3 0 7.3 6.7 11 20 11 8 0
13.2-.8 15.5-2.5 2.3-1.7 4.2-5.5 5.5-11.5 2-13.3 5.7-27 11-41 14.7-44.7 39
-84.5 73-119.5s73.7-60.2 119-75.5c6-2 9-5.7 9-11s-3-9-9-11c-45.3-15.3-85-40.5
-119-75.5s-58.3-74.8-73-119.5c-4.7-14-8.3-27.3-11-40-1.3-6.7-3.2-10.8-5.5
-12.5-2.3-1.7-7.5-2.5-15.5-2.5-14 0-21 3.7-21 11 0 2 2 10.3 6 25 20.7 83.3 67
151.7 139 205zm96 379h399894v40H0zm0 0h399904v40H0z`,baraboveshortleftharpoon:`M507,435c-4,4,-6.3,8.7,-7,14c0,5.3,0.7,9,2,11
c1.3,2,5.3,5.3,12,10c90.7,54,156,130,196,228c3.3,10.7,6.3,16.3,9,17
c2,0.7,5,1,9,1c0,0,5,0,5,0c10.7,0,16.7,-2,18,-6c2,-2.7,1,-9.7,-3,-21
c-32,-87.3,-82.7,-157.7,-152,-211c0,0,-3,-3,-3,-3l399351,0l0,-40
c-398570,0,-399437,0,-399437,0z M593 435 v40 H399500 v-40z
M0 281 v-40 H399908 v40z M0 281 v-40 H399908 v40z`,rightharpoonaboveshortbar:`M0,241 l0,40c399126,0,399993,0,399993,0
c4.7,-4.7,7,-9.3,7,-14c0,-9.3,-3.7,-15.3,-11,-18c-92.7,-56.7,-159,-133.7,-199,
-231c-3.3,-9.3,-6,-14.7,-8,-16c-2,-1.3,-7,-2,-15,-2c-10.7,0,-16.7,2,-18,6
c-2,2.7,-1,9.7,3,21c15.3,42,36.7,81.8,64,119.5c27.3,37.7,58,69.2,92,94.5z
M0 241 v40 H399908 v-40z M0 475 v-40 H399500 v40z M0 475 v-40 H399500 v40z`,shortbaraboveleftharpoon:`M7,435c-4,4,-6.3,8.7,-7,14c0,5.3,0.7,9,2,11
c1.3,2,5.3,5.3,12,10c90.7,54,156,130,196,228c3.3,10.7,6.3,16.3,9,17c2,0.7,5,1,9,
1c0,0,5,0,5,0c10.7,0,16.7,-2,18,-6c2,-2.7,1,-9.7,-3,-21c-32,-87.3,-82.7,-157.7,
-152,-211c0,0,-3,-3,-3,-3l399907,0l0,-40c-399126,0,-399993,0,-399993,0z
M93 435 v40 H400000 v-40z M500 241 v40 H400000 v-40z M500 241 v40 H400000 v-40z`,shortrightharpoonabovebar:`M53,241l0,40c398570,0,399437,0,399437,0
c4.7,-4.7,7,-9.3,7,-14c0,-9.3,-3.7,-15.3,-11,-18c-92.7,-56.7,-159,-133.7,-199,
-231c-3.3,-9.3,-6,-14.7,-8,-16c-2,-1.3,-7,-2,-15,-2c-10.7,0,-16.7,2,-18,6
c-2,2.7,-1,9.7,3,21c15.3,42,36.7,81.8,64,119.5c27.3,37.7,58,69.2,92,94.5z
M500 241 v40 H399408 v-40z M500 435 v40 H400000 v-40z`},Hhe=function(e,n){switch(e){case"lbrack":return"M403 1759 V84 H666 V0 H319 V1759 v"+n+` v1759 h347 v-84
H403z M403 1759 V0 H319 V1759 v`+n+" v1759 h84z";case"rbrack":return"M347 1759 V0 H0 V84 H263 V1759 v"+n+` v1759 H0 v84 H347z
M347 1759 V0 H263 V1759 v`+n+" v1759 h84z";case"vert":return"M145 15 v585 v"+n+` v585 c2.667,10,9.667,15,21,15
c10,0,16.667,-5,20,-15 v-585 v`+-n+` v-585 c-2.667,-10,-9.667,-15,-21,-15
c-10,0,-16.667,5,-20,15z M188 15 H145 v585 v`+n+" v585 h43z";case"doublevert":return"M145 15 v585 v"+n+` v585 c2.667,10,9.667,15,21,15
c10,0,16.667,-5,20,-15 v-585 v`+-n+` v-585 c-2.667,-10,-9.667,-15,-21,-15
c-10,0,-16.667,5,-20,15z M188 15 H145 v585 v`+n+` v585 h43z
M367 15 v585 v`+n+` v585 c2.667,10,9.667,15,21,15
c10,0,16.667,-5,20,-15 v-585 v`+-n+` v-585 c-2.667,-10,-9.667,-15,-21,-15
c-10,0,-16.667,5,-20,15z M410 15 H367 v585 v`+n+" v585 h43z";case"lfloor":return"M319 602 V0 H403 V602 v"+n+` v1715 h263 v84 H319z
MM319 602 V0 H403 V602 v`+n+" v1715 H319z";case"rfloor":return"M319 602 V0 H403 V602 v"+n+` v1799 H0 v-84 H319z
MM319 602 V0 H403 V602 v`+n+" v1715 H319z";case"lceil":return"M403 1759 V84 H666 V0 H319 V1759 v"+n+` v602 h84z
M403 1759 V0 H319 V1759 v`+n+" v602 h84z";case"rceil":return"M347 1759 V0 H0 V84 H263 V1759 v"+n+` v602 h84z
M347 1759 V0 h-84 V1759 v`+n+" v602 h84z";case"lparen":return`M863,9c0,-2,-2,-5,-6,-9c0,0,-17,0,-17,0c-12.7,0,-19.3,0.3,-20,1
c-5.3,5.3,-10.3,11,-15,17c-242.7,294.7,-395.3,682,-458,1162c-21.3,163.3,-33.3,349,
-36,557 l0,`+(n+84)+`c0.2,6,0,26,0,60c2,159.3,10,310.7,24,454c53.3,528,210,
949.7,470,1265c4.7,6,9.7,11.7,15,17c0.7,0.7,7,1,19,1c0,0,18,0,18,0c4,-4,6,-7,6,-9
c0,-2.7,-3.3,-8.7,-10,-18c-135.3,-192.7,-235.5,-414.3,-300.5,-665c-65,-250.7,-102.5,
-544.7,-112.5,-882c-2,-104,-3,-167,-3,-189
l0,-`+(n+92)+`c0,-162.7,5.7,-314,17,-454c20.7,-272,63.7,-513,129,-723c65.3,
-210,155.3,-396.3,270,-559c6.7,-9.3,10,-15.3,10,-18z`;case"rparen":return`M76,0c-16.7,0,-25,3,-25,9c0,2,2,6.3,6,13c21.3,28.7,42.3,60.3,
63,95c96.7,156.7,172.8,332.5,228.5,527.5c55.7,195,92.8,416.5,111.5,664.5
c11.3,139.3,17,290.7,17,454c0,28,1.7,43,3.3,45l0,`+(n+9)+`
c-3,4,-3.3,16.7,-3.3,38c0,162,-5.7,313.7,-17,455c-18.7,248,-55.8,469.3,-111.5,664
c-55.7,194.7,-131.8,370.3,-228.5,527c-20.7,34.7,-41.7,66.3,-63,95c-2,3.3,-4,7,-6,11
c0,7.3,5.7,11,17,11c0,0,11,0,11,0c9.3,0,14.3,-0.3,15,-1c5.3,-5.3,10.3,-11,15,-17
c242.7,-294.7,395.3,-681.7,458,-1161c21.3,-164.7,33.3,-350.7,36,-558
l0,-`+(n+144)+`c-2,-159.3,-10,-310.7,-24,-454c-53.3,-528,-210,-949.7,
-470,-1265c-4.7,-6,-9.7,-11.7,-15,-17c-0.7,-0.7,-6.7,-1,-18,-1z`;default:throw new Error("Unknown stretchy delimiter.")}};class Uh{constructor(e){this.children=void 0,this.classes=void 0,this.height=void 0,this.depth=void 0,this.maxFontSize=void 0,this.style=void 0,this.children=e,this.classes=[],this.height=0,this.depth=0,this.maxFontSize=0,this.style={}}hasClass(e){return Pe.contains(this.classes,e)}toNode(){for(var e=document.createDocumentFragment(),n=0;n<this.children.length;n++)e.appendChild(this.children[n].toNode());return e}toMarkup(){for(var e="",n=0;n<this.children.length;n++)e+=this.children[n].toMarkup();return e}toText(){var e=n=>n.toText();return this.children.map(e).join("")}}var ui={"AMS-Regular":{32:[0,0,0,0,.25],65:[0,.68889,0,0,.72222],66:[0,.68889,0,0,.66667],67:[0,.68889,0,0,.72222],68:[0,.68889,0,0,.72222],69:[0,.68889,0,0,.66667],70:[0,.68889,0,0,.61111],71:[0,.68889,0,0,.77778],72:[0,.68889,0,0,.77778],73:[0,.68889,0,0,.38889],74:[.16667,.68889,0,0,.5],75:[0,.68889,0,0,.77778],76:[0,.68889,0,0,.66667],77:[0,.68889,0,0,.94445],78:[0,.68889,0,0,.72222],79:[.16667,.68889,0,0,.77778],80:[0,.68889,0,0,.61111],81:[.16667,.68889,0,0,.77778],82:[0,.68889,0,0,.72222],83:[0,.68889,0,0,.55556],84:[0,.68889,0,0,.66667],85:[0,.68889,0,0,.72222],86:[0,.68889,0,0,.72222],87:[0,.68889,0,0,1],88:[0,.68889,0,0,.72222],89:[0,.68889,0,0,.72222],90:[0,.68889,0,0,.66667],107:[0,.68889,0,0,.55556],160:[0,0,0,0,.25],165:[0,.675,.025,0,.75],174:[.15559,.69224,0,0,.94666],240:[0,.68889,0,0,.55556],295:[0,.68889,0,0,.54028],710:[0,.825,0,0,2.33334],732:[0,.9,0,0,2.33334],770:[0,.825,0,0,2.33334],771:[0,.9,0,0,2.33334],989:[.08167,.58167,0,0,.77778],1008:[0,.43056,.04028,0,.66667],8245:[0,.54986,0,0,.275],8463:[0,.68889,0,0,.54028],8487:[0,.68889,0,0,.72222],8498:[0,.68889,0,0,.55556],8502:[0,.68889,0,0,.66667],8503:[0,.68889,0,0,.44445],8504:[0,.68889,0,0,.66667],8513:[0,.68889,0,0,.63889],8592:[-.03598,.46402,0,0,.5],8594:[-.03598,.46402,0,0,.5],8602:[-.13313,.36687,0,0,1],8603:[-.13313,.36687,0,0,1],8606:[.01354,.52239,0,0,1],8608:[.01354,.52239,0,0,1],8610:[.01354,.52239,0,0,1.11111],8611:[.01354,.52239,0,0,1.11111],8619:[0,.54986,0,0,1],8620:[0,.54986,0,0,1],8621:[-.13313,.37788,0,0,1.38889],8622:[-.13313,.36687,0,0,1],8624:[0,.69224,0,0,.5],8625:[0,.69224,0,0,.5],8630:[0,.43056,0,0,1],8631:[0,.43056,0,0,1],8634:[.08198,.58198,0,0,.77778],8635:[.08198,.58198,0,0,.77778],8638:[.19444,.69224,0,0,.41667],8639:[.19444,.69224,0,0,.41667],8642:[.19444,.69224,0,0,.41667],8643:[.19444,.69224,0,0,.41667],8644:[.1808,.675,0,0,1],8646:[.1808,.675,0,0,1],8647:[.1808,.675,0,0,1],8648:[.19444,.69224,0,0,.83334],8649:[.1808,.675,0,0,1],8650:[.19444,.69224,0,0,.83334],8651:[.01354,.52239,0,0,1],8652:[.01354,.52239,0,0,1],8653:[-.13313,.36687,0,0,1],8654:[-.13313,.36687,0,0,1],8655:[-.13313,.36687,0,0,1],8666:[.13667,.63667,0,0,1],8667:[.13667,.63667,0,0,1],8669:[-.13313,.37788,0,0,1],8672:[-.064,.437,0,0,1.334],8674:[-.064,.437,0,0,1.334],8705:[0,.825,0,0,.5],8708:[0,.68889,0,0,.55556],8709:[.08167,.58167,0,0,.77778],8717:[0,.43056,0,0,.42917],8722:[-.03598,.46402,0,0,.5],8724:[.08198,.69224,0,0,.77778],8726:[.08167,.58167,0,0,.77778],8733:[0,.69224,0,0,.77778],8736:[0,.69224,0,0,.72222],8737:[0,.69224,0,0,.72222],8738:[.03517,.52239,0,0,.72222],8739:[.08167,.58167,0,0,.22222],8740:[.25142,.74111,0,0,.27778],8741:[.08167,.58167,0,0,.38889],8742:[.25142,.74111,0,0,.5],8756:[0,.69224,0,0,.66667],8757:[0,.69224,0,0,.66667],8764:[-.13313,.36687,0,0,.77778],8765:[-.13313,.37788,0,0,.77778],8769:[-.13313,.36687,0,0,.77778],8770:[-.03625,.46375,0,0,.77778],8774:[.30274,.79383,0,0,.77778],8776:[-.01688,.48312,0,0,.77778],8778:[.08167,.58167,0,0,.77778],8782:[.06062,.54986,0,0,.77778],8783:[.06062,.54986,0,0,.77778],8785:[.08198,.58198,0,0,.77778],8786:[.08198,.58198,0,0,.77778],8787:[.08198,.58198,0,0,.77778],8790:[0,.69224,0,0,.77778],8791:[.22958,.72958,0,0,.77778],8796:[.08198,.91667,0,0,.77778],8806:[.25583,.75583,0,0,.77778],8807:[.25583,.75583,0,0,.77778],8808:[.25142,.75726,0,0,.77778],8809:[.25142,.75726,0,0,.77778],8812:[.25583,.75583,0,0,.5],8814:[.20576,.70576,0,0,.77778],8815:[.20576,.70576,0,0,.77778],8816:[.30274,.79383,0,0,.77778],8817:[.30274,.79383,0,0,.77778],8818:[.22958,.72958,0,0,.77778],8819:[.22958,.72958,0,0,.77778],8822:[.1808,.675,0,0,.77778],8823:[.1808,.675,0,0,.77778],8828:[.13667,.63667,0,0,.77778],8829:[.13667,.63667,0,0,.77778],8830:[.22958,.72958,0,0,.77778],8831:[.22958,.72958,0,0,.77778],8832:[.20576,.70576,0,0,.77778],8833:[.20576,.70576,0,0,.77778],8840:[.30274,.79383,0,0,.77778],8841:[.30274,.79383,0,0,.77778],8842:[.13597,.63597,0,0,.77778],8843:[.13597,.63597,0,0,.77778],8847:[.03517,.54986,0,0,.77778],8848:[.03517,.54986,0,0,.77778],8858:[.08198,.58198,0,0,.77778],8859:[.08198,.58198,0,0,.77778],8861:[.08198,.58198,0,0,.77778],8862:[0,.675,0,0,.77778],8863:[0,.675,0,0,.77778],8864:[0,.675,0,0,.77778],8865:[0,.675,0,0,.77778],8872:[0,.69224,0,0,.61111],8873:[0,.69224,0,0,.72222],8874:[0,.69224,0,0,.88889],8876:[0,.68889,0,0,.61111],8877:[0,.68889,0,0,.61111],8878:[0,.68889,0,0,.72222],8879:[0,.68889,0,0,.72222],8882:[.03517,.54986,0,0,.77778],8883:[.03517,.54986,0,0,.77778],8884:[.13667,.63667,0,0,.77778],8885:[.13667,.63667,0,0,.77778],8888:[0,.54986,0,0,1.11111],8890:[.19444,.43056,0,0,.55556],8891:[.19444,.69224,0,0,.61111],8892:[.19444,.69224,0,0,.61111],8901:[0,.54986,0,0,.27778],8903:[.08167,.58167,0,0,.77778],8905:[.08167,.58167,0,0,.77778],8906:[.08167,.58167,0,0,.77778],8907:[0,.69224,0,0,.77778],8908:[0,.69224,0,0,.77778],8909:[-.03598,.46402,0,0,.77778],8910:[0,.54986,0,0,.76042],8911:[0,.54986,0,0,.76042],8912:[.03517,.54986,0,0,.77778],8913:[.03517,.54986,0,0,.77778],8914:[0,.54986,0,0,.66667],8915:[0,.54986,0,0,.66667],8916:[0,.69224,0,0,.66667],8918:[.0391,.5391,0,0,.77778],8919:[.0391,.5391,0,0,.77778],8920:[.03517,.54986,0,0,1.33334],8921:[.03517,.54986,0,0,1.33334],8922:[.38569,.88569,0,0,.77778],8923:[.38569,.88569,0,0,.77778],8926:[.13667,.63667,0,0,.77778],8927:[.13667,.63667,0,0,.77778],8928:[.30274,.79383,0,0,.77778],8929:[.30274,.79383,0,0,.77778],8934:[.23222,.74111,0,0,.77778],8935:[.23222,.74111,0,0,.77778],8936:[.23222,.74111,0,0,.77778],8937:[.23222,.74111,0,0,.77778],8938:[.20576,.70576,0,0,.77778],8939:[.20576,.70576,0,0,.77778],8940:[.30274,.79383,0,0,.77778],8941:[.30274,.79383,0,0,.77778],8994:[.19444,.69224,0,0,.77778],8995:[.19444,.69224,0,0,.77778],9416:[.15559,.69224,0,0,.90222],9484:[0,.69224,0,0,.5],9488:[0,.69224,0,0,.5],9492:[0,.37788,0,0,.5],9496:[0,.37788,0,0,.5],9585:[.19444,.68889,0,0,.88889],9586:[.19444,.74111,0,0,.88889],9632:[0,.675,0,0,.77778],9633:[0,.675,0,0,.77778],9650:[0,.54986,0,0,.72222],9651:[0,.54986,0,0,.72222],9654:[.03517,.54986,0,0,.77778],9660:[0,.54986,0,0,.72222],9661:[0,.54986,0,0,.72222],9664:[.03517,.54986,0,0,.77778],9674:[.11111,.69224,0,0,.66667],9733:[.19444,.69224,0,0,.94445],10003:[0,.69224,0,0,.83334],10016:[0,.69224,0,0,.83334],10731:[.11111,.69224,0,0,.66667],10846:[.19444,.75583,0,0,.61111],10877:[.13667,.63667,0,0,.77778],10878:[.13667,.63667,0,0,.77778],10885:[.25583,.75583,0,0,.77778],10886:[.25583,.75583,0,0,.77778],10887:[.13597,.63597,0,0,.77778],10888:[.13597,.63597,0,0,.77778],10889:[.26167,.75726,0,0,.77778],10890:[.26167,.75726,0,0,.77778],10891:[.48256,.98256,0,0,.77778],10892:[.48256,.98256,0,0,.77778],10901:[.13667,.63667,0,0,.77778],10902:[.13667,.63667,0,0,.77778],10933:[.25142,.75726,0,0,.77778],10934:[.25142,.75726,0,0,.77778],10935:[.26167,.75726,0,0,.77778],10936:[.26167,.75726,0,0,.77778],10937:[.26167,.75726,0,0,.77778],10938:[.26167,.75726,0,0,.77778],10949:[.25583,.75583,0,0,.77778],10950:[.25583,.75583,0,0,.77778],10955:[.28481,.79383,0,0,.77778],10956:[.28481,.79383,0,0,.77778],57350:[.08167,.58167,0,0,.22222],57351:[.08167,.58167,0,0,.38889],57352:[.08167,.58167,0,0,.77778],57353:[0,.43056,.04028,0,.66667],57356:[.25142,.75726,0,0,.77778],57357:[.25142,.75726,0,0,.77778],57358:[.41951,.91951,0,0,.77778],57359:[.30274,.79383,0,0,.77778],57360:[.30274,.79383,0,0,.77778],57361:[.41951,.91951,0,0,.77778],57366:[.25142,.75726,0,0,.77778],57367:[.25142,.75726,0,0,.77778],57368:[.25142,.75726,0,0,.77778],57369:[.25142,.75726,0,0,.77778],57370:[.13597,.63597,0,0,.77778],57371:[.13597,.63597,0,0,.77778]},"Caligraphic-Regular":{32:[0,0,0,0,.25],65:[0,.68333,0,.19445,.79847],66:[0,.68333,.03041,.13889,.65681],67:[0,.68333,.05834,.13889,.52653],68:[0,.68333,.02778,.08334,.77139],69:[0,.68333,.08944,.11111,.52778],70:[0,.68333,.09931,.11111,.71875],71:[.09722,.68333,.0593,.11111,.59487],72:[0,.68333,.00965,.11111,.84452],73:[0,.68333,.07382,0,.54452],74:[.09722,.68333,.18472,.16667,.67778],75:[0,.68333,.01445,.05556,.76195],76:[0,.68333,0,.13889,.68972],77:[0,.68333,0,.13889,1.2009],78:[0,.68333,.14736,.08334,.82049],79:[0,.68333,.02778,.11111,.79611],80:[0,.68333,.08222,.08334,.69556],81:[.09722,.68333,0,.11111,.81667],82:[0,.68333,0,.08334,.8475],83:[0,.68333,.075,.13889,.60556],84:[0,.68333,.25417,0,.54464],85:[0,.68333,.09931,.08334,.62583],86:[0,.68333,.08222,0,.61278],87:[0,.68333,.08222,.08334,.98778],88:[0,.68333,.14643,.13889,.7133],89:[.09722,.68333,.08222,.08334,.66834],90:[0,.68333,.07944,.13889,.72473],160:[0,0,0,0,.25]},"Fraktur-Regular":{32:[0,0,0,0,.25],33:[0,.69141,0,0,.29574],34:[0,.69141,0,0,.21471],38:[0,.69141,0,0,.73786],39:[0,.69141,0,0,.21201],40:[.24982,.74947,0,0,.38865],41:[.24982,.74947,0,0,.38865],42:[0,.62119,0,0,.27764],43:[.08319,.58283,0,0,.75623],44:[0,.10803,0,0,.27764],45:[.08319,.58283,0,0,.75623],46:[0,.10803,0,0,.27764],47:[.24982,.74947,0,0,.50181],48:[0,.47534,0,0,.50181],49:[0,.47534,0,0,.50181],50:[0,.47534,0,0,.50181],51:[.18906,.47534,0,0,.50181],52:[.18906,.47534,0,0,.50181],53:[.18906,.47534,0,0,.50181],54:[0,.69141,0,0,.50181],55:[.18906,.47534,0,0,.50181],56:[0,.69141,0,0,.50181],57:[.18906,.47534,0,0,.50181],58:[0,.47534,0,0,.21606],59:[.12604,.47534,0,0,.21606],61:[-.13099,.36866,0,0,.75623],63:[0,.69141,0,0,.36245],65:[0,.69141,0,0,.7176],66:[0,.69141,0,0,.88397],67:[0,.69141,0,0,.61254],68:[0,.69141,0,0,.83158],69:[0,.69141,0,0,.66278],70:[.12604,.69141,0,0,.61119],71:[0,.69141,0,0,.78539],72:[.06302,.69141,0,0,.7203],73:[0,.69141,0,0,.55448],74:[.12604,.69141,0,0,.55231],75:[0,.69141,0,0,.66845],76:[0,.69141,0,0,.66602],77:[0,.69141,0,0,1.04953],78:[0,.69141,0,0,.83212],79:[0,.69141,0,0,.82699],80:[.18906,.69141,0,0,.82753],81:[.03781,.69141,0,0,.82699],82:[0,.69141,0,0,.82807],83:[0,.69141,0,0,.82861],84:[0,.69141,0,0,.66899],85:[0,.69141,0,0,.64576],86:[0,.69141,0,0,.83131],87:[0,.69141,0,0,1.04602],88:[0,.69141,0,0,.71922],89:[.18906,.69141,0,0,.83293],90:[.12604,.69141,0,0,.60201],91:[.24982,.74947,0,0,.27764],93:[.24982,.74947,0,0,.27764],94:[0,.69141,0,0,.49965],97:[0,.47534,0,0,.50046],98:[0,.69141,0,0,.51315],99:[0,.47534,0,0,.38946],100:[0,.62119,0,0,.49857],101:[0,.47534,0,0,.40053],102:[.18906,.69141,0,0,.32626],103:[.18906,.47534,0,0,.5037],104:[.18906,.69141,0,0,.52126],105:[0,.69141,0,0,.27899],106:[0,.69141,0,0,.28088],107:[0,.69141,0,0,.38946],108:[0,.69141,0,0,.27953],109:[0,.47534,0,0,.76676],110:[0,.47534,0,0,.52666],111:[0,.47534,0,0,.48885],112:[.18906,.52396,0,0,.50046],113:[.18906,.47534,0,0,.48912],114:[0,.47534,0,0,.38919],115:[0,.47534,0,0,.44266],116:[0,.62119,0,0,.33301],117:[0,.47534,0,0,.5172],118:[0,.52396,0,0,.5118],119:[0,.52396,0,0,.77351],120:[.18906,.47534,0,0,.38865],121:[.18906,.47534,0,0,.49884],122:[.18906,.47534,0,0,.39054],160:[0,0,0,0,.25],8216:[0,.69141,0,0,.21471],8217:[0,.69141,0,0,.21471],58112:[0,.62119,0,0,.49749],58113:[0,.62119,0,0,.4983],58114:[.18906,.69141,0,0,.33328],58115:[.18906,.69141,0,0,.32923],58116:[.18906,.47534,0,0,.50343],58117:[0,.69141,0,0,.33301],58118:[0,.62119,0,0,.33409],58119:[0,.47534,0,0,.50073]},"Main-Bold":{32:[0,0,0,0,.25],33:[0,.69444,0,0,.35],34:[0,.69444,0,0,.60278],35:[.19444,.69444,0,0,.95833],36:[.05556,.75,0,0,.575],37:[.05556,.75,0,0,.95833],38:[0,.69444,0,0,.89444],39:[0,.69444,0,0,.31944],40:[.25,.75,0,0,.44722],41:[.25,.75,0,0,.44722],42:[0,.75,0,0,.575],43:[.13333,.63333,0,0,.89444],44:[.19444,.15556,0,0,.31944],45:[0,.44444,0,0,.38333],46:[0,.15556,0,0,.31944],47:[.25,.75,0,0,.575],48:[0,.64444,0,0,.575],49:[0,.64444,0,0,.575],50:[0,.64444,0,0,.575],51:[0,.64444,0,0,.575],52:[0,.64444,0,0,.575],53:[0,.64444,0,0,.575],54:[0,.64444,0,0,.575],55:[0,.64444,0,0,.575],56:[0,.64444,0,0,.575],57:[0,.64444,0,0,.575],58:[0,.44444,0,0,.31944],59:[.19444,.44444,0,0,.31944],60:[.08556,.58556,0,0,.89444],61:[-.10889,.39111,0,0,.89444],62:[.08556,.58556,0,0,.89444],63:[0,.69444,0,0,.54305],64:[0,.69444,0,0,.89444],65:[0,.68611,0,0,.86944],66:[0,.68611,0,0,.81805],67:[0,.68611,0,0,.83055],68:[0,.68611,0,0,.88194],69:[0,.68611,0,0,.75555],70:[0,.68611,0,0,.72361],71:[0,.68611,0,0,.90416],72:[0,.68611,0,0,.9],73:[0,.68611,0,0,.43611],74:[0,.68611,0,0,.59444],75:[0,.68611,0,0,.90138],76:[0,.68611,0,0,.69166],77:[0,.68611,0,0,1.09166],78:[0,.68611,0,0,.9],79:[0,.68611,0,0,.86388],80:[0,.68611,0,0,.78611],81:[.19444,.68611,0,0,.86388],82:[0,.68611,0,0,.8625],83:[0,.68611,0,0,.63889],84:[0,.68611,0,0,.8],85:[0,.68611,0,0,.88472],86:[0,.68611,.01597,0,.86944],87:[0,.68611,.01597,0,1.18888],88:[0,.68611,0,0,.86944],89:[0,.68611,.02875,0,.86944],90:[0,.68611,0,0,.70277],91:[.25,.75,0,0,.31944],92:[.25,.75,0,0,.575],93:[.25,.75,0,0,.31944],94:[0,.69444,0,0,.575],95:[.31,.13444,.03194,0,.575],97:[0,.44444,0,0,.55902],98:[0,.69444,0,0,.63889],99:[0,.44444,0,0,.51111],100:[0,.69444,0,0,.63889],101:[0,.44444,0,0,.52708],102:[0,.69444,.10903,0,.35139],103:[.19444,.44444,.01597,0,.575],104:[0,.69444,0,0,.63889],105:[0,.69444,0,0,.31944],106:[.19444,.69444,0,0,.35139],107:[0,.69444,0,0,.60694],108:[0,.69444,0,0,.31944],109:[0,.44444,0,0,.95833],110:[0,.44444,0,0,.63889],111:[0,.44444,0,0,.575],112:[.19444,.44444,0,0,.63889],113:[.19444,.44444,0,0,.60694],114:[0,.44444,0,0,.47361],115:[0,.44444,0,0,.45361],116:[0,.63492,0,0,.44722],117:[0,.44444,0,0,.63889],118:[0,.44444,.01597,0,.60694],119:[0,.44444,.01597,0,.83055],120:[0,.44444,0,0,.60694],121:[.19444,.44444,.01597,0,.60694],122:[0,.44444,0,0,.51111],123:[.25,.75,0,0,.575],124:[.25,.75,0,0,.31944],125:[.25,.75,0,0,.575],126:[.35,.34444,0,0,.575],160:[0,0,0,0,.25],163:[0,.69444,0,0,.86853],168:[0,.69444,0,0,.575],172:[0,.44444,0,0,.76666],176:[0,.69444,0,0,.86944],177:[.13333,.63333,0,0,.89444],184:[.17014,0,0,0,.51111],198:[0,.68611,0,0,1.04166],215:[.13333,.63333,0,0,.89444],216:[.04861,.73472,0,0,.89444],223:[0,.69444,0,0,.59722],230:[0,.44444,0,0,.83055],247:[.13333,.63333,0,0,.89444],248:[.09722,.54167,0,0,.575],305:[0,.44444,0,0,.31944],338:[0,.68611,0,0,1.16944],339:[0,.44444,0,0,.89444],567:[.19444,.44444,0,0,.35139],710:[0,.69444,0,0,.575],711:[0,.63194,0,0,.575],713:[0,.59611,0,0,.575],714:[0,.69444,0,0,.575],715:[0,.69444,0,0,.575],728:[0,.69444,0,0,.575],729:[0,.69444,0,0,.31944],730:[0,.69444,0,0,.86944],732:[0,.69444,0,0,.575],733:[0,.69444,0,0,.575],915:[0,.68611,0,0,.69166],916:[0,.68611,0,0,.95833],920:[0,.68611,0,0,.89444],923:[0,.68611,0,0,.80555],926:[0,.68611,0,0,.76666],928:[0,.68611,0,0,.9],931:[0,.68611,0,0,.83055],933:[0,.68611,0,0,.89444],934:[0,.68611,0,0,.83055],936:[0,.68611,0,0,.89444],937:[0,.68611,0,0,.83055],8211:[0,.44444,.03194,0,.575],8212:[0,.44444,.03194,0,1.14999],8216:[0,.69444,0,0,.31944],8217:[0,.69444,0,0,.31944],8220:[0,.69444,0,0,.60278],8221:[0,.69444,0,0,.60278],8224:[.19444,.69444,0,0,.51111],8225:[.19444,.69444,0,0,.51111],8242:[0,.55556,0,0,.34444],8407:[0,.72444,.15486,0,.575],8463:[0,.69444,0,0,.66759],8465:[0,.69444,0,0,.83055],8467:[0,.69444,0,0,.47361],8472:[.19444,.44444,0,0,.74027],8476:[0,.69444,0,0,.83055],8501:[0,.69444,0,0,.70277],8592:[-.10889,.39111,0,0,1.14999],8593:[.19444,.69444,0,0,.575],8594:[-.10889,.39111,0,0,1.14999],8595:[.19444,.69444,0,0,.575],8596:[-.10889,.39111,0,0,1.14999],8597:[.25,.75,0,0,.575],8598:[.19444,.69444,0,0,1.14999],8599:[.19444,.69444,0,0,1.14999],8600:[.19444,.69444,0,0,1.14999],8601:[.19444,.69444,0,0,1.14999],8636:[-.10889,.39111,0,0,1.14999],8637:[-.10889,.39111,0,0,1.14999],8640:[-.10889,.39111,0,0,1.14999],8641:[-.10889,.39111,0,0,1.14999],8656:[-.10889,.39111,0,0,1.14999],8657:[.19444,.69444,0,0,.70277],8658:[-.10889,.39111,0,0,1.14999],8659:[.19444,.69444,0,0,.70277],8660:[-.10889,.39111,0,0,1.14999],8661:[.25,.75,0,0,.70277],8704:[0,.69444,0,0,.63889],8706:[0,.69444,.06389,0,.62847],8707:[0,.69444,0,0,.63889],8709:[.05556,.75,0,0,.575],8711:[0,.68611,0,0,.95833],8712:[.08556,.58556,0,0,.76666],8715:[.08556,.58556,0,0,.76666],8722:[.13333,.63333,0,0,.89444],8723:[.13333,.63333,0,0,.89444],8725:[.25,.75,0,0,.575],8726:[.25,.75,0,0,.575],8727:[-.02778,.47222,0,0,.575],8728:[-.02639,.47361,0,0,.575],8729:[-.02639,.47361,0,0,.575],8730:[.18,.82,0,0,.95833],8733:[0,.44444,0,0,.89444],8734:[0,.44444,0,0,1.14999],8736:[0,.69224,0,0,.72222],8739:[.25,.75,0,0,.31944],8741:[.25,.75,0,0,.575],8743:[0,.55556,0,0,.76666],8744:[0,.55556,0,0,.76666],8745:[0,.55556,0,0,.76666],8746:[0,.55556,0,0,.76666],8747:[.19444,.69444,.12778,0,.56875],8764:[-.10889,.39111,0,0,.89444],8768:[.19444,.69444,0,0,.31944],8771:[.00222,.50222,0,0,.89444],8773:[.027,.638,0,0,.894],8776:[.02444,.52444,0,0,.89444],8781:[.00222,.50222,0,0,.89444],8801:[.00222,.50222,0,0,.89444],8804:[.19667,.69667,0,0,.89444],8805:[.19667,.69667,0,0,.89444],8810:[.08556,.58556,0,0,1.14999],8811:[.08556,.58556,0,0,1.14999],8826:[.08556,.58556,0,0,.89444],8827:[.08556,.58556,0,0,.89444],8834:[.08556,.58556,0,0,.89444],8835:[.08556,.58556,0,0,.89444],8838:[.19667,.69667,0,0,.89444],8839:[.19667,.69667,0,0,.89444],8846:[0,.55556,0,0,.76666],8849:[.19667,.69667,0,0,.89444],8850:[.19667,.69667,0,0,.89444],8851:[0,.55556,0,0,.76666],8852:[0,.55556,0,0,.76666],8853:[.13333,.63333,0,0,.89444],8854:[.13333,.63333,0,0,.89444],8855:[.13333,.63333,0,0,.89444],8856:[.13333,.63333,0,0,.89444],8857:[.13333,.63333,0,0,.89444],8866:[0,.69444,0,0,.70277],8867:[0,.69444,0,0,.70277],8868:[0,.69444,0,0,.89444],8869:[0,.69444,0,0,.89444],8900:[-.02639,.47361,0,0,.575],8901:[-.02639,.47361,0,0,.31944],8902:[-.02778,.47222,0,0,.575],8968:[.25,.75,0,0,.51111],8969:[.25,.75,0,0,.51111],8970:[.25,.75,0,0,.51111],8971:[.25,.75,0,0,.51111],8994:[-.13889,.36111,0,0,1.14999],8995:[-.13889,.36111,0,0,1.14999],9651:[.19444,.69444,0,0,1.02222],9657:[-.02778,.47222,0,0,.575],9661:[.19444,.69444,0,0,1.02222],9667:[-.02778,.47222,0,0,.575],9711:[.19444,.69444,0,0,1.14999],9824:[.12963,.69444,0,0,.89444],9825:[.12963,.69444,0,0,.89444],9826:[.12963,.69444,0,0,.89444],9827:[.12963,.69444,0,0,.89444],9837:[0,.75,0,0,.44722],9838:[.19444,.69444,0,0,.44722],9839:[.19444,.69444,0,0,.44722],10216:[.25,.75,0,0,.44722],10217:[.25,.75,0,0,.44722],10815:[0,.68611,0,0,.9],10927:[.19667,.69667,0,0,.89444],10928:[.19667,.69667,0,0,.89444],57376:[.19444,.69444,0,0,0]},"Main-BoldItalic":{32:[0,0,0,0,.25],33:[0,.69444,.11417,0,.38611],34:[0,.69444,.07939,0,.62055],35:[.19444,.69444,.06833,0,.94444],37:[.05556,.75,.12861,0,.94444],38:[0,.69444,.08528,0,.88555],39:[0,.69444,.12945,0,.35555],40:[.25,.75,.15806,0,.47333],41:[.25,.75,.03306,0,.47333],42:[0,.75,.14333,0,.59111],43:[.10333,.60333,.03306,0,.88555],44:[.19444,.14722,0,0,.35555],45:[0,.44444,.02611,0,.41444],46:[0,.14722,0,0,.35555],47:[.25,.75,.15806,0,.59111],48:[0,.64444,.13167,0,.59111],49:[0,.64444,.13167,0,.59111],50:[0,.64444,.13167,0,.59111],51:[0,.64444,.13167,0,.59111],52:[.19444,.64444,.13167,0,.59111],53:[0,.64444,.13167,0,.59111],54:[0,.64444,.13167,0,.59111],55:[.19444,.64444,.13167,0,.59111],56:[0,.64444,.13167,0,.59111],57:[0,.64444,.13167,0,.59111],58:[0,.44444,.06695,0,.35555],59:[.19444,.44444,.06695,0,.35555],61:[-.10889,.39111,.06833,0,.88555],63:[0,.69444,.11472,0,.59111],64:[0,.69444,.09208,0,.88555],65:[0,.68611,0,0,.86555],66:[0,.68611,.0992,0,.81666],67:[0,.68611,.14208,0,.82666],68:[0,.68611,.09062,0,.87555],69:[0,.68611,.11431,0,.75666],70:[0,.68611,.12903,0,.72722],71:[0,.68611,.07347,0,.89527],72:[0,.68611,.17208,0,.8961],73:[0,.68611,.15681,0,.47166],74:[0,.68611,.145,0,.61055],75:[0,.68611,.14208,0,.89499],76:[0,.68611,0,0,.69777],77:[0,.68611,.17208,0,1.07277],78:[0,.68611,.17208,0,.8961],79:[0,.68611,.09062,0,.85499],80:[0,.68611,.0992,0,.78721],81:[.19444,.68611,.09062,0,.85499],82:[0,.68611,.02559,0,.85944],83:[0,.68611,.11264,0,.64999],84:[0,.68611,.12903,0,.7961],85:[0,.68611,.17208,0,.88083],86:[0,.68611,.18625,0,.86555],87:[0,.68611,.18625,0,1.15999],88:[0,.68611,.15681,0,.86555],89:[0,.68611,.19803,0,.86555],90:[0,.68611,.14208,0,.70888],91:[.25,.75,.1875,0,.35611],93:[.25,.75,.09972,0,.35611],94:[0,.69444,.06709,0,.59111],95:[.31,.13444,.09811,0,.59111],97:[0,.44444,.09426,0,.59111],98:[0,.69444,.07861,0,.53222],99:[0,.44444,.05222,0,.53222],100:[0,.69444,.10861,0,.59111],101:[0,.44444,.085,0,.53222],102:[.19444,.69444,.21778,0,.4],103:[.19444,.44444,.105,0,.53222],104:[0,.69444,.09426,0,.59111],105:[0,.69326,.11387,0,.35555],106:[.19444,.69326,.1672,0,.35555],107:[0,.69444,.11111,0,.53222],108:[0,.69444,.10861,0,.29666],109:[0,.44444,.09426,0,.94444],110:[0,.44444,.09426,0,.64999],111:[0,.44444,.07861,0,.59111],112:[.19444,.44444,.07861,0,.59111],113:[.19444,.44444,.105,0,.53222],114:[0,.44444,.11111,0,.50167],115:[0,.44444,.08167,0,.48694],116:[0,.63492,.09639,0,.385],117:[0,.44444,.09426,0,.62055],118:[0,.44444,.11111,0,.53222],119:[0,.44444,.11111,0,.76777],120:[0,.44444,.12583,0,.56055],121:[.19444,.44444,.105,0,.56166],122:[0,.44444,.13889,0,.49055],126:[.35,.34444,.11472,0,.59111],160:[0,0,0,0,.25],168:[0,.69444,.11473,0,.59111],176:[0,.69444,0,0,.94888],184:[.17014,0,0,0,.53222],198:[0,.68611,.11431,0,1.02277],216:[.04861,.73472,.09062,0,.88555],223:[.19444,.69444,.09736,0,.665],230:[0,.44444,.085,0,.82666],248:[.09722,.54167,.09458,0,.59111],305:[0,.44444,.09426,0,.35555],338:[0,.68611,.11431,0,1.14054],339:[0,.44444,.085,0,.82666],567:[.19444,.44444,.04611,0,.385],710:[0,.69444,.06709,0,.59111],711:[0,.63194,.08271,0,.59111],713:[0,.59444,.10444,0,.59111],714:[0,.69444,.08528,0,.59111],715:[0,.69444,0,0,.59111],728:[0,.69444,.10333,0,.59111],729:[0,.69444,.12945,0,.35555],730:[0,.69444,0,0,.94888],732:[0,.69444,.11472,0,.59111],733:[0,.69444,.11472,0,.59111],915:[0,.68611,.12903,0,.69777],916:[0,.68611,0,0,.94444],920:[0,.68611,.09062,0,.88555],923:[0,.68611,0,0,.80666],926:[0,.68611,.15092,0,.76777],928:[0,.68611,.17208,0,.8961],931:[0,.68611,.11431,0,.82666],933:[0,.68611,.10778,0,.88555],934:[0,.68611,.05632,0,.82666],936:[0,.68611,.10778,0,.88555],937:[0,.68611,.0992,0,.82666],8211:[0,.44444,.09811,0,.59111],8212:[0,.44444,.09811,0,1.18221],8216:[0,.69444,.12945,0,.35555],8217:[0,.69444,.12945,0,.35555],8220:[0,.69444,.16772,0,.62055],8221:[0,.69444,.07939,0,.62055]},"Main-Italic":{32:[0,0,0,0,.25],33:[0,.69444,.12417,0,.30667],34:[0,.69444,.06961,0,.51444],35:[.19444,.69444,.06616,0,.81777],37:[.05556,.75,.13639,0,.81777],38:[0,.69444,.09694,0,.76666],39:[0,.69444,.12417,0,.30667],40:[.25,.75,.16194,0,.40889],41:[.25,.75,.03694,0,.40889],42:[0,.75,.14917,0,.51111],43:[.05667,.56167,.03694,0,.76666],44:[.19444,.10556,0,0,.30667],45:[0,.43056,.02826,0,.35778],46:[0,.10556,0,0,.30667],47:[.25,.75,.16194,0,.51111],48:[0,.64444,.13556,0,.51111],49:[0,.64444,.13556,0,.51111],50:[0,.64444,.13556,0,.51111],51:[0,.64444,.13556,0,.51111],52:[.19444,.64444,.13556,0,.51111],53:[0,.64444,.13556,0,.51111],54:[0,.64444,.13556,0,.51111],55:[.19444,.64444,.13556,0,.51111],56:[0,.64444,.13556,0,.51111],57:[0,.64444,.13556,0,.51111],58:[0,.43056,.0582,0,.30667],59:[.19444,.43056,.0582,0,.30667],61:[-.13313,.36687,.06616,0,.76666],63:[0,.69444,.1225,0,.51111],64:[0,.69444,.09597,0,.76666],65:[0,.68333,0,0,.74333],66:[0,.68333,.10257,0,.70389],67:[0,.68333,.14528,0,.71555],68:[0,.68333,.09403,0,.755],69:[0,.68333,.12028,0,.67833],70:[0,.68333,.13305,0,.65277],71:[0,.68333,.08722,0,.77361],72:[0,.68333,.16389,0,.74333],73:[0,.68333,.15806,0,.38555],74:[0,.68333,.14028,0,.525],75:[0,.68333,.14528,0,.76888],76:[0,.68333,0,0,.62722],77:[0,.68333,.16389,0,.89666],78:[0,.68333,.16389,0,.74333],79:[0,.68333,.09403,0,.76666],80:[0,.68333,.10257,0,.67833],81:[.19444,.68333,.09403,0,.76666],82:[0,.68333,.03868,0,.72944],83:[0,.68333,.11972,0,.56222],84:[0,.68333,.13305,0,.71555],85:[0,.68333,.16389,0,.74333],86:[0,.68333,.18361,0,.74333],87:[0,.68333,.18361,0,.99888],88:[0,.68333,.15806,0,.74333],89:[0,.68333,.19383,0,.74333],90:[0,.68333,.14528,0,.61333],91:[.25,.75,.1875,0,.30667],93:[.25,.75,.10528,0,.30667],94:[0,.69444,.06646,0,.51111],95:[.31,.12056,.09208,0,.51111],97:[0,.43056,.07671,0,.51111],98:[0,.69444,.06312,0,.46],99:[0,.43056,.05653,0,.46],100:[0,.69444,.10333,0,.51111],101:[0,.43056,.07514,0,.46],102:[.19444,.69444,.21194,0,.30667],103:[.19444,.43056,.08847,0,.46],104:[0,.69444,.07671,0,.51111],105:[0,.65536,.1019,0,.30667],106:[.19444,.65536,.14467,0,.30667],107:[0,.69444,.10764,0,.46],108:[0,.69444,.10333,0,.25555],109:[0,.43056,.07671,0,.81777],110:[0,.43056,.07671,0,.56222],111:[0,.43056,.06312,0,.51111],112:[.19444,.43056,.06312,0,.51111],113:[.19444,.43056,.08847,0,.46],114:[0,.43056,.10764,0,.42166],115:[0,.43056,.08208,0,.40889],116:[0,.61508,.09486,0,.33222],117:[0,.43056,.07671,0,.53666],118:[0,.43056,.10764,0,.46],119:[0,.43056,.10764,0,.66444],120:[0,.43056,.12042,0,.46389],121:[.19444,.43056,.08847,0,.48555],122:[0,.43056,.12292,0,.40889],126:[.35,.31786,.11585,0,.51111],160:[0,0,0,0,.25],168:[0,.66786,.10474,0,.51111],176:[0,.69444,0,0,.83129],184:[.17014,0,0,0,.46],198:[0,.68333,.12028,0,.88277],216:[.04861,.73194,.09403,0,.76666],223:[.19444,.69444,.10514,0,.53666],230:[0,.43056,.07514,0,.71555],248:[.09722,.52778,.09194,0,.51111],338:[0,.68333,.12028,0,.98499],339:[0,.43056,.07514,0,.71555],710:[0,.69444,.06646,0,.51111],711:[0,.62847,.08295,0,.51111],713:[0,.56167,.10333,0,.51111],714:[0,.69444,.09694,0,.51111],715:[0,.69444,0,0,.51111],728:[0,.69444,.10806,0,.51111],729:[0,.66786,.11752,0,.30667],730:[0,.69444,0,0,.83129],732:[0,.66786,.11585,0,.51111],733:[0,.69444,.1225,0,.51111],915:[0,.68333,.13305,0,.62722],916:[0,.68333,0,0,.81777],920:[0,.68333,.09403,0,.76666],923:[0,.68333,0,0,.69222],926:[0,.68333,.15294,0,.66444],928:[0,.68333,.16389,0,.74333],931:[0,.68333,.12028,0,.71555],933:[0,.68333,.11111,0,.76666],934:[0,.68333,.05986,0,.71555],936:[0,.68333,.11111,0,.76666],937:[0,.68333,.10257,0,.71555],8211:[0,.43056,.09208,0,.51111],8212:[0,.43056,.09208,0,1.02222],8216:[0,.69444,.12417,0,.30667],8217:[0,.69444,.12417,0,.30667],8220:[0,.69444,.1685,0,.51444],8221:[0,.69444,.06961,0,.51444],8463:[0,.68889,0,0,.54028]},"Main-Regular":{32:[0,0,0,0,.25],33:[0,.69444,0,0,.27778],34:[0,.69444,0,0,.5],35:[.19444,.69444,0,0,.83334],36:[.05556,.75,0,0,.5],37:[.05556,.75,0,0,.83334],38:[0,.69444,0,0,.77778],39:[0,.69444,0,0,.27778],40:[.25,.75,0,0,.38889],41:[.25,.75,0,0,.38889],42:[0,.75,0,0,.5],43:[.08333,.58333,0,0,.77778],44:[.19444,.10556,0,0,.27778],45:[0,.43056,0,0,.33333],46:[0,.10556,0,0,.27778],47:[.25,.75,0,0,.5],48:[0,.64444,0,0,.5],49:[0,.64444,0,0,.5],50:[0,.64444,0,0,.5],51:[0,.64444,0,0,.5],52:[0,.64444,0,0,.5],53:[0,.64444,0,0,.5],54:[0,.64444,0,0,.5],55:[0,.64444,0,0,.5],56:[0,.64444,0,0,.5],57:[0,.64444,0,0,.5],58:[0,.43056,0,0,.27778],59:[.19444,.43056,0,0,.27778],60:[.0391,.5391,0,0,.77778],61:[-.13313,.36687,0,0,.77778],62:[.0391,.5391,0,0,.77778],63:[0,.69444,0,0,.47222],64:[0,.69444,0,0,.77778],65:[0,.68333,0,0,.75],66:[0,.68333,0,0,.70834],67:[0,.68333,0,0,.72222],68:[0,.68333,0,0,.76389],69:[0,.68333,0,0,.68056],70:[0,.68333,0,0,.65278],71:[0,.68333,0,0,.78472],72:[0,.68333,0,0,.75],73:[0,.68333,0,0,.36111],74:[0,.68333,0,0,.51389],75:[0,.68333,0,0,.77778],76:[0,.68333,0,0,.625],77:[0,.68333,0,0,.91667],78:[0,.68333,0,0,.75],79:[0,.68333,0,0,.77778],80:[0,.68333,0,0,.68056],81:[.19444,.68333,0,0,.77778],82:[0,.68333,0,0,.73611],83:[0,.68333,0,0,.55556],84:[0,.68333,0,0,.72222],85:[0,.68333,0,0,.75],86:[0,.68333,.01389,0,.75],87:[0,.68333,.01389,0,1.02778],88:[0,.68333,0,0,.75],89:[0,.68333,.025,0,.75],90:[0,.68333,0,0,.61111],91:[.25,.75,0,0,.27778],92:[.25,.75,0,0,.5],93:[.25,.75,0,0,.27778],94:[0,.69444,0,0,.5],95:[.31,.12056,.02778,0,.5],97:[0,.43056,0,0,.5],98:[0,.69444,0,0,.55556],99:[0,.43056,0,0,.44445],100:[0,.69444,0,0,.55556],101:[0,.43056,0,0,.44445],102:[0,.69444,.07778,0,.30556],103:[.19444,.43056,.01389,0,.5],104:[0,.69444,0,0,.55556],105:[0,.66786,0,0,.27778],106:[.19444,.66786,0,0,.30556],107:[0,.69444,0,0,.52778],108:[0,.69444,0,0,.27778],109:[0,.43056,0,0,.83334],110:[0,.43056,0,0,.55556],111:[0,.43056,0,0,.5],112:[.19444,.43056,0,0,.55556],113:[.19444,.43056,0,0,.52778],114:[0,.43056,0,0,.39167],115:[0,.43056,0,0,.39445],116:[0,.61508,0,0,.38889],117:[0,.43056,0,0,.55556],118:[0,.43056,.01389,0,.52778],119:[0,.43056,.01389,0,.72222],120:[0,.43056,0,0,.52778],121:[.19444,.43056,.01389,0,.52778],122:[0,.43056,0,0,.44445],123:[.25,.75,0,0,.5],124:[.25,.75,0,0,.27778],125:[.25,.75,0,0,.5],126:[.35,.31786,0,0,.5],160:[0,0,0,0,.25],163:[0,.69444,0,0,.76909],167:[.19444,.69444,0,0,.44445],168:[0,.66786,0,0,.5],172:[0,.43056,0,0,.66667],176:[0,.69444,0,0,.75],177:[.08333,.58333,0,0,.77778],182:[.19444,.69444,0,0,.61111],184:[.17014,0,0,0,.44445],198:[0,.68333,0,0,.90278],215:[.08333,.58333,0,0,.77778],216:[.04861,.73194,0,0,.77778],223:[0,.69444,0,0,.5],230:[0,.43056,0,0,.72222],247:[.08333,.58333,0,0,.77778],248:[.09722,.52778,0,0,.5],305:[0,.43056,0,0,.27778],338:[0,.68333,0,0,1.01389],339:[0,.43056,0,0,.77778],567:[.19444,.43056,0,0,.30556],710:[0,.69444,0,0,.5],711:[0,.62847,0,0,.5],713:[0,.56778,0,0,.5],714:[0,.69444,0,0,.5],715:[0,.69444,0,0,.5],728:[0,.69444,0,0,.5],729:[0,.66786,0,0,.27778],730:[0,.69444,0,0,.75],732:[0,.66786,0,0,.5],733:[0,.69444,0,0,.5],915:[0,.68333,0,0,.625],916:[0,.68333,0,0,.83334],920:[0,.68333,0,0,.77778],923:[0,.68333,0,0,.69445],926:[0,.68333,0,0,.66667],928:[0,.68333,0,0,.75],931:[0,.68333,0,0,.72222],933:[0,.68333,0,0,.77778],934:[0,.68333,0,0,.72222],936:[0,.68333,0,0,.77778],937:[0,.68333,0,0,.72222],8211:[0,.43056,.02778,0,.5],8212:[0,.43056,.02778,0,1],8216:[0,.69444,0,0,.27778],8217:[0,.69444,0,0,.27778],8220:[0,.69444,0,0,.5],8221:[0,.69444,0,0,.5],8224:[.19444,.69444,0,0,.44445],8225:[.19444,.69444,0,0,.44445],8230:[0,.123,0,0,1.172],8242:[0,.55556,0,0,.275],8407:[0,.71444,.15382,0,.5],8463:[0,.68889,0,0,.54028],8465:[0,.69444,0,0,.72222],8467:[0,.69444,0,.11111,.41667],8472:[.19444,.43056,0,.11111,.63646],8476:[0,.69444,0,0,.72222],8501:[0,.69444,0,0,.61111],8592:[-.13313,.36687,0,0,1],8593:[.19444,.69444,0,0,.5],8594:[-.13313,.36687,0,0,1],8595:[.19444,.69444,0,0,.5],8596:[-.13313,.36687,0,0,1],8597:[.25,.75,0,0,.5],8598:[.19444,.69444,0,0,1],8599:[.19444,.69444,0,0,1],8600:[.19444,.69444,0,0,1],8601:[.19444,.69444,0,0,1],8614:[.011,.511,0,0,1],8617:[.011,.511,0,0,1.126],8618:[.011,.511,0,0,1.126],8636:[-.13313,.36687,0,0,1],8637:[-.13313,.36687,0,0,1],8640:[-.13313,.36687,0,0,1],8641:[-.13313,.36687,0,0,1],8652:[.011,.671,0,0,1],8656:[-.13313,.36687,0,0,1],8657:[.19444,.69444,0,0,.61111],8658:[-.13313,.36687,0,0,1],8659:[.19444,.69444,0,0,.61111],8660:[-.13313,.36687,0,0,1],8661:[.25,.75,0,0,.61111],8704:[0,.69444,0,0,.55556],8706:[0,.69444,.05556,.08334,.5309],8707:[0,.69444,0,0,.55556],8709:[.05556,.75,0,0,.5],8711:[0,.68333,0,0,.83334],8712:[.0391,.5391,0,0,.66667],8715:[.0391,.5391,0,0,.66667],8722:[.08333,.58333,0,0,.77778],8723:[.08333,.58333,0,0,.77778],8725:[.25,.75,0,0,.5],8726:[.25,.75,0,0,.5],8727:[-.03472,.46528,0,0,.5],8728:[-.05555,.44445,0,0,.5],8729:[-.05555,.44445,0,0,.5],8730:[.2,.8,0,0,.83334],8733:[0,.43056,0,0,.77778],8734:[0,.43056,0,0,1],8736:[0,.69224,0,0,.72222],8739:[.25,.75,0,0,.27778],8741:[.25,.75,0,0,.5],8743:[0,.55556,0,0,.66667],8744:[0,.55556,0,0,.66667],8745:[0,.55556,0,0,.66667],8746:[0,.55556,0,0,.66667],8747:[.19444,.69444,.11111,0,.41667],8764:[-.13313,.36687,0,0,.77778],8768:[.19444,.69444,0,0,.27778],8771:[-.03625,.46375,0,0,.77778],8773:[-.022,.589,0,0,.778],8776:[-.01688,.48312,0,0,.77778],8781:[-.03625,.46375,0,0,.77778],8784:[-.133,.673,0,0,.778],8801:[-.03625,.46375,0,0,.77778],8804:[.13597,.63597,0,0,.77778],8805:[.13597,.63597,0,0,.77778],8810:[.0391,.5391,0,0,1],8811:[.0391,.5391,0,0,1],8826:[.0391,.5391,0,0,.77778],8827:[.0391,.5391,0,0,.77778],8834:[.0391,.5391,0,0,.77778],8835:[.0391,.5391,0,0,.77778],8838:[.13597,.63597,0,0,.77778],8839:[.13597,.63597,0,0,.77778],8846:[0,.55556,0,0,.66667],8849:[.13597,.63597,0,0,.77778],8850:[.13597,.63597,0,0,.77778],8851:[0,.55556,0,0,.66667],8852:[0,.55556,0,0,.66667],8853:[.08333,.58333,0,0,.77778],8854:[.08333,.58333,0,0,.77778],8855:[.08333,.58333,0,0,.77778],8856:[.08333,.58333,0,0,.77778],8857:[.08333,.58333,0,0,.77778],8866:[0,.69444,0,0,.61111],8867:[0,.69444,0,0,.61111],8868:[0,.69444,0,0,.77778],8869:[0,.69444,0,0,.77778],8872:[.249,.75,0,0,.867],8900:[-.05555,.44445,0,0,.5],8901:[-.05555,.44445,0,0,.27778],8902:[-.03472,.46528,0,0,.5],8904:[.005,.505,0,0,.9],8942:[.03,.903,0,0,.278],8943:[-.19,.313,0,0,1.172],8945:[-.1,.823,0,0,1.282],8968:[.25,.75,0,0,.44445],8969:[.25,.75,0,0,.44445],8970:[.25,.75,0,0,.44445],8971:[.25,.75,0,0,.44445],8994:[-.14236,.35764,0,0,1],8995:[-.14236,.35764,0,0,1],9136:[.244,.744,0,0,.412],9137:[.244,.745,0,0,.412],9651:[.19444,.69444,0,0,.88889],9657:[-.03472,.46528,0,0,.5],9661:[.19444,.69444,0,0,.88889],9667:[-.03472,.46528,0,0,.5],9711:[.19444,.69444,0,0,1],9824:[.12963,.69444,0,0,.77778],9825:[.12963,.69444,0,0,.77778],9826:[.12963,.69444,0,0,.77778],9827:[.12963,.69444,0,0,.77778],9837:[0,.75,0,0,.38889],9838:[.19444,.69444,0,0,.38889],9839:[.19444,.69444,0,0,.38889],10216:[.25,.75,0,0,.38889],10217:[.25,.75,0,0,.38889],10222:[.244,.744,0,0,.412],10223:[.244,.745,0,0,.412],10229:[.011,.511,0,0,1.609],10230:[.011,.511,0,0,1.638],10231:[.011,.511,0,0,1.859],10232:[.024,.525,0,0,1.609],10233:[.024,.525,0,0,1.638],10234:[.024,.525,0,0,1.858],10236:[.011,.511,0,0,1.638],10815:[0,.68333,0,0,.75],10927:[.13597,.63597,0,0,.77778],10928:[.13597,.63597,0,0,.77778],57376:[.19444,.69444,0,0,0]},"Math-BoldItalic":{32:[0,0,0,0,.25],48:[0,.44444,0,0,.575],49:[0,.44444,0,0,.575],50:[0,.44444,0,0,.575],51:[.19444,.44444,0,0,.575],52:[.19444,.44444,0,0,.575],53:[.19444,.44444,0,0,.575],54:[0,.64444,0,0,.575],55:[.19444,.44444,0,0,.575],56:[0,.64444,0,0,.575],57:[.19444,.44444,0,0,.575],65:[0,.68611,0,0,.86944],66:[0,.68611,.04835,0,.8664],67:[0,.68611,.06979,0,.81694],68:[0,.68611,.03194,0,.93812],69:[0,.68611,.05451,0,.81007],70:[0,.68611,.15972,0,.68889],71:[0,.68611,0,0,.88673],72:[0,.68611,.08229,0,.98229],73:[0,.68611,.07778,0,.51111],74:[0,.68611,.10069,0,.63125],75:[0,.68611,.06979,0,.97118],76:[0,.68611,0,0,.75555],77:[0,.68611,.11424,0,1.14201],78:[0,.68611,.11424,0,.95034],79:[0,.68611,.03194,0,.83666],80:[0,.68611,.15972,0,.72309],81:[.19444,.68611,0,0,.86861],82:[0,.68611,.00421,0,.87235],83:[0,.68611,.05382,0,.69271],84:[0,.68611,.15972,0,.63663],85:[0,.68611,.11424,0,.80027],86:[0,.68611,.25555,0,.67778],87:[0,.68611,.15972,0,1.09305],88:[0,.68611,.07778,0,.94722],89:[0,.68611,.25555,0,.67458],90:[0,.68611,.06979,0,.77257],97:[0,.44444,0,0,.63287],98:[0,.69444,0,0,.52083],99:[0,.44444,0,0,.51342],100:[0,.69444,0,0,.60972],101:[0,.44444,0,0,.55361],102:[.19444,.69444,.11042,0,.56806],103:[.19444,.44444,.03704,0,.5449],104:[0,.69444,0,0,.66759],105:[0,.69326,0,0,.4048],106:[.19444,.69326,.0622,0,.47083],107:[0,.69444,.01852,0,.6037],108:[0,.69444,.0088,0,.34815],109:[0,.44444,0,0,1.0324],110:[0,.44444,0,0,.71296],111:[0,.44444,0,0,.58472],112:[.19444,.44444,0,0,.60092],113:[.19444,.44444,.03704,0,.54213],114:[0,.44444,.03194,0,.5287],115:[0,.44444,0,0,.53125],116:[0,.63492,0,0,.41528],117:[0,.44444,0,0,.68102],118:[0,.44444,.03704,0,.56666],119:[0,.44444,.02778,0,.83148],120:[0,.44444,0,0,.65903],121:[.19444,.44444,.03704,0,.59028],122:[0,.44444,.04213,0,.55509],160:[0,0,0,0,.25],915:[0,.68611,.15972,0,.65694],916:[0,.68611,0,0,.95833],920:[0,.68611,.03194,0,.86722],923:[0,.68611,0,0,.80555],926:[0,.68611,.07458,0,.84125],928:[0,.68611,.08229,0,.98229],931:[0,.68611,.05451,0,.88507],933:[0,.68611,.15972,0,.67083],934:[0,.68611,0,0,.76666],936:[0,.68611,.11653,0,.71402],937:[0,.68611,.04835,0,.8789],945:[0,.44444,0,0,.76064],946:[.19444,.69444,.03403,0,.65972],947:[.19444,.44444,.06389,0,.59003],948:[0,.69444,.03819,0,.52222],949:[0,.44444,0,0,.52882],950:[.19444,.69444,.06215,0,.50833],951:[.19444,.44444,.03704,0,.6],952:[0,.69444,.03194,0,.5618],953:[0,.44444,0,0,.41204],954:[0,.44444,0,0,.66759],955:[0,.69444,0,0,.67083],956:[.19444,.44444,0,0,.70787],957:[0,.44444,.06898,0,.57685],958:[.19444,.69444,.03021,0,.50833],959:[0,.44444,0,0,.58472],960:[0,.44444,.03704,0,.68241],961:[.19444,.44444,0,0,.6118],962:[.09722,.44444,.07917,0,.42361],963:[0,.44444,.03704,0,.68588],964:[0,.44444,.13472,0,.52083],965:[0,.44444,.03704,0,.63055],966:[.19444,.44444,0,0,.74722],967:[.19444,.44444,0,0,.71805],968:[.19444,.69444,.03704,0,.75833],969:[0,.44444,.03704,0,.71782],977:[0,.69444,0,0,.69155],981:[.19444,.69444,0,0,.7125],982:[0,.44444,.03194,0,.975],1009:[.19444,.44444,0,0,.6118],1013:[0,.44444,0,0,.48333],57649:[0,.44444,0,0,.39352],57911:[.19444,.44444,0,0,.43889]},"Math-Italic":{32:[0,0,0,0,.25],48:[0,.43056,0,0,.5],49:[0,.43056,0,0,.5],50:[0,.43056,0,0,.5],51:[.19444,.43056,0,0,.5],52:[.19444,.43056,0,0,.5],53:[.19444,.43056,0,0,.5],54:[0,.64444,0,0,.5],55:[.19444,.43056,0,0,.5],56:[0,.64444,0,0,.5],57:[.19444,.43056,0,0,.5],65:[0,.68333,0,.13889,.75],66:[0,.68333,.05017,.08334,.75851],67:[0,.68333,.07153,.08334,.71472],68:[0,.68333,.02778,.05556,.82792],69:[0,.68333,.05764,.08334,.7382],70:[0,.68333,.13889,.08334,.64306],71:[0,.68333,0,.08334,.78625],72:[0,.68333,.08125,.05556,.83125],73:[0,.68333,.07847,.11111,.43958],74:[0,.68333,.09618,.16667,.55451],75:[0,.68333,.07153,.05556,.84931],76:[0,.68333,0,.02778,.68056],77:[0,.68333,.10903,.08334,.97014],78:[0,.68333,.10903,.08334,.80347],79:[0,.68333,.02778,.08334,.76278],80:[0,.68333,.13889,.08334,.64201],81:[.19444,.68333,0,.08334,.79056],82:[0,.68333,.00773,.08334,.75929],83:[0,.68333,.05764,.08334,.6132],84:[0,.68333,.13889,.08334,.58438],85:[0,.68333,.10903,.02778,.68278],86:[0,.68333,.22222,0,.58333],87:[0,.68333,.13889,0,.94445],88:[0,.68333,.07847,.08334,.82847],89:[0,.68333,.22222,0,.58056],90:[0,.68333,.07153,.08334,.68264],97:[0,.43056,0,0,.52859],98:[0,.69444,0,0,.42917],99:[0,.43056,0,.05556,.43276],100:[0,.69444,0,.16667,.52049],101:[0,.43056,0,.05556,.46563],102:[.19444,.69444,.10764,.16667,.48959],103:[.19444,.43056,.03588,.02778,.47697],104:[0,.69444,0,0,.57616],105:[0,.65952,0,0,.34451],106:[.19444,.65952,.05724,0,.41181],107:[0,.69444,.03148,0,.5206],108:[0,.69444,.01968,.08334,.29838],109:[0,.43056,0,0,.87801],110:[0,.43056,0,0,.60023],111:[0,.43056,0,.05556,.48472],112:[.19444,.43056,0,.08334,.50313],113:[.19444,.43056,.03588,.08334,.44641],114:[0,.43056,.02778,.05556,.45116],115:[0,.43056,0,.05556,.46875],116:[0,.61508,0,.08334,.36111],117:[0,.43056,0,.02778,.57246],118:[0,.43056,.03588,.02778,.48472],119:[0,.43056,.02691,.08334,.71592],120:[0,.43056,0,.02778,.57153],121:[.19444,.43056,.03588,.05556,.49028],122:[0,.43056,.04398,.05556,.46505],160:[0,0,0,0,.25],915:[0,.68333,.13889,.08334,.61528],916:[0,.68333,0,.16667,.83334],920:[0,.68333,.02778,.08334,.76278],923:[0,.68333,0,.16667,.69445],926:[0,.68333,.07569,.08334,.74236],928:[0,.68333,.08125,.05556,.83125],931:[0,.68333,.05764,.08334,.77986],933:[0,.68333,.13889,.05556,.58333],934:[0,.68333,0,.08334,.66667],936:[0,.68333,.11,.05556,.61222],937:[0,.68333,.05017,.08334,.7724],945:[0,.43056,.0037,.02778,.6397],946:[.19444,.69444,.05278,.08334,.56563],947:[.19444,.43056,.05556,0,.51773],948:[0,.69444,.03785,.05556,.44444],949:[0,.43056,0,.08334,.46632],950:[.19444,.69444,.07378,.08334,.4375],951:[.19444,.43056,.03588,.05556,.49653],952:[0,.69444,.02778,.08334,.46944],953:[0,.43056,0,.05556,.35394],954:[0,.43056,0,0,.57616],955:[0,.69444,0,0,.58334],956:[.19444,.43056,0,.02778,.60255],957:[0,.43056,.06366,.02778,.49398],958:[.19444,.69444,.04601,.11111,.4375],959:[0,.43056,0,.05556,.48472],960:[0,.43056,.03588,0,.57003],961:[.19444,.43056,0,.08334,.51702],962:[.09722,.43056,.07986,.08334,.36285],963:[0,.43056,.03588,0,.57141],964:[0,.43056,.1132,.02778,.43715],965:[0,.43056,.03588,.02778,.54028],966:[.19444,.43056,0,.08334,.65417],967:[.19444,.43056,0,.05556,.62569],968:[.19444,.69444,.03588,.11111,.65139],969:[0,.43056,.03588,0,.62245],977:[0,.69444,0,.08334,.59144],981:[.19444,.69444,0,.08334,.59583],982:[0,.43056,.02778,0,.82813],1009:[.19444,.43056,0,.08334,.51702],1013:[0,.43056,0,.05556,.4059],57649:[0,.43056,0,.02778,.32246],57911:[.19444,.43056,0,.08334,.38403]},"SansSerif-Bold":{32:[0,0,0,0,.25],33:[0,.69444,0,0,.36667],34:[0,.69444,0,0,.55834],35:[.19444,.69444,0,0,.91667],36:[.05556,.75,0,0,.55],37:[.05556,.75,0,0,1.02912],38:[0,.69444,0,0,.83056],39:[0,.69444,0,0,.30556],40:[.25,.75,0,0,.42778],41:[.25,.75,0,0,.42778],42:[0,.75,0,0,.55],43:[.11667,.61667,0,0,.85556],44:[.10556,.13056,0,0,.30556],45:[0,.45833,0,0,.36667],46:[0,.13056,0,0,.30556],47:[.25,.75,0,0,.55],48:[0,.69444,0,0,.55],49:[0,.69444,0,0,.55],50:[0,.69444,0,0,.55],51:[0,.69444,0,0,.55],52:[0,.69444,0,0,.55],53:[0,.69444,0,0,.55],54:[0,.69444,0,0,.55],55:[0,.69444,0,0,.55],56:[0,.69444,0,0,.55],57:[0,.69444,0,0,.55],58:[0,.45833,0,0,.30556],59:[.10556,.45833,0,0,.30556],61:[-.09375,.40625,0,0,.85556],63:[0,.69444,0,0,.51945],64:[0,.69444,0,0,.73334],65:[0,.69444,0,0,.73334],66:[0,.69444,0,0,.73334],67:[0,.69444,0,0,.70278],68:[0,.69444,0,0,.79445],69:[0,.69444,0,0,.64167],70:[0,.69444,0,0,.61111],71:[0,.69444,0,0,.73334],72:[0,.69444,0,0,.79445],73:[0,.69444,0,0,.33056],74:[0,.69444,0,0,.51945],75:[0,.69444,0,0,.76389],76:[0,.69444,0,0,.58056],77:[0,.69444,0,0,.97778],78:[0,.69444,0,0,.79445],79:[0,.69444,0,0,.79445],80:[0,.69444,0,0,.70278],81:[.10556,.69444,0,0,.79445],82:[0,.69444,0,0,.70278],83:[0,.69444,0,0,.61111],84:[0,.69444,0,0,.73334],85:[0,.69444,0,0,.76389],86:[0,.69444,.01528,0,.73334],87:[0,.69444,.01528,0,1.03889],88:[0,.69444,0,0,.73334],89:[0,.69444,.0275,0,.73334],90:[0,.69444,0,0,.67223],91:[.25,.75,0,0,.34306],93:[.25,.75,0,0,.34306],94:[0,.69444,0,0,.55],95:[.35,.10833,.03056,0,.55],97:[0,.45833,0,0,.525],98:[0,.69444,0,0,.56111],99:[0,.45833,0,0,.48889],100:[0,.69444,0,0,.56111],101:[0,.45833,0,0,.51111],102:[0,.69444,.07639,0,.33611],103:[.19444,.45833,.01528,0,.55],104:[0,.69444,0,0,.56111],105:[0,.69444,0,0,.25556],106:[.19444,.69444,0,0,.28611],107:[0,.69444,0,0,.53056],108:[0,.69444,0,0,.25556],109:[0,.45833,0,0,.86667],110:[0,.45833,0,0,.56111],111:[0,.45833,0,0,.55],112:[.19444,.45833,0,0,.56111],113:[.19444,.45833,0,0,.56111],114:[0,.45833,.01528,0,.37222],115:[0,.45833,0,0,.42167],116:[0,.58929,0,0,.40417],117:[0,.45833,0,0,.56111],118:[0,.45833,.01528,0,.5],119:[0,.45833,.01528,0,.74445],120:[0,.45833,0,0,.5],121:[.19444,.45833,.01528,0,.5],122:[0,.45833,0,0,.47639],126:[.35,.34444,0,0,.55],160:[0,0,0,0,.25],168:[0,.69444,0,0,.55],176:[0,.69444,0,0,.73334],180:[0,.69444,0,0,.55],184:[.17014,0,0,0,.48889],305:[0,.45833,0,0,.25556],567:[.19444,.45833,0,0,.28611],710:[0,.69444,0,0,.55],711:[0,.63542,0,0,.55],713:[0,.63778,0,0,.55],728:[0,.69444,0,0,.55],729:[0,.69444,0,0,.30556],730:[0,.69444,0,0,.73334],732:[0,.69444,0,0,.55],733:[0,.69444,0,0,.55],915:[0,.69444,0,0,.58056],916:[0,.69444,0,0,.91667],920:[0,.69444,0,0,.85556],923:[0,.69444,0,0,.67223],926:[0,.69444,0,0,.73334],928:[0,.69444,0,0,.79445],931:[0,.69444,0,0,.79445],933:[0,.69444,0,0,.85556],934:[0,.69444,0,0,.79445],936:[0,.69444,0,0,.85556],937:[0,.69444,0,0,.79445],8211:[0,.45833,.03056,0,.55],8212:[0,.45833,.03056,0,1.10001],8216:[0,.69444,0,0,.30556],8217:[0,.69444,0,0,.30556],8220:[0,.69444,0,0,.55834],8221:[0,.69444,0,0,.55834]},"SansSerif-Italic":{32:[0,0,0,0,.25],33:[0,.69444,.05733,0,.31945],34:[0,.69444,.00316,0,.5],35:[.19444,.69444,.05087,0,.83334],36:[.05556,.75,.11156,0,.5],37:[.05556,.75,.03126,0,.83334],38:[0,.69444,.03058,0,.75834],39:[0,.69444,.07816,0,.27778],40:[.25,.75,.13164,0,.38889],41:[.25,.75,.02536,0,.38889],42:[0,.75,.11775,0,.5],43:[.08333,.58333,.02536,0,.77778],44:[.125,.08333,0,0,.27778],45:[0,.44444,.01946,0,.33333],46:[0,.08333,0,0,.27778],47:[.25,.75,.13164,0,.5],48:[0,.65556,.11156,0,.5],49:[0,.65556,.11156,0,.5],50:[0,.65556,.11156,0,.5],51:[0,.65556,.11156,0,.5],52:[0,.65556,.11156,0,.5],53:[0,.65556,.11156,0,.5],54:[0,.65556,.11156,0,.5],55:[0,.65556,.11156,0,.5],56:[0,.65556,.11156,0,.5],57:[0,.65556,.11156,0,.5],58:[0,.44444,.02502,0,.27778],59:[.125,.44444,.02502,0,.27778],61:[-.13,.37,.05087,0,.77778],63:[0,.69444,.11809,0,.47222],64:[0,.69444,.07555,0,.66667],65:[0,.69444,0,0,.66667],66:[0,.69444,.08293,0,.66667],67:[0,.69444,.11983,0,.63889],68:[0,.69444,.07555,0,.72223],69:[0,.69444,.11983,0,.59722],70:[0,.69444,.13372,0,.56945],71:[0,.69444,.11983,0,.66667],72:[0,.69444,.08094,0,.70834],73:[0,.69444,.13372,0,.27778],74:[0,.69444,.08094,0,.47222],75:[0,.69444,.11983,0,.69445],76:[0,.69444,0,0,.54167],77:[0,.69444,.08094,0,.875],78:[0,.69444,.08094,0,.70834],79:[0,.69444,.07555,0,.73611],80:[0,.69444,.08293,0,.63889],81:[.125,.69444,.07555,0,.73611],82:[0,.69444,.08293,0,.64584],83:[0,.69444,.09205,0,.55556],84:[0,.69444,.13372,0,.68056],85:[0,.69444,.08094,0,.6875],86:[0,.69444,.1615,0,.66667],87:[0,.69444,.1615,0,.94445],88:[0,.69444,.13372,0,.66667],89:[0,.69444,.17261,0,.66667],90:[0,.69444,.11983,0,.61111],91:[.25,.75,.15942,0,.28889],93:[.25,.75,.08719,0,.28889],94:[0,.69444,.0799,0,.5],95:[.35,.09444,.08616,0,.5],97:[0,.44444,.00981,0,.48056],98:[0,.69444,.03057,0,.51667],99:[0,.44444,.08336,0,.44445],100:[0,.69444,.09483,0,.51667],101:[0,.44444,.06778,0,.44445],102:[0,.69444,.21705,0,.30556],103:[.19444,.44444,.10836,0,.5],104:[0,.69444,.01778,0,.51667],105:[0,.67937,.09718,0,.23889],106:[.19444,.67937,.09162,0,.26667],107:[0,.69444,.08336,0,.48889],108:[0,.69444,.09483,0,.23889],109:[0,.44444,.01778,0,.79445],110:[0,.44444,.01778,0,.51667],111:[0,.44444,.06613,0,.5],112:[.19444,.44444,.0389,0,.51667],113:[.19444,.44444,.04169,0,.51667],114:[0,.44444,.10836,0,.34167],115:[0,.44444,.0778,0,.38333],116:[0,.57143,.07225,0,.36111],117:[0,.44444,.04169,0,.51667],118:[0,.44444,.10836,0,.46111],119:[0,.44444,.10836,0,.68334],120:[0,.44444,.09169,0,.46111],121:[.19444,.44444,.10836,0,.46111],122:[0,.44444,.08752,0,.43472],126:[.35,.32659,.08826,0,.5],160:[0,0,0,0,.25],168:[0,.67937,.06385,0,.5],176:[0,.69444,0,0,.73752],184:[.17014,0,0,0,.44445],305:[0,.44444,.04169,0,.23889],567:[.19444,.44444,.04169,0,.26667],710:[0,.69444,.0799,0,.5],711:[0,.63194,.08432,0,.5],713:[0,.60889,.08776,0,.5],714:[0,.69444,.09205,0,.5],715:[0,.69444,0,0,.5],728:[0,.69444,.09483,0,.5],729:[0,.67937,.07774,0,.27778],730:[0,.69444,0,0,.73752],732:[0,.67659,.08826,0,.5],733:[0,.69444,.09205,0,.5],915:[0,.69444,.13372,0,.54167],916:[0,.69444,0,0,.83334],920:[0,.69444,.07555,0,.77778],923:[0,.69444,0,0,.61111],926:[0,.69444,.12816,0,.66667],928:[0,.69444,.08094,0,.70834],931:[0,.69444,.11983,0,.72222],933:[0,.69444,.09031,0,.77778],934:[0,.69444,.04603,0,.72222],936:[0,.69444,.09031,0,.77778],937:[0,.69444,.08293,0,.72222],8211:[0,.44444,.08616,0,.5],8212:[0,.44444,.08616,0,1],8216:[0,.69444,.07816,0,.27778],8217:[0,.69444,.07816,0,.27778],8220:[0,.69444,.14205,0,.5],8221:[0,.69444,.00316,0,.5]},"SansSerif-Regular":{32:[0,0,0,0,.25],33:[0,.69444,0,0,.31945],34:[0,.69444,0,0,.5],35:[.19444,.69444,0,0,.83334],36:[.05556,.75,0,0,.5],37:[.05556,.75,0,0,.83334],38:[0,.69444,0,0,.75834],39:[0,.69444,0,0,.27778],40:[.25,.75,0,0,.38889],41:[.25,.75,0,0,.38889],42:[0,.75,0,0,.5],43:[.08333,.58333,0,0,.77778],44:[.125,.08333,0,0,.27778],45:[0,.44444,0,0,.33333],46:[0,.08333,0,0,.27778],47:[.25,.75,0,0,.5],48:[0,.65556,0,0,.5],49:[0,.65556,0,0,.5],50:[0,.65556,0,0,.5],51:[0,.65556,0,0,.5],52:[0,.65556,0,0,.5],53:[0,.65556,0,0,.5],54:[0,.65556,0,0,.5],55:[0,.65556,0,0,.5],56:[0,.65556,0,0,.5],57:[0,.65556,0,0,.5],58:[0,.44444,0,0,.27778],59:[.125,.44444,0,0,.27778],61:[-.13,.37,0,0,.77778],63:[0,.69444,0,0,.47222],64:[0,.69444,0,0,.66667],65:[0,.69444,0,0,.66667],66:[0,.69444,0,0,.66667],67:[0,.69444,0,0,.63889],68:[0,.69444,0,0,.72223],69:[0,.69444,0,0,.59722],70:[0,.69444,0,0,.56945],71:[0,.69444,0,0,.66667],72:[0,.69444,0,0,.70834],73:[0,.69444,0,0,.27778],74:[0,.69444,0,0,.47222],75:[0,.69444,0,0,.69445],76:[0,.69444,0,0,.54167],77:[0,.69444,0,0,.875],78:[0,.69444,0,0,.70834],79:[0,.69444,0,0,.73611],80:[0,.69444,0,0,.63889],81:[.125,.69444,0,0,.73611],82:[0,.69444,0,0,.64584],83:[0,.69444,0,0,.55556],84:[0,.69444,0,0,.68056],85:[0,.69444,0,0,.6875],86:[0,.69444,.01389,0,.66667],87:[0,.69444,.01389,0,.94445],88:[0,.69444,0,0,.66667],89:[0,.69444,.025,0,.66667],90:[0,.69444,0,0,.61111],91:[.25,.75,0,0,.28889],93:[.25,.75,0,0,.28889],94:[0,.69444,0,0,.5],95:[.35,.09444,.02778,0,.5],97:[0,.44444,0,0,.48056],98:[0,.69444,0,0,.51667],99:[0,.44444,0,0,.44445],100:[0,.69444,0,0,.51667],101:[0,.44444,0,0,.44445],102:[0,.69444,.06944,0,.30556],103:[.19444,.44444,.01389,0,.5],104:[0,.69444,0,0,.51667],105:[0,.67937,0,0,.23889],106:[.19444,.67937,0,0,.26667],107:[0,.69444,0,0,.48889],108:[0,.69444,0,0,.23889],109:[0,.44444,0,0,.79445],110:[0,.44444,0,0,.51667],111:[0,.44444,0,0,.5],112:[.19444,.44444,0,0,.51667],113:[.19444,.44444,0,0,.51667],114:[0,.44444,.01389,0,.34167],115:[0,.44444,0,0,.38333],116:[0,.57143,0,0,.36111],117:[0,.44444,0,0,.51667],118:[0,.44444,.01389,0,.46111],119:[0,.44444,.01389,0,.68334],120:[0,.44444,0,0,.46111],121:[.19444,.44444,.01389,0,.46111],122:[0,.44444,0,0,.43472],126:[.35,.32659,0,0,.5],160:[0,0,0,0,.25],168:[0,.67937,0,0,.5],176:[0,.69444,0,0,.66667],184:[.17014,0,0,0,.44445],305:[0,.44444,0,0,.23889],567:[.19444,.44444,0,0,.26667],710:[0,.69444,0,0,.5],711:[0,.63194,0,0,.5],713:[0,.60889,0,0,.5],714:[0,.69444,0,0,.5],715:[0,.69444,0,0,.5],728:[0,.69444,0,0,.5],729:[0,.67937,0,0,.27778],730:[0,.69444,0,0,.66667],732:[0,.67659,0,0,.5],733:[0,.69444,0,0,.5],915:[0,.69444,0,0,.54167],916:[0,.69444,0,0,.83334],920:[0,.69444,0,0,.77778],923:[0,.69444,0,0,.61111],926:[0,.69444,0,0,.66667],928:[0,.69444,0,0,.70834],931:[0,.69444,0,0,.72222],933:[0,.69444,0,0,.77778],934:[0,.69444,0,0,.72222],936:[0,.69444,0,0,.77778],937:[0,.69444,0,0,.72222],8211:[0,.44444,.02778,0,.5],8212:[0,.44444,.02778,0,1],8216:[0,.69444,0,0,.27778],8217:[0,.69444,0,0,.27778],8220:[0,.69444,0,0,.5],8221:[0,.69444,0,0,.5]},"Script-Regular":{32:[0,0,0,0,.25],65:[0,.7,.22925,0,.80253],66:[0,.7,.04087,0,.90757],67:[0,.7,.1689,0,.66619],68:[0,.7,.09371,0,.77443],69:[0,.7,.18583,0,.56162],70:[0,.7,.13634,0,.89544],71:[0,.7,.17322,0,.60961],72:[0,.7,.29694,0,.96919],73:[0,.7,.19189,0,.80907],74:[.27778,.7,.19189,0,1.05159],75:[0,.7,.31259,0,.91364],76:[0,.7,.19189,0,.87373],77:[0,.7,.15981,0,1.08031],78:[0,.7,.3525,0,.9015],79:[0,.7,.08078,0,.73787],80:[0,.7,.08078,0,1.01262],81:[0,.7,.03305,0,.88282],82:[0,.7,.06259,0,.85],83:[0,.7,.19189,0,.86767],84:[0,.7,.29087,0,.74697],85:[0,.7,.25815,0,.79996],86:[0,.7,.27523,0,.62204],87:[0,.7,.27523,0,.80532],88:[0,.7,.26006,0,.94445],89:[0,.7,.2939,0,.70961],90:[0,.7,.24037,0,.8212],160:[0,0,0,0,.25]},"Size1-Regular":{32:[0,0,0,0,.25],40:[.35001,.85,0,0,.45834],41:[.35001,.85,0,0,.45834],47:[.35001,.85,0,0,.57778],91:[.35001,.85,0,0,.41667],92:[.35001,.85,0,0,.57778],93:[.35001,.85,0,0,.41667],123:[.35001,.85,0,0,.58334],125:[.35001,.85,0,0,.58334],160:[0,0,0,0,.25],710:[0,.72222,0,0,.55556],732:[0,.72222,0,0,.55556],770:[0,.72222,0,0,.55556],771:[0,.72222,0,0,.55556],8214:[-99e-5,.601,0,0,.77778],8593:[1e-5,.6,0,0,.66667],8595:[1e-5,.6,0,0,.66667],8657:[1e-5,.6,0,0,.77778],8659:[1e-5,.6,0,0,.77778],8719:[.25001,.75,0,0,.94445],8720:[.25001,.75,0,0,.94445],8721:[.25001,.75,0,0,1.05556],8730:[.35001,.85,0,0,1],8739:[-.00599,.606,0,0,.33333],8741:[-.00599,.606,0,0,.55556],8747:[.30612,.805,.19445,0,.47222],8748:[.306,.805,.19445,0,.47222],8749:[.306,.805,.19445,0,.47222],8750:[.30612,.805,.19445,0,.47222],8896:[.25001,.75,0,0,.83334],8897:[.25001,.75,0,0,.83334],8898:[.25001,.75,0,0,.83334],8899:[.25001,.75,0,0,.83334],8968:[.35001,.85,0,0,.47222],8969:[.35001,.85,0,0,.47222],8970:[.35001,.85,0,0,.47222],8971:[.35001,.85,0,0,.47222],9168:[-99e-5,.601,0,0,.66667],10216:[.35001,.85,0,0,.47222],10217:[.35001,.85,0,0,.47222],10752:[.25001,.75,0,0,1.11111],10753:[.25001,.75,0,0,1.11111],10754:[.25001,.75,0,0,1.11111],10756:[.25001,.75,0,0,.83334],10758:[.25001,.75,0,0,.83334]},"Size2-Regular":{32:[0,0,0,0,.25],40:[.65002,1.15,0,0,.59722],41:[.65002,1.15,0,0,.59722],47:[.65002,1.15,0,0,.81111],91:[.65002,1.15,0,0,.47222],92:[.65002,1.15,0,0,.81111],93:[.65002,1.15,0,0,.47222],123:[.65002,1.15,0,0,.66667],125:[.65002,1.15,0,0,.66667],160:[0,0,0,0,.25],710:[0,.75,0,0,1],732:[0,.75,0,0,1],770:[0,.75,0,0,1],771:[0,.75,0,0,1],8719:[.55001,1.05,0,0,1.27778],8720:[.55001,1.05,0,0,1.27778],8721:[.55001,1.05,0,0,1.44445],8730:[.65002,1.15,0,0,1],8747:[.86225,1.36,.44445,0,.55556],8748:[.862,1.36,.44445,0,.55556],8749:[.862,1.36,.44445,0,.55556],8750:[.86225,1.36,.44445,0,.55556],8896:[.55001,1.05,0,0,1.11111],8897:[.55001,1.05,0,0,1.11111],8898:[.55001,1.05,0,0,1.11111],8899:[.55001,1.05,0,0,1.11111],8968:[.65002,1.15,0,0,.52778],8969:[.65002,1.15,0,0,.52778],8970:[.65002,1.15,0,0,.52778],8971:[.65002,1.15,0,0,.52778],10216:[.65002,1.15,0,0,.61111],10217:[.65002,1.15,0,0,.61111],10752:[.55001,1.05,0,0,1.51112],10753:[.55001,1.05,0,0,1.51112],10754:[.55001,1.05,0,0,1.51112],10756:[.55001,1.05,0,0,1.11111],10758:[.55001,1.05,0,0,1.11111]},"Size3-Regular":{32:[0,0,0,0,.25],40:[.95003,1.45,0,0,.73611],41:[.95003,1.45,0,0,.73611],47:[.95003,1.45,0,0,1.04445],91:[.95003,1.45,0,0,.52778],92:[.95003,1.45,0,0,1.04445],93:[.95003,1.45,0,0,.52778],123:[.95003,1.45,0,0,.75],125:[.95003,1.45,0,0,.75],160:[0,0,0,0,.25],710:[0,.75,0,0,1.44445],732:[0,.75,0,0,1.44445],770:[0,.75,0,0,1.44445],771:[0,.75,0,0,1.44445],8730:[.95003,1.45,0,0,1],8968:[.95003,1.45,0,0,.58334],8969:[.95003,1.45,0,0,.58334],8970:[.95003,1.45,0,0,.58334],8971:[.95003,1.45,0,0,.58334],10216:[.95003,1.45,0,0,.75],10217:[.95003,1.45,0,0,.75]},"Size4-Regular":{32:[0,0,0,0,.25],40:[1.25003,1.75,0,0,.79167],41:[1.25003,1.75,0,0,.79167],47:[1.25003,1.75,0,0,1.27778],91:[1.25003,1.75,0,0,.58334],92:[1.25003,1.75,0,0,1.27778],93:[1.25003,1.75,0,0,.58334],123:[1.25003,1.75,0,0,.80556],125:[1.25003,1.75,0,0,.80556],160:[0,0,0,0,.25],710:[0,.825,0,0,1.8889],732:[0,.825,0,0,1.8889],770:[0,.825,0,0,1.8889],771:[0,.825,0,0,1.8889],8730:[1.25003,1.75,0,0,1],8968:[1.25003,1.75,0,0,.63889],8969:[1.25003,1.75,0,0,.63889],8970:[1.25003,1.75,0,0,.63889],8971:[1.25003,1.75,0,0,.63889],9115:[.64502,1.155,0,0,.875],9116:[1e-5,.6,0,0,.875],9117:[.64502,1.155,0,0,.875],9118:[.64502,1.155,0,0,.875],9119:[1e-5,.6,0,0,.875],9120:[.64502,1.155,0,0,.875],9121:[.64502,1.155,0,0,.66667],9122:[-99e-5,.601,0,0,.66667],9123:[.64502,1.155,0,0,.66667],9124:[.64502,1.155,0,0,.66667],9125:[-99e-5,.601,0,0,.66667],9126:[.64502,1.155,0,0,.66667],9127:[1e-5,.9,0,0,.88889],9128:[.65002,1.15,0,0,.88889],9129:[.90001,0,0,0,.88889],9130:[0,.3,0,0,.88889],9131:[1e-5,.9,0,0,.88889],9132:[.65002,1.15,0,0,.88889],9133:[.90001,0,0,0,.88889],9143:[.88502,.915,0,0,1.05556],10216:[1.25003,1.75,0,0,.80556],10217:[1.25003,1.75,0,0,.80556],57344:[-.00499,.605,0,0,1.05556],57345:[-.00499,.605,0,0,1.05556],57680:[0,.12,0,0,.45],57681:[0,.12,0,0,.45],57682:[0,.12,0,0,.45],57683:[0,.12,0,0,.45]},"Typewriter-Regular":{32:[0,0,0,0,.525],33:[0,.61111,0,0,.525],34:[0,.61111,0,0,.525],35:[0,.61111,0,0,.525],36:[.08333,.69444,0,0,.525],37:[.08333,.69444,0,0,.525],38:[0,.61111,0,0,.525],39:[0,.61111,0,0,.525],40:[.08333,.69444,0,0,.525],41:[.08333,.69444,0,0,.525],42:[0,.52083,0,0,.525],43:[-.08056,.53055,0,0,.525],44:[.13889,.125,0,0,.525],45:[-.08056,.53055,0,0,.525],46:[0,.125,0,0,.525],47:[.08333,.69444,0,0,.525],48:[0,.61111,0,0,.525],49:[0,.61111,0,0,.525],50:[0,.61111,0,0,.525],51:[0,.61111,0,0,.525],52:[0,.61111,0,0,.525],53:[0,.61111,0,0,.525],54:[0,.61111,0,0,.525],55:[0,.61111,0,0,.525],56:[0,.61111,0,0,.525],57:[0,.61111,0,0,.525],58:[0,.43056,0,0,.525],59:[.13889,.43056,0,0,.525],60:[-.05556,.55556,0,0,.525],61:[-.19549,.41562,0,0,.525],62:[-.05556,.55556,0,0,.525],63:[0,.61111,0,0,.525],64:[0,.61111,0,0,.525],65:[0,.61111,0,0,.525],66:[0,.61111,0,0,.525],67:[0,.61111,0,0,.525],68:[0,.61111,0,0,.525],69:[0,.61111,0,0,.525],70:[0,.61111,0,0,.525],71:[0,.61111,0,0,.525],72:[0,.61111,0,0,.525],73:[0,.61111,0,0,.525],74:[0,.61111,0,0,.525],75:[0,.61111,0,0,.525],76:[0,.61111,0,0,.525],77:[0,.61111,0,0,.525],78:[0,.61111,0,0,.525],79:[0,.61111,0,0,.525],80:[0,.61111,0,0,.525],81:[.13889,.61111,0,0,.525],82:[0,.61111,0,0,.525],83:[0,.61111,0,0,.525],84:[0,.61111,0,0,.525],85:[0,.61111,0,0,.525],86:[0,.61111,0,0,.525],87:[0,.61111,0,0,.525],88:[0,.61111,0,0,.525],89:[0,.61111,0,0,.525],90:[0,.61111,0,0,.525],91:[.08333,.69444,0,0,.525],92:[.08333,.69444,0,0,.525],93:[.08333,.69444,0,0,.525],94:[0,.61111,0,0,.525],95:[.09514,0,0,0,.525],96:[0,.61111,0,0,.525],97:[0,.43056,0,0,.525],98:[0,.61111,0,0,.525],99:[0,.43056,0,0,.525],100:[0,.61111,0,0,.525],101:[0,.43056,0,0,.525],102:[0,.61111,0,0,.525],103:[.22222,.43056,0,0,.525],104:[0,.61111,0,0,.525],105:[0,.61111,0,0,.525],106:[.22222,.61111,0,0,.525],107:[0,.61111,0,0,.525],108:[0,.61111,0,0,.525],109:[0,.43056,0,0,.525],110:[0,.43056,0,0,.525],111:[0,.43056,0,0,.525],112:[.22222,.43056,0,0,.525],113:[.22222,.43056,0,0,.525],114:[0,.43056,0,0,.525],115:[0,.43056,0,0,.525],116:[0,.55358,0,0,.525],117:[0,.43056,0,0,.525],118:[0,.43056,0,0,.525],119:[0,.43056,0,0,.525],120:[0,.43056,0,0,.525],121:[.22222,.43056,0,0,.525],122:[0,.43056,0,0,.525],123:[.08333,.69444,0,0,.525],124:[.08333,.69444,0,0,.525],125:[.08333,.69444,0,0,.525],126:[0,.61111,0,0,.525],127:[0,.61111,0,0,.525],160:[0,0,0,0,.525],176:[0,.61111,0,0,.525],184:[.19445,0,0,0,.525],305:[0,.43056,0,0,.525],567:[.22222,.43056,0,0,.525],711:[0,.56597,0,0,.525],713:[0,.56555,0,0,.525],714:[0,.61111,0,0,.525],715:[0,.61111,0,0,.525],728:[0,.61111,0,0,.525],730:[0,.61111,0,0,.525],770:[0,.61111,0,0,.525],771:[0,.61111,0,0,.525],776:[0,.61111,0,0,.525],915:[0,.61111,0,0,.525],916:[0,.61111,0,0,.525],920:[0,.61111,0,0,.525],923:[0,.61111,0,0,.525],926:[0,.61111,0,0,.525],928:[0,.61111,0,0,.525],931:[0,.61111,0,0,.525],933:[0,.61111,0,0,.525],934:[0,.61111,0,0,.525],936:[0,.61111,0,0,.525],937:[0,.61111,0,0,.525],8216:[0,.61111,0,0,.525],8217:[0,.61111,0,0,.525],8242:[0,.61111,0,0,.525],9251:[.11111,.21944,0,0,.525]}},ip={slant:[.25,.25,.25],space:[0,0,0],stretch:[0,0,0],shrink:[0,0,0],xHeight:[.431,.431,.431],quad:[1,1.171,1.472],extraSpace:[0,0,0],num1:[.677,.732,.925],num2:[.394,.384,.387],num3:[.444,.471,.504],denom1:[.686,.752,1.025],denom2:[.345,.344,.532],sup1:[.413,.503,.504],sup2:[.363,.431,.404],sup3:[.289,.286,.294],sub1:[.15,.143,.2],sub2:[.247,.286,.4],supDrop:[.386,.353,.494],subDrop:[.05,.071,.1],delim1:[2.39,1.7,1.98],delim2:[1.01,1.157,1.42],axisHeight:[.25,.25,.25],defaultRuleThickness:[.04,.049,.049],bigOpSpacing1:[.111,.111,.111],bigOpSpacing2:[.166,.166,.166],bigOpSpacing3:[.2,.2,.2],bigOpSpacing4:[.6,.611,.611],bigOpSpacing5:[.1,.143,.143],sqrtRuleThickness:[.04,.04,.04],ptPerEm:[10,10,10],doubleRuleSep:[.2,.2,.2],arrayRuleWidth:[.04,.04,.04],fboxsep:[.3,.3,.3],fboxrule:[.04,.04,.04]},_8={Å:"A",Ð:"D",Þ:"o",å:"a",ð:"d",þ:"o",А:"A",Б:"B",В:"B",Г:"F",Д:"A",Е:"E",Ж:"K",З:"3",И:"N",Й:"N",К:"K",Л:"N",М:"M",Н:"H",О:"O",П:"N",Р:"P",С:"C",Т:"T",У:"y",Ф:"O",Х:"X",Ц:"U",Ч:"h",Ш:"W",Щ:"W",Ъ:"B",Ы:"X",Ь:"B",Э:"3",Ю:"X",Я:"R",а:"a",б:"b",в:"a",г:"r",д:"y",е:"e",ж:"m",з:"e",и:"n",й:"n",к:"n",л:"n",м:"m",н:"n",о:"o",п:"n",р:"p",с:"c",т:"o",у:"y",ф:"b",х:"x",ц:"n",ч:"n",ш:"w",щ:"w",ъ:"a",ы:"m",ь:"a",э:"e",ю:"m",я:"r"};function Whe(t,e){ui[t]=e}function ob(t,e,n){if(!ui[e])throw new Error("Font metrics not found for font: "+e+".");var r=t.charCodeAt(0),s=ui[e][r];if(!s&&t[0]in _8&&(r=_8[t[0]].charCodeAt(0),s=ui[e][r]),!s&&n==="text"&&mj(r)&&(s=ui[e][77]),s)return{depth:s[0],height:s[1],italic:s[2],skew:s[3],width:s[4]}}var Ky={};function Khe(t){var e;if(t>=5?e=0:t>=3?e=1:e=2,!Ky[e]){var n=Ky[e]={cssEmPerMu:ip.quad[e]/18};for(var r in ip)ip.hasOwnProperty(r)&&(n[r]=ip[r][e])}return Ky[e]}var Ghe=[[1,1,1],[2,1,1],[3,1,1],[4,2,1],[5,2,1],[6,3,1],[7,4,2],[8,6,3],[9,7,6],[10,8,7],[11,10,9]],A8=[.5,.6,.7,.8,.9,1,1.2,1.44,1.728,2.074,2.488],D8=function(e,n){return n.size<2?e:Ghe[e-1][n.size-1]};class Bi{constructor(e){this.style=void 0,this.color=void 0,this.size=void 0,this.textSize=void 0,this.phantom=void 0,this.font=void 0,this.fontFamily=void 0,this.fontWeight=void 0,this.fontShape=void 0,this.sizeMultiplier=void 0,this.maxSize=void 0,this.minRuleThickness=void 0,this._fontMetrics=void 0,this.style=e.style,this.color=e.color,this.size=e.size||Bi.BASESIZE,this.textSize=e.textSize||this.size,this.phantom=!!e.phantom,this.font=e.font||"",this.fontFamily=e.fontFamily||"",this.fontWeight=e.fontWeight||"",this.fontShape=e.fontShape||"",this.sizeMultiplier=A8[this.size-1],this.maxSize=e.maxSize,this.minRuleThickness=e.minRuleThickness,this._fontMetrics=void 0}extend(e){var n={style:this.style,size:this.size,textSize:this.textSize,color:this.color,phantom:this.phantom,font:this.font,fontFamily:this.fontFamily,fontWeight:this.fontWeight,fontShape:this.fontShape,maxSize:this.maxSize,minRuleThickness:this.minRuleThickness};for(var r in e)e.hasOwnProperty(r)&&(n[r]=e[r]);return new Bi(n)}havingStyle(e){return this.style===e?this:this.extend({style:e,size:D8(this.textSize,e)})}havingCrampedStyle(){return this.havingStyle(this.style.cramp())}havingSize(e){return this.size===e&&this.textSize===e?this:this.extend({style:this.style.text(),size:e,textSize:e,sizeMultiplier:A8[e-1]})}havingBaseStyle(e){e=e||this.style.text();var n=D8(Bi.BASESIZE,e);return this.size===n&&this.textSize===Bi.BASESIZE&&this.style===e?this:this.extend({style:e,size:n})}havingBaseSizing(){var e;switch(this.style.id){case 4:case 5:e=3;break;case 6:case 7:e=1;break;default:e=6}return this.extend({style:this.style.text(),size:e})}withColor(e){return this.extend({color:e})}withPhantom(){return this.extend({phantom:!0})}withFont(e){return this.extend({font:e})}withTextFontFamily(e){return this.extend({fontFamily:e,font:""})}withTextFontWeight(e){return this.extend({fontWeight:e,font:""})}withTextFontShape(e){return this.extend({fontShape:e,font:""})}sizingClasses(e){return e.size!==this.size?["sizing","reset-size"+e.size,"size"+this.size]:[]}baseSizingClasses(){return this.size!==Bi.BASESIZE?["sizing","reset-size"+this.size,"size"+Bi.BASESIZE]:[]}fontMetrics(){return this._fontMetrics||(this._fontMetrics=Khe(this.size)),this._fontMetrics}getColor(){return this.phantom?"transparent":this.color}}Bi.BASESIZE=6;var RS={pt:1,mm:7227/2540,cm:7227/254,in:72.27,bp:803/800,pc:12,dd:1238/1157,cc:14856/1157,nd:685/642,nc:1370/107,sp:1/65536,px:803/800},Vhe={ex:!0,em:!0,mu:!0},yj=function(e){return typeof e!="string"&&(e=e.unit),e in RS||e in Vhe||e==="ex"},Lt=function(e,n){var r;if(e.unit in RS)r=RS[e.unit]/n.fontMetrics().ptPerEm/n.sizeMultiplier;else if(e.unit==="mu")r=n.fontMetrics().cssEmPerMu;else{var s;if(n.style.isTight()?s=n.havingStyle(n.style.text()):s=n,e.unit==="ex")r=s.fontMetrics().xHeight;else if(e.unit==="em")r=s.fontMetrics().quad;else throw new ie("Invalid unit: '"+e.unit+"'");s!==n&&(r*=s.sizeMultiplier/n.sizeMultiplier)}return Math.min(e.number*r,n.maxSize)},ae=function(e){return+e.toFixed(4)+"em"},ha=function(e){return e.filter(n=>n).join(" ")},vj=function(e,n,r){if(this.classes=e||[],this.attributes={},this.height=0,this.depth=0,this.maxFontSize=0,this.style=r||{},n){n.style.isTight()&&this.classes.push("mtight");var s=n.getColor();s&&(this.style.color=s)}},Sj=function(e){var n=document.createElement(e);n.className=ha(this.classes);for(var r in this.style)this.style.hasOwnProperty(r)&&(n.style[r]=this.style[r]);for(var s in this.attributes)this.attributes.hasOwnProperty(s)&&n.setAttribute(s,this.attributes[s]);for(var i=0;i<this.children.length;i++)n.appendChild(this.children[i].toNode());return n},qhe=/[\s"'>/=\x00-\x1f]/,xj=function(e){var n="<"+e;this.classes.length&&(n+=' class="'+Pe.escape(ha(this.classes))+'"');var r="";for(var s in this.style)this.style.hasOwnProperty(s)&&(r+=Pe.hyphenate(s)+":"+this.style[s]+";");r&&(n+=' style="'+Pe.escape(r)+'"');for(var i in this.attributes)if(this.attributes.hasOwnProperty(i)){if(qhe.test(i))throw new ie("Invalid attribute name '"+i+"'");n+=" "+i+'="'+Pe.escape(this.attributes[i])+'"'}n+=">";for(var o=0;o<this.children.length;o++)n+=this.children[o].toMarkup();return n+="</"+e+">",n};class Hh{constructor(e,n,r,s){this.children=void 0,this.attributes=void 0,this.classes=void 0,this.height=void 0,this.depth=void 0,this.width=void 0,this.maxFontSize=void 0,this.style=void 0,vj.call(this,e,r,s),this.children=n||[]}setAttribute(e,n){this.attributes[e]=n}hasClass(e){return Pe.contains(this.classes,e)}toNode(){return Sj.call(this,"span")}toMarkup(){return xj.call(this,"span")}}class ab{constructor(e,n,r,s){this.children=void 0,this.attributes=void 0,this.classes=void 0,this.height=void 0,this.depth=void 0,this.maxFontSize=void 0,this.style=void 0,vj.call(this,n,s),this.children=r||[],this.setAttribute("href",e)}setAttribute(e,n){this.attributes[e]=n}hasClass(e){return Pe.contains(this.classes,e)}toNode(){return Sj.call(this,"a")}toMarkup(){return xj.call(this,"a")}}class Yhe{constructor(e,n,r){this.src=void 0,this.alt=void 0,this.classes=void 0,this.height=void 0,this.depth=void 0,this.maxFontSize=void 0,this.style=void 0,this.alt=n,this.src=e,this.classes=["mord"],this.style=r}hasClass(e){return Pe.contains(this.classes,e)}toNode(){var e=document.createElement("img");e.src=this.src,e.alt=this.alt,e.className="mord";for(var n in this.style)this.style.hasOwnProperty(n)&&(e.style[n]=this.style[n]);return e}toMarkup(){var e='<img src="'+Pe.escape(this.src)+'"'+(' alt="'+Pe.escape(this.alt)+'"'),n="";for(var r in this.style)this.style.hasOwnProperty(r)&&(n+=Pe.hyphenate(r)+":"+this.style[r]+";");return n&&(e+=' style="'+Pe.escape(n)+'"'),e+="'/>",e}}var Xhe={î:"ı̂",ï:"ı̈",í:"ı́",ì:"ı̀"};class xs{constructor(e,n,r,s,i,o,a,l){this.text=void 0,this.height=void 0,this.depth=void 0,this.italic=void 0,this.skew=void 0,this.width=void 0,this.maxFontSize=void 0,this.classes=void 0,this.style=void 0,this.text=e,this.height=n||0,this.depth=r||0,this.italic=s||0,this.skew=i||0,this.width=o||0,this.classes=a||[],this.style=l||{},this.maxFontSize=0;var c=jhe(this.text.charCodeAt(0));c&&this.classes.push(c+"_fallback"),/[îïíì]/.test(this.text)&&(this.text=Xhe[this.text])}hasClass(e){return Pe.contains(this.classes,e)}toNode(){var e=document.createTextNode(this.text),n=null;this.italic>0&&(n=document.createElement("span"),n.style.marginRight=ae(this.italic)),this.classes.length>0&&(n=n||document.createElement("span"),n.className=ha(this.classes));for(var r in this.style)this.style.hasOwnProperty(r)&&(n=n||document.createElement("span"),n.style[r]=this.style[r]);return n?(n.appendChild(e),n):e}toMarkup(){var e=!1,n="<span";this.classes.length&&(e=!0,n+=' class="',n+=Pe.escape(ha(this.classes)),n+='"');var r="";this.italic>0&&(r+="margin-right:"+this.italic+"em;");for(var s in this.style)this.style.hasOwnProperty(s)&&(r+=Pe.hyphenate(s)+":"+this.style[s]+";");r&&(e=!0,n+=' style="'+Pe.escape(r)+'"');var i=Pe.escape(this.text);return e?(n+=">",n+=i,n+="</span>",n):i}}class lo{constructor(e,n){this.children=void 0,this.attributes=void 0,this.children=e||[],this.attributes=n||{}}toNode(){var e="http://www.w3.org/2000/svg",n=document.createElementNS(e,"svg");for(var r in this.attributes)Object.prototype.hasOwnProperty.call(this.attributes,r)&&n.setAttribute(r,this.attributes[r]);for(var s=0;s<this.children.length;s++)n.appendChild(this.children[s].toNode());return n}toMarkup(){var e='<svg xmlns="http://www.w3.org/2000/svg"';for(var n in this.attributes)Object.prototype.hasOwnProperty.call(this.attributes,n)&&(e+=" "+n+'="'+Pe.escape(this.attributes[n])+'"');e+=">";for(var r=0;r<this.children.length;r++)e+=this.children[r].toMarkup();return e+="</svg>",e}}class pa{constructor(e,n){this.pathName=void 0,this.alternate=void 0,this.pathName=e,this.alternate=n}toNode(){var e="http://www.w3.org/2000/svg",n=document.createElementNS(e,"path");return this.alternate?n.setAttribute("d",this.alternate):n.setAttribute("d",M8[this.pathName]),n}toMarkup(){return this.alternate?'<path d="'+Pe.escape(this.alternate)+'"/>':'<path d="'+Pe.escape(M8[this.pathName])+'"/>'}}class OS{constructor(e){this.attributes=void 0,this.attributes=e||{}}toNode(){var e="http://www.w3.org/2000/svg",n=document.createElementNS(e,"line");for(var r in this.attributes)Object.prototype.hasOwnProperty.call(this.attributes,r)&&n.setAttribute(r,this.attributes[r]);return n}toMarkup(){var e="<line";for(var n in this.attributes)Object.prototype.hasOwnProperty.call(this.attributes,n)&&(e+=" "+n+'="'+Pe.escape(this.attributes[n])+'"');return e+="/>",e}}function j8(t){if(t instanceof xs)return t;throw new Error("Expected symbolNode but got "+String(t)+".")}function Zhe(t){if(t instanceof Hh)return t;throw new Error("Expected span<HtmlDomNode> but got "+String(t)+".")}var Qhe={bin:1,close:1,inner:1,open:1,punct:1,rel:1},Jhe={"accent-token":1,mathord:1,"op-token":1,spacing:1,textord:1},St={math:{},text:{}};function k(t,e,n,r,s,i){St[t][s]={font:e,group:n,replace:r},i&&r&&(St[t][r]=St[t][s])}var T="math",re="text",A="main",z="ams",At="accent-token",pe="bin",cr="close",iu="inner",Ee="mathord",Jt="op-token",Jr="open",Hm="punct",F="rel",wo="spacing",B="textord";k(T,A,F,"≡","\\equiv",!0);k(T,A,F,"≺","\\prec",!0);k(T,A,F,"≻","\\succ",!0);k(T,A,F,"∼","\\sim",!0);k(T,A,F,"⊥","\\perp");k(T,A,F,"⪯","\\preceq",!0);k(T,A,F,"⪰","\\succeq",!0);k(T,A,F,"≃","\\simeq",!0);k(T,A,F,"∣","\\mid",!0);k(T,A,F,"≪","\\ll",!0);k(T,A,F,"≫","\\gg",!0);k(T,A,F,"≍","\\asymp",!0);k(T,A,F,"∥","\\parallel");k(T,A,F,"⋈","\\bowtie",!0);k(T,A,F,"⌣","\\smile",!0);k(T,A,F,"⊑","\\sqsubseteq",!0);k(T,A,F,"⊒","\\sqsupseteq",!0);k(T,A,F,"≐","\\doteq",!0);k(T,A,F,"⌢","\\frown",!0);k(T,A,F,"∋","\\ni",!0);k(T,A,F,"∝","\\propto",!0);k(T,A,F,"⊢","\\vdash",!0);k(T,A,F,"⊣","\\dashv",!0);k(T,A,F,"∋","\\owns");k(T,A,Hm,".","\\ldotp");k(T,A,Hm,"⋅","\\cdotp");k(T,A,B,"#","\\#");k(re,A,B,"#","\\#");k(T,A,B,"&","\\&");k(re,A,B,"&","\\&");k(T,A,B,"ℵ","\\aleph",!0);k(T,A,B,"∀","\\forall",!0);k(T,A,B,"ℏ","\\hbar",!0);k(T,A,B,"∃","\\exists",!0);k(T,A,B,"∇","\\nabla",!0);k(T,A,B,"♭","\\flat",!0);k(T,A,B,"ℓ","\\ell",!0);k(T,A,B,"♮","\\natural",!0);k(T,A,B,"♣","\\clubsuit",!0);k(T,A,B,"℘","\\wp",!0);k(T,A,B,"♯","\\sharp",!0);k(T,A,B,"♢","\\diamondsuit",!0);k(T,A,B,"ℜ","\\Re",!0);k(T,A,B,"♡","\\heartsuit",!0);k(T,A,B,"ℑ","\\Im",!0);k(T,A,B,"♠","\\spadesuit",!0);k(T,A,B,"§","\\S",!0);k(re,A,B,"§","\\S");k(T,A,B,"¶","\\P",!0);k(re,A,B,"¶","\\P");k(T,A,B,"†","\\dag");k(re,A,B,"†","\\dag");k(re,A,B,"†","\\textdagger");k(T,A,B,"‡","\\ddag");k(re,A,B,"‡","\\ddag");k(re,A,B,"‡","\\textdaggerdbl");k(T,A,cr,"⎱","\\rmoustache",!0);k(T,A,Jr,"⎰","\\lmoustache",!0);k(T,A,cr,"⟯","\\rgroup",!0);k(T,A,Jr,"⟮","\\lgroup",!0);k(T,A,pe,"∓","\\mp",!0);k(T,A,pe,"⊖","\\ominus",!0);k(T,A,pe,"⊎","\\uplus",!0);k(T,A,pe,"⊓","\\sqcap",!0);k(T,A,pe,"∗","\\ast");k(T,A,pe,"⊔","\\sqcup",!0);k(T,A,pe,"◯","\\bigcirc",!0);k(T,A,pe,"∙","\\bullet",!0);k(T,A,pe,"‡","\\ddagger");k(T,A,pe,"≀","\\wr",!0);k(T,A,pe,"⨿","\\amalg");k(T,A,pe,"&","\\And");k(T,A,F,"⟵","\\longleftarrow",!0);k(T,A,F,"⇐","\\Leftarrow",!0);k(T,A,F,"⟸","\\Longleftarrow",!0);k(T,A,F,"⟶","\\longrightarrow",!0);k(T,A,F,"⇒","\\Rightarrow",!0);k(T,A,F,"⟹","\\Longrightarrow",!0);k(T,A,F,"↔","\\leftrightarrow",!0);k(T,A,F,"⟷","\\longleftrightarrow",!0);k(T,A,F,"⇔","\\Leftrightarrow",!0);k(T,A,F,"⟺","\\Longleftrightarrow",!0);k(T,A,F,"↦","\\mapsto",!0);k(T,A,F,"⟼","\\longmapsto",!0);k(T,A,F,"↗","\\nearrow",!0);k(T,A,F,"↩","\\hookleftarrow",!0);k(T,A,F,"↪","\\hookrightarrow",!0);k(T,A,F,"↘","\\searrow",!0);k(T,A,F,"↼","\\leftharpoonup",!0);k(T,A,F,"⇀","\\rightharpoonup",!0);k(T,A,F,"↙","\\swarrow",!0);k(T,A,F,"↽","\\leftharpoondown",!0);k(T,A,F,"⇁","\\rightharpoondown",!0);k(T,A,F,"↖","\\nwarrow",!0);k(T,A,F,"⇌","\\rightleftharpoons",!0);k(T,z,F,"≮","\\nless",!0);k(T,z,F,"","\\@nleqslant");k(T,z,F,"","\\@nleqq");k(T,z,F,"⪇","\\lneq",!0);k(T,z,F,"≨","\\lneqq",!0);k(T,z,F,"","\\@lvertneqq");k(T,z,F,"⋦","\\lnsim",!0);k(T,z,F,"⪉","\\lnapprox",!0);k(T,z,F,"⊀","\\nprec",!0);k(T,z,F,"⋠","\\npreceq",!0);k(T,z,F,"⋨","\\precnsim",!0);k(T,z,F,"⪹","\\precnapprox",!0);k(T,z,F,"≁","\\nsim",!0);k(T,z,F,"","\\@nshortmid");k(T,z,F,"∤","\\nmid",!0);k(T,z,F,"⊬","\\nvdash",!0);k(T,z,F,"⊭","\\nvDash",!0);k(T,z,F,"⋪","\\ntriangleleft");k(T,z,F,"⋬","\\ntrianglelefteq",!0);k(T,z,F,"⊊","\\subsetneq",!0);k(T,z,F,"","\\@varsubsetneq");k(T,z,F,"⫋","\\subsetneqq",!0);k(T,z,F,"","\\@varsubsetneqq");k(T,z,F,"≯","\\ngtr",!0);k(T,z,F,"","\\@ngeqslant");k(T,z,F,"","\\@ngeqq");k(T,z,F,"⪈","\\gneq",!0);k(T,z,F,"≩","\\gneqq",!0);k(T,z,F,"","\\@gvertneqq");k(T,z,F,"⋧","\\gnsim",!0);k(T,z,F,"⪊","\\gnapprox",!0);k(T,z,F,"⊁","\\nsucc",!0);k(T,z,F,"⋡","\\nsucceq",!0);k(T,z,F,"⋩","\\succnsim",!0);k(T,z,F,"⪺","\\succnapprox",!0);k(T,z,F,"≆","\\ncong",!0);k(T,z,F,"","\\@nshortparallel");k(T,z,F,"∦","\\nparallel",!0);k(T,z,F,"⊯","\\nVDash",!0);k(T,z,F,"⋫","\\ntriangleright");k(T,z,F,"⋭","\\ntrianglerighteq",!0);k(T,z,F,"","\\@nsupseteqq");k(T,z,F,"⊋","\\supsetneq",!0);k(T,z,F,"","\\@varsupsetneq");k(T,z,F,"⫌","\\supsetneqq",!0);k(T,z,F,"","\\@varsupsetneqq");k(T,z,F,"⊮","\\nVdash",!0);k(T,z,F,"⪵","\\precneqq",!0);k(T,z,F,"⪶","\\succneqq",!0);k(T,z,F,"","\\@nsubseteqq");k(T,z,pe,"⊴","\\unlhd");k(T,z,pe,"⊵","\\unrhd");k(T,z,F,"↚","\\nleftarrow",!0);k(T,z,F,"↛","\\nrightarrow",!0);k(T,z,F,"⇍","\\nLeftarrow",!0);k(T,z,F,"⇏","\\nRightarrow",!0);k(T,z,F,"↮","\\nleftrightarrow",!0);k(T,z,F,"⇎","\\nLeftrightarrow",!0);k(T,z,F,"△","\\vartriangle");k(T,z,B,"ℏ","\\hslash");k(T,z,B,"▽","\\triangledown");k(T,z,B,"◊","\\lozenge");k(T,z,B,"Ⓢ","\\circledS");k(T,z,B,"®","\\circledR");k(re,z,B,"®","\\circledR");k(T,z,B,"∡","\\measuredangle",!0);k(T,z,B,"∄","\\nexists");k(T,z,B,"℧","\\mho");k(T,z,B,"Ⅎ","\\Finv",!0);k(T,z,B,"⅁","\\Game",!0);k(T,z,B,"‵","\\backprime");k(T,z,B,"▲","\\blacktriangle");k(T,z,B,"▼","\\blacktriangledown");k(T,z,B,"■","\\blacksquare");k(T,z,B,"⧫","\\blacklozenge");k(T,z,B,"★","\\bigstar");k(T,z,B,"∢","\\sphericalangle",!0);k(T,z,B,"∁","\\complement",!0);k(T,z,B,"ð","\\eth",!0);k(re,A,B,"ð","ð");k(T,z,B,"╱","\\diagup");k(T,z,B,"╲","\\diagdown");k(T,z,B,"□","\\square");k(T,z,B,"□","\\Box");k(T,z,B,"◊","\\Diamond");k(T,z,B,"¥","\\yen",!0);k(re,z,B,"¥","\\yen",!0);k(T,z,B,"✓","\\checkmark",!0);k(re,z,B,"✓","\\checkmark");k(T,z,B,"ℶ","\\beth",!0);k(T,z,B,"ℸ","\\daleth",!0);k(T,z,B,"ℷ","\\gimel",!0);k(T,z,B,"ϝ","\\digamma",!0);k(T,z,B,"ϰ","\\varkappa");k(T,z,Jr,"┌","\\@ulcorner",!0);k(T,z,cr,"┐","\\@urcorner",!0);k(T,z,Jr,"└","\\@llcorner",!0);k(T,z,cr,"┘","\\@lrcorner",!0);k(T,z,F,"≦","\\leqq",!0);k(T,z,F,"⩽","\\leqslant",!0);k(T,z,F,"⪕","\\eqslantless",!0);k(T,z,F,"≲","\\lesssim",!0);k(T,z,F,"⪅","\\lessapprox",!0);k(T,z,F,"≊","\\approxeq",!0);k(T,z,pe,"⋖","\\lessdot");k(T,z,F,"⋘","\\lll",!0);k(T,z,F,"≶","\\lessgtr",!0);k(T,z,F,"⋚","\\lesseqgtr",!0);k(T,z,F,"⪋","\\lesseqqgtr",!0);k(T,z,F,"≑","\\doteqdot");k(T,z,F,"≓","\\risingdotseq",!0);k(T,z,F,"≒","\\fallingdotseq",!0);k(T,z,F,"∽","\\backsim",!0);k(T,z,F,"⋍","\\backsimeq",!0);k(T,z,F,"⫅","\\subseteqq",!0);k(T,z,F,"⋐","\\Subset",!0);k(T,z,F,"⊏","\\sqsubset",!0);k(T,z,F,"≼","\\preccurlyeq",!0);k(T,z,F,"⋞","\\curlyeqprec",!0);k(T,z,F,"≾","\\precsim",!0);k(T,z,F,"⪷","\\precapprox",!0);k(T,z,F,"⊲","\\vartriangleleft");k(T,z,F,"⊴","\\trianglelefteq");k(T,z,F,"⊨","\\vDash",!0);k(T,z,F,"⊪","\\Vvdash",!0);k(T,z,F,"⌣","\\smallsmile");k(T,z,F,"⌢","\\smallfrown");k(T,z,F,"≏","\\bumpeq",!0);k(T,z,F,"≎","\\Bumpeq",!0);k(T,z,F,"≧","\\geqq",!0);k(T,z,F,"⩾","\\geqslant",!0);k(T,z,F,"⪖","\\eqslantgtr",!0);k(T,z,F,"≳","\\gtrsim",!0);k(T,z,F,"⪆","\\gtrapprox",!0);k(T,z,pe,"⋗","\\gtrdot");k(T,z,F,"⋙","\\ggg",!0);k(T,z,F,"≷","\\gtrless",!0);k(T,z,F,"⋛","\\gtreqless",!0);k(T,z,F,"⪌","\\gtreqqless",!0);k(T,z,F,"≖","\\eqcirc",!0);k(T,z,F,"≗","\\circeq",!0);k(T,z,F,"≜","\\triangleq",!0);k(T,z,F,"∼","\\thicksim");k(T,z,F,"≈","\\thickapprox");k(T,z,F,"⫆","\\supseteqq",!0);k(T,z,F,"⋑","\\Supset",!0);k(T,z,F,"⊐","\\sqsupset",!0);k(T,z,F,"≽","\\succcurlyeq",!0);k(T,z,F,"⋟","\\curlyeqsucc",!0);k(T,z,F,"≿","\\succsim",!0);k(T,z,F,"⪸","\\succapprox",!0);k(T,z,F,"⊳","\\vartriangleright");k(T,z,F,"⊵","\\trianglerighteq");k(T,z,F,"⊩","\\Vdash",!0);k(T,z,F,"∣","\\shortmid");k(T,z,F,"∥","\\shortparallel");k(T,z,F,"≬","\\between",!0);k(T,z,F,"⋔","\\pitchfork",!0);k(T,z,F,"∝","\\varpropto");k(T,z,F,"◀","\\blacktriangleleft");k(T,z,F,"∴","\\therefore",!0);k(T,z,F,"∍","\\backepsilon");k(T,z,F,"▶","\\blacktriangleright");k(T,z,F,"∵","\\because",!0);k(T,z,F,"⋘","\\llless");k(T,z,F,"⋙","\\gggtr");k(T,z,pe,"⊲","\\lhd");k(T,z,pe,"⊳","\\rhd");k(T,z,F,"≂","\\eqsim",!0);k(T,A,F,"⋈","\\Join");k(T,z,F,"≑","\\Doteq",!0);k(T,z,pe,"∔","\\dotplus",!0);k(T,z,pe,"∖","\\smallsetminus");k(T,z,pe,"⋒","\\Cap",!0);k(T,z,pe,"⋓","\\Cup",!0);k(T,z,pe,"⩞","\\doublebarwedge",!0);k(T,z,pe,"⊟","\\boxminus",!0);k(T,z,pe,"⊞","\\boxplus",!0);k(T,z,pe,"⋇","\\divideontimes",!0);k(T,z,pe,"⋉","\\ltimes",!0);k(T,z,pe,"⋊","\\rtimes",!0);k(T,z,pe,"⋋","\\leftthreetimes",!0);k(T,z,pe,"⋌","\\rightthreetimes",!0);k(T,z,pe,"⋏","\\curlywedge",!0);k(T,z,pe,"⋎","\\curlyvee",!0);k(T,z,pe,"⊝","\\circleddash",!0);k(T,z,pe,"⊛","\\circledast",!0);k(T,z,pe,"⋅","\\centerdot");k(T,z,pe,"⊺","\\intercal",!0);k(T,z,pe,"⋒","\\doublecap");k(T,z,pe,"⋓","\\doublecup");k(T,z,pe,"⊠","\\boxtimes",!0);k(T,z,F,"⇢","\\dashrightarrow",!0);k(T,z,F,"⇠","\\dashleftarrow",!0);k(T,z,F,"⇇","\\leftleftarrows",!0);k(T,z,F,"⇆","\\leftrightarrows",!0);k(T,z,F,"⇚","\\Lleftarrow",!0);k(T,z,F,"↞","\\twoheadleftarrow",!0);k(T,z,F,"↢","\\leftarrowtail",!0);k(T,z,F,"↫","\\looparrowleft",!0);k(T,z,F,"⇋","\\leftrightharpoons",!0);k(T,z,F,"↶","\\curvearrowleft",!0);k(T,z,F,"↺","\\circlearrowleft",!0);k(T,z,F,"↰","\\Lsh",!0);k(T,z,F,"⇈","\\upuparrows",!0);k(T,z,F,"↿","\\upharpoonleft",!0);k(T,z,F,"⇃","\\downharpoonleft",!0);k(T,A,F,"⊶","\\origof",!0);k(T,A,F,"⊷","\\imageof",!0);k(T,z,F,"⊸","\\multimap",!0);k(T,z,F,"↭","\\leftrightsquigarrow",!0);k(T,z,F,"⇉","\\rightrightarrows",!0);k(T,z,F,"⇄","\\rightleftarrows",!0);k(T,z,F,"↠","\\twoheadrightarrow",!0);k(T,z,F,"↣","\\rightarrowtail",!0);k(T,z,F,"↬","\\looparrowright",!0);k(T,z,F,"↷","\\curvearrowright",!0);k(T,z,F,"↻","\\circlearrowright",!0);k(T,z,F,"↱","\\Rsh",!0);k(T,z,F,"⇊","\\downdownarrows",!0);k(T,z,F,"↾","\\upharpoonright",!0);k(T,z,F,"⇂","\\downharpoonright",!0);k(T,z,F,"⇝","\\rightsquigarrow",!0);k(T,z,F,"⇝","\\leadsto");k(T,z,F,"⇛","\\Rrightarrow",!0);k(T,z,F,"↾","\\restriction");k(T,A,B,"‘","`");k(T,A,B,"$","\\$");k(re,A,B,"$","\\$");k(re,A,B,"$","\\textdollar");k(T,A,B,"%","\\%");k(re,A,B,"%","\\%");k(T,A,B,"_","\\_");k(re,A,B,"_","\\_");k(re,A,B,"_","\\textunderscore");k(T,A,B,"∠","\\angle",!0);k(T,A,B,"∞","\\infty",!0);k(T,A,B,"′","\\prime");k(T,A,B,"△","\\triangle");k(T,A,B,"Γ","\\Gamma",!0);k(T,A,B,"Δ","\\Delta",!0);k(T,A,B,"Θ","\\Theta",!0);k(T,A,B,"Λ","\\Lambda",!0);k(T,A,B,"Ξ","\\Xi",!0);k(T,A,B,"Π","\\Pi",!0);k(T,A,B,"Σ","\\Sigma",!0);k(T,A,B,"Υ","\\Upsilon",!0);k(T,A,B,"Φ","\\Phi",!0);k(T,A,B,"Ψ","\\Psi",!0);k(T,A,B,"Ω","\\Omega",!0);k(T,A,B,"A","Α");k(T,A,B,"B","Β");k(T,A,B,"E","Ε");k(T,A,B,"Z","Ζ");k(T,A,B,"H","Η");k(T,A,B,"I","Ι");k(T,A,B,"K","Κ");k(T,A,B,"M","Μ");k(T,A,B,"N","Ν");k(T,A,B,"O","Ο");k(T,A,B,"P","Ρ");k(T,A,B,"T","Τ");k(T,A,B,"X","Χ");k(T,A,B,"¬","\\neg",!0);k(T,A,B,"¬","\\lnot");k(T,A,B,"⊤","\\top");k(T,A,B,"⊥","\\bot");k(T,A,B,"∅","\\emptyset");k(T,z,B,"∅","\\varnothing");k(T,A,Ee,"α","\\alpha",!0);k(T,A,Ee,"β","\\beta",!0);k(T,A,Ee,"γ","\\gamma",!0);k(T,A,Ee,"δ","\\delta",!0);k(T,A,Ee,"ϵ","\\epsilon",!0);k(T,A,Ee,"ζ","\\zeta",!0);k(T,A,Ee,"η","\\eta",!0);k(T,A,Ee,"θ","\\theta",!0);k(T,A,Ee,"ι","\\iota",!0);k(T,A,Ee,"κ","\\kappa",!0);k(T,A,Ee,"λ","\\lambda",!0);k(T,A,Ee,"μ","\\mu",!0);k(T,A,Ee,"ν","\\nu",!0);k(T,A,Ee,"ξ","\\xi",!0);k(T,A,Ee,"ο","\\omicron",!0);k(T,A,Ee,"π","\\pi",!0);k(T,A,Ee,"ρ","\\rho",!0);k(T,A,Ee,"σ","\\sigma",!0);k(T,A,Ee,"τ","\\tau",!0);k(T,A,Ee,"υ","\\upsilon",!0);k(T,A,Ee,"ϕ","\\phi",!0);k(T,A,Ee,"χ","\\chi",!0);k(T,A,Ee,"ψ","\\psi",!0);k(T,A,Ee,"ω","\\omega",!0);k(T,A,Ee,"ε","\\varepsilon",!0);k(T,A,Ee,"ϑ","\\vartheta",!0);k(T,A,Ee,"ϖ","\\varpi",!0);k(T,A,Ee,"ϱ","\\varrho",!0);k(T,A,Ee,"ς","\\varsigma",!0);k(T,A,Ee,"φ","\\varphi",!0);k(T,A,pe,"∗","*",!0);k(T,A,pe,"+","+");k(T,A,pe,"−","-",!0);k(T,A,pe,"⋅","\\cdot",!0);k(T,A,pe,"∘","\\circ",!0);k(T,A,pe,"÷","\\div",!0);k(T,A,pe,"±","\\pm",!0);k(T,A,pe,"×","\\times",!0);k(T,A,pe,"∩","\\cap",!0);k(T,A,pe,"∪","\\cup",!0);k(T,A,pe,"∖","\\setminus",!0);k(T,A,pe,"∧","\\land");k(T,A,pe,"∨","\\lor");k(T,A,pe,"∧","\\wedge",!0);k(T,A,pe,"∨","\\vee",!0);k(T,A,B,"√","\\surd");k(T,A,Jr,"⟨","\\langle",!0);k(T,A,Jr,"∣","\\lvert");k(T,A,Jr,"∥","\\lVert");k(T,A,cr,"?","?");k(T,A,cr,"!","!");k(T,A,cr,"⟩","\\rangle",!0);k(T,A,cr,"∣","\\rvert");k(T,A,cr,"∥","\\rVert");k(T,A,F,"=","=");k(T,A,F,":",":");k(T,A,F,"≈","\\approx",!0);k(T,A,F,"≅","\\cong",!0);k(T,A,F,"≥","\\ge");k(T,A,F,"≥","\\geq",!0);k(T,A,F,"←","\\gets");k(T,A,F,">","\\gt",!0);k(T,A,F,"∈","\\in",!0);k(T,A,F,"","\\@not");k(T,A,F,"⊂","\\subset",!0);k(T,A,F,"⊃","\\supset",!0);k(T,A,F,"⊆","\\subseteq",!0);k(T,A,F,"⊇","\\supseteq",!0);k(T,z,F,"⊈","\\nsubseteq",!0);k(T,z,F,"⊉","\\nsupseteq",!0);k(T,A,F,"⊨","\\models");k(T,A,F,"←","\\leftarrow",!0);k(T,A,F,"≤","\\le");k(T,A,F,"≤","\\leq",!0);k(T,A,F,"<","\\lt",!0);k(T,A,F,"→","\\rightarrow",!0);k(T,A,F,"→","\\to");k(T,z,F,"≱","\\ngeq",!0);k(T,z,F,"≰","\\nleq",!0);k(T,A,wo," ","\\ ");k(T,A,wo," ","\\space");k(T,A,wo," ","\\nobreakspace");k(re,A,wo," ","\\ ");k(re,A,wo," "," ");k(re,A,wo," ","\\space");k(re,A,wo," ","\\nobreakspace");k(T,A,wo,null,"\\nobreak");k(T,A,wo,null,"\\allowbreak");k(T,A,Hm,",",",");k(T,A,Hm,";",";");k(T,z,pe,"⊼","\\barwedge",!0);k(T,z,pe,"⊻","\\veebar",!0);k(T,A,pe,"⊙","\\odot",!0);k(T,A,pe,"⊕","\\oplus",!0);k(T,A,pe,"⊗","\\otimes",!0);k(T,A,B,"∂","\\partial",!0);k(T,A,pe,"⊘","\\oslash",!0);k(T,z,pe,"⊚","\\circledcirc",!0);k(T,z,pe,"⊡","\\boxdot",!0);k(T,A,pe,"△","\\bigtriangleup");k(T,A,pe,"▽","\\bigtriangledown");k(T,A,pe,"†","\\dagger");k(T,A,pe,"⋄","\\diamond");k(T,A,pe,"⋆","\\star");k(T,A,pe,"◃","\\triangleleft");k(T,A,pe,"▹","\\triangleright");k(T,A,Jr,"{","\\{");k(re,A,B,"{","\\{");k(re,A,B,"{","\\textbraceleft");k(T,A,cr,"}","\\}");k(re,A,B,"}","\\}");k(re,A,B,"}","\\textbraceright");k(T,A,Jr,"{","\\lbrace");k(T,A,cr,"}","\\rbrace");k(T,A,Jr,"[","\\lbrack",!0);k(re,A,B,"[","\\lbrack",!0);k(T,A,cr,"]","\\rbrack",!0);k(re,A,B,"]","\\rbrack",!0);k(T,A,Jr,"(","\\lparen",!0);k(T,A,cr,")","\\rparen",!0);k(re,A,B,"<","\\textless",!0);k(re,A,B,">","\\textgreater",!0);k(T,A,Jr,"⌊","\\lfloor",!0);k(T,A,cr,"⌋","\\rfloor",!0);k(T,A,Jr,"⌈","\\lceil",!0);k(T,A,cr,"⌉","\\rceil",!0);k(T,A,B,"\\","\\backslash");k(T,A,B,"∣","|");k(T,A,B,"∣","\\vert");k(re,A,B,"|","\\textbar",!0);k(T,A,B,"∥","\\|");k(T,A,B,"∥","\\Vert");k(re,A,B,"∥","\\textbardbl");k(re,A,B,"~","\\textasciitilde");k(re,A,B,"\\","\\textbackslash");k(re,A,B,"^","\\textasciicircum");k(T,A,F,"↑","\\uparrow",!0);k(T,A,F,"⇑","\\Uparrow",!0);k(T,A,F,"↓","\\downarrow",!0);k(T,A,F,"⇓","\\Downarrow",!0);k(T,A,F,"↕","\\updownarrow",!0);k(T,A,F,"⇕","\\Updownarrow",!0);k(T,A,Jt,"∐","\\coprod");k(T,A,Jt,"⋁","\\bigvee");k(T,A,Jt,"⋀","\\bigwedge");k(T,A,Jt,"⨄","\\biguplus");k(T,A,Jt,"⋂","\\bigcap");k(T,A,Jt,"⋃","\\bigcup");k(T,A,Jt,"∫","\\int");k(T,A,Jt,"∫","\\intop");k(T,A,Jt,"∬","\\iint");k(T,A,Jt,"∭","\\iiint");k(T,A,Jt,"∏","\\prod");k(T,A,Jt,"∑","\\sum");k(T,A,Jt,"⨂","\\bigotimes");k(T,A,Jt,"⨁","\\bigoplus");k(T,A,Jt,"⨀","\\bigodot");k(T,A,Jt,"∮","\\oint");k(T,A,Jt,"∯","\\oiint");k(T,A,Jt,"∰","\\oiiint");k(T,A,Jt,"⨆","\\bigsqcup");k(T,A,Jt,"∫","\\smallint");k(re,A,iu,"…","\\textellipsis");k(T,A,iu,"…","\\mathellipsis");k(re,A,iu,"…","\\ldots",!0);k(T,A,iu,"…","\\ldots",!0);k(T,A,iu,"⋯","\\@cdots",!0);k(T,A,iu,"⋱","\\ddots",!0);k(T,A,B,"⋮","\\varvdots");k(re,A,B,"⋮","\\varvdots");k(T,A,At,"ˊ","\\acute");k(T,A,At,"ˋ","\\grave");k(T,A,At,"¨","\\ddot");k(T,A,At,"~","\\tilde");k(T,A,At,"ˉ","\\bar");k(T,A,At,"˘","\\breve");k(T,A,At,"ˇ","\\check");k(T,A,At,"^","\\hat");k(T,A,At,"⃗","\\vec");k(T,A,At,"˙","\\dot");k(T,A,At,"˚","\\mathring");k(T,A,Ee,"","\\@imath");k(T,A,Ee,"","\\@jmath");k(T,A,B,"ı","ı");k(T,A,B,"ȷ","ȷ");k(re,A,B,"ı","\\i",!0);k(re,A,B,"ȷ","\\j",!0);k(re,A,B,"ß","\\ss",!0);k(re,A,B,"æ","\\ae",!0);k(re,A,B,"œ","\\oe",!0);k(re,A,B,"ø","\\o",!0);k(re,A,B,"Æ","\\AE",!0);k(re,A,B,"Œ","\\OE",!0);k(re,A,B,"Ø","\\O",!0);k(re,A,At,"ˊ","\\'");k(re,A,At,"ˋ","\\`");k(re,A,At,"ˆ","\\^");k(re,A,At,"˜","\\~");k(re,A,At,"ˉ","\\=");k(re,A,At,"˘","\\u");k(re,A,At,"˙","\\.");k(re,A,At,"¸","\\c");k(re,A,At,"˚","\\r");k(re,A,At,"ˇ","\\v");k(re,A,At,"¨",'\\"');k(re,A,At,"˝","\\H");k(re,A,At,"◯","\\textcircled");var wj={"--":!0,"---":!0,"``":!0,"''":!0};k(re,A,B,"–","--",!0);k(re,A,B,"–","\\textendash");k(re,A,B,"—","---",!0);k(re,A,B,"—","\\textemdash");k(re,A,B,"‘","`",!0);k(re,A,B,"‘","\\textquoteleft");k(re,A,B,"’","'",!0);k(re,A,B,"’","\\textquoteright");k(re,A,B,"“","``",!0);k(re,A,B,"“","\\textquotedblleft");k(re,A,B,"”","''",!0);k(re,A,B,"”","\\textquotedblright");k(T,A,B,"°","\\degree",!0);k(re,A,B,"°","\\degree");k(re,A,B,"°","\\textdegree",!0);k(T,A,B,"£","\\pounds");k(T,A,B,"£","\\mathsterling",!0);k(re,A,B,"£","\\pounds");k(re,A,B,"£","\\textsterling",!0);k(T,z,B,"✠","\\maltese");k(re,z,B,"✠","\\maltese");var R8='0123456789/@."';for(var Gy=0;Gy<R8.length;Gy++){var O8=R8.charAt(Gy);k(T,A,B,O8,O8)}var L8='0123456789!@*()-=+";:?/.,';for(var Vy=0;Vy<L8.length;Vy++){var N8=L8.charAt(Vy);k(re,A,B,N8,N8)}var Pg="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz";for(var qy=0;qy<Pg.length;qy++){var op=Pg.charAt(qy);k(T,A,Ee,op,op),k(re,A,B,op,op)}k(T,z,B,"C","ℂ");k(re,z,B,"C","ℂ");k(T,z,B,"H","ℍ");k(re,z,B,"H","ℍ");k(T,z,B,"N","ℕ");k(re,z,B,"N","ℕ");k(T,z,B,"P","ℙ");k(re,z,B,"P","ℙ");k(T,z,B,"Q","ℚ");k(re,z,B,"Q","ℚ");k(T,z,B,"R","ℝ");k(re,z,B,"R","ℝ");k(T,z,B,"Z","ℤ");k(re,z,B,"Z","ℤ");k(T,A,Ee,"h","ℎ");k(re,A,Ee,"h","ℎ");var Me="";for(var Yn=0;Yn<Pg.length;Yn++){var Ut=Pg.charAt(Yn);Me=String.fromCharCode(55349,56320+Yn),k(T,A,Ee,Ut,Me),k(re,A,B,Ut,Me),Me=String.fromCharCode(55349,56372+Yn),k(T,A,Ee,Ut,Me),k(re,A,B,Ut,Me),Me=String.fromCharCode(55349,56424+Yn),k(T,A,Ee,Ut,Me),k(re,A,B,Ut,Me),Me=String.fromCharCode(55349,56580+Yn),k(T,A,Ee,Ut,Me),k(re,A,B,Ut,Me),Me=String.fromCharCode(55349,56684+Yn),k(T,A,Ee,Ut,Me),k(re,A,B,Ut,Me),Me=String.fromCharCode(55349,56736+Yn),k(T,A,Ee,Ut,Me),k(re,A,B,Ut,Me),Me=String.fromCharCode(55349,56788+Yn),k(T,A,Ee,Ut,Me),k(re,A,B,Ut,Me),Me=String.fromCharCode(55349,56840+Yn),k(T,A,Ee,Ut,Me),k(re,A,B,Ut,Me),Me=String.fromCharCode(55349,56944+Yn),k(T,A,Ee,Ut,Me),k(re,A,B,Ut,Me),Yn<26&&(Me=String.fromCharCode(55349,56632+Yn),k(T,A,Ee,Ut,Me),k(re,A,B,Ut,Me),Me=String.fromCharCode(55349,56476+Yn),k(T,A,Ee,Ut,Me),k(re,A,B,Ut,Me))}Me="𝕜";k(T,A,Ee,"k",Me);k(re,A,B,"k",Me);for(var Na=0;Na<10;Na++){var Mo=Na.toString();Me=String.fromCharCode(55349,57294+Na),k(T,A,Ee,Mo,Me),k(re,A,B,Mo,Me),Me=String.fromCharCode(55349,57314+Na),k(T,A,Ee,Mo,Me),k(re,A,B,Mo,Me),Me=String.fromCharCode(55349,57324+Na),k(T,A,Ee,Mo,Me),k(re,A,B,Mo,Me),Me=String.fromCharCode(55349,57334+Na),k(T,A,Ee,Mo,Me),k(re,A,B,Mo,Me)}var LS="ÐÞþ";for(var Yy=0;Yy<LS.length;Yy++){var ap=LS.charAt(Yy);k(T,A,Ee,ap,ap),k(re,A,B,ap,ap)}var lp=[["mathbf","textbf","Main-Bold"],["mathbf","textbf","Main-Bold"],["mathnormal","textit","Math-Italic"],["mathnormal","textit","Math-Italic"],["boldsymbol","boldsymbol","Main-BoldItalic"],["boldsymbol","boldsymbol","Main-BoldItalic"],["mathscr","textscr","Script-Regular"],["","",""],["","",""],["","",""],["mathfrak","textfrak","Fraktur-Regular"],["mathfrak","textfrak","Fraktur-Regular"],["mathbb","textbb","AMS-Regular"],["mathbb","textbb","AMS-Regular"],["mathboldfrak","textboldfrak","Fraktur-Regular"],["mathboldfrak","textboldfrak","Fraktur-Regular"],["mathsf","textsf","SansSerif-Regular"],["mathsf","textsf","SansSerif-Regular"],["mathboldsf","textboldsf","SansSerif-Bold"],["mathboldsf","textboldsf","SansSerif-Bold"],["mathitsf","textitsf","SansSerif-Italic"],["mathitsf","textitsf","SansSerif-Italic"],["","",""],["","",""],["mathtt","texttt","Typewriter-Regular"],["mathtt","texttt","Typewriter-Regular"]],z8=[["mathbf","textbf","Main-Bold"],["","",""],["mathsf","textsf","SansSerif-Regular"],["mathboldsf","textboldsf","SansSerif-Bold"],["mathtt","texttt","Typewriter-Regular"]],e0e=function(e,n){var r=e.charCodeAt(0),s=e.charCodeAt(1),i=(r-55296)*1024+(s-56320)+65536,o=n==="math"?0:1;if(119808<=i&&i<120484){var a=Math.floor((i-119808)/26);return[lp[a][2],lp[a][o]]}else if(120782<=i&&i<=120831){var l=Math.floor((i-120782)/10);return[z8[l][2],z8[l][o]]}else{if(i===120485||i===120486)return[lp[0][2],lp[0][o]];if(120486<i&&i<120782)return["",""];throw new ie("Unsupported character: "+e)}},Wm=function(e,n,r){return St[r][e]&&St[r][e].replace&&(e=St[r][e].replace),{value:e,metrics:ob(e,n,r)}},_s=function(e,n,r,s,i){var o=Wm(e,n,r),a=o.metrics;e=o.value;var l;if(a){var c=a.italic;(r==="text"||s&&s.font==="mathit")&&(c=0),l=new xs(e,a.height,a.depth,c,a.skew,a.width,i)}else typeof console<"u"&&console.warn("No character metrics "+("for '"+e+"' in style '"+n+"' and mode '"+r+"'")),l=new xs(e,0,0,0,0,0,i);if(s){l.maxFontSize=s.sizeMultiplier,s.style.isTight()&&l.classes.push("mtight");var u=s.getColor();u&&(l.style.color=u)}return l},t0e=function(e,n,r,s){return s===void 0&&(s=[]),r.font==="boldsymbol"&&Wm(e,"Main-Bold",n).metrics?_s(e,"Main-Bold",n,r,s.concat(["mathbf"])):e==="\\"||St[n][e].font==="main"?_s(e,"Main-Regular",n,r,s):_s(e,"AMS-Regular",n,r,s.concat(["amsrm"]))},n0e=function(e,n,r,s,i){return i!=="textord"&&Wm(e,"Math-BoldItalic",n).metrics?{fontName:"Math-BoldItalic",fontClass:"boldsymbol"}:{fontName:"Main-Bold",fontClass:"mathbf"}},r0e=function(e,n,r){var s=e.mode,i=e.text,o=["mord"],a=s==="math"||s==="text"&&n.font,l=a?n.font:n.fontFamily,c="",u="";if(i.charCodeAt(0)===55349&&([c,u]=e0e(i,s)),c.length>0)return _s(i,c,s,n,o.concat(u));if(l){var h,p;if(l==="boldsymbol"){var f=n0e(i,s,n,o,r);h=f.fontName,p=[f.fontClass]}else a?(h=Pj[l].fontName,p=[l]):(h=cp(l,n.fontWeight,n.fontShape),p=[l,n.fontWeight,n.fontShape]);if(Wm(i,h,s).metrics)return _s(i,h,s,n,o.concat(p));if(wj.hasOwnProperty(i)&&h.slice(0,10)==="Typewriter"){for(var v=[],m=0;m<i.length;m++)v.push(_s(i[m],h,s,n,o.concat(p)));return Cj(v)}}if(r==="mathord")return _s(i,"Math-Italic",s,n,o.concat(["mathnormal"]));if(r==="textord"){var x=St[s][i]&&St[s][i].font;if(x==="ams"){var y=cp("amsrm",n.fontWeight,n.fontShape);return _s(i,y,s,n,o.concat("amsrm",n.fontWeight,n.fontShape))}else if(x==="main"||!x){var S=cp("textrm",n.fontWeight,n.fontShape);return _s(i,S,s,n,o.concat(n.fontWeight,n.fontShape))}else{var w=cp(x,n.fontWeight,n.fontShape);return _s(i,w,s,n,o.concat(w,n.fontWeight,n.fontShape))}}else throw new Error("unexpected type: "+r+" in makeOrd")},s0e=(t,e)=>{if(ha(t.classes)!==ha(e.classes)||t.skew!==e.skew||t.maxFontSize!==e.maxFontSize)return!1;if(t.classes.length===1){var n=t.classes[0];if(n==="mbin"||n==="mord")return!1}for(var r in t.style)if(t.style.hasOwnProperty(r)&&t.style[r]!==e.style[r])return!1;for(var s in e.style)if(e.style.hasOwnProperty(s)&&t.style[s]!==e.style[s])return!1;return!0},i0e=t=>{for(var e=0;e<t.length-1;e++){var n=t[e],r=t[e+1];n instanceof xs&&r instanceof xs&&s0e(n,r)&&(n.text+=r.text,n.height=Math.max(n.height,r.height),n.depth=Math.max(n.depth,r.depth),n.italic=r.italic,t.splice(e+1,1),e--)}return t},lb=function(e){for(var n=0,r=0,s=0,i=0;i<e.children.length;i++){var o=e.children[i];o.height>n&&(n=o.height),o.depth>r&&(r=o.depth),o.maxFontSize>s&&(s=o.maxFontSize)}e.height=n,e.depth=r,e.maxFontSize=s},hr=function(e,n,r,s){var i=new Hh(e,n,r,s);return lb(i),i},bj=(t,e,n,r)=>new Hh(t,e,n,r),o0e=function(e,n,r){var s=hr([e],[],n);return s.height=Math.max(r||n.fontMetrics().defaultRuleThickness,n.minRuleThickness),s.style.borderBottomWidth=ae(s.height),s.maxFontSize=1,s},a0e=function(e,n,r,s){var i=new ab(e,n,r,s);return lb(i),i},Cj=function(e){var n=new Uh(e);return lb(n),n},l0e=function(e,n){return e instanceof Uh?hr([],[e],n):e},c0e=function(e){if(e.positionType==="individualShift"){for(var n=e.children,r=[n[0]],s=-n[0].shift-n[0].elem.depth,i=s,o=1;o<n.length;o++){var a=-n[o].shift-i-n[o].elem.depth,l=a-(n[o-1].elem.height+n[o-1].elem.depth);i=i+a,r.push({type:"kern",size:l}),r.push(n[o])}return{children:r,depth:s}}var c;if(e.positionType==="top"){for(var u=e.positionData,h=0;h<e.children.length;h++){var p=e.children[h];u-=p.type==="kern"?p.size:p.elem.height+p.elem.depth}c=u}else if(e.positionType==="bottom")c=-e.positionData;else{var f=e.children[0];if(f.type!=="elem")throw new Error('First child must have type "elem".');if(e.positionType==="shift")c=-f.elem.depth-e.positionData;else if(e.positionType==="firstBaseline")c=-f.elem.depth;else throw new Error("Invalid positionType "+e.positionType+".")}return{children:e.children,depth:c}},u0e=function(e,n){for(var{children:r,depth:s}=c0e(e),i=0,o=0;o<r.length;o++){var a=r[o];if(a.type==="elem"){var l=a.elem;i=Math.max(i,l.maxFontSize,l.height)}}i+=2;var c=hr(["pstrut"],[]);c.style.height=ae(i);for(var u=[],h=s,p=s,f=s,v=0;v<r.length;v++){var m=r[v];if(m.type==="kern")f+=m.size;else{var x=m.elem,y=m.wrapperClasses||[],S=m.wrapperStyle||{},w=hr(y,[c,x],void 0,S);w.style.top=ae(-i-f-x.depth),m.marginLeft&&(w.style.marginLeft=m.marginLeft),m.marginRight&&(w.style.marginRight=m.marginRight),u.push(w),f+=x.height+x.depth}h=Math.min(h,f),p=Math.max(p,f)}var P=hr(["vlist"],u);P.style.height=ae(p);var E;if(h<0){var M=hr([],[]),I=hr(["vlist"],[M]);I.style.height=ae(-h);var _=hr(["vlist-s"],[new xs("​")]);E=[hr(["vlist-r"],[P,_]),hr(["vlist-r"],[I])]}else E=[hr(["vlist-r"],[P])];var D=hr(["vlist-t"],E);return E.length===2&&D.classes.push("vlist-t2"),D.height=p,D.depth=-h,D},d0e=(t,e)=>{var n=hr(["mspace"],[],e),r=Lt(t,e);return n.style.marginRight=ae(r),n},cp=function(e,n,r){var s="";switch(e){case"amsrm":s="AMS";break;case"textrm":s="Main";break;case"textsf":s="SansSerif";break;case"texttt":s="Typewriter";break;default:s=e}var i;return n==="textbf"&&r==="textit"?i="BoldItalic":n==="textbf"?i="Bold":n==="textit"?i="Italic":i="Regular",s+"-"+i},Pj={mathbf:{variant:"bold",fontName:"Main-Bold"},mathrm:{variant:"normal",fontName:"Main-Regular"},textit:{variant:"italic",fontName:"Main-Italic"},mathit:{variant:"italic",fontName:"Main-Italic"},mathnormal:{variant:"italic",fontName:"Math-Italic"},mathsfit:{variant:"sans-serif-italic",fontName:"SansSerif-Italic"},mathbb:{variant:"double-struck",fontName:"AMS-Regular"},mathcal:{variant:"script",fontName:"Caligraphic-Regular"},mathfrak:{variant:"fraktur",fontName:"Fraktur-Regular"},mathscr:{variant:"script",fontName:"Script-Regular"},mathsf:{variant:"sans-serif",fontName:"SansSerif-Regular"},mathtt:{variant:"monospace",fontName:"Typewriter-Regular"}},kj={vec:["vec",.471,.714],oiintSize1:["oiintSize1",.957,.499],oiintSize2:["oiintSize2",1.472,.659],oiiintSize1:["oiiintSize1",1.304,.499],oiiintSize2:["oiiintSize2",1.98,.659]},h0e=function(e,n){var[r,s,i]=kj[e],o=new pa(r),a=new lo([o],{width:ae(s),height:ae(i),style:"width:"+ae(s),viewBox:"0 0 "+1e3*s+" "+1e3*i,preserveAspectRatio:"xMinYMin"}),l=bj(["overlay"],[a],n);return l.height=i,l.style.height=ae(i),l.style.width=ae(s),l},Y={fontMap:Pj,makeSymbol:_s,mathsym:t0e,makeSpan:hr,makeSvgSpan:bj,makeLineSpan:o0e,makeAnchor:a0e,makeFragment:Cj,wrapFragment:l0e,makeVList:u0e,makeOrd:r0e,makeGlue:d0e,staticSvg:h0e,svgData:kj,tryCombineChars:i0e},jt={number:3,unit:"mu"},za={number:4,unit:"mu"},Ri={number:5,unit:"mu"},p0e={mord:{mop:jt,mbin:za,mrel:Ri,minner:jt},mop:{mord:jt,mop:jt,mrel:Ri,minner:jt},mbin:{mord:za,mop:za,mopen:za,minner:za},mrel:{mord:Ri,mop:Ri,mopen:Ri,minner:Ri},mopen:{},mclose:{mop:jt,mbin:za,mrel:Ri,minner:jt},mpunct:{mord:jt,mop:jt,mrel:Ri,mopen:jt,mclose:jt,mpunct:jt,minner:jt},minner:{mord:jt,mop:jt,mbin:za,mrel:Ri,mopen:jt,mpunct:jt,minner:jt}},f0e={mord:{mop:jt},mop:{mord:jt,mop:jt},mbin:{},mrel:{},mopen:{},mclose:{mop:jt},mpunct:{},minner:{mop:jt}},Ij={},kg={},Ig={};function ue(t){for(var{type:e,names:n,props:r,handler:s,htmlBuilder:i,mathmlBuilder:o}=t,a={type:e,numArgs:r.numArgs,argTypes:r.argTypes,allowedInArgument:!!r.allowedInArgument,allowedInText:!!r.allowedInText,allowedInMath:r.allowedInMath===void 0?!0:r.allowedInMath,numOptionalArgs:r.numOptionalArgs||0,infix:!!r.infix,primitive:!!r.primitive,handler:s},l=0;l<n.length;++l)Ij[n[l]]=a;e&&(i&&(kg[e]=i),o&&(Ig[e]=o))}function Il(t){var{type:e,htmlBuilder:n,mathmlBuilder:r}=t;ue({type:e,names:[],props:{numArgs:0},handler(){throw new Error("Should never be called.")},htmlBuilder:n,mathmlBuilder:r})}var Eg=function(e){return e.type==="ordgroup"&&e.body.length===1?e.body[0]:e},Yt=function(e){return e.type==="ordgroup"?e.body:[e]},co=Y.makeSpan,g0e=["leftmost","mbin","mopen","mrel","mop","mpunct"],m0e=["rightmost","mrel","mclose","mpunct"],y0e={display:Te.DISPLAY,text:Te.TEXT,script:Te.SCRIPT,scriptscript:Te.SCRIPTSCRIPT},v0e={mord:"mord",mop:"mop",mbin:"mbin",mrel:"mrel",mopen:"mopen",mclose:"mclose",mpunct:"mpunct",minner:"minner"},on=function(e,n,r,s){s===void 0&&(s=[null,null]);for(var i=[],o=0;o<e.length;o++){var a=Je(e[o],n);if(a instanceof Uh){var l=a.children;i.push(...l)}else i.push(a)}if(Y.tryCombineChars(i),!r)return i;var c=n;if(e.length===1){var u=e[0];u.type==="sizing"?c=n.havingSize(u.size):u.type==="styling"&&(c=n.havingStyle(y0e[u.style]))}var h=co([s[0]||"leftmost"],[],n),p=co([s[1]||"rightmost"],[],n),f=r==="root";return F8(i,(v,m)=>{var x=m.classes[0],y=v.classes[0];x==="mbin"&&Pe.contains(m0e,y)?m.classes[0]="mord":y==="mbin"&&Pe.contains(g0e,x)&&(v.classes[0]="mord")},{node:h},p,f),F8(i,(v,m)=>{var x=NS(m),y=NS(v),S=x&&y?v.hasClass("mtight")?f0e[x][y]:p0e[x][y]:null;if(S)return Y.makeGlue(S,c)},{node:h},p,f),i},F8=function t(e,n,r,s,i){s&&e.push(s);for(var o=0;o<e.length;o++){var a=e[o],l=Ej(a);if(l){t(l.children,n,r,null,i);continue}var c=!a.hasClass("mspace");if(c){var u=n(a,r.node);u&&(r.insertAfter?r.insertAfter(u):(e.unshift(u),o++))}c?r.node=a:i&&a.hasClass("newline")&&(r.node=co(["leftmost"])),r.insertAfter=(h=>p=>{e.splice(h+1,0,p),o++})(o)}s&&e.pop()},Ej=function(e){return e instanceof Uh||e instanceof ab||e instanceof Hh&&e.hasClass("enclosing")?e:null},S0e=function t(e,n){var r=Ej(e);if(r){var s=r.children;if(s.length){if(n==="right")return t(s[s.length-1],"right");if(n==="left")return t(s[0],"left")}}return e},NS=function(e,n){return e?(n&&(e=S0e(e,n)),v0e[e.classes[0]]||null):null},dh=function(e,n){var r=["nulldelimiter"].concat(e.baseSizingClasses());return co(n.concat(r))},Je=function(e,n,r){if(!e)return co();if(kg[e.type]){var s=kg[e.type](e,n);if(r&&n.size!==r.size){s=co(n.sizingClasses(r),[s],n);var i=n.sizeMultiplier/r.sizeMultiplier;s.height*=i,s.depth*=i}return s}else throw new ie("Got group of unknown type: '"+e.type+"'")};function up(t,e){var n=co(["base"],t,e),r=co(["strut"]);return r.style.height=ae(n.height+n.depth),n.depth&&(r.style.verticalAlign=ae(-n.depth)),n.children.unshift(r),n}function zS(t,e){var n=null;t.length===1&&t[0].type==="tag"&&(n=t[0].tag,t=t[0].body);var r=on(t,e,"root"),s;r.length===2&&r[1].hasClass("tag")&&(s=r.pop());for(var i=[],o=[],a=0;a<r.length;a++)if(o.push(r[a]),r[a].hasClass("mbin")||r[a].hasClass("mrel")||r[a].hasClass("allowbreak")){for(var l=!1;a<r.length-1&&r[a+1].hasClass("mspace")&&!r[a+1].hasClass("newline");)a++,o.push(r[a]),r[a].hasClass("nobreak")&&(l=!0);l||(i.push(up(o,e)),o=[])}else r[a].hasClass("newline")&&(o.pop(),o.length>0&&(i.push(up(o,e)),o=[]),i.push(r[a]));o.length>0&&i.push(up(o,e));var c;n?(c=up(on(n,e,!0)),c.classes=["tag"],i.push(c)):s&&i.push(s);var u=co(["katex-html"],i);if(u.setAttribute("aria-hidden","true"),c){var h=c.children[0];h.style.height=ae(u.height+u.depth),u.depth&&(h.style.verticalAlign=ae(-u.depth))}return u}function Tj(t){return new Uh(t)}class Fr{constructor(e,n,r){this.type=void 0,this.attributes=void 0,this.children=void 0,this.classes=void 0,this.type=e,this.attributes={},this.children=n||[],this.classes=r||[]}setAttribute(e,n){this.attributes[e]=n}getAttribute(e){return this.attributes[e]}toNode(){var e=document.createElementNS("http://www.w3.org/1998/Math/MathML",this.type);for(var n in this.attributes)Object.prototype.hasOwnProperty.call(this.attributes,n)&&e.setAttribute(n,this.attributes[n]);this.classes.length>0&&(e.className=ha(this.classes));for(var r=0;r<this.children.length;r++)if(this.children[r]instanceof di&&this.children[r+1]instanceof di){for(var s=this.children[r].toText()+this.children[++r].toText();this.children[r+1]instanceof di;)s+=this.children[++r].toText();e.appendChild(new di(s).toNode())}else e.appendChild(this.children[r].toNode());return e}toMarkup(){var e="<"+this.type;for(var n in this.attributes)Object.prototype.hasOwnProperty.call(this.attributes,n)&&(e+=" "+n+'="',e+=Pe.escape(this.attributes[n]),e+='"');this.classes.length>0&&(e+=' class ="'+Pe.escape(ha(this.classes))+'"'),e+=">";for(var r=0;r<this.children.length;r++)e+=this.children[r].toMarkup();return e+="</"+this.type+">",e}toText(){return this.children.map(e=>e.toText()).join("")}}class di{constructor(e){this.text=void 0,this.text=e}toNode(){return document.createTextNode(this.text)}toMarkup(){return Pe.escape(this.toText())}toText(){return this.text}}class x0e{constructor(e){this.width=void 0,this.character=void 0,this.width=e,e>=.05555&&e<=.05556?this.character=" ":e>=.1666&&e<=.1667?this.character=" ":e>=.2222&&e<=.2223?this.character=" ":e>=.2777&&e<=.2778?this.character="  ":e>=-.05556&&e<=-.05555?this.character=" ⁣":e>=-.1667&&e<=-.1666?this.character=" ⁣":e>=-.2223&&e<=-.2222?this.character=" ⁣":e>=-.2778&&e<=-.2777?this.character=" ⁣":this.character=null}toNode(){if(this.character)return document.createTextNode(this.character);var e=document.createElementNS("http://www.w3.org/1998/Math/MathML","mspace");return e.setAttribute("width",ae(this.width)),e}toMarkup(){return this.character?"<mtext>"+this.character+"</mtext>":'<mspace width="'+ae(this.width)+'"/>'}toText(){return this.character?this.character:" "}}var se={MathNode:Fr,TextNode:di,SpaceNode:x0e,newDocumentFragment:Tj},ws=function(e,n,r){return St[n][e]&&St[n][e].replace&&e.charCodeAt(0)!==55349&&!(wj.hasOwnProperty(e)&&r&&(r.fontFamily&&r.fontFamily.slice(4,6)==="tt"||r.font&&r.font.slice(4,6)==="tt"))&&(e=St[n][e].replace),new se.TextNode(e)},cb=function(e){return e.length===1?e[0]:new se.MathNode("mrow",e)},ub=function(e,n){if(n.fontFamily==="texttt")return"monospace";if(n.fontFamily==="textsf")return n.fontShape==="textit"&&n.fontWeight==="textbf"?"sans-serif-bold-italic":n.fontShape==="textit"?"sans-serif-italic":n.fontWeight==="textbf"?"bold-sans-serif":"sans-serif";if(n.fontShape==="textit"&&n.fontWeight==="textbf")return"bold-italic";if(n.fontShape==="textit")return"italic";if(n.fontWeight==="textbf")return"bold";var r=n.font;if(!r||r==="mathnormal")return null;var s=e.mode;if(r==="mathit")return"italic";if(r==="boldsymbol")return e.type==="textord"?"bold":"bold-italic";if(r==="mathbf")return"bold";if(r==="mathbb")return"double-struck";if(r==="mathsfit")return"sans-serif-italic";if(r==="mathfrak")return"fraktur";if(r==="mathscr"||r==="mathcal")return"script";if(r==="mathsf")return"sans-serif";if(r==="mathtt")return"monospace";var i=e.text;if(Pe.contains(["\\imath","\\jmath"],i))return null;St[s][i]&&St[s][i].replace&&(i=St[s][i].replace);var o=Y.fontMap[r].fontName;return ob(i,o,s)?Y.fontMap[r].variant:null};function Xy(t){if(!t)return!1;if(t.type==="mi"&&t.children.length===1){var e=t.children[0];return e instanceof di&&e.text==="."}else if(t.type==="mo"&&t.children.length===1&&t.getAttribute("separator")==="true"&&t.getAttribute("lspace")==="0em"&&t.getAttribute("rspace")==="0em"){var n=t.children[0];return n instanceof di&&n.text===","}else return!1}var Mr=function(e,n,r){if(e.length===1){var s=ht(e[0],n);return r&&s instanceof Fr&&s.type==="mo"&&(s.setAttribute("lspace","0em"),s.setAttribute("rspace","0em")),[s]}for(var i=[],o,a=0;a<e.length;a++){var l=ht(e[a],n);if(l instanceof Fr&&o instanceof Fr){if(l.type==="mtext"&&o.type==="mtext"&&l.getAttribute("mathvariant")===o.getAttribute("mathvariant")){o.children.push(...l.children);continue}else if(l.type==="mn"&&o.type==="mn"){o.children.push(...l.children);continue}else if(Xy(l)&&o.type==="mn"){o.children.push(...l.children);continue}else if(l.type==="mn"&&Xy(o))l.children=[...o.children,...l.children],i.pop();else if((l.type==="msup"||l.type==="msub")&&l.children.length>=1&&(o.type==="mn"||Xy(o))){var c=l.children[0];c instanceof Fr&&c.type==="mn"&&(c.children=[...o.children,...c.children],i.pop())}else if(o.type==="mi"&&o.children.length===1){var u=o.children[0];if(u instanceof di&&u.text==="̸"&&(l.type==="mo"||l.type==="mi"||l.type==="mn")){var h=l.children[0];h instanceof di&&h.text.length>0&&(h.text=h.text.slice(0,1)+"̸"+h.text.slice(1),i.pop())}}}i.push(l),o=l}return i},fa=function(e,n,r){return cb(Mr(e,n,r))},ht=function(e,n){if(!e)return new se.MathNode("mrow");if(Ig[e.type]){var r=Ig[e.type](e,n);return r}else throw new ie("Got group of unknown type: '"+e.type+"'")};function $8(t,e,n,r,s){var i=Mr(t,n),o;i.length===1&&i[0]instanceof Fr&&Pe.contains(["mrow","mtable"],i[0].type)?o=i[0]:o=new se.MathNode("mrow",i);var a=new se.MathNode("annotation",[new se.TextNode(e)]);a.setAttribute("encoding","application/x-tex");var l=new se.MathNode("semantics",[o,a]),c=new se.MathNode("math",[l]);c.setAttribute("xmlns","http://www.w3.org/1998/Math/MathML"),r&&c.setAttribute("display","block");var u=s?"katex":"katex-mathml";return Y.makeSpan([u],[c])}var Mj=function(e){return new Bi({style:e.displayMode?Te.DISPLAY:Te.TEXT,maxSize:e.maxSize,minRuleThickness:e.minRuleThickness})},_j=function(e,n){if(n.displayMode){var r=["katex-display"];n.leqno&&r.push("leqno"),n.fleqn&&r.push("fleqn"),e=Y.makeSpan(r,[e])}return e},w0e=function(e,n,r){var s=Mj(r),i;if(r.output==="mathml")return $8(e,n,s,r.displayMode,!0);if(r.output==="html"){var o=zS(e,s);i=Y.makeSpan(["katex"],[o])}else{var a=$8(e,n,s,r.displayMode,!1),l=zS(e,s);i=Y.makeSpan(["katex"],[a,l])}return _j(i,r)},b0e=function(e,n,r){var s=Mj(r),i=zS(e,s),o=Y.makeSpan(["katex"],[i]);return _j(o,r)},C0e={widehat:"^",widecheck:"ˇ",widetilde:"~",utilde:"~",overleftarrow:"←",underleftarrow:"←",xleftarrow:"←",overrightarrow:"→",underrightarrow:"→",xrightarrow:"→",underbrace:"⏟",overbrace:"⏞",overgroup:"⏠",undergroup:"⏡",overleftrightarrow:"↔",underleftrightarrow:"↔",xleftrightarrow:"↔",Overrightarrow:"⇒",xRightarrow:"⇒",overleftharpoon:"↼",xleftharpoonup:"↼",overrightharpoon:"⇀",xrightharpoonup:"⇀",xLeftarrow:"⇐",xLeftrightarrow:"⇔",xhookleftarrow:"↩",xhookrightarrow:"↪",xmapsto:"↦",xrightharpoondown:"⇁",xleftharpoondown:"↽",xrightleftharpoons:"⇌",xleftrightharpoons:"⇋",xtwoheadleftarrow:"↞",xtwoheadrightarrow:"↠",xlongequal:"=",xtofrom:"⇄",xrightleftarrows:"⇄",xrightequilibrium:"⇌",xleftequilibrium:"⇋","\\cdrightarrow":"→","\\cdleftarrow":"←","\\cdlongequal":"="},P0e=function(e){var n=new se.MathNode("mo",[new se.TextNode(C0e[e.replace(/^\\/,"")])]);return n.setAttribute("stretchy","true"),n},k0e={overrightarrow:[["rightarrow"],.888,522,"xMaxYMin"],overleftarrow:[["leftarrow"],.888,522,"xMinYMin"],underrightarrow:[["rightarrow"],.888,522,"xMaxYMin"],underleftarrow:[["leftarrow"],.888,522,"xMinYMin"],xrightarrow:[["rightarrow"],1.469,522,"xMaxYMin"],"\\cdrightarrow":[["rightarrow"],3,522,"xMaxYMin"],xleftarrow:[["leftarrow"],1.469,522,"xMinYMin"],"\\cdleftarrow":[["leftarrow"],3,522,"xMinYMin"],Overrightarrow:[["doublerightarrow"],.888,560,"xMaxYMin"],xRightarrow:[["doublerightarrow"],1.526,560,"xMaxYMin"],xLeftarrow:[["doubleleftarrow"],1.526,560,"xMinYMin"],overleftharpoon:[["leftharpoon"],.888,522,"xMinYMin"],xleftharpoonup:[["leftharpoon"],.888,522,"xMinYMin"],xleftharpoondown:[["leftharpoondown"],.888,522,"xMinYMin"],overrightharpoon:[["rightharpoon"],.888,522,"xMaxYMin"],xrightharpoonup:[["rightharpoon"],.888,522,"xMaxYMin"],xrightharpoondown:[["rightharpoondown"],.888,522,"xMaxYMin"],xlongequal:[["longequal"],.888,334,"xMinYMin"],"\\cdlongequal":[["longequal"],3,334,"xMinYMin"],xtwoheadleftarrow:[["twoheadleftarrow"],.888,334,"xMinYMin"],xtwoheadrightarrow:[["twoheadrightarrow"],.888,334,"xMaxYMin"],overleftrightarrow:[["leftarrow","rightarrow"],.888,522],overbrace:[["leftbrace","midbrace","rightbrace"],1.6,548],underbrace:[["leftbraceunder","midbraceunder","rightbraceunder"],1.6,548],underleftrightarrow:[["leftarrow","rightarrow"],.888,522],xleftrightarrow:[["leftarrow","rightarrow"],1.75,522],xLeftrightarrow:[["doubleleftarrow","doublerightarrow"],1.75,560],xrightleftharpoons:[["leftharpoondownplus","rightharpoonplus"],1.75,716],xleftrightharpoons:[["leftharpoonplus","rightharpoondownplus"],1.75,716],xhookleftarrow:[["leftarrow","righthook"],1.08,522],xhookrightarrow:[["lefthook","rightarrow"],1.08,522],overlinesegment:[["leftlinesegment","rightlinesegment"],.888,522],underlinesegment:[["leftlinesegment","rightlinesegment"],.888,522],overgroup:[["leftgroup","rightgroup"],.888,342],undergroup:[["leftgroupunder","rightgroupunder"],.888,342],xmapsto:[["leftmapsto","rightarrow"],1.5,522],xtofrom:[["leftToFrom","rightToFrom"],1.75,528],xrightleftarrows:[["baraboveleftarrow","rightarrowabovebar"],1.75,901],xrightequilibrium:[["baraboveshortleftharpoon","rightharpoonaboveshortbar"],1.75,716],xleftequilibrium:[["shortbaraboveleftharpoon","shortrightharpoonabovebar"],1.75,716]},I0e=function(e){return e.type==="ordgroup"?e.body.length:1},E0e=function(e,n){function r(){var a=4e5,l=e.label.slice(1);if(Pe.contains(["widehat","widecheck","widetilde","utilde"],l)){var c=e,u=I0e(c.base),h,p,f;if(u>5)l==="widehat"||l==="widecheck"?(h=420,a=2364,f=.42,p=l+"4"):(h=312,a=2340,f=.34,p="tilde4");else{var v=[1,1,2,2,3,3][u];l==="widehat"||l==="widecheck"?(a=[0,1062,2364,2364,2364][v],h=[0,239,300,360,420][v],f=[0,.24,.3,.3,.36,.42][v],p=l+v):(a=[0,600,1033,2339,2340][v],h=[0,260,286,306,312][v],f=[0,.26,.286,.3,.306,.34][v],p="tilde"+v)}var m=new pa(p),x=new lo([m],{width:"100%",height:ae(f),viewBox:"0 0 "+a+" "+h,preserveAspectRatio:"none"});return{span:Y.makeSvgSpan([],[x],n),minWidth:0,height:f}}else{var y=[],S=k0e[l],[w,P,E]=S,M=E/1e3,I=w.length,_,D;if(I===1){var R=S[3];_=["hide-tail"],D=[R]}else if(I===2)_=["halfarrow-left","halfarrow-right"],D=["xMinYMin","xMaxYMin"];else if(I===3)_=["brace-left","brace-center","brace-right"],D=["xMinYMin","xMidYMin","xMaxYMin"];else throw new Error(`Correct katexImagesData or update code here to support
                    `+I+" children.");for(var $=0;$<I;$++){var U=new pa(w[$]),O=new lo([U],{width:"400em",height:ae(M),viewBox:"0 0 "+a+" "+E,preserveAspectRatio:D[$]+" slice"}),N=Y.makeSvgSpan([_[$]],[O],n);if(I===1)return{span:N,minWidth:P,height:M};N.style.height=ae(M),y.push(N)}return{span:Y.makeSpan(["stretchy"],y,n),minWidth:P,height:M}}}var{span:s,minWidth:i,height:o}=r();return s.height=o,s.style.height=ae(o),i>0&&(s.style.minWidth=ae(i)),s},T0e=function(e,n,r,s,i){var o,a=e.height+e.depth+r+s;if(/fbox|color|angl/.test(n)){if(o=Y.makeSpan(["stretchy",n],[],i),n==="fbox"){var l=i.color&&i.getColor();l&&(o.style.borderColor=l)}}else{var c=[];/^[bx]cancel$/.test(n)&&c.push(new OS({x1:"0",y1:"0",x2:"100%",y2:"100%","stroke-width":"0.046em"})),/^x?cancel$/.test(n)&&c.push(new OS({x1:"0",y1:"100%",x2:"100%",y2:"0","stroke-width":"0.046em"}));var u=new lo(c,{width:"100%",height:ae(a)});o=Y.makeSvgSpan([],[u],i)}return o.height=a,o.style.height=ae(a),o},uo={encloseSpan:T0e,mathMLnode:P0e,svgSpan:E0e};function Oe(t,e){if(!t||t.type!==e)throw new Error("Expected node of type "+e+", but got "+(t?"node of type "+t.type:String(t)));return t}function db(t){var e=Km(t);if(!e)throw new Error("Expected node of symbol group type, but got "+(t?"node of type "+t.type:String(t)));return e}function Km(t){return t&&(t.type==="atom"||Jhe.hasOwnProperty(t.type))?t:null}var hb=(t,e)=>{var n,r,s;t&&t.type==="supsub"?(r=Oe(t.base,"accent"),n=r.base,t.base=n,s=Zhe(Je(t,e)),t.base=r):(r=Oe(t,"accent"),n=r.base);var i=Je(n,e.havingCrampedStyle()),o=r.isShifty&&Pe.isCharacterBox(n),a=0;if(o){var l=Pe.getBaseElem(n),c=Je(l,e.havingCrampedStyle());a=j8(c).skew}var u=r.label==="\\c",h=u?i.height+i.depth:Math.min(i.height,e.fontMetrics().xHeight),p;if(r.isStretchy)p=uo.svgSpan(r,e),p=Y.makeVList({positionType:"firstBaseline",children:[{type:"elem",elem:i},{type:"elem",elem:p,wrapperClasses:["svg-align"],wrapperStyle:a>0?{width:"calc(100% - "+ae(2*a)+")",marginLeft:ae(2*a)}:void 0}]},e);else{var f,v;r.label==="\\vec"?(f=Y.staticSvg("vec",e),v=Y.svgData.vec[1]):(f=Y.makeOrd({mode:r.mode,text:r.label},e,"textord"),f=j8(f),f.italic=0,v=f.width,u&&(h+=f.depth)),p=Y.makeSpan(["accent-body"],[f]);var m=r.label==="\\textcircled";m&&(p.classes.push("accent-full"),h=i.height);var x=a;m||(x-=v/2),p.style.left=ae(x),r.label==="\\textcircled"&&(p.style.top=".2em"),p=Y.makeVList({positionType:"firstBaseline",children:[{type:"elem",elem:i},{type:"kern",size:-h},{type:"elem",elem:p}]},e)}var y=Y.makeSpan(["mord","accent"],[p],e);return s?(s.children[0]=y,s.height=Math.max(y.height,s.height),s.classes[0]="mord",s):y},Aj=(t,e)=>{var n=t.isStretchy?uo.mathMLnode(t.label):new se.MathNode("mo",[ws(t.label,t.mode)]),r=new se.MathNode("mover",[ht(t.base,e),n]);return r.setAttribute("accent","true"),r},M0e=new RegExp(["\\acute","\\grave","\\ddot","\\tilde","\\bar","\\breve","\\check","\\hat","\\vec","\\dot","\\mathring"].map(t=>"\\"+t).join("|"));ue({type:"accent",names:["\\acute","\\grave","\\ddot","\\tilde","\\bar","\\breve","\\check","\\hat","\\vec","\\dot","\\mathring","\\widecheck","\\widehat","\\widetilde","\\overrightarrow","\\overleftarrow","\\Overrightarrow","\\overleftrightarrow","\\overgroup","\\overlinesegment","\\overleftharpoon","\\overrightharpoon"],props:{numArgs:1},handler:(t,e)=>{var n=Eg(e[0]),r=!M0e.test(t.funcName),s=!r||t.funcName==="\\widehat"||t.funcName==="\\widetilde"||t.funcName==="\\widecheck";return{type:"accent",mode:t.parser.mode,label:t.funcName,isStretchy:r,isShifty:s,base:n}},htmlBuilder:hb,mathmlBuilder:Aj});ue({type:"accent",names:["\\'","\\`","\\^","\\~","\\=","\\u","\\.",'\\"',"\\c","\\r","\\H","\\v","\\textcircled"],props:{numArgs:1,allowedInText:!0,allowedInMath:!0,argTypes:["primitive"]},handler:(t,e)=>{var n=e[0],r=t.parser.mode;return r==="math"&&(t.parser.settings.reportNonstrict("mathVsTextAccents","LaTeX's accent "+t.funcName+" works only in text mode"),r="text"),{type:"accent",mode:r,label:t.funcName,isStretchy:!1,isShifty:!0,base:n}},htmlBuilder:hb,mathmlBuilder:Aj});ue({type:"accentUnder",names:["\\underleftarrow","\\underrightarrow","\\underleftrightarrow","\\undergroup","\\underlinesegment","\\utilde"],props:{numArgs:1},handler:(t,e)=>{var{parser:n,funcName:r}=t,s=e[0];return{type:"accentUnder",mode:n.mode,label:r,base:s}},htmlBuilder:(t,e)=>{var n=Je(t.base,e),r=uo.svgSpan(t,e),s=t.label==="\\utilde"?.12:0,i=Y.makeVList({positionType:"top",positionData:n.height,children:[{type:"elem",elem:r,wrapperClasses:["svg-align"]},{type:"kern",size:s},{type:"elem",elem:n}]},e);return Y.makeSpan(["mord","accentunder"],[i],e)},mathmlBuilder:(t,e)=>{var n=uo.mathMLnode(t.label),r=new se.MathNode("munder",[ht(t.base,e),n]);return r.setAttribute("accentunder","true"),r}});var dp=t=>{var e=new se.MathNode("mpadded",t?[t]:[]);return e.setAttribute("width","+0.6em"),e.setAttribute("lspace","0.3em"),e};ue({type:"xArrow",names:["\\xleftarrow","\\xrightarrow","\\xLeftarrow","\\xRightarrow","\\xleftrightarrow","\\xLeftrightarrow","\\xhookleftarrow","\\xhookrightarrow","\\xmapsto","\\xrightharpoondown","\\xrightharpoonup","\\xleftharpoondown","\\xleftharpoonup","\\xrightleftharpoons","\\xleftrightharpoons","\\xlongequal","\\xtwoheadrightarrow","\\xtwoheadleftarrow","\\xtofrom","\\xrightleftarrows","\\xrightequilibrium","\\xleftequilibrium","\\\\cdrightarrow","\\\\cdleftarrow","\\\\cdlongequal"],props:{numArgs:1,numOptionalArgs:1},handler(t,e,n){var{parser:r,funcName:s}=t;return{type:"xArrow",mode:r.mode,label:s,body:e[0],below:n[0]}},htmlBuilder(t,e){var n=e.style,r=e.havingStyle(n.sup()),s=Y.wrapFragment(Je(t.body,r,e),e),i=t.label.slice(0,2)==="\\x"?"x":"cd";s.classes.push(i+"-arrow-pad");var o;t.below&&(r=e.havingStyle(n.sub()),o=Y.wrapFragment(Je(t.below,r,e),e),o.classes.push(i+"-arrow-pad"));var a=uo.svgSpan(t,e),l=-e.fontMetrics().axisHeight+.5*a.height,c=-e.fontMetrics().axisHeight-.5*a.height-.111;(s.depth>.25||t.label==="\\xleftequilibrium")&&(c-=s.depth);var u;if(o){var h=-e.fontMetrics().axisHeight+o.height+.5*a.height+.111;u=Y.makeVList({positionType:"individualShift",children:[{type:"elem",elem:s,shift:c},{type:"elem",elem:a,shift:l},{type:"elem",elem:o,shift:h}]},e)}else u=Y.makeVList({positionType:"individualShift",children:[{type:"elem",elem:s,shift:c},{type:"elem",elem:a,shift:l}]},e);return u.children[0].children[0].children[1].classes.push("svg-align"),Y.makeSpan(["mrel","x-arrow"],[u],e)},mathmlBuilder(t,e){var n=uo.mathMLnode(t.label);n.setAttribute("minsize",t.label.charAt(0)==="x"?"1.75em":"3.0em");var r;if(t.body){var s=dp(ht(t.body,e));if(t.below){var i=dp(ht(t.below,e));r=new se.MathNode("munderover",[n,i,s])}else r=new se.MathNode("mover",[n,s])}else if(t.below){var o=dp(ht(t.below,e));r=new se.MathNode("munder",[n,o])}else r=dp(),r=new se.MathNode("mover",[n,r]);return r}});var _0e=Y.makeSpan;function Dj(t,e){var n=on(t.body,e,!0);return _0e([t.mclass],n,e)}function jj(t,e){var n,r=Mr(t.body,e);return t.mclass==="minner"?n=new se.MathNode("mpadded",r):t.mclass==="mord"?t.isCharacterBox?(n=r[0],n.type="mi"):n=new se.MathNode("mi",r):(t.isCharacterBox?(n=r[0],n.type="mo"):n=new se.MathNode("mo",r),t.mclass==="mbin"?(n.attributes.lspace="0.22em",n.attributes.rspace="0.22em"):t.mclass==="mpunct"?(n.attributes.lspace="0em",n.attributes.rspace="0.17em"):t.mclass==="mopen"||t.mclass==="mclose"?(n.attributes.lspace="0em",n.attributes.rspace="0em"):t.mclass==="minner"&&(n.attributes.lspace="0.0556em",n.attributes.width="+0.1111em")),n}ue({type:"mclass",names:["\\mathord","\\mathbin","\\mathrel","\\mathopen","\\mathclose","\\mathpunct","\\mathinner"],props:{numArgs:1,primitive:!0},handler(t,e){var{parser:n,funcName:r}=t,s=e[0];return{type:"mclass",mode:n.mode,mclass:"m"+r.slice(5),body:Yt(s),isCharacterBox:Pe.isCharacterBox(s)}},htmlBuilder:Dj,mathmlBuilder:jj});var Gm=t=>{var e=t.type==="ordgroup"&&t.body.length?t.body[0]:t;return e.type==="atom"&&(e.family==="bin"||e.family==="rel")?"m"+e.family:"mord"};ue({type:"mclass",names:["\\@binrel"],props:{numArgs:2},handler(t,e){var{parser:n}=t;return{type:"mclass",mode:n.mode,mclass:Gm(e[0]),body:Yt(e[1]),isCharacterBox:Pe.isCharacterBox(e[1])}}});ue({type:"mclass",names:["\\stackrel","\\overset","\\underset"],props:{numArgs:2},handler(t,e){var{parser:n,funcName:r}=t,s=e[1],i=e[0],o;r!=="\\stackrel"?o=Gm(s):o="mrel";var a={type:"op",mode:s.mode,limits:!0,alwaysHandleSupSub:!0,parentIsSupSub:!1,symbol:!1,suppressBaseShift:r!=="\\stackrel",body:Yt(s)},l={type:"supsub",mode:i.mode,base:a,sup:r==="\\underset"?null:i,sub:r==="\\underset"?i:null};return{type:"mclass",mode:n.mode,mclass:o,body:[l],isCharacterBox:Pe.isCharacterBox(l)}},htmlBuilder:Dj,mathmlBuilder:jj});ue({type:"pmb",names:["\\pmb"],props:{numArgs:1,allowedInText:!0},handler(t,e){var{parser:n}=t;return{type:"pmb",mode:n.mode,mclass:Gm(e[0]),body:Yt(e[0])}},htmlBuilder(t,e){var n=on(t.body,e,!0),r=Y.makeSpan([t.mclass],n,e);return r.style.textShadow="0.02em 0.01em 0.04px",r},mathmlBuilder(t,e){var n=Mr(t.body,e),r=new se.MathNode("mstyle",n);return r.setAttribute("style","text-shadow: 0.02em 0.01em 0.04px"),r}});var A0e={">":"\\\\cdrightarrow","<":"\\\\cdleftarrow","=":"\\\\cdlongequal",A:"\\uparrow",V:"\\downarrow","|":"\\Vert",".":"no arrow"},B8=()=>({type:"styling",body:[],mode:"math",style:"display"}),U8=t=>t.type==="textord"&&t.text==="@",D0e=(t,e)=>(t.type==="mathord"||t.type==="atom")&&t.text===e;function j0e(t,e,n){var r=A0e[t];switch(r){case"\\\\cdrightarrow":case"\\\\cdleftarrow":return n.callFunction(r,[e[0]],[e[1]]);case"\\uparrow":case"\\downarrow":{var s=n.callFunction("\\\\cdleft",[e[0]],[]),i={type:"atom",text:r,mode:"math",family:"rel"},o=n.callFunction("\\Big",[i],[]),a=n.callFunction("\\\\cdright",[e[1]],[]),l={type:"ordgroup",mode:"math",body:[s,o,a]};return n.callFunction("\\\\cdparent",[l],[])}case"\\\\cdlongequal":return n.callFunction("\\\\cdlongequal",[],[]);case"\\Vert":{var c={type:"textord",text:"\\Vert",mode:"math"};return n.callFunction("\\Big",[c],[])}default:return{type:"textord",text:" ",mode:"math"}}}function R0e(t){var e=[];for(t.gullet.beginGroup(),t.gullet.macros.set("\\cr","\\\\\\relax"),t.gullet.beginGroup();;){e.push(t.parseExpression(!1,"\\\\")),t.gullet.endGroup(),t.gullet.beginGroup();var n=t.fetch().text;if(n==="&"||n==="\\\\")t.consume();else if(n==="\\end"){e[e.length-1].length===0&&e.pop();break}else throw new ie("Expected \\\\ or \\cr or \\end",t.nextToken)}for(var r=[],s=[r],i=0;i<e.length;i++){for(var o=e[i],a=B8(),l=0;l<o.length;l++)if(!U8(o[l]))a.body.push(o[l]);else{r.push(a),l+=1;var c=db(o[l]).text,u=new Array(2);if(u[0]={type:"ordgroup",mode:"math",body:[]},u[1]={type:"ordgroup",mode:"math",body:[]},!("=|.".indexOf(c)>-1))if("<>AV".indexOf(c)>-1)for(var h=0;h<2;h++){for(var p=!0,f=l+1;f<o.length;f++){if(D0e(o[f],c)){p=!1,l=f;break}if(U8(o[f]))throw new ie("Missing a "+c+" character to complete a CD arrow.",o[f]);u[h].body.push(o[f])}if(p)throw new ie("Missing a "+c+" character to complete a CD arrow.",o[l])}else throw new ie('Expected one of "<>AV=|." after @',o[l]);var v=j0e(c,u,t),m={type:"styling",body:[v],mode:"math",style:"display"};r.push(m),a=B8()}i%2===0?r.push(a):r.shift(),r=[],s.push(r)}t.gullet.endGroup(),t.gullet.endGroup();var x=new Array(s[0].length).fill({type:"align",align:"c",pregap:.25,postgap:.25});return{type:"array",mode:"math",body:s,arraystretch:1,addJot:!0,rowGaps:[null],cols:x,colSeparationType:"CD",hLinesBeforeRow:new Array(s.length+1).fill([])}}ue({type:"cdlabel",names:["\\\\cdleft","\\\\cdright"],props:{numArgs:1},handler(t,e){var{parser:n,funcName:r}=t;return{type:"cdlabel",mode:n.mode,side:r.slice(4),label:e[0]}},htmlBuilder(t,e){var n=e.havingStyle(e.style.sup()),r=Y.wrapFragment(Je(t.label,n,e),e);return r.classes.push("cd-label-"+t.side),r.style.bottom=ae(.8-r.depth),r.height=0,r.depth=0,r},mathmlBuilder(t,e){var n=new se.MathNode("mrow",[ht(t.label,e)]);return n=new se.MathNode("mpadded",[n]),n.setAttribute("width","0"),t.side==="left"&&n.setAttribute("lspace","-1width"),n.setAttribute("voffset","0.7em"),n=new se.MathNode("mstyle",[n]),n.setAttribute("displaystyle","false"),n.setAttribute("scriptlevel","1"),n}});ue({type:"cdlabelparent",names:["\\\\cdparent"],props:{numArgs:1},handler(t,e){var{parser:n}=t;return{type:"cdlabelparent",mode:n.mode,fragment:e[0]}},htmlBuilder(t,e){var n=Y.wrapFragment(Je(t.fragment,e),e);return n.classes.push("cd-vert-arrow"),n},mathmlBuilder(t,e){return new se.MathNode("mrow",[ht(t.fragment,e)])}});ue({type:"textord",names:["\\@char"],props:{numArgs:1,allowedInText:!0},handler(t,e){for(var{parser:n}=t,r=Oe(e[0],"ordgroup"),s=r.body,i="",o=0;o<s.length;o++){var a=Oe(s[o],"textord");i+=a.text}var l=parseInt(i),c;if(isNaN(l))throw new ie("\\@char has non-numeric argument "+i);if(l<0||l>=1114111)throw new ie("\\@char with invalid code point "+i);return l<=65535?c=String.fromCharCode(l):(l-=65536,c=String.fromCharCode((l>>10)+55296,(l&1023)+56320)),{type:"textord",mode:n.mode,text:c}}});var Rj=(t,e)=>{var n=on(t.body,e.withColor(t.color),!1);return Y.makeFragment(n)},Oj=(t,e)=>{var n=Mr(t.body,e.withColor(t.color)),r=new se.MathNode("mstyle",n);return r.setAttribute("mathcolor",t.color),r};ue({type:"color",names:["\\textcolor"],props:{numArgs:2,allowedInText:!0,argTypes:["color","original"]},handler(t,e){var{parser:n}=t,r=Oe(e[0],"color-token").color,s=e[1];return{type:"color",mode:n.mode,color:r,body:Yt(s)}},htmlBuilder:Rj,mathmlBuilder:Oj});ue({type:"color",names:["\\color"],props:{numArgs:1,allowedInText:!0,argTypes:["color"]},handler(t,e){var{parser:n,breakOnTokenText:r}=t,s=Oe(e[0],"color-token").color;n.gullet.macros.set("\\current@color",s);var i=n.parseExpression(!0,r);return{type:"color",mode:n.mode,color:s,body:i}},htmlBuilder:Rj,mathmlBuilder:Oj});ue({type:"cr",names:["\\\\"],props:{numArgs:0,numOptionalArgs:0,allowedInText:!0},handler(t,e,n){var{parser:r}=t,s=r.gullet.future().text==="["?r.parseSizeGroup(!0):null,i=!r.settings.displayMode||!r.settings.useStrictBehavior("newLineInDisplayMode","In LaTeX, \\\\ or \\newline does nothing in display mode");return{type:"cr",mode:r.mode,newLine:i,size:s&&Oe(s,"size").value}},htmlBuilder(t,e){var n=Y.makeSpan(["mspace"],[],e);return t.newLine&&(n.classes.push("newline"),t.size&&(n.style.marginTop=ae(Lt(t.size,e)))),n},mathmlBuilder(t,e){var n=new se.MathNode("mspace");return t.newLine&&(n.setAttribute("linebreak","newline"),t.size&&n.setAttribute("height",ae(Lt(t.size,e)))),n}});var FS={"\\global":"\\global","\\long":"\\\\globallong","\\\\globallong":"\\\\globallong","\\def":"\\gdef","\\gdef":"\\gdef","\\edef":"\\xdef","\\xdef":"\\xdef","\\let":"\\\\globallet","\\futurelet":"\\\\globalfuture"},Lj=t=>{var e=t.text;if(/^(?:[\\{}$&#^_]|EOF)$/.test(e))throw new ie("Expected a control sequence",t);return e},O0e=t=>{var e=t.gullet.popToken();return e.text==="="&&(e=t.gullet.popToken(),e.text===" "&&(e=t.gullet.popToken())),e},Nj=(t,e,n,r)=>{var s=t.gullet.macros.get(n.text);s==null&&(n.noexpand=!0,s={tokens:[n],numArgs:0,unexpandable:!t.gullet.isExpandable(n.text)}),t.gullet.macros.set(e,s,r)};ue({type:"internal",names:["\\global","\\long","\\\\globallong"],props:{numArgs:0,allowedInText:!0},handler(t){var{parser:e,funcName:n}=t;e.consumeSpaces();var r=e.fetch();if(FS[r.text])return(n==="\\global"||n==="\\\\globallong")&&(r.text=FS[r.text]),Oe(e.parseFunction(),"internal");throw new ie("Invalid token after macro prefix",r)}});ue({type:"internal",names:["\\def","\\gdef","\\edef","\\xdef"],props:{numArgs:0,allowedInText:!0,primitive:!0},handler(t){var{parser:e,funcName:n}=t,r=e.gullet.popToken(),s=r.text;if(/^(?:[\\{}$&#^_]|EOF)$/.test(s))throw new ie("Expected a control sequence",r);for(var i=0,o,a=[[]];e.gullet.future().text!=="{";)if(r=e.gullet.popToken(),r.text==="#"){if(e.gullet.future().text==="{"){o=e.gullet.future(),a[i].push("{");break}if(r=e.gullet.popToken(),!/^[1-9]$/.test(r.text))throw new ie('Invalid argument number "'+r.text+'"');if(parseInt(r.text)!==i+1)throw new ie('Argument number "'+r.text+'" out of order');i++,a.push([])}else{if(r.text==="EOF")throw new ie("Expected a macro definition");a[i].push(r.text)}var{tokens:l}=e.gullet.consumeArg();return o&&l.unshift(o),(n==="\\edef"||n==="\\xdef")&&(l=e.gullet.expandTokens(l),l.reverse()),e.gullet.macros.set(s,{tokens:l,numArgs:i,delimiters:a},n===FS[n]),{type:"internal",mode:e.mode}}});ue({type:"internal",names:["\\let","\\\\globallet"],props:{numArgs:0,allowedInText:!0,primitive:!0},handler(t){var{parser:e,funcName:n}=t,r=Lj(e.gullet.popToken());e.gullet.consumeSpaces();var s=O0e(e);return Nj(e,r,s,n==="\\\\globallet"),{type:"internal",mode:e.mode}}});ue({type:"internal",names:["\\futurelet","\\\\globalfuture"],props:{numArgs:0,allowedInText:!0,primitive:!0},handler(t){var{parser:e,funcName:n}=t,r=Lj(e.gullet.popToken()),s=e.gullet.popToken(),i=e.gullet.popToken();return Nj(e,r,i,n==="\\\\globalfuture"),e.gullet.pushToken(i),e.gullet.pushToken(s),{type:"internal",mode:e.mode}}});var id=function(e,n,r){var s=St.math[e]&&St.math[e].replace,i=ob(s||e,n,r);if(!i)throw new Error("Unsupported symbol "+e+" and font size "+n+".");return i},pb=function(e,n,r,s){var i=r.havingBaseStyle(n),o=Y.makeSpan(s.concat(i.sizingClasses(r)),[e],r),a=i.sizeMultiplier/r.sizeMultiplier;return o.height*=a,o.depth*=a,o.maxFontSize=i.sizeMultiplier,o},zj=function(e,n,r){var s=n.havingBaseStyle(r),i=(1-n.sizeMultiplier/s.sizeMultiplier)*n.fontMetrics().axisHeight;e.classes.push("delimcenter"),e.style.top=ae(i),e.height-=i,e.depth+=i},L0e=function(e,n,r,s,i,o){var a=Y.makeSymbol(e,"Main-Regular",i,s),l=pb(a,n,s,o);return r&&zj(l,s,n),l},N0e=function(e,n,r,s){return Y.makeSymbol(e,"Size"+n+"-Regular",r,s)},Fj=function(e,n,r,s,i,o){var a=N0e(e,n,i,s),l=pb(Y.makeSpan(["delimsizing","size"+n],[a],s),Te.TEXT,s,o);return r&&zj(l,s,Te.TEXT),l},Zy=function(e,n,r){var s;n==="Size1-Regular"?s="delim-size1":s="delim-size4";var i=Y.makeSpan(["delimsizinginner",s],[Y.makeSpan([],[Y.makeSymbol(e,n,r)])]);return{type:"elem",elem:i}},Qy=function(e,n,r){var s=ui["Size4-Regular"][e.charCodeAt(0)]?ui["Size4-Regular"][e.charCodeAt(0)][4]:ui["Size1-Regular"][e.charCodeAt(0)][4],i=new pa("inner",Uhe(e,Math.round(1e3*n))),o=new lo([i],{width:ae(s),height:ae(n),style:"width:"+ae(s),viewBox:"0 0 "+1e3*s+" "+Math.round(1e3*n),preserveAspectRatio:"xMinYMin"}),a=Y.makeSvgSpan([],[o],r);return a.height=n,a.style.height=ae(n),a.style.width=ae(s),{type:"elem",elem:a}},$S=.008,hp={type:"kern",size:-1*$S},z0e=["|","\\lvert","\\rvert","\\vert"],F0e=["\\|","\\lVert","\\rVert","\\Vert"],$j=function(e,n,r,s,i,o){var a,l,c,u,h="",p=0;a=c=u=e,l=null;var f="Size1-Regular";e==="\\uparrow"?c=u="⏐":e==="\\Uparrow"?c=u="‖":e==="\\downarrow"?a=c="⏐":e==="\\Downarrow"?a=c="‖":e==="\\updownarrow"?(a="\\uparrow",c="⏐",u="\\downarrow"):e==="\\Updownarrow"?(a="\\Uparrow",c="‖",u="\\Downarrow"):Pe.contains(z0e,e)?(c="∣",h="vert",p=333):Pe.contains(F0e,e)?(c="∥",h="doublevert",p=556):e==="["||e==="\\lbrack"?(a="⎡",c="⎢",u="⎣",f="Size4-Regular",h="lbrack",p=667):e==="]"||e==="\\rbrack"?(a="⎤",c="⎥",u="⎦",f="Size4-Regular",h="rbrack",p=667):e==="\\lfloor"||e==="⌊"?(c=a="⎢",u="⎣",f="Size4-Regular",h="lfloor",p=667):e==="\\lceil"||e==="⌈"?(a="⎡",c=u="⎢",f="Size4-Regular",h="lceil",p=667):e==="\\rfloor"||e==="⌋"?(c=a="⎥",u="⎦",f="Size4-Regular",h="rfloor",p=667):e==="\\rceil"||e==="⌉"?(a="⎤",c=u="⎥",f="Size4-Regular",h="rceil",p=667):e==="("||e==="\\lparen"?(a="⎛",c="⎜",u="⎝",f="Size4-Regular",h="lparen",p=875):e===")"||e==="\\rparen"?(a="⎞",c="⎟",u="⎠",f="Size4-Regular",h="rparen",p=875):e==="\\{"||e==="\\lbrace"?(a="⎧",l="⎨",u="⎩",c="⎪",f="Size4-Regular"):e==="\\}"||e==="\\rbrace"?(a="⎫",l="⎬",u="⎭",c="⎪",f="Size4-Regular"):e==="\\lgroup"||e==="⟮"?(a="⎧",u="⎩",c="⎪",f="Size4-Regular"):e==="\\rgroup"||e==="⟯"?(a="⎫",u="⎭",c="⎪",f="Size4-Regular"):e==="\\lmoustache"||e==="⎰"?(a="⎧",u="⎭",c="⎪",f="Size4-Regular"):(e==="\\rmoustache"||e==="⎱")&&(a="⎫",u="⎩",c="⎪",f="Size4-Regular");var v=id(a,f,i),m=v.height+v.depth,x=id(c,f,i),y=x.height+x.depth,S=id(u,f,i),w=S.height+S.depth,P=0,E=1;if(l!==null){var M=id(l,f,i);P=M.height+M.depth,E=2}var I=m+w+P,_=Math.max(0,Math.ceil((n-I)/(E*y))),D=I+_*E*y,R=s.fontMetrics().axisHeight;r&&(R*=s.sizeMultiplier);var $=D/2-R,U=[];if(h.length>0){var O=D-m-w,N=Math.round(D*1e3),H=Hhe(h,Math.round(O*1e3)),Z=new pa(h,H),q=(p/1e3).toFixed(3)+"em",V=(N/1e3).toFixed(3)+"em",Q=new lo([Z],{width:q,height:V,viewBox:"0 0 "+p+" "+N}),ne=Y.makeSvgSpan([],[Q],s);ne.height=N/1e3,ne.style.width=q,ne.style.height=V,U.push({type:"elem",elem:ne})}else{if(U.push(Zy(u,f,i)),U.push(hp),l===null){var le=D-m-w+2*$S;U.push(Qy(c,le,s))}else{var de=(D-m-w-P)/2+2*$S;U.push(Qy(c,de,s)),U.push(hp),U.push(Zy(l,f,i)),U.push(hp),U.push(Qy(c,de,s))}U.push(hp),U.push(Zy(a,f,i))}var _e=s.havingBaseStyle(Te.TEXT),je=Y.makeVList({positionType:"bottom",positionData:$,children:U},_e);return pb(Y.makeSpan(["delimsizing","mult"],[je],_e),Te.TEXT,s,o)},Jy=80,ev=.08,tv=function(e,n,r,s,i){var o=Bhe(e,s,r),a=new pa(e,o),l=new lo([a],{width:"400em",height:ae(n),viewBox:"0 0 400000 "+r,preserveAspectRatio:"xMinYMin slice"});return Y.makeSvgSpan(["hide-tail"],[l],i)},$0e=function(e,n){var r=n.havingBaseSizing(),s=Wj("\\surd",e*r.sizeMultiplier,Hj,r),i=r.sizeMultiplier,o=Math.max(0,n.minRuleThickness-n.fontMetrics().sqrtRuleThickness),a,l=0,c=0,u=0,h;return s.type==="small"?(u=1e3+1e3*o+Jy,e<1?i=1:e<1.4&&(i=.7),l=(1+o+ev)/i,c=(1+o)/i,a=tv("sqrtMain",l,u,o,n),a.style.minWidth="0.853em",h=.833/i):s.type==="large"?(u=(1e3+Jy)*Pd[s.size],c=(Pd[s.size]+o)/i,l=(Pd[s.size]+o+ev)/i,a=tv("sqrtSize"+s.size,l,u,o,n),a.style.minWidth="1.02em",h=1/i):(l=e+o+ev,c=e+o,u=Math.floor(1e3*e+o)+Jy,a=tv("sqrtTall",l,u,o,n),a.style.minWidth="0.742em",h=1.056),a.height=c,a.style.height=ae(l),{span:a,advanceWidth:h,ruleWidth:(n.fontMetrics().sqrtRuleThickness+o)*i}},Bj=["(","\\lparen",")","\\rparen","[","\\lbrack","]","\\rbrack","\\{","\\lbrace","\\}","\\rbrace","\\lfloor","\\rfloor","⌊","⌋","\\lceil","\\rceil","⌈","⌉","\\surd"],B0e=["\\uparrow","\\downarrow","\\updownarrow","\\Uparrow","\\Downarrow","\\Updownarrow","|","\\|","\\vert","\\Vert","\\lvert","\\rvert","\\lVert","\\rVert","\\lgroup","\\rgroup","⟮","⟯","\\lmoustache","\\rmoustache","⎰","⎱"],Uj=["<",">","\\langle","\\rangle","/","\\backslash","\\lt","\\gt"],Pd=[0,1.2,1.8,2.4,3],U0e=function(e,n,r,s,i){if(e==="<"||e==="\\lt"||e==="⟨"?e="\\langle":(e===">"||e==="\\gt"||e==="⟩")&&(e="\\rangle"),Pe.contains(Bj,e)||Pe.contains(Uj,e))return Fj(e,n,!1,r,s,i);if(Pe.contains(B0e,e))return $j(e,Pd[n],!1,r,s,i);throw new ie("Illegal delimiter: '"+e+"'")},H0e=[{type:"small",style:Te.SCRIPTSCRIPT},{type:"small",style:Te.SCRIPT},{type:"small",style:Te.TEXT},{type:"large",size:1},{type:"large",size:2},{type:"large",size:3},{type:"large",size:4}],W0e=[{type:"small",style:Te.SCRIPTSCRIPT},{type:"small",style:Te.SCRIPT},{type:"small",style:Te.TEXT},{type:"stack"}],Hj=[{type:"small",style:Te.SCRIPTSCRIPT},{type:"small",style:Te.SCRIPT},{type:"small",style:Te.TEXT},{type:"large",size:1},{type:"large",size:2},{type:"large",size:3},{type:"large",size:4},{type:"stack"}],K0e=function(e){if(e.type==="small")return"Main-Regular";if(e.type==="large")return"Size"+e.size+"-Regular";if(e.type==="stack")return"Size4-Regular";throw new Error("Add support for delim type '"+e.type+"' here.")},Wj=function(e,n,r,s){for(var i=Math.min(2,3-s.style.size),o=i;o<r.length&&r[o].type!=="stack";o++){var a=id(e,K0e(r[o]),"math"),l=a.height+a.depth;if(r[o].type==="small"){var c=s.havingBaseStyle(r[o].style);l*=c.sizeMultiplier}if(l>n)return r[o]}return r[r.length-1]},Kj=function(e,n,r,s,i,o){e==="<"||e==="\\lt"||e==="⟨"?e="\\langle":(e===">"||e==="\\gt"||e==="⟩")&&(e="\\rangle");var a;Pe.contains(Uj,e)?a=H0e:Pe.contains(Bj,e)?a=Hj:a=W0e;var l=Wj(e,n,a,s);return l.type==="small"?L0e(e,l.style,r,s,i,o):l.type==="large"?Fj(e,l.size,r,s,i,o):$j(e,n,r,s,i,o)},G0e=function(e,n,r,s,i,o){var a=s.fontMetrics().axisHeight*s.sizeMultiplier,l=901,c=5/s.fontMetrics().ptPerEm,u=Math.max(n-a,r+a),h=Math.max(u/500*l,2*u-c);return Kj(e,h,!0,s,i,o)},Ji={sqrtImage:$0e,sizedDelim:U0e,sizeToMaxHeight:Pd,customSizedDelim:Kj,leftRightDelim:G0e},H8={"\\bigl":{mclass:"mopen",size:1},"\\Bigl":{mclass:"mopen",size:2},"\\biggl":{mclass:"mopen",size:3},"\\Biggl":{mclass:"mopen",size:4},"\\bigr":{mclass:"mclose",size:1},"\\Bigr":{mclass:"mclose",size:2},"\\biggr":{mclass:"mclose",size:3},"\\Biggr":{mclass:"mclose",size:4},"\\bigm":{mclass:"mrel",size:1},"\\Bigm":{mclass:"mrel",size:2},"\\biggm":{mclass:"mrel",size:3},"\\Biggm":{mclass:"mrel",size:4},"\\big":{mclass:"mord",size:1},"\\Big":{mclass:"mord",size:2},"\\bigg":{mclass:"mord",size:3},"\\Bigg":{mclass:"mord",size:4}},V0e=["(","\\lparen",")","\\rparen","[","\\lbrack","]","\\rbrack","\\{","\\lbrace","\\}","\\rbrace","\\lfloor","\\rfloor","⌊","⌋","\\lceil","\\rceil","⌈","⌉","<",">","\\langle","⟨","\\rangle","⟩","\\lt","\\gt","\\lvert","\\rvert","\\lVert","\\rVert","\\lgroup","\\rgroup","⟮","⟯","\\lmoustache","\\rmoustache","⎰","⎱","/","\\backslash","|","\\vert","\\|","\\Vert","\\uparrow","\\Uparrow","\\downarrow","\\Downarrow","\\updownarrow","\\Updownarrow","."];function Vm(t,e){var n=Km(t);if(n&&Pe.contains(V0e,n.text))return n;throw n?new ie("Invalid delimiter '"+n.text+"' after '"+e.funcName+"'",t):new ie("Invalid delimiter type '"+t.type+"'",t)}ue({type:"delimsizing",names:["\\bigl","\\Bigl","\\biggl","\\Biggl","\\bigr","\\Bigr","\\biggr","\\Biggr","\\bigm","\\Bigm","\\biggm","\\Biggm","\\big","\\Big","\\bigg","\\Bigg"],props:{numArgs:1,argTypes:["primitive"]},handler:(t,e)=>{var n=Vm(e[0],t);return{type:"delimsizing",mode:t.parser.mode,size:H8[t.funcName].size,mclass:H8[t.funcName].mclass,delim:n.text}},htmlBuilder:(t,e)=>t.delim==="."?Y.makeSpan([t.mclass]):Ji.sizedDelim(t.delim,t.size,e,t.mode,[t.mclass]),mathmlBuilder:t=>{var e=[];t.delim!=="."&&e.push(ws(t.delim,t.mode));var n=new se.MathNode("mo",e);t.mclass==="mopen"||t.mclass==="mclose"?n.setAttribute("fence","true"):n.setAttribute("fence","false"),n.setAttribute("stretchy","true");var r=ae(Ji.sizeToMaxHeight[t.size]);return n.setAttribute("minsize",r),n.setAttribute("maxsize",r),n}});function W8(t){if(!t.body)throw new Error("Bug: The leftright ParseNode wasn't fully parsed.")}ue({type:"leftright-right",names:["\\right"],props:{numArgs:1,primitive:!0},handler:(t,e)=>{var n=t.parser.gullet.macros.get("\\current@color");if(n&&typeof n!="string")throw new ie("\\current@color set to non-string in \\right");return{type:"leftright-right",mode:t.parser.mode,delim:Vm(e[0],t).text,color:n}}});ue({type:"leftright",names:["\\left"],props:{numArgs:1,primitive:!0},handler:(t,e)=>{var n=Vm(e[0],t),r=t.parser;++r.leftrightDepth;var s=r.parseExpression(!1);--r.leftrightDepth,r.expect("\\right",!1);var i=Oe(r.parseFunction(),"leftright-right");return{type:"leftright",mode:r.mode,body:s,left:n.text,right:i.delim,rightColor:i.color}},htmlBuilder:(t,e)=>{W8(t);for(var n=on(t.body,e,!0,["mopen","mclose"]),r=0,s=0,i=!1,o=0;o<n.length;o++)n[o].isMiddle?i=!0:(r=Math.max(n[o].height,r),s=Math.max(n[o].depth,s));r*=e.sizeMultiplier,s*=e.sizeMultiplier;var a;if(t.left==="."?a=dh(e,["mopen"]):a=Ji.leftRightDelim(t.left,r,s,e,t.mode,["mopen"]),n.unshift(a),i)for(var l=1;l<n.length;l++){var c=n[l],u=c.isMiddle;u&&(n[l]=Ji.leftRightDelim(u.delim,r,s,u.options,t.mode,[]))}var h;if(t.right===".")h=dh(e,["mclose"]);else{var p=t.rightColor?e.withColor(t.rightColor):e;h=Ji.leftRightDelim(t.right,r,s,p,t.mode,["mclose"])}return n.push(h),Y.makeSpan(["minner"],n,e)},mathmlBuilder:(t,e)=>{W8(t);var n=Mr(t.body,e);if(t.left!=="."){var r=new se.MathNode("mo",[ws(t.left,t.mode)]);r.setAttribute("fence","true"),n.unshift(r)}if(t.right!=="."){var s=new se.MathNode("mo",[ws(t.right,t.mode)]);s.setAttribute("fence","true"),t.rightColor&&s.setAttribute("mathcolor",t.rightColor),n.push(s)}return cb(n)}});ue({type:"middle",names:["\\middle"],props:{numArgs:1,primitive:!0},handler:(t,e)=>{var n=Vm(e[0],t);if(!t.parser.leftrightDepth)throw new ie("\\middle without preceding \\left",n);return{type:"middle",mode:t.parser.mode,delim:n.text}},htmlBuilder:(t,e)=>{var n;if(t.delim===".")n=dh(e,[]);else{n=Ji.sizedDelim(t.delim,1,e,t.mode,[]);var r={delim:t.delim,options:e};n.isMiddle=r}return n},mathmlBuilder:(t,e)=>{var n=t.delim==="\\vert"||t.delim==="|"?ws("|","text"):ws(t.delim,t.mode),r=new se.MathNode("mo",[n]);return r.setAttribute("fence","true"),r.setAttribute("lspace","0.05em"),r.setAttribute("rspace","0.05em"),r}});var fb=(t,e)=>{var n=Y.wrapFragment(Je(t.body,e),e),r=t.label.slice(1),s=e.sizeMultiplier,i,o=0,a=Pe.isCharacterBox(t.body);if(r==="sout")i=Y.makeSpan(["stretchy","sout"]),i.height=e.fontMetrics().defaultRuleThickness/s,o=-.5*e.fontMetrics().xHeight;else if(r==="phase"){var l=Lt({number:.6,unit:"pt"},e),c=Lt({number:.35,unit:"ex"},e),u=e.havingBaseSizing();s=s/u.sizeMultiplier;var h=n.height+n.depth+l+c;n.style.paddingLeft=ae(h/2+l);var p=Math.floor(1e3*h*s),f=Fhe(p),v=new lo([new pa("phase",f)],{width:"400em",height:ae(p/1e3),viewBox:"0 0 400000 "+p,preserveAspectRatio:"xMinYMin slice"});i=Y.makeSvgSpan(["hide-tail"],[v],e),i.style.height=ae(h),o=n.depth+l+c}else{/cancel/.test(r)?a||n.classes.push("cancel-pad"):r==="angl"?n.classes.push("anglpad"):n.classes.push("boxpad");var m=0,x=0,y=0;/box/.test(r)?(y=Math.max(e.fontMetrics().fboxrule,e.minRuleThickness),m=e.fontMetrics().fboxsep+(r==="colorbox"?0:y),x=m):r==="angl"?(y=Math.max(e.fontMetrics().defaultRuleThickness,e.minRuleThickness),m=4*y,x=Math.max(0,.25-n.depth)):(m=a?.2:0,x=m),i=uo.encloseSpan(n,r,m,x,e),/fbox|boxed|fcolorbox/.test(r)?(i.style.borderStyle="solid",i.style.borderWidth=ae(y)):r==="angl"&&y!==.049&&(i.style.borderTopWidth=ae(y),i.style.borderRightWidth=ae(y)),o=n.depth+x,t.backgroundColor&&(i.style.backgroundColor=t.backgroundColor,t.borderColor&&(i.style.borderColor=t.borderColor))}var S;if(t.backgroundColor)S=Y.makeVList({positionType:"individualShift",children:[{type:"elem",elem:i,shift:o},{type:"elem",elem:n,shift:0}]},e);else{var w=/cancel|phase/.test(r)?["svg-align"]:[];S=Y.makeVList({positionType:"individualShift",children:[{type:"elem",elem:n,shift:0},{type:"elem",elem:i,shift:o,wrapperClasses:w}]},e)}return/cancel/.test(r)&&(S.height=n.height,S.depth=n.depth),/cancel/.test(r)&&!a?Y.makeSpan(["mord","cancel-lap"],[S],e):Y.makeSpan(["mord"],[S],e)},gb=(t,e)=>{var n=0,r=new se.MathNode(t.label.indexOf("colorbox")>-1?"mpadded":"menclose",[ht(t.body,e)]);switch(t.label){case"\\cancel":r.setAttribute("notation","updiagonalstrike");break;case"\\bcancel":r.setAttribute("notation","downdiagonalstrike");break;case"\\phase":r.setAttribute("notation","phasorangle");break;case"\\sout":r.setAttribute("notation","horizontalstrike");break;case"\\fbox":r.setAttribute("notation","box");break;case"\\angl":r.setAttribute("notation","actuarial");break;case"\\fcolorbox":case"\\colorbox":if(n=e.fontMetrics().fboxsep*e.fontMetrics().ptPerEm,r.setAttribute("width","+"+2*n+"pt"),r.setAttribute("height","+"+2*n+"pt"),r.setAttribute("lspace",n+"pt"),r.setAttribute("voffset",n+"pt"),t.label==="\\fcolorbox"){var s=Math.max(e.fontMetrics().fboxrule,e.minRuleThickness);r.setAttribute("style","border: "+s+"em solid "+String(t.borderColor))}break;case"\\xcancel":r.setAttribute("notation","updiagonalstrike downdiagonalstrike");break}return t.backgroundColor&&r.setAttribute("mathbackground",t.backgroundColor),r};ue({type:"enclose",names:["\\colorbox"],props:{numArgs:2,allowedInText:!0,argTypes:["color","text"]},handler(t,e,n){var{parser:r,funcName:s}=t,i=Oe(e[0],"color-token").color,o=e[1];return{type:"enclose",mode:r.mode,label:s,backgroundColor:i,body:o}},htmlBuilder:fb,mathmlBuilder:gb});ue({type:"enclose",names:["\\fcolorbox"],props:{numArgs:3,allowedInText:!0,argTypes:["color","color","text"]},handler(t,e,n){var{parser:r,funcName:s}=t,i=Oe(e[0],"color-token").color,o=Oe(e[1],"color-token").color,a=e[2];return{type:"enclose",mode:r.mode,label:s,backgroundColor:o,borderColor:i,body:a}},htmlBuilder:fb,mathmlBuilder:gb});ue({type:"enclose",names:["\\fbox"],props:{numArgs:1,argTypes:["hbox"],allowedInText:!0},handler(t,e){var{parser:n}=t;return{type:"enclose",mode:n.mode,label:"\\fbox",body:e[0]}}});ue({type:"enclose",names:["\\cancel","\\bcancel","\\xcancel","\\sout","\\phase"],props:{numArgs:1},handler(t,e){var{parser:n,funcName:r}=t,s=e[0];return{type:"enclose",mode:n.mode,label:r,body:s}},htmlBuilder:fb,mathmlBuilder:gb});ue({type:"enclose",names:["\\angl"],props:{numArgs:1,argTypes:["hbox"],allowedInText:!1},handler(t,e){var{parser:n}=t;return{type:"enclose",mode:n.mode,label:"\\angl",body:e[0]}}});var Gj={};function Ti(t){for(var{type:e,names:n,props:r,handler:s,htmlBuilder:i,mathmlBuilder:o}=t,a={type:e,numArgs:r.numArgs||0,allowedInText:!1,numOptionalArgs:0,handler:s},l=0;l<n.length;++l)Gj[n[l]]=a;i&&(kg[e]=i),o&&(Ig[e]=o)}var Vj={};function j(t,e){Vj[t]=e}function K8(t){var e=[];t.consumeSpaces();var n=t.fetch().text;for(n==="\\relax"&&(t.consume(),t.consumeSpaces(),n=t.fetch().text);n==="\\hline"||n==="\\hdashline";)t.consume(),e.push(n==="\\hdashline"),t.consumeSpaces(),n=t.fetch().text;return e}var qm=t=>{var e=t.parser.settings;if(!e.displayMode)throw new ie("{"+t.envName+"} can be used only in display mode.")};function mb(t){if(t.indexOf("ed")===-1)return t.indexOf("*")===-1}function Ma(t,e,n){var{hskipBeforeAndAfter:r,addJot:s,cols:i,arraystretch:o,colSeparationType:a,autoTag:l,singleRow:c,emptySingleRow:u,maxNumCols:h,leqno:p}=e;if(t.gullet.beginGroup(),c||t.gullet.macros.set("\\cr","\\\\\\relax"),!o){var f=t.gullet.expandMacroAsText("\\arraystretch");if(f==null)o=1;else if(o=parseFloat(f),!o||o<0)throw new ie("Invalid \\arraystretch: "+f)}t.gullet.beginGroup();var v=[],m=[v],x=[],y=[],S=l!=null?[]:void 0;function w(){l&&t.gullet.macros.set("\\@eqnsw","1",!0)}function P(){S&&(t.gullet.macros.get("\\df@tag")?(S.push(t.subparse([new ms("\\df@tag")])),t.gullet.macros.set("\\df@tag",void 0,!0)):S.push(!!l&&t.gullet.macros.get("\\@eqnsw")==="1"))}for(w(),y.push(K8(t));;){var E=t.parseExpression(!1,c?"\\end":"\\\\");t.gullet.endGroup(),t.gullet.beginGroup(),E={type:"ordgroup",mode:t.mode,body:E},n&&(E={type:"styling",mode:t.mode,style:n,body:[E]}),v.push(E);var M=t.fetch().text;if(M==="&"){if(h&&v.length===h){if(c||a)throw new ie("Too many tab characters: &",t.nextToken);t.settings.reportNonstrict("textEnv","Too few columns specified in the {array} column argument.")}t.consume()}else if(M==="\\end"){P(),v.length===1&&E.type==="styling"&&E.body[0].body.length===0&&(m.length>1||!u)&&m.pop(),y.length<m.length+1&&y.push([]);break}else if(M==="\\\\"){t.consume();var I=void 0;t.gullet.future().text!==" "&&(I=t.parseSizeGroup(!0)),x.push(I?I.value:null),P(),y.push(K8(t)),v=[],m.push(v),w()}else throw new ie("Expected & or \\\\ or \\cr or \\end",t.nextToken)}return t.gullet.endGroup(),t.gullet.endGroup(),{type:"array",mode:t.mode,addJot:s,arraystretch:o,body:m,cols:i,rowGaps:x,hskipBeforeAndAfter:r,hLinesBeforeRow:y,colSeparationType:a,tags:S,leqno:p}}function yb(t){return t.slice(0,1)==="d"?"display":"text"}var Mi=function(e,n){var r,s,i=e.body.length,o=e.hLinesBeforeRow,a=0,l=new Array(i),c=[],u=Math.max(n.fontMetrics().arrayRuleWidth,n.minRuleThickness),h=1/n.fontMetrics().ptPerEm,p=5*h;if(e.colSeparationType&&e.colSeparationType==="small"){var f=n.havingStyle(Te.SCRIPT).sizeMultiplier;p=.2778*(f/n.sizeMultiplier)}var v=e.colSeparationType==="CD"?Lt({number:3,unit:"ex"},n):12*h,m=3*h,x=e.arraystretch*v,y=.7*x,S=.3*x,w=0;function P(qs){for(var Ar=0;Ar<qs.length;++Ar)Ar>0&&(w+=.25),c.push({pos:w,isDashed:qs[Ar]})}for(P(o[0]),r=0;r<e.body.length;++r){var E=e.body[r],M=y,I=S;a<E.length&&(a=E.length);var _=new Array(E.length);for(s=0;s<E.length;++s){var D=Je(E[s],n);I<D.depth&&(I=D.depth),M<D.height&&(M=D.height),_[s]=D}var R=e.rowGaps[r],$=0;R&&($=Lt(R,n),$>0&&($+=S,I<$&&(I=$),$=0)),e.addJot&&(I+=m),_.height=M,_.depth=I,w+=M,_.pos=w,w+=I+$,l[r]=_,P(o[r+1])}var U=w/2+n.fontMetrics().axisHeight,O=e.cols||[],N=[],H,Z,q=[];if(e.tags&&e.tags.some(qs=>qs))for(r=0;r<i;++r){var V=l[r],Q=V.pos-U,ne=e.tags[r],le=void 0;ne===!0?le=Y.makeSpan(["eqn-num"],[],n):ne===!1?le=Y.makeSpan([],[],n):le=Y.makeSpan([],on(ne,n,!0),n),le.depth=V.depth,le.height=V.height,q.push({type:"elem",elem:le,shift:Q})}for(s=0,Z=0;s<a||Z<O.length;++s,++Z){for(var de=O[Z]||{},_e=!0;de.type==="separator";){if(_e||(H=Y.makeSpan(["arraycolsep"],[]),H.style.width=ae(n.fontMetrics().doubleRuleSep),N.push(H)),de.separator==="|"||de.separator===":"){var je=de.separator==="|"?"solid":"dashed",ce=Y.makeSpan(["vertical-separator"],[],n);ce.style.height=ae(w),ce.style.borderRightWidth=ae(u),ce.style.borderRightStyle=je,ce.style.margin="0 "+ae(-u/2);var tt=w-U;tt&&(ce.style.verticalAlign=ae(-tt)),N.push(ce)}else throw new ie("Invalid separator type: "+de.separator);Z++,de=O[Z]||{},_e=!1}if(!(s>=a)){var Ue=void 0;(s>0||e.hskipBeforeAndAfter)&&(Ue=Pe.deflt(de.pregap,p),Ue!==0&&(H=Y.makeSpan(["arraycolsep"],[]),H.style.width=ae(Ue),N.push(H)));var et=[];for(r=0;r<i;++r){var Ge=l[r],lt=Ge[s];if(lt){var nt=Ge.pos-U;lt.depth=Ge.depth,lt.height=Ge.height,et.push({type:"elem",elem:lt,shift:nt})}}et=Y.makeVList({positionType:"individualShift",children:et},n),et=Y.makeSpan(["col-align-"+(de.align||"c")],[et]),N.push(et),(s<a-1||e.hskipBeforeAndAfter)&&(Ue=Pe.deflt(de.postgap,p),Ue!==0&&(H=Y.makeSpan(["arraycolsep"],[]),H.style.width=ae(Ue),N.push(H)))}}if(l=Y.makeSpan(["mtable"],N),c.length>0){for(var qn=Y.makeLineSpan("hline",n,u),en=Y.makeLineSpan("hdashline",n,u),an=[{type:"elem",elem:l,shift:0}];c.length>0;){var Et=c.pop(),tn=Et.pos-U;Et.isDashed?an.push({type:"elem",elem:en,shift:tn}):an.push({type:"elem",elem:qn,shift:tn})}l=Y.makeVList({positionType:"individualShift",children:an},n)}if(q.length===0)return Y.makeSpan(["mord"],[l],n);var _r=Y.makeVList({positionType:"individualShift",children:q},n);return _r=Y.makeSpan(["tag"],[_r],n),Y.makeFragment([l,_r])},q0e={c:"center ",l:"left ",r:"right "},_i=function(e,n){for(var r=[],s=new se.MathNode("mtd",[],["mtr-glue"]),i=new se.MathNode("mtd",[],["mml-eqn-num"]),o=0;o<e.body.length;o++){for(var a=e.body[o],l=[],c=0;c<a.length;c++)l.push(new se.MathNode("mtd",[ht(a[c],n)]));e.tags&&e.tags[o]&&(l.unshift(s),l.push(s),e.leqno?l.unshift(i):l.push(i)),r.push(new se.MathNode("mtr",l))}var u=new se.MathNode("mtable",r),h=e.arraystretch===.5?.1:.16+e.arraystretch-1+(e.addJot?.09:0);u.setAttribute("rowspacing",ae(h));var p="",f="";if(e.cols&&e.cols.length>0){var v=e.cols,m="",x=!1,y=0,S=v.length;v[0].type==="separator"&&(p+="top ",y=1),v[v.length-1].type==="separator"&&(p+="bottom ",S-=1);for(var w=y;w<S;w++)v[w].type==="align"?(f+=q0e[v[w].align],x&&(m+="none "),x=!0):v[w].type==="separator"&&x&&(m+=v[w].separator==="|"?"solid ":"dashed ",x=!1);u.setAttribute("columnalign",f.trim()),/[sd]/.test(m)&&u.setAttribute("columnlines",m.trim())}if(e.colSeparationType==="align"){for(var P=e.cols||[],E="",M=1;M<P.length;M++)E+=M%2?"0em ":"1em ";u.setAttribute("columnspacing",E.trim())}else e.colSeparationType==="alignat"||e.colSeparationType==="gather"?u.setAttribute("columnspacing","0em"):e.colSeparationType==="small"?u.setAttribute("columnspacing","0.2778em"):e.colSeparationType==="CD"?u.setAttribute("columnspacing","0.5em"):u.setAttribute("columnspacing","1em");var I="",_=e.hLinesBeforeRow;p+=_[0].length>0?"left ":"",p+=_[_.length-1].length>0?"right ":"";for(var D=1;D<_.length-1;D++)I+=_[D].length===0?"none ":_[D][0]?"dashed ":"solid ";return/[sd]/.test(I)&&u.setAttribute("rowlines",I.trim()),p!==""&&(u=new se.MathNode("menclose",[u]),u.setAttribute("notation",p.trim())),e.arraystretch&&e.arraystretch<1&&(u=new se.MathNode("mstyle",[u]),u.setAttribute("scriptlevel","1")),u},qj=function(e,n){e.envName.indexOf("ed")===-1&&qm(e);var r=[],s=e.envName.indexOf("at")>-1?"alignat":"align",i=e.envName==="split",o=Ma(e.parser,{cols:r,addJot:!0,autoTag:i?void 0:mb(e.envName),emptySingleRow:!0,colSeparationType:s,maxNumCols:i?2:void 0,leqno:e.parser.settings.leqno},"display"),a,l=0,c={type:"ordgroup",mode:e.mode,body:[]};if(n[0]&&n[0].type==="ordgroup"){for(var u="",h=0;h<n[0].body.length;h++){var p=Oe(n[0].body[h],"textord");u+=p.text}a=Number(u),l=a*2}var f=!l;o.body.forEach(function(y){for(var S=1;S<y.length;S+=2){var w=Oe(y[S],"styling"),P=Oe(w.body[0],"ordgroup");P.body.unshift(c)}if(f)l<y.length&&(l=y.length);else{var E=y.length/2;if(a<E)throw new ie("Too many math in a row: "+("expected "+a+", but got "+E),y[0])}});for(var v=0;v<l;++v){var m="r",x=0;v%2===1?m="l":v>0&&f&&(x=1),r[v]={type:"align",align:m,pregap:x,postgap:0}}return o.colSeparationType=f?"align":"alignat",o};Ti({type:"array",names:["array","darray"],props:{numArgs:1},handler(t,e){var n=Km(e[0]),r=n?[e[0]]:Oe(e[0],"ordgroup").body,s=r.map(function(o){var a=db(o),l=a.text;if("lcr".indexOf(l)!==-1)return{type:"align",align:l};if(l==="|")return{type:"separator",separator:"|"};if(l===":")return{type:"separator",separator:":"};throw new ie("Unknown column alignment: "+l,o)}),i={cols:s,hskipBeforeAndAfter:!0,maxNumCols:s.length};return Ma(t.parser,i,yb(t.envName))},htmlBuilder:Mi,mathmlBuilder:_i});Ti({type:"array",names:["matrix","pmatrix","bmatrix","Bmatrix","vmatrix","Vmatrix","matrix*","pmatrix*","bmatrix*","Bmatrix*","vmatrix*","Vmatrix*"],props:{numArgs:0},handler(t){var e={matrix:null,pmatrix:["(",")"],bmatrix:["[","]"],Bmatrix:["\\{","\\}"],vmatrix:["|","|"],Vmatrix:["\\Vert","\\Vert"]}[t.envName.replace("*","")],n="c",r={hskipBeforeAndAfter:!1,cols:[{type:"align",align:n}]};if(t.envName.charAt(t.envName.length-1)==="*"){var s=t.parser;if(s.consumeSpaces(),s.fetch().text==="["){if(s.consume(),s.consumeSpaces(),n=s.fetch().text,"lcr".indexOf(n)===-1)throw new ie("Expected l or c or r",s.nextToken);s.consume(),s.consumeSpaces(),s.expect("]"),s.consume(),r.cols=[{type:"align",align:n}]}}var i=Ma(t.parser,r,yb(t.envName)),o=Math.max(0,...i.body.map(a=>a.length));return i.cols=new Array(o).fill({type:"align",align:n}),e?{type:"leftright",mode:t.mode,body:[i],left:e[0],right:e[1],rightColor:void 0}:i},htmlBuilder:Mi,mathmlBuilder:_i});Ti({type:"array",names:["smallmatrix"],props:{numArgs:0},handler(t){var e={arraystretch:.5},n=Ma(t.parser,e,"script");return n.colSeparationType="small",n},htmlBuilder:Mi,mathmlBuilder:_i});Ti({type:"array",names:["subarray"],props:{numArgs:1},handler(t,e){var n=Km(e[0]),r=n?[e[0]]:Oe(e[0],"ordgroup").body,s=r.map(function(o){var a=db(o),l=a.text;if("lc".indexOf(l)!==-1)return{type:"align",align:l};throw new ie("Unknown column alignment: "+l,o)});if(s.length>1)throw new ie("{subarray} can contain only one column");var i={cols:s,hskipBeforeAndAfter:!1,arraystretch:.5};if(i=Ma(t.parser,i,"script"),i.body.length>0&&i.body[0].length>1)throw new ie("{subarray} can contain only one column");return i},htmlBuilder:Mi,mathmlBuilder:_i});Ti({type:"array",names:["cases","dcases","rcases","drcases"],props:{numArgs:0},handler(t){var e={arraystretch:1.2,cols:[{type:"align",align:"l",pregap:0,postgap:1},{type:"align",align:"l",pregap:0,postgap:0}]},n=Ma(t.parser,e,yb(t.envName));return{type:"leftright",mode:t.mode,body:[n],left:t.envName.indexOf("r")>-1?".":"\\{",right:t.envName.indexOf("r")>-1?"\\}":".",rightColor:void 0}},htmlBuilder:Mi,mathmlBuilder:_i});Ti({type:"array",names:["align","align*","aligned","split"],props:{numArgs:0},handler:qj,htmlBuilder:Mi,mathmlBuilder:_i});Ti({type:"array",names:["gathered","gather","gather*"],props:{numArgs:0},handler(t){Pe.contains(["gather","gather*"],t.envName)&&qm(t);var e={cols:[{type:"align",align:"c"}],addJot:!0,colSeparationType:"gather",autoTag:mb(t.envName),emptySingleRow:!0,leqno:t.parser.settings.leqno};return Ma(t.parser,e,"display")},htmlBuilder:Mi,mathmlBuilder:_i});Ti({type:"array",names:["alignat","alignat*","alignedat"],props:{numArgs:1},handler:qj,htmlBuilder:Mi,mathmlBuilder:_i});Ti({type:"array",names:["equation","equation*"],props:{numArgs:0},handler(t){qm(t);var e={autoTag:mb(t.envName),emptySingleRow:!0,singleRow:!0,maxNumCols:1,leqno:t.parser.settings.leqno};return Ma(t.parser,e,"display")},htmlBuilder:Mi,mathmlBuilder:_i});Ti({type:"array",names:["CD"],props:{numArgs:0},handler(t){return qm(t),R0e(t.parser)},htmlBuilder:Mi,mathmlBuilder:_i});j("\\nonumber","\\gdef\\@eqnsw{0}");j("\\notag","\\nonumber");ue({type:"text",names:["\\hline","\\hdashline"],props:{numArgs:0,allowedInText:!0,allowedInMath:!0},handler(t,e){throw new ie(t.funcName+" valid only within array environment")}});var G8=Gj;ue({type:"environment",names:["\\begin","\\end"],props:{numArgs:1,argTypes:["text"]},handler(t,e){var{parser:n,funcName:r}=t,s=e[0];if(s.type!=="ordgroup")throw new ie("Invalid environment name",s);for(var i="",o=0;o<s.body.length;++o)i+=Oe(s.body[o],"textord").text;if(r==="\\begin"){if(!G8.hasOwnProperty(i))throw new ie("No such environment: "+i,s);var a=G8[i],{args:l,optArgs:c}=n.parseArguments("\\begin{"+i+"}",a),u={mode:n.mode,envName:i,parser:n},h=a.handler(u,l,c);n.expect("\\end",!1);var p=n.nextToken,f=Oe(n.parseFunction(),"environment");if(f.name!==i)throw new ie("Mismatch: \\begin{"+i+"} matched by \\end{"+f.name+"}",p);return h}return{type:"environment",mode:n.mode,name:i,nameGroup:s}}});var Yj=(t,e)=>{var n=t.font,r=e.withFont(n);return Je(t.body,r)},Xj=(t,e)=>{var n=t.font,r=e.withFont(n);return ht(t.body,r)},V8={"\\Bbb":"\\mathbb","\\bold":"\\mathbf","\\frak":"\\mathfrak","\\bm":"\\boldsymbol"};ue({type:"font",names:["\\mathrm","\\mathit","\\mathbf","\\mathnormal","\\mathsfit","\\mathbb","\\mathcal","\\mathfrak","\\mathscr","\\mathsf","\\mathtt","\\Bbb","\\bold","\\frak"],props:{numArgs:1,allowedInArgument:!0},handler:(t,e)=>{var{parser:n,funcName:r}=t,s=Eg(e[0]),i=r;return i in V8&&(i=V8[i]),{type:"font",mode:n.mode,font:i.slice(1),body:s}},htmlBuilder:Yj,mathmlBuilder:Xj});ue({type:"mclass",names:["\\boldsymbol","\\bm"],props:{numArgs:1},handler:(t,e)=>{var{parser:n}=t,r=e[0],s=Pe.isCharacterBox(r);return{type:"mclass",mode:n.mode,mclass:Gm(r),body:[{type:"font",mode:n.mode,font:"boldsymbol",body:r}],isCharacterBox:s}}});ue({type:"font",names:["\\rm","\\sf","\\tt","\\bf","\\it","\\cal"],props:{numArgs:0,allowedInText:!0},handler:(t,e)=>{var{parser:n,funcName:r,breakOnTokenText:s}=t,{mode:i}=n,o=n.parseExpression(!0,s),a="math"+r.slice(1);return{type:"font",mode:i,font:a,body:{type:"ordgroup",mode:n.mode,body:o}}},htmlBuilder:Yj,mathmlBuilder:Xj});var Zj=(t,e)=>{var n=e;return t==="display"?n=n.id>=Te.SCRIPT.id?n.text():Te.DISPLAY:t==="text"&&n.size===Te.DISPLAY.size?n=Te.TEXT:t==="script"?n=Te.SCRIPT:t==="scriptscript"&&(n=Te.SCRIPTSCRIPT),n},vb=(t,e)=>{var n=Zj(t.size,e.style),r=n.fracNum(),s=n.fracDen(),i;i=e.havingStyle(r);var o=Je(t.numer,i,e);if(t.continued){var a=8.5/e.fontMetrics().ptPerEm,l=3.5/e.fontMetrics().ptPerEm;o.height=o.height<a?a:o.height,o.depth=o.depth<l?l:o.depth}i=e.havingStyle(s);var c=Je(t.denom,i,e),u,h,p;t.hasBarLine?(t.barSize?(h=Lt(t.barSize,e),u=Y.makeLineSpan("frac-line",e,h)):u=Y.makeLineSpan("frac-line",e),h=u.height,p=u.height):(u=null,h=0,p=e.fontMetrics().defaultRuleThickness);var f,v,m;n.size===Te.DISPLAY.size||t.size==="display"?(f=e.fontMetrics().num1,h>0?v=3*p:v=7*p,m=e.fontMetrics().denom1):(h>0?(f=e.fontMetrics().num2,v=p):(f=e.fontMetrics().num3,v=3*p),m=e.fontMetrics().denom2);var x;if(u){var S=e.fontMetrics().axisHeight;f-o.depth-(S+.5*h)<v&&(f+=v-(f-o.depth-(S+.5*h))),S-.5*h-(c.height-m)<v&&(m+=v-(S-.5*h-(c.height-m)));var w=-(S-.5*h);x=Y.makeVList({positionType:"individualShift",children:[{type:"elem",elem:c,shift:m},{type:"elem",elem:u,shift:w},{type:"elem",elem:o,shift:-f}]},e)}else{var y=f-o.depth-(c.height-m);y<v&&(f+=.5*(v-y),m+=.5*(v-y)),x=Y.makeVList({positionType:"individualShift",children:[{type:"elem",elem:c,shift:m},{type:"elem",elem:o,shift:-f}]},e)}i=e.havingStyle(n),x.height*=i.sizeMultiplier/e.sizeMultiplier,x.depth*=i.sizeMultiplier/e.sizeMultiplier;var P;n.size===Te.DISPLAY.size?P=e.fontMetrics().delim1:n.size===Te.SCRIPTSCRIPT.size?P=e.havingStyle(Te.SCRIPT).fontMetrics().delim2:P=e.fontMetrics().delim2;var E,M;return t.leftDelim==null?E=dh(e,["mopen"]):E=Ji.customSizedDelim(t.leftDelim,P,!0,e.havingStyle(n),t.mode,["mopen"]),t.continued?M=Y.makeSpan([]):t.rightDelim==null?M=dh(e,["mclose"]):M=Ji.customSizedDelim(t.rightDelim,P,!0,e.havingStyle(n),t.mode,["mclose"]),Y.makeSpan(["mord"].concat(i.sizingClasses(e)),[E,Y.makeSpan(["mfrac"],[x]),M],e)},Sb=(t,e)=>{var n=new se.MathNode("mfrac",[ht(t.numer,e),ht(t.denom,e)]);if(!t.hasBarLine)n.setAttribute("linethickness","0px");else if(t.barSize){var r=Lt(t.barSize,e);n.setAttribute("linethickness",ae(r))}var s=Zj(t.size,e.style);if(s.size!==e.style.size){n=new se.MathNode("mstyle",[n]);var i=s.size===Te.DISPLAY.size?"true":"false";n.setAttribute("displaystyle",i),n.setAttribute("scriptlevel","0")}if(t.leftDelim!=null||t.rightDelim!=null){var o=[];if(t.leftDelim!=null){var a=new se.MathNode("mo",[new se.TextNode(t.leftDelim.replace("\\",""))]);a.setAttribute("fence","true"),o.push(a)}if(o.push(n),t.rightDelim!=null){var l=new se.MathNode("mo",[new se.TextNode(t.rightDelim.replace("\\",""))]);l.setAttribute("fence","true"),o.push(l)}return cb(o)}return n};ue({type:"genfrac",names:["\\dfrac","\\frac","\\tfrac","\\dbinom","\\binom","\\tbinom","\\\\atopfrac","\\\\bracefrac","\\\\brackfrac"],props:{numArgs:2,allowedInArgument:!0},handler:(t,e)=>{var{parser:n,funcName:r}=t,s=e[0],i=e[1],o,a=null,l=null,c="auto";switch(r){case"\\dfrac":case"\\frac":case"\\tfrac":o=!0;break;case"\\\\atopfrac":o=!1;break;case"\\dbinom":case"\\binom":case"\\tbinom":o=!1,a="(",l=")";break;case"\\\\bracefrac":o=!1,a="\\{",l="\\}";break;case"\\\\brackfrac":o=!1,a="[",l="]";break;default:throw new Error("Unrecognized genfrac command")}switch(r){case"\\dfrac":case"\\dbinom":c="display";break;case"\\tfrac":case"\\tbinom":c="text";break}return{type:"genfrac",mode:n.mode,continued:!1,numer:s,denom:i,hasBarLine:o,leftDelim:a,rightDelim:l,size:c,barSize:null}},htmlBuilder:vb,mathmlBuilder:Sb});ue({type:"genfrac",names:["\\cfrac"],props:{numArgs:2},handler:(t,e)=>{var{parser:n,funcName:r}=t,s=e[0],i=e[1];return{type:"genfrac",mode:n.mode,continued:!0,numer:s,denom:i,hasBarLine:!0,leftDelim:null,rightDelim:null,size:"display",barSize:null}}});ue({type:"infix",names:["\\over","\\choose","\\atop","\\brace","\\brack"],props:{numArgs:0,infix:!0},handler(t){var{parser:e,funcName:n,token:r}=t,s;switch(n){case"\\over":s="\\frac";break;case"\\choose":s="\\binom";break;case"\\atop":s="\\\\atopfrac";break;case"\\brace":s="\\\\bracefrac";break;case"\\brack":s="\\\\brackfrac";break;default:throw new Error("Unrecognized infix genfrac command")}return{type:"infix",mode:e.mode,replaceWith:s,token:r}}});var q8=["display","text","script","scriptscript"],Y8=function(e){var n=null;return e.length>0&&(n=e,n=n==="."?null:n),n};ue({type:"genfrac",names:["\\genfrac"],props:{numArgs:6,allowedInArgument:!0,argTypes:["math","math","size","text","math","math"]},handler(t,e){var{parser:n}=t,r=e[4],s=e[5],i=Eg(e[0]),o=i.type==="atom"&&i.family==="open"?Y8(i.text):null,a=Eg(e[1]),l=a.type==="atom"&&a.family==="close"?Y8(a.text):null,c=Oe(e[2],"size"),u,h=null;c.isBlank?u=!0:(h=c.value,u=h.number>0);var p="auto",f=e[3];if(f.type==="ordgroup"){if(f.body.length>0){var v=Oe(f.body[0],"textord");p=q8[Number(v.text)]}}else f=Oe(f,"textord"),p=q8[Number(f.text)];return{type:"genfrac",mode:n.mode,numer:r,denom:s,continued:!1,hasBarLine:u,barSize:h,leftDelim:o,rightDelim:l,size:p}},htmlBuilder:vb,mathmlBuilder:Sb});ue({type:"infix",names:["\\above"],props:{numArgs:1,argTypes:["size"],infix:!0},handler(t,e){var{parser:n,funcName:r,token:s}=t;return{type:"infix",mode:n.mode,replaceWith:"\\\\abovefrac",size:Oe(e[0],"size").value,token:s}}});ue({type:"genfrac",names:["\\\\abovefrac"],props:{numArgs:3,argTypes:["math","size","math"]},handler:(t,e)=>{var{parser:n,funcName:r}=t,s=e[0],i=Phe(Oe(e[1],"infix").size),o=e[2],a=i.number>0;return{type:"genfrac",mode:n.mode,numer:s,denom:o,continued:!1,hasBarLine:a,barSize:i,leftDelim:null,rightDelim:null,size:"auto"}},htmlBuilder:vb,mathmlBuilder:Sb});var Qj=(t,e)=>{var n=e.style,r,s;t.type==="supsub"?(r=t.sup?Je(t.sup,e.havingStyle(n.sup()),e):Je(t.sub,e.havingStyle(n.sub()),e),s=Oe(t.base,"horizBrace")):s=Oe(t,"horizBrace");var i=Je(s.base,e.havingBaseStyle(Te.DISPLAY)),o=uo.svgSpan(s,e),a;if(s.isOver?(a=Y.makeVList({positionType:"firstBaseline",children:[{type:"elem",elem:i},{type:"kern",size:.1},{type:"elem",elem:o}]},e),a.children[0].children[0].children[1].classes.push("svg-align")):(a=Y.makeVList({positionType:"bottom",positionData:i.depth+.1+o.height,children:[{type:"elem",elem:o},{type:"kern",size:.1},{type:"elem",elem:i}]},e),a.children[0].children[0].children[0].classes.push("svg-align")),r){var l=Y.makeSpan(["mord",s.isOver?"mover":"munder"],[a],e);s.isOver?a=Y.makeVList({positionType:"firstBaseline",children:[{type:"elem",elem:l},{type:"kern",size:.2},{type:"elem",elem:r}]},e):a=Y.makeVList({positionType:"bottom",positionData:l.depth+.2+r.height+r.depth,children:[{type:"elem",elem:r},{type:"kern",size:.2},{type:"elem",elem:l}]},e)}return Y.makeSpan(["mord",s.isOver?"mover":"munder"],[a],e)},Y0e=(t,e)=>{var n=uo.mathMLnode(t.label);return new se.MathNode(t.isOver?"mover":"munder",[ht(t.base,e),n])};ue({type:"horizBrace",names:["\\overbrace","\\underbrace"],props:{numArgs:1},handler(t,e){var{parser:n,funcName:r}=t;return{type:"horizBrace",mode:n.mode,label:r,isOver:/^\\over/.test(r),base:e[0]}},htmlBuilder:Qj,mathmlBuilder:Y0e});ue({type:"href",names:["\\href"],props:{numArgs:2,argTypes:["url","original"],allowedInText:!0},handler:(t,e)=>{var{parser:n}=t,r=e[1],s=Oe(e[0],"url").url;return n.settings.isTrusted({command:"\\href",url:s})?{type:"href",mode:n.mode,href:s,body:Yt(r)}:n.formatUnsupportedCmd("\\href")},htmlBuilder:(t,e)=>{var n=on(t.body,e,!1);return Y.makeAnchor(t.href,[],n,e)},mathmlBuilder:(t,e)=>{var n=fa(t.body,e);return n instanceof Fr||(n=new Fr("mrow",[n])),n.setAttribute("href",t.href),n}});ue({type:"href",names:["\\url"],props:{numArgs:1,argTypes:["url"],allowedInText:!0},handler:(t,e)=>{var{parser:n}=t,r=Oe(e[0],"url").url;if(!n.settings.isTrusted({command:"\\url",url:r}))return n.formatUnsupportedCmd("\\url");for(var s=[],i=0;i<r.length;i++){var o=r[i];o==="~"&&(o="\\textasciitilde"),s.push({type:"textord",mode:"text",text:o})}var a={type:"text",mode:n.mode,font:"\\texttt",body:s};return{type:"href",mode:n.mode,href:r,body:Yt(a)}}});ue({type:"hbox",names:["\\hbox"],props:{numArgs:1,argTypes:["text"],allowedInText:!0,primitive:!0},handler(t,e){var{parser:n}=t;return{type:"hbox",mode:n.mode,body:Yt(e[0])}},htmlBuilder(t,e){var n=on(t.body,e,!1);return Y.makeFragment(n)},mathmlBuilder(t,e){return new se.MathNode("mrow",Mr(t.body,e))}});ue({type:"html",names:["\\htmlClass","\\htmlId","\\htmlStyle","\\htmlData"],props:{numArgs:2,argTypes:["raw","original"],allowedInText:!0},handler:(t,e)=>{var{parser:n,funcName:r,token:s}=t,i=Oe(e[0],"raw").string,o=e[1];n.settings.strict&&n.settings.reportNonstrict("htmlExtension","HTML extension is disabled on strict mode");var a,l={};switch(r){case"\\htmlClass":l.class=i,a={command:"\\htmlClass",class:i};break;case"\\htmlId":l.id=i,a={command:"\\htmlId",id:i};break;case"\\htmlStyle":l.style=i,a={command:"\\htmlStyle",style:i};break;case"\\htmlData":{for(var c=i.split(","),u=0;u<c.length;u++){var h=c[u].split("=");if(h.length!==2)throw new ie("Error parsing key-value for \\htmlData");l["data-"+h[0].trim()]=h[1].trim()}a={command:"\\htmlData",attributes:l};break}default:throw new Error("Unrecognized html command")}return n.settings.isTrusted(a)?{type:"html",mode:n.mode,attributes:l,body:Yt(o)}:n.formatUnsupportedCmd(r)},htmlBuilder:(t,e)=>{var n=on(t.body,e,!1),r=["enclosing"];t.attributes.class&&r.push(...t.attributes.class.trim().split(/\s+/));var s=Y.makeSpan(r,n,e);for(var i in t.attributes)i!=="class"&&t.attributes.hasOwnProperty(i)&&s.setAttribute(i,t.attributes[i]);return s},mathmlBuilder:(t,e)=>fa(t.body,e)});ue({type:"htmlmathml",names:["\\html@mathml"],props:{numArgs:2,allowedInText:!0},handler:(t,e)=>{var{parser:n}=t;return{type:"htmlmathml",mode:n.mode,html:Yt(e[0]),mathml:Yt(e[1])}},htmlBuilder:(t,e)=>{var n=on(t.html,e,!1);return Y.makeFragment(n)},mathmlBuilder:(t,e)=>fa(t.mathml,e)});var nv=function(e){if(/^[-+]? *(\d+(\.\d*)?|\.\d+)$/.test(e))return{number:+e,unit:"bp"};var n=/([-+]?) *(\d+(?:\.\d*)?|\.\d+) *([a-z]{2})/.exec(e);if(!n)throw new ie("Invalid size: '"+e+"' in \\includegraphics");var r={number:+(n[1]+n[2]),unit:n[3]};if(!yj(r))throw new ie("Invalid unit: '"+r.unit+"' in \\includegraphics.");return r};ue({type:"includegraphics",names:["\\includegraphics"],props:{numArgs:1,numOptionalArgs:1,argTypes:["raw","url"],allowedInText:!1},handler:(t,e,n)=>{var{parser:r}=t,s={number:0,unit:"em"},i={number:.9,unit:"em"},o={number:0,unit:"em"},a="";if(n[0])for(var l=Oe(n[0],"raw").string,c=l.split(","),u=0;u<c.length;u++){var h=c[u].split("=");if(h.length===2){var p=h[1].trim();switch(h[0].trim()){case"alt":a=p;break;case"width":s=nv(p);break;case"height":i=nv(p);break;case"totalheight":o=nv(p);break;default:throw new ie("Invalid key: '"+h[0]+"' in \\includegraphics.")}}}var f=Oe(e[0],"url").url;return a===""&&(a=f,a=a.replace(/^.*[\\/]/,""),a=a.substring(0,a.lastIndexOf("."))),r.settings.isTrusted({command:"\\includegraphics",url:f})?{type:"includegraphics",mode:r.mode,alt:a,width:s,height:i,totalheight:o,src:f}:r.formatUnsupportedCmd("\\includegraphics")},htmlBuilder:(t,e)=>{var n=Lt(t.height,e),r=0;t.totalheight.number>0&&(r=Lt(t.totalheight,e)-n);var s=0;t.width.number>0&&(s=Lt(t.width,e));var i={height:ae(n+r)};s>0&&(i.width=ae(s)),r>0&&(i.verticalAlign=ae(-r));var o=new Yhe(t.src,t.alt,i);return o.height=n,o.depth=r,o},mathmlBuilder:(t,e)=>{var n=new se.MathNode("mglyph",[]);n.setAttribute("alt",t.alt);var r=Lt(t.height,e),s=0;if(t.totalheight.number>0&&(s=Lt(t.totalheight,e)-r,n.setAttribute("valign",ae(-s))),n.setAttribute("height",ae(r+s)),t.width.number>0){var i=Lt(t.width,e);n.setAttribute("width",ae(i))}return n.setAttribute("src",t.src),n}});ue({type:"kern",names:["\\kern","\\mkern","\\hskip","\\mskip"],props:{numArgs:1,argTypes:["size"],primitive:!0,allowedInText:!0},handler(t,e){var{parser:n,funcName:r}=t,s=Oe(e[0],"size");if(n.settings.strict){var i=r[1]==="m",o=s.value.unit==="mu";i?(o||n.settings.reportNonstrict("mathVsTextUnits","LaTeX's "+r+" supports only mu units, "+("not "+s.value.unit+" units")),n.mode!=="math"&&n.settings.reportNonstrict("mathVsTextUnits","LaTeX's "+r+" works only in math mode")):o&&n.settings.reportNonstrict("mathVsTextUnits","LaTeX's "+r+" doesn't support mu units")}return{type:"kern",mode:n.mode,dimension:s.value}},htmlBuilder(t,e){return Y.makeGlue(t.dimension,e)},mathmlBuilder(t,e){var n=Lt(t.dimension,e);return new se.SpaceNode(n)}});ue({type:"lap",names:["\\mathllap","\\mathrlap","\\mathclap"],props:{numArgs:1,allowedInText:!0},handler:(t,e)=>{var{parser:n,funcName:r}=t,s=e[0];return{type:"lap",mode:n.mode,alignment:r.slice(5),body:s}},htmlBuilder:(t,e)=>{var n;t.alignment==="clap"?(n=Y.makeSpan([],[Je(t.body,e)]),n=Y.makeSpan(["inner"],[n],e)):n=Y.makeSpan(["inner"],[Je(t.body,e)]);var r=Y.makeSpan(["fix"],[]),s=Y.makeSpan([t.alignment],[n,r],e),i=Y.makeSpan(["strut"]);return i.style.height=ae(s.height+s.depth),s.depth&&(i.style.verticalAlign=ae(-s.depth)),s.children.unshift(i),s=Y.makeSpan(["thinbox"],[s],e),Y.makeSpan(["mord","vbox"],[s],e)},mathmlBuilder:(t,e)=>{var n=new se.MathNode("mpadded",[ht(t.body,e)]);if(t.alignment!=="rlap"){var r=t.alignment==="llap"?"-1":"-0.5";n.setAttribute("lspace",r+"width")}return n.setAttribute("width","0px"),n}});ue({type:"styling",names:["\\(","$"],props:{numArgs:0,allowedInText:!0,allowedInMath:!1},handler(t,e){var{funcName:n,parser:r}=t,s=r.mode;r.switchMode("math");var i=n==="\\("?"\\)":"$",o=r.parseExpression(!1,i);return r.expect(i),r.switchMode(s),{type:"styling",mode:r.mode,style:"text",body:o}}});ue({type:"text",names:["\\)","\\]"],props:{numArgs:0,allowedInText:!0,allowedInMath:!1},handler(t,e){throw new ie("Mismatched "+t.funcName)}});var X8=(t,e)=>{switch(e.style.size){case Te.DISPLAY.size:return t.display;case Te.TEXT.size:return t.text;case Te.SCRIPT.size:return t.script;case Te.SCRIPTSCRIPT.size:return t.scriptscript;default:return t.text}};ue({type:"mathchoice",names:["\\mathchoice"],props:{numArgs:4,primitive:!0},handler:(t,e)=>{var{parser:n}=t;return{type:"mathchoice",mode:n.mode,display:Yt(e[0]),text:Yt(e[1]),script:Yt(e[2]),scriptscript:Yt(e[3])}},htmlBuilder:(t,e)=>{var n=X8(t,e),r=on(n,e,!1);return Y.makeFragment(r)},mathmlBuilder:(t,e)=>{var n=X8(t,e);return fa(n,e)}});var Jj=(t,e,n,r,s,i,o)=>{t=Y.makeSpan([],[t]);var a=n&&Pe.isCharacterBox(n),l,c;if(e){var u=Je(e,r.havingStyle(s.sup()),r);c={elem:u,kern:Math.max(r.fontMetrics().bigOpSpacing1,r.fontMetrics().bigOpSpacing3-u.depth)}}if(n){var h=Je(n,r.havingStyle(s.sub()),r);l={elem:h,kern:Math.max(r.fontMetrics().bigOpSpacing2,r.fontMetrics().bigOpSpacing4-h.height)}}var p;if(c&&l){var f=r.fontMetrics().bigOpSpacing5+l.elem.height+l.elem.depth+l.kern+t.depth+o;p=Y.makeVList({positionType:"bottom",positionData:f,children:[{type:"kern",size:r.fontMetrics().bigOpSpacing5},{type:"elem",elem:l.elem,marginLeft:ae(-i)},{type:"kern",size:l.kern},{type:"elem",elem:t},{type:"kern",size:c.kern},{type:"elem",elem:c.elem,marginLeft:ae(i)},{type:"kern",size:r.fontMetrics().bigOpSpacing5}]},r)}else if(l){var v=t.height-o;p=Y.makeVList({positionType:"top",positionData:v,children:[{type:"kern",size:r.fontMetrics().bigOpSpacing5},{type:"elem",elem:l.elem,marginLeft:ae(-i)},{type:"kern",size:l.kern},{type:"elem",elem:t}]},r)}else if(c){var m=t.depth+o;p=Y.makeVList({positionType:"bottom",positionData:m,children:[{type:"elem",elem:t},{type:"kern",size:c.kern},{type:"elem",elem:c.elem,marginLeft:ae(i)},{type:"kern",size:r.fontMetrics().bigOpSpacing5}]},r)}else return t;var x=[p];if(l&&i!==0&&!a){var y=Y.makeSpan(["mspace"],[],r);y.style.marginRight=ae(i),x.unshift(y)}return Y.makeSpan(["mop","op-limits"],x,r)},eR=["\\smallint"],ou=(t,e)=>{var n,r,s=!1,i;t.type==="supsub"?(n=t.sup,r=t.sub,i=Oe(t.base,"op"),s=!0):i=Oe(t,"op");var o=e.style,a=!1;o.size===Te.DISPLAY.size&&i.symbol&&!Pe.contains(eR,i.name)&&(a=!0);var l;if(i.symbol){var c=a?"Size2-Regular":"Size1-Regular",u="";if((i.name==="\\oiint"||i.name==="\\oiiint")&&(u=i.name.slice(1),i.name=u==="oiint"?"\\iint":"\\iiint"),l=Y.makeSymbol(i.name,c,"math",e,["mop","op-symbol",a?"large-op":"small-op"]),u.length>0){var h=l.italic,p=Y.staticSvg(u+"Size"+(a?"2":"1"),e);l=Y.makeVList({positionType:"individualShift",children:[{type:"elem",elem:l,shift:0},{type:"elem",elem:p,shift:a?.08:0}]},e),i.name="\\"+u,l.classes.unshift("mop"),l.italic=h}}else if(i.body){var f=on(i.body,e,!0);f.length===1&&f[0]instanceof xs?(l=f[0],l.classes[0]="mop"):l=Y.makeSpan(["mop"],f,e)}else{for(var v=[],m=1;m<i.name.length;m++)v.push(Y.mathsym(i.name[m],i.mode,e));l=Y.makeSpan(["mop"],v,e)}var x=0,y=0;return(l instanceof xs||i.name==="\\oiint"||i.name==="\\oiiint")&&!i.suppressBaseShift&&(x=(l.height-l.depth)/2-e.fontMetrics().axisHeight,y=l.italic),s?Jj(l,n,r,e,o,y,x):(x&&(l.style.position="relative",l.style.top=ae(x)),l)},Wh=(t,e)=>{var n;if(t.symbol)n=new Fr("mo",[ws(t.name,t.mode)]),Pe.contains(eR,t.name)&&n.setAttribute("largeop","false");else if(t.body)n=new Fr("mo",Mr(t.body,e));else{n=new Fr("mi",[new di(t.name.slice(1))]);var r=new Fr("mo",[ws("⁡","text")]);t.parentIsSupSub?n=new Fr("mrow",[n,r]):n=Tj([n,r])}return n},X0e={"∏":"\\prod","∐":"\\coprod","∑":"\\sum","⋀":"\\bigwedge","⋁":"\\bigvee","⋂":"\\bigcap","⋃":"\\bigcup","⨀":"\\bigodot","⨁":"\\bigoplus","⨂":"\\bigotimes","⨄":"\\biguplus","⨆":"\\bigsqcup"};ue({type:"op",names:["\\coprod","\\bigvee","\\bigwedge","\\biguplus","\\bigcap","\\bigcup","\\intop","\\prod","\\sum","\\bigotimes","\\bigoplus","\\bigodot","\\bigsqcup","\\smallint","∏","∐","∑","⋀","⋁","⋂","⋃","⨀","⨁","⨂","⨄","⨆"],props:{numArgs:0},handler:(t,e)=>{var{parser:n,funcName:r}=t,s=r;return s.length===1&&(s=X0e[s]),{type:"op",mode:n.mode,limits:!0,parentIsSupSub:!1,symbol:!0,name:s}},htmlBuilder:ou,mathmlBuilder:Wh});ue({type:"op",names:["\\mathop"],props:{numArgs:1,primitive:!0},handler:(t,e)=>{var{parser:n}=t,r=e[0];return{type:"op",mode:n.mode,limits:!1,parentIsSupSub:!1,symbol:!1,body:Yt(r)}},htmlBuilder:ou,mathmlBuilder:Wh});var Z0e={"∫":"\\int","∬":"\\iint","∭":"\\iiint","∮":"\\oint","∯":"\\oiint","∰":"\\oiiint"};ue({type:"op",names:["\\arcsin","\\arccos","\\arctan","\\arctg","\\arcctg","\\arg","\\ch","\\cos","\\cosec","\\cosh","\\cot","\\cotg","\\coth","\\csc","\\ctg","\\cth","\\deg","\\dim","\\exp","\\hom","\\ker","\\lg","\\ln","\\log","\\sec","\\sin","\\sinh","\\sh","\\tan","\\tanh","\\tg","\\th"],props:{numArgs:0},handler(t){var{parser:e,funcName:n}=t;return{type:"op",mode:e.mode,limits:!1,parentIsSupSub:!1,symbol:!1,name:n}},htmlBuilder:ou,mathmlBuilder:Wh});ue({type:"op",names:["\\det","\\gcd","\\inf","\\lim","\\max","\\min","\\Pr","\\sup"],props:{numArgs:0},handler(t){var{parser:e,funcName:n}=t;return{type:"op",mode:e.mode,limits:!0,parentIsSupSub:!1,symbol:!1,name:n}},htmlBuilder:ou,mathmlBuilder:Wh});ue({type:"op",names:["\\int","\\iint","\\iiint","\\oint","\\oiint","\\oiiint","∫","∬","∭","∮","∯","∰"],props:{numArgs:0},handler(t){var{parser:e,funcName:n}=t,r=n;return r.length===1&&(r=Z0e[r]),{type:"op",mode:e.mode,limits:!1,parentIsSupSub:!1,symbol:!0,name:r}},htmlBuilder:ou,mathmlBuilder:Wh});var tR=(t,e)=>{var n,r,s=!1,i;t.type==="supsub"?(n=t.sup,r=t.sub,i=Oe(t.base,"operatorname"),s=!0):i=Oe(t,"operatorname");var o;if(i.body.length>0){for(var a=i.body.map(h=>{var p=h.text;return typeof p=="string"?{type:"textord",mode:h.mode,text:p}:h}),l=on(a,e.withFont("mathrm"),!0),c=0;c<l.length;c++){var u=l[c];u instanceof xs&&(u.text=u.text.replace(/\u2212/,"-").replace(/\u2217/,"*"))}o=Y.makeSpan(["mop"],l,e)}else o=Y.makeSpan(["mop"],[],e);return s?Jj(o,n,r,e,e.style,0,0):o},Q0e=(t,e)=>{for(var n=Mr(t.body,e.withFont("mathrm")),r=!0,s=0;s<n.length;s++){var i=n[s];if(!(i instanceof se.SpaceNode))if(i instanceof se.MathNode)switch(i.type){case"mi":case"mn":case"ms":case"mspace":case"mtext":break;case"mo":{var o=i.children[0];i.children.length===1&&o instanceof se.TextNode?o.text=o.text.replace(/\u2212/,"-").replace(/\u2217/,"*"):r=!1;break}default:r=!1}else r=!1}if(r){var a=n.map(u=>u.toText()).join("");n=[new se.TextNode(a)]}var l=new se.MathNode("mi",n);l.setAttribute("mathvariant","normal");var c=new se.MathNode("mo",[ws("⁡","text")]);return t.parentIsSupSub?new se.MathNode("mrow",[l,c]):se.newDocumentFragment([l,c])};ue({type:"operatorname",names:["\\operatorname@","\\operatornamewithlimits"],props:{numArgs:1},handler:(t,e)=>{var{parser:n,funcName:r}=t,s=e[0];return{type:"operatorname",mode:n.mode,body:Yt(s),alwaysHandleSupSub:r==="\\operatornamewithlimits",limits:!1,parentIsSupSub:!1}},htmlBuilder:tR,mathmlBuilder:Q0e});j("\\operatorname","\\@ifstar\\operatornamewithlimits\\operatorname@");Il({type:"ordgroup",htmlBuilder(t,e){return t.semisimple?Y.makeFragment(on(t.body,e,!1)):Y.makeSpan(["mord"],on(t.body,e,!0),e)},mathmlBuilder(t,e){return fa(t.body,e,!0)}});ue({type:"overline",names:["\\overline"],props:{numArgs:1},handler(t,e){var{parser:n}=t,r=e[0];return{type:"overline",mode:n.mode,body:r}},htmlBuilder(t,e){var n=Je(t.body,e.havingCrampedStyle()),r=Y.makeLineSpan("overline-line",e),s=e.fontMetrics().defaultRuleThickness,i=Y.makeVList({positionType:"firstBaseline",children:[{type:"elem",elem:n},{type:"kern",size:3*s},{type:"elem",elem:r},{type:"kern",size:s}]},e);return Y.makeSpan(["mord","overline"],[i],e)},mathmlBuilder(t,e){var n=new se.MathNode("mo",[new se.TextNode("‾")]);n.setAttribute("stretchy","true");var r=new se.MathNode("mover",[ht(t.body,e),n]);return r.setAttribute("accent","true"),r}});ue({type:"phantom",names:["\\phantom"],props:{numArgs:1,allowedInText:!0},handler:(t,e)=>{var{parser:n}=t,r=e[0];return{type:"phantom",mode:n.mode,body:Yt(r)}},htmlBuilder:(t,e)=>{var n=on(t.body,e.withPhantom(),!1);return Y.makeFragment(n)},mathmlBuilder:(t,e)=>{var n=Mr(t.body,e);return new se.MathNode("mphantom",n)}});ue({type:"hphantom",names:["\\hphantom"],props:{numArgs:1,allowedInText:!0},handler:(t,e)=>{var{parser:n}=t,r=e[0];return{type:"hphantom",mode:n.mode,body:r}},htmlBuilder:(t,e)=>{var n=Y.makeSpan([],[Je(t.body,e.withPhantom())]);if(n.height=0,n.depth=0,n.children)for(var r=0;r<n.children.length;r++)n.children[r].height=0,n.children[r].depth=0;return n=Y.makeVList({positionType:"firstBaseline",children:[{type:"elem",elem:n}]},e),Y.makeSpan(["mord"],[n],e)},mathmlBuilder:(t,e)=>{var n=Mr(Yt(t.body),e),r=new se.MathNode("mphantom",n),s=new se.MathNode("mpadded",[r]);return s.setAttribute("height","0px"),s.setAttribute("depth","0px"),s}});ue({type:"vphantom",names:["\\vphantom"],props:{numArgs:1,allowedInText:!0},handler:(t,e)=>{var{parser:n}=t,r=e[0];return{type:"vphantom",mode:n.mode,body:r}},htmlBuilder:(t,e)=>{var n=Y.makeSpan(["inner"],[Je(t.body,e.withPhantom())]),r=Y.makeSpan(["fix"],[]);return Y.makeSpan(["mord","rlap"],[n,r],e)},mathmlBuilder:(t,e)=>{var n=Mr(Yt(t.body),e),r=new se.MathNode("mphantom",n),s=new se.MathNode("mpadded",[r]);return s.setAttribute("width","0px"),s}});ue({type:"raisebox",names:["\\raisebox"],props:{numArgs:2,argTypes:["size","hbox"],allowedInText:!0},handler(t,e){var{parser:n}=t,r=Oe(e[0],"size").value,s=e[1];return{type:"raisebox",mode:n.mode,dy:r,body:s}},htmlBuilder(t,e){var n=Je(t.body,e),r=Lt(t.dy,e);return Y.makeVList({positionType:"shift",positionData:-r,children:[{type:"elem",elem:n}]},e)},mathmlBuilder(t,e){var n=new se.MathNode("mpadded",[ht(t.body,e)]),r=t.dy.number+t.dy.unit;return n.setAttribute("voffset",r),n}});ue({type:"internal",names:["\\relax"],props:{numArgs:0,allowedInText:!0},handler(t){var{parser:e}=t;return{type:"internal",mode:e.mode}}});ue({type:"rule",names:["\\rule"],props:{numArgs:2,numOptionalArgs:1,allowedInText:!0,allowedInMath:!0,argTypes:["size","size","size"]},handler(t,e,n){var{parser:r}=t,s=n[0],i=Oe(e[0],"size"),o=Oe(e[1],"size");return{type:"rule",mode:r.mode,shift:s&&Oe(s,"size").value,width:i.value,height:o.value}},htmlBuilder(t,e){var n=Y.makeSpan(["mord","rule"],[],e),r=Lt(t.width,e),s=Lt(t.height,e),i=t.shift?Lt(t.shift,e):0;return n.style.borderRightWidth=ae(r),n.style.borderTopWidth=ae(s),n.style.bottom=ae(i),n.width=r,n.height=s+i,n.depth=-i,n.maxFontSize=s*1.125*e.sizeMultiplier,n},mathmlBuilder(t,e){var n=Lt(t.width,e),r=Lt(t.height,e),s=t.shift?Lt(t.shift,e):0,i=e.color&&e.getColor()||"black",o=new se.MathNode("mspace");o.setAttribute("mathbackground",i),o.setAttribute("width",ae(n)),o.setAttribute("height",ae(r));var a=new se.MathNode("mpadded",[o]);return s>=0?a.setAttribute("height",ae(s)):(a.setAttribute("height",ae(s)),a.setAttribute("depth",ae(-s))),a.setAttribute("voffset",ae(s)),a}});function nR(t,e,n){for(var r=on(t,e,!1),s=e.sizeMultiplier/n.sizeMultiplier,i=0;i<r.length;i++){var o=r[i].classes.indexOf("sizing");o<0?Array.prototype.push.apply(r[i].classes,e.sizingClasses(n)):r[i].classes[o+1]==="reset-size"+e.size&&(r[i].classes[o+1]="reset-size"+n.size),r[i].height*=s,r[i].depth*=s}return Y.makeFragment(r)}var Z8=["\\tiny","\\sixptsize","\\scriptsize","\\footnotesize","\\small","\\normalsize","\\large","\\Large","\\LARGE","\\huge","\\Huge"],J0e=(t,e)=>{var n=e.havingSize(t.size);return nR(t.body,n,e)};ue({type:"sizing",names:Z8,props:{numArgs:0,allowedInText:!0},handler:(t,e)=>{var{breakOnTokenText:n,funcName:r,parser:s}=t,i=s.parseExpression(!1,n);return{type:"sizing",mode:s.mode,size:Z8.indexOf(r)+1,body:i}},htmlBuilder:J0e,mathmlBuilder:(t,e)=>{var n=e.havingSize(t.size),r=Mr(t.body,n),s=new se.MathNode("mstyle",r);return s.setAttribute("mathsize",ae(n.sizeMultiplier)),s}});ue({type:"smash",names:["\\smash"],props:{numArgs:1,numOptionalArgs:1,allowedInText:!0},handler:(t,e,n)=>{var{parser:r}=t,s=!1,i=!1,o=n[0]&&Oe(n[0],"ordgroup");if(o)for(var a="",l=0;l<o.body.length;++l){var c=o.body[l];if(a=c.text,a==="t")s=!0;else if(a==="b")i=!0;else{s=!1,i=!1;break}}else s=!0,i=!0;var u=e[0];return{type:"smash",mode:r.mode,body:u,smashHeight:s,smashDepth:i}},htmlBuilder:(t,e)=>{var n=Y.makeSpan([],[Je(t.body,e)]);if(!t.smashHeight&&!t.smashDepth)return n;if(t.smashHeight&&(n.height=0,n.children))for(var r=0;r<n.children.length;r++)n.children[r].height=0;if(t.smashDepth&&(n.depth=0,n.children))for(var s=0;s<n.children.length;s++)n.children[s].depth=0;var i=Y.makeVList({positionType:"firstBaseline",children:[{type:"elem",elem:n}]},e);return Y.makeSpan(["mord"],[i],e)},mathmlBuilder:(t,e)=>{var n=new se.MathNode("mpadded",[ht(t.body,e)]);return t.smashHeight&&n.setAttribute("height","0px"),t.smashDepth&&n.setAttribute("depth","0px"),n}});ue({type:"sqrt",names:["\\sqrt"],props:{numArgs:1,numOptionalArgs:1},handler(t,e,n){var{parser:r}=t,s=n[0],i=e[0];return{type:"sqrt",mode:r.mode,body:i,index:s}},htmlBuilder(t,e){var n=Je(t.body,e.havingCrampedStyle());n.height===0&&(n.height=e.fontMetrics().xHeight),n=Y.wrapFragment(n,e);var r=e.fontMetrics(),s=r.defaultRuleThickness,i=s;e.style.id<Te.TEXT.id&&(i=e.fontMetrics().xHeight);var o=s+i/4,a=n.height+n.depth+o+s,{span:l,ruleWidth:c,advanceWidth:u}=Ji.sqrtImage(a,e),h=l.height-c;h>n.height+n.depth+o&&(o=(o+h-n.height-n.depth)/2);var p=l.height-n.height-o-c;n.style.paddingLeft=ae(u);var f=Y.makeVList({positionType:"firstBaseline",children:[{type:"elem",elem:n,wrapperClasses:["svg-align"]},{type:"kern",size:-(n.height+p)},{type:"elem",elem:l},{type:"kern",size:c}]},e);if(t.index){var v=e.havingStyle(Te.SCRIPTSCRIPT),m=Je(t.index,v,e),x=.6*(f.height-f.depth),y=Y.makeVList({positionType:"shift",positionData:-x,children:[{type:"elem",elem:m}]},e),S=Y.makeSpan(["root"],[y]);return Y.makeSpan(["mord","sqrt"],[S,f],e)}else return Y.makeSpan(["mord","sqrt"],[f],e)},mathmlBuilder(t,e){var{body:n,index:r}=t;return r?new se.MathNode("mroot",[ht(n,e),ht(r,e)]):new se.MathNode("msqrt",[ht(n,e)])}});var Q8={display:Te.DISPLAY,text:Te.TEXT,script:Te.SCRIPT,scriptscript:Te.SCRIPTSCRIPT};ue({type:"styling",names:["\\displaystyle","\\textstyle","\\scriptstyle","\\scriptscriptstyle"],props:{numArgs:0,allowedInText:!0,primitive:!0},handler(t,e){var{breakOnTokenText:n,funcName:r,parser:s}=t,i=s.parseExpression(!0,n),o=r.slice(1,r.length-5);return{type:"styling",mode:s.mode,style:o,body:i}},htmlBuilder(t,e){var n=Q8[t.style],r=e.havingStyle(n).withFont("");return nR(t.body,r,e)},mathmlBuilder(t,e){var n=Q8[t.style],r=e.havingStyle(n),s=Mr(t.body,r),i=new se.MathNode("mstyle",s),o={display:["0","true"],text:["0","false"],script:["1","false"],scriptscript:["2","false"]},a=o[t.style];return i.setAttribute("scriptlevel",a[0]),i.setAttribute("displaystyle",a[1]),i}});var epe=function(e,n){var r=e.base;if(r)if(r.type==="op"){var s=r.limits&&(n.style.size===Te.DISPLAY.size||r.alwaysHandleSupSub);return s?ou:null}else if(r.type==="operatorname"){var i=r.alwaysHandleSupSub&&(n.style.size===Te.DISPLAY.size||r.limits);return i?tR:null}else{if(r.type==="accent")return Pe.isCharacterBox(r.base)?hb:null;if(r.type==="horizBrace"){var o=!e.sub;return o===r.isOver?Qj:null}else return null}else return null};Il({type:"supsub",htmlBuilder(t,e){var n=epe(t,e);if(n)return n(t,e);var{base:r,sup:s,sub:i}=t,o=Je(r,e),a,l,c=e.fontMetrics(),u=0,h=0,p=r&&Pe.isCharacterBox(r);if(s){var f=e.havingStyle(e.style.sup());a=Je(s,f,e),p||(u=o.height-f.fontMetrics().supDrop*f.sizeMultiplier/e.sizeMultiplier)}if(i){var v=e.havingStyle(e.style.sub());l=Je(i,v,e),p||(h=o.depth+v.fontMetrics().subDrop*v.sizeMultiplier/e.sizeMultiplier)}var m;e.style===Te.DISPLAY?m=c.sup1:e.style.cramped?m=c.sup3:m=c.sup2;var x=e.sizeMultiplier,y=ae(.5/c.ptPerEm/x),S=null;if(l){var w=t.base&&t.base.type==="op"&&t.base.name&&(t.base.name==="\\oiint"||t.base.name==="\\oiiint");(o instanceof xs||w)&&(S=ae(-o.italic))}var P;if(a&&l){u=Math.max(u,m,a.depth+.25*c.xHeight),h=Math.max(h,c.sub2);var E=c.defaultRuleThickness,M=4*E;if(u-a.depth-(l.height-h)<M){h=M-(u-a.depth)+l.height;var I=.8*c.xHeight-(u-a.depth);I>0&&(u+=I,h-=I)}var _=[{type:"elem",elem:l,shift:h,marginRight:y,marginLeft:S},{type:"elem",elem:a,shift:-u,marginRight:y}];P=Y.makeVList({positionType:"individualShift",children:_},e)}else if(l){h=Math.max(h,c.sub1,l.height-.8*c.xHeight);var D=[{type:"elem",elem:l,marginLeft:S,marginRight:y}];P=Y.makeVList({positionType:"shift",positionData:h,children:D},e)}else if(a)u=Math.max(u,m,a.depth+.25*c.xHeight),P=Y.makeVList({positionType:"shift",positionData:-u,children:[{type:"elem",elem:a,marginRight:y}]},e);else throw new Error("supsub must have either sup or sub.");var R=NS(o,"right")||"mord";return Y.makeSpan([R],[o,Y.makeSpan(["msupsub"],[P])],e)},mathmlBuilder(t,e){var n=!1,r,s;t.base&&t.base.type==="horizBrace"&&(s=!!t.sup,s===t.base.isOver&&(n=!0,r=t.base.isOver)),t.base&&(t.base.type==="op"||t.base.type==="operatorname")&&(t.base.parentIsSupSub=!0);var i=[ht(t.base,e)];t.sub&&i.push(ht(t.sub,e)),t.sup&&i.push(ht(t.sup,e));var o;if(n)o=r?"mover":"munder";else if(t.sub)if(t.sup){var c=t.base;c&&c.type==="op"&&c.limits&&e.style===Te.DISPLAY||c&&c.type==="operatorname"&&c.alwaysHandleSupSub&&(e.style===Te.DISPLAY||c.limits)?o="munderover":o="msubsup"}else{var l=t.base;l&&l.type==="op"&&l.limits&&(e.style===Te.DISPLAY||l.alwaysHandleSupSub)||l&&l.type==="operatorname"&&l.alwaysHandleSupSub&&(l.limits||e.style===Te.DISPLAY)?o="munder":o="msub"}else{var a=t.base;a&&a.type==="op"&&a.limits&&(e.style===Te.DISPLAY||a.alwaysHandleSupSub)||a&&a.type==="operatorname"&&a.alwaysHandleSupSub&&(a.limits||e.style===Te.DISPLAY)?o="mover":o="msup"}return new se.MathNode(o,i)}});Il({type:"atom",htmlBuilder(t,e){return Y.mathsym(t.text,t.mode,e,["m"+t.family])},mathmlBuilder(t,e){var n=new se.MathNode("mo",[ws(t.text,t.mode)]);if(t.family==="bin"){var r=ub(t,e);r==="bold-italic"&&n.setAttribute("mathvariant",r)}else t.family==="punct"?n.setAttribute("separator","true"):(t.family==="open"||t.family==="close")&&n.setAttribute("stretchy","false");return n}});var rR={mi:"italic",mn:"normal",mtext:"normal"};Il({type:"mathord",htmlBuilder(t,e){return Y.makeOrd(t,e,"mathord")},mathmlBuilder(t,e){var n=new se.MathNode("mi",[ws(t.text,t.mode,e)]),r=ub(t,e)||"italic";return r!==rR[n.type]&&n.setAttribute("mathvariant",r),n}});Il({type:"textord",htmlBuilder(t,e){return Y.makeOrd(t,e,"textord")},mathmlBuilder(t,e){var n=ws(t.text,t.mode,e),r=ub(t,e)||"normal",s;return t.mode==="text"?s=new se.MathNode("mtext",[n]):/[0-9]/.test(t.text)?s=new se.MathNode("mn",[n]):t.text==="\\prime"?s=new se.MathNode("mo",[n]):s=new se.MathNode("mi",[n]),r!==rR[s.type]&&s.setAttribute("mathvariant",r),s}});var rv={"\\nobreak":"nobreak","\\allowbreak":"allowbreak"},sv={" ":{},"\\ ":{},"~":{className:"nobreak"},"\\space":{},"\\nobreakspace":{className:"nobreak"}};Il({type:"spacing",htmlBuilder(t,e){if(sv.hasOwnProperty(t.text)){var n=sv[t.text].className||"";if(t.mode==="text"){var r=Y.makeOrd(t,e,"textord");return r.classes.push(n),r}else return Y.makeSpan(["mspace",n],[Y.mathsym(t.text,t.mode,e)],e)}else{if(rv.hasOwnProperty(t.text))return Y.makeSpan(["mspace",rv[t.text]],[],e);throw new ie('Unknown type of space "'+t.text+'"')}},mathmlBuilder(t,e){var n;if(sv.hasOwnProperty(t.text))n=new se.MathNode("mtext",[new se.TextNode(" ")]);else{if(rv.hasOwnProperty(t.text))return new se.MathNode("mspace");throw new ie('Unknown type of space "'+t.text+'"')}return n}});var J8=()=>{var t=new se.MathNode("mtd",[]);return t.setAttribute("width","50%"),t};Il({type:"tag",mathmlBuilder(t,e){var n=new se.MathNode("mtable",[new se.MathNode("mtr",[J8(),new se.MathNode("mtd",[fa(t.body,e)]),J8(),new se.MathNode("mtd",[fa(t.tag,e)])])]);return n.setAttribute("width","100%"),n}});var e9={"\\text":void 0,"\\textrm":"textrm","\\textsf":"textsf","\\texttt":"texttt","\\textnormal":"textrm"},t9={"\\textbf":"textbf","\\textmd":"textmd"},tpe={"\\textit":"textit","\\textup":"textup"},n9=(t,e)=>{var n=t.font;if(n){if(e9[n])return e.withTextFontFamily(e9[n]);if(t9[n])return e.withTextFontWeight(t9[n]);if(n==="\\emph")return e.fontShape==="textit"?e.withTextFontShape("textup"):e.withTextFontShape("textit")}else return e;return e.withTextFontShape(tpe[n])};ue({type:"text",names:["\\text","\\textrm","\\textsf","\\texttt","\\textnormal","\\textbf","\\textmd","\\textit","\\textup","\\emph"],props:{numArgs:1,argTypes:["text"],allowedInArgument:!0,allowedInText:!0},handler(t,e){var{parser:n,funcName:r}=t,s=e[0];return{type:"text",mode:n.mode,body:Yt(s),font:r}},htmlBuilder(t,e){var n=n9(t,e),r=on(t.body,n,!0);return Y.makeSpan(["mord","text"],r,n)},mathmlBuilder(t,e){var n=n9(t,e);return fa(t.body,n)}});ue({type:"underline",names:["\\underline"],props:{numArgs:1,allowedInText:!0},handler(t,e){var{parser:n}=t;return{type:"underline",mode:n.mode,body:e[0]}},htmlBuilder(t,e){var n=Je(t.body,e),r=Y.makeLineSpan("underline-line",e),s=e.fontMetrics().defaultRuleThickness,i=Y.makeVList({positionType:"top",positionData:n.height,children:[{type:"kern",size:s},{type:"elem",elem:r},{type:"kern",size:3*s},{type:"elem",elem:n}]},e);return Y.makeSpan(["mord","underline"],[i],e)},mathmlBuilder(t,e){var n=new se.MathNode("mo",[new se.TextNode("‾")]);n.setAttribute("stretchy","true");var r=new se.MathNode("munder",[ht(t.body,e),n]);return r.setAttribute("accentunder","true"),r}});ue({type:"vcenter",names:["\\vcenter"],props:{numArgs:1,argTypes:["original"],allowedInText:!1},handler(t,e){var{parser:n}=t;return{type:"vcenter",mode:n.mode,body:e[0]}},htmlBuilder(t,e){var n=Je(t.body,e),r=e.fontMetrics().axisHeight,s=.5*(n.height-r-(n.depth+r));return Y.makeVList({positionType:"shift",positionData:s,children:[{type:"elem",elem:n}]},e)},mathmlBuilder(t,e){return new se.MathNode("mpadded",[ht(t.body,e)],["vcenter"])}});ue({type:"verb",names:["\\verb"],props:{numArgs:0,allowedInText:!0},handler(t,e,n){throw new ie("\\verb ended by end of line instead of matching delimiter")},htmlBuilder(t,e){for(var n=r9(t),r=[],s=e.havingStyle(e.style.text()),i=0;i<n.length;i++){var o=n[i];o==="~"&&(o="\\textasciitilde"),r.push(Y.makeSymbol(o,"Typewriter-Regular",t.mode,s,["mord","texttt"]))}return Y.makeSpan(["mord","text"].concat(s.sizingClasses(e)),Y.tryCombineChars(r),s)},mathmlBuilder(t,e){var n=new se.TextNode(r9(t)),r=new se.MathNode("mtext",[n]);return r.setAttribute("mathvariant","monospace"),r}});var r9=t=>t.body.replace(/ /g,t.star?"␣":" "),Ho=Ij,sR=`[ \r
	]`,npe="\\\\[a-zA-Z@]+",rpe="\\\\[^\uD800-\uDFFF]",spe="("+npe+")"+sR+"*",ipe=`\\\\(
|[ \r	]+
?)[ \r	]*`,BS="[̀-ͯ]",ope=new RegExp(BS+"+$"),ape="("+sR+"+)|"+(ipe+"|")+"([!-\\[\\]-‧‪-퟿豈-￿]"+(BS+"*")+"|[\uD800-\uDBFF][\uDC00-\uDFFF]"+(BS+"*")+"|\\\\verb\\*([^]).*?\\4|\\\\verb([^*a-zA-Z]).*?\\5"+("|"+spe)+("|"+rpe+")");class s9{constructor(e,n){this.input=void 0,this.settings=void 0,this.tokenRegex=void 0,this.catcodes=void 0,this.input=e,this.settings=n,this.tokenRegex=new RegExp(ape,"g"),this.catcodes={"%":14,"~":13}}setCatcode(e,n){this.catcodes[e]=n}lex(){var e=this.input,n=this.tokenRegex.lastIndex;if(n===e.length)return new ms("EOF",new Lr(this,n,n));var r=this.tokenRegex.exec(e);if(r===null||r.index!==n)throw new ie("Unexpected character: '"+e[n]+"'",new ms(e[n],new Lr(this,n,n+1)));var s=r[6]||r[3]||(r[2]?"\\ ":" ");if(this.catcodes[s]===14){var i=e.indexOf(`
`,this.tokenRegex.lastIndex);return i===-1?(this.tokenRegex.lastIndex=e.length,this.settings.reportNonstrict("commentAtEnd","% comment has no terminating newline; LaTeX would fail because of commenting the end of math mode (e.g. $)")):this.tokenRegex.lastIndex=i+1,this.lex()}return new ms(s,new Lr(this,n,this.tokenRegex.lastIndex))}}class lpe{constructor(e,n){e===void 0&&(e={}),n===void 0&&(n={}),this.current=void 0,this.builtins=void 0,this.undefStack=void 0,this.current=n,this.builtins=e,this.undefStack=[]}beginGroup(){this.undefStack.push({})}endGroup(){if(this.undefStack.length===0)throw new ie("Unbalanced namespace destruction: attempt to pop global namespace; please report this as a bug");var e=this.undefStack.pop();for(var n in e)e.hasOwnProperty(n)&&(e[n]==null?delete this.current[n]:this.current[n]=e[n])}endGroups(){for(;this.undefStack.length>0;)this.endGroup()}has(e){return this.current.hasOwnProperty(e)||this.builtins.hasOwnProperty(e)}get(e){return this.current.hasOwnProperty(e)?this.current[e]:this.builtins[e]}set(e,n,r){if(r===void 0&&(r=!1),r){for(var s=0;s<this.undefStack.length;s++)delete this.undefStack[s][e];this.undefStack.length>0&&(this.undefStack[this.undefStack.length-1][e]=n)}else{var i=this.undefStack[this.undefStack.length-1];i&&!i.hasOwnProperty(e)&&(i[e]=this.current[e])}n==null?delete this.current[e]:this.current[e]=n}}var cpe=Vj;j("\\noexpand",function(t){var e=t.popToken();return t.isExpandable(e.text)&&(e.noexpand=!0,e.treatAsRelax=!0),{tokens:[e],numArgs:0}});j("\\expandafter",function(t){var e=t.popToken();return t.expandOnce(!0),{tokens:[e],numArgs:0}});j("\\@firstoftwo",function(t){var e=t.consumeArgs(2);return{tokens:e[0],numArgs:0}});j("\\@secondoftwo",function(t){var e=t.consumeArgs(2);return{tokens:e[1],numArgs:0}});j("\\@ifnextchar",function(t){var e=t.consumeArgs(3);t.consumeSpaces();var n=t.future();return e[0].length===1&&e[0][0].text===n.text?{tokens:e[1],numArgs:0}:{tokens:e[2],numArgs:0}});j("\\@ifstar","\\@ifnextchar *{\\@firstoftwo{#1}}");j("\\TextOrMath",function(t){var e=t.consumeArgs(2);return t.mode==="text"?{tokens:e[0],numArgs:0}:{tokens:e[1],numArgs:0}});var i9={0:0,1:1,2:2,3:3,4:4,5:5,6:6,7:7,8:8,9:9,a:10,A:10,b:11,B:11,c:12,C:12,d:13,D:13,e:14,E:14,f:15,F:15};j("\\char",function(t){var e=t.popToken(),n,r="";if(e.text==="'")n=8,e=t.popToken();else if(e.text==='"')n=16,e=t.popToken();else if(e.text==="`")if(e=t.popToken(),e.text[0]==="\\")r=e.text.charCodeAt(1);else{if(e.text==="EOF")throw new ie("\\char` missing argument");r=e.text.charCodeAt(0)}else n=10;if(n){if(r=i9[e.text],r==null||r>=n)throw new ie("Invalid base-"+n+" digit "+e.text);for(var s;(s=i9[t.future().text])!=null&&s<n;)r*=n,r+=s,t.popToken()}return"\\@char{"+r+"}"});var xb=(t,e,n,r)=>{var s=t.consumeArg().tokens;if(s.length!==1)throw new ie("\\newcommand's first argument must be a macro name");var i=s[0].text,o=t.isDefined(i);if(o&&!e)throw new ie("\\newcommand{"+i+"} attempting to redefine "+(i+"; use \\renewcommand"));if(!o&&!n)throw new ie("\\renewcommand{"+i+"} when command "+i+" does not yet exist; use \\newcommand");var a=0;if(s=t.consumeArg().tokens,s.length===1&&s[0].text==="["){for(var l="",c=t.expandNextToken();c.text!=="]"&&c.text!=="EOF";)l+=c.text,c=t.expandNextToken();if(!l.match(/^\s*[0-9]+\s*$/))throw new ie("Invalid number of arguments: "+l);a=parseInt(l),s=t.consumeArg().tokens}return o&&r||t.macros.set(i,{tokens:s,numArgs:a}),""};j("\\newcommand",t=>xb(t,!1,!0,!1));j("\\renewcommand",t=>xb(t,!0,!1,!1));j("\\providecommand",t=>xb(t,!0,!0,!0));j("\\message",t=>{var e=t.consumeArgs(1)[0];return console.log(e.reverse().map(n=>n.text).join("")),""});j("\\errmessage",t=>{var e=t.consumeArgs(1)[0];return console.error(e.reverse().map(n=>n.text).join("")),""});j("\\show",t=>{var e=t.popToken(),n=e.text;return console.log(e,t.macros.get(n),Ho[n],St.math[n],St.text[n]),""});j("\\bgroup","{");j("\\egroup","}");j("~","\\nobreakspace");j("\\lq","`");j("\\rq","'");j("\\aa","\\r a");j("\\AA","\\r A");j("\\textcopyright","\\html@mathml{\\textcircled{c}}{\\char`©}");j("\\copyright","\\TextOrMath{\\textcopyright}{\\text{\\textcopyright}}");j("\\textregistered","\\html@mathml{\\textcircled{\\scriptsize R}}{\\char`®}");j("ℬ","\\mathscr{B}");j("ℰ","\\mathscr{E}");j("ℱ","\\mathscr{F}");j("ℋ","\\mathscr{H}");j("ℐ","\\mathscr{I}");j("ℒ","\\mathscr{L}");j("ℳ","\\mathscr{M}");j("ℛ","\\mathscr{R}");j("ℭ","\\mathfrak{C}");j("ℌ","\\mathfrak{H}");j("ℨ","\\mathfrak{Z}");j("\\Bbbk","\\Bbb{k}");j("·","\\cdotp");j("\\llap","\\mathllap{\\textrm{#1}}");j("\\rlap","\\mathrlap{\\textrm{#1}}");j("\\clap","\\mathclap{\\textrm{#1}}");j("\\mathstrut","\\vphantom{(}");j("\\underbar","\\underline{\\text{#1}}");j("\\not",'\\html@mathml{\\mathrel{\\mathrlap\\@not}}{\\char"338}');j("\\neq","\\html@mathml{\\mathrel{\\not=}}{\\mathrel{\\char`≠}}");j("\\ne","\\neq");j("≠","\\neq");j("\\notin","\\html@mathml{\\mathrel{{\\in}\\mathllap{/\\mskip1mu}}}{\\mathrel{\\char`∉}}");j("∉","\\notin");j("≘","\\html@mathml{\\mathrel{=\\kern{-1em}\\raisebox{0.4em}{$\\scriptsize\\frown$}}}{\\mathrel{\\char`≘}}");j("≙","\\html@mathml{\\stackrel{\\tiny\\wedge}{=}}{\\mathrel{\\char`≘}}");j("≚","\\html@mathml{\\stackrel{\\tiny\\vee}{=}}{\\mathrel{\\char`≚}}");j("≛","\\html@mathml{\\stackrel{\\scriptsize\\star}{=}}{\\mathrel{\\char`≛}}");j("≝","\\html@mathml{\\stackrel{\\tiny\\mathrm{def}}{=}}{\\mathrel{\\char`≝}}");j("≞","\\html@mathml{\\stackrel{\\tiny\\mathrm{m}}{=}}{\\mathrel{\\char`≞}}");j("≟","\\html@mathml{\\stackrel{\\tiny?}{=}}{\\mathrel{\\char`≟}}");j("⟂","\\perp");j("‼","\\mathclose{!\\mkern-0.8mu!}");j("∌","\\notni");j("⌜","\\ulcorner");j("⌝","\\urcorner");j("⌞","\\llcorner");j("⌟","\\lrcorner");j("©","\\copyright");j("®","\\textregistered");j("️","\\textregistered");j("\\ulcorner",'\\html@mathml{\\@ulcorner}{\\mathop{\\char"231c}}');j("\\urcorner",'\\html@mathml{\\@urcorner}{\\mathop{\\char"231d}}');j("\\llcorner",'\\html@mathml{\\@llcorner}{\\mathop{\\char"231e}}');j("\\lrcorner",'\\html@mathml{\\@lrcorner}{\\mathop{\\char"231f}}');j("\\vdots","{\\varvdots\\rule{0pt}{15pt}}");j("⋮","\\vdots");j("\\varGamma","\\mathit{\\Gamma}");j("\\varDelta","\\mathit{\\Delta}");j("\\varTheta","\\mathit{\\Theta}");j("\\varLambda","\\mathit{\\Lambda}");j("\\varXi","\\mathit{\\Xi}");j("\\varPi","\\mathit{\\Pi}");j("\\varSigma","\\mathit{\\Sigma}");j("\\varUpsilon","\\mathit{\\Upsilon}");j("\\varPhi","\\mathit{\\Phi}");j("\\varPsi","\\mathit{\\Psi}");j("\\varOmega","\\mathit{\\Omega}");j("\\substack","\\begin{subarray}{c}#1\\end{subarray}");j("\\colon","\\nobreak\\mskip2mu\\mathpunct{}\\mathchoice{\\mkern-3mu}{\\mkern-3mu}{}{}{:}\\mskip6mu\\relax");j("\\boxed","\\fbox{$\\displaystyle{#1}$}");j("\\iff","\\DOTSB\\;\\Longleftrightarrow\\;");j("\\implies","\\DOTSB\\;\\Longrightarrow\\;");j("\\impliedby","\\DOTSB\\;\\Longleftarrow\\;");j("\\dddot","{\\overset{\\raisebox{-0.1ex}{\\normalsize ...}}{#1}}");j("\\ddddot","{\\overset{\\raisebox{-0.1ex}{\\normalsize ....}}{#1}}");var o9={",":"\\dotsc","\\not":"\\dotsb","+":"\\dotsb","=":"\\dotsb","<":"\\dotsb",">":"\\dotsb","-":"\\dotsb","*":"\\dotsb",":":"\\dotsb","\\DOTSB":"\\dotsb","\\coprod":"\\dotsb","\\bigvee":"\\dotsb","\\bigwedge":"\\dotsb","\\biguplus":"\\dotsb","\\bigcap":"\\dotsb","\\bigcup":"\\dotsb","\\prod":"\\dotsb","\\sum":"\\dotsb","\\bigotimes":"\\dotsb","\\bigoplus":"\\dotsb","\\bigodot":"\\dotsb","\\bigsqcup":"\\dotsb","\\And":"\\dotsb","\\longrightarrow":"\\dotsb","\\Longrightarrow":"\\dotsb","\\longleftarrow":"\\dotsb","\\Longleftarrow":"\\dotsb","\\longleftrightarrow":"\\dotsb","\\Longleftrightarrow":"\\dotsb","\\mapsto":"\\dotsb","\\longmapsto":"\\dotsb","\\hookrightarrow":"\\dotsb","\\doteq":"\\dotsb","\\mathbin":"\\dotsb","\\mathrel":"\\dotsb","\\relbar":"\\dotsb","\\Relbar":"\\dotsb","\\xrightarrow":"\\dotsb","\\xleftarrow":"\\dotsb","\\DOTSI":"\\dotsi","\\int":"\\dotsi","\\oint":"\\dotsi","\\iint":"\\dotsi","\\iiint":"\\dotsi","\\iiiint":"\\dotsi","\\idotsint":"\\dotsi","\\DOTSX":"\\dotsx"};j("\\dots",function(t){var e="\\dotso",n=t.expandAfterFuture().text;return n in o9?e=o9[n]:(n.slice(0,4)==="\\not"||n in St.math&&Pe.contains(["bin","rel"],St.math[n].group))&&(e="\\dotsb"),e});var wb={")":!0,"]":!0,"\\rbrack":!0,"\\}":!0,"\\rbrace":!0,"\\rangle":!0,"\\rceil":!0,"\\rfloor":!0,"\\rgroup":!0,"\\rmoustache":!0,"\\right":!0,"\\bigr":!0,"\\biggr":!0,"\\Bigr":!0,"\\Biggr":!0,$:!0,";":!0,".":!0,",":!0};j("\\dotso",function(t){var e=t.future().text;return e in wb?"\\ldots\\,":"\\ldots"});j("\\dotsc",function(t){var e=t.future().text;return e in wb&&e!==","?"\\ldots\\,":"\\ldots"});j("\\cdots",function(t){var e=t.future().text;return e in wb?"\\@cdots\\,":"\\@cdots"});j("\\dotsb","\\cdots");j("\\dotsm","\\cdots");j("\\dotsi","\\!\\cdots");j("\\dotsx","\\ldots\\,");j("\\DOTSI","\\relax");j("\\DOTSB","\\relax");j("\\DOTSX","\\relax");j("\\tmspace","\\TextOrMath{\\kern#1#3}{\\mskip#1#2}\\relax");j("\\,","\\tmspace+{3mu}{.1667em}");j("\\thinspace","\\,");j("\\>","\\mskip{4mu}");j("\\:","\\tmspace+{4mu}{.2222em}");j("\\medspace","\\:");j("\\;","\\tmspace+{5mu}{.2777em}");j("\\thickspace","\\;");j("\\!","\\tmspace-{3mu}{.1667em}");j("\\negthinspace","\\!");j("\\negmedspace","\\tmspace-{4mu}{.2222em}");j("\\negthickspace","\\tmspace-{5mu}{.277em}");j("\\enspace","\\kern.5em ");j("\\enskip","\\hskip.5em\\relax");j("\\quad","\\hskip1em\\relax");j("\\qquad","\\hskip2em\\relax");j("\\tag","\\@ifstar\\tag@literal\\tag@paren");j("\\tag@paren","\\tag@literal{({#1})}");j("\\tag@literal",t=>{if(t.macros.get("\\df@tag"))throw new ie("Multiple \\tag");return"\\gdef\\df@tag{\\text{#1}}"});j("\\bmod","\\mathchoice{\\mskip1mu}{\\mskip1mu}{\\mskip5mu}{\\mskip5mu}\\mathbin{\\rm mod}\\mathchoice{\\mskip1mu}{\\mskip1mu}{\\mskip5mu}{\\mskip5mu}");j("\\pod","\\allowbreak\\mathchoice{\\mkern18mu}{\\mkern8mu}{\\mkern8mu}{\\mkern8mu}(#1)");j("\\pmod","\\pod{{\\rm mod}\\mkern6mu#1}");j("\\mod","\\allowbreak\\mathchoice{\\mkern18mu}{\\mkern12mu}{\\mkern12mu}{\\mkern12mu}{\\rm mod}\\,\\,#1");j("\\newline","\\\\\\relax");j("\\TeX","\\textrm{\\html@mathml{T\\kern-.1667em\\raisebox{-.5ex}{E}\\kern-.125emX}{TeX}}");var iR=ae(ui["Main-Regular"][84][1]-.7*ui["Main-Regular"][65][1]);j("\\LaTeX","\\textrm{\\html@mathml{"+("L\\kern-.36em\\raisebox{"+iR+"}{\\scriptstyle A}")+"\\kern-.15em\\TeX}{LaTeX}}");j("\\KaTeX","\\textrm{\\html@mathml{"+("K\\kern-.17em\\raisebox{"+iR+"}{\\scriptstyle A}")+"\\kern-.15em\\TeX}{KaTeX}}");j("\\hspace","\\@ifstar\\@hspacer\\@hspace");j("\\@hspace","\\hskip #1\\relax");j("\\@hspacer","\\rule{0pt}{0pt}\\hskip #1\\relax");j("\\ordinarycolon",":");j("\\vcentcolon","\\mathrel{\\mathop\\ordinarycolon}");j("\\dblcolon",'\\html@mathml{\\mathrel{\\vcentcolon\\mathrel{\\mkern-.9mu}\\vcentcolon}}{\\mathop{\\char"2237}}');j("\\coloneqq",'\\html@mathml{\\mathrel{\\vcentcolon\\mathrel{\\mkern-1.2mu}=}}{\\mathop{\\char"2254}}');j("\\Coloneqq",'\\html@mathml{\\mathrel{\\dblcolon\\mathrel{\\mkern-1.2mu}=}}{\\mathop{\\char"2237\\char"3d}}');j("\\coloneq",'\\html@mathml{\\mathrel{\\vcentcolon\\mathrel{\\mkern-1.2mu}\\mathrel{-}}}{\\mathop{\\char"3a\\char"2212}}');j("\\Coloneq",'\\html@mathml{\\mathrel{\\dblcolon\\mathrel{\\mkern-1.2mu}\\mathrel{-}}}{\\mathop{\\char"2237\\char"2212}}');j("\\eqqcolon",'\\html@mathml{\\mathrel{=\\mathrel{\\mkern-1.2mu}\\vcentcolon}}{\\mathop{\\char"2255}}');j("\\Eqqcolon",'\\html@mathml{\\mathrel{=\\mathrel{\\mkern-1.2mu}\\dblcolon}}{\\mathop{\\char"3d\\char"2237}}');j("\\eqcolon",'\\html@mathml{\\mathrel{\\mathrel{-}\\mathrel{\\mkern-1.2mu}\\vcentcolon}}{\\mathop{\\char"2239}}');j("\\Eqcolon",'\\html@mathml{\\mathrel{\\mathrel{-}\\mathrel{\\mkern-1.2mu}\\dblcolon}}{\\mathop{\\char"2212\\char"2237}}');j("\\colonapprox",'\\html@mathml{\\mathrel{\\vcentcolon\\mathrel{\\mkern-1.2mu}\\approx}}{\\mathop{\\char"3a\\char"2248}}');j("\\Colonapprox",'\\html@mathml{\\mathrel{\\dblcolon\\mathrel{\\mkern-1.2mu}\\approx}}{\\mathop{\\char"2237\\char"2248}}');j("\\colonsim",'\\html@mathml{\\mathrel{\\vcentcolon\\mathrel{\\mkern-1.2mu}\\sim}}{\\mathop{\\char"3a\\char"223c}}');j("\\Colonsim",'\\html@mathml{\\mathrel{\\dblcolon\\mathrel{\\mkern-1.2mu}\\sim}}{\\mathop{\\char"2237\\char"223c}}');j("∷","\\dblcolon");j("∹","\\eqcolon");j("≔","\\coloneqq");j("≕","\\eqqcolon");j("⩴","\\Coloneqq");j("\\ratio","\\vcentcolon");j("\\coloncolon","\\dblcolon");j("\\colonequals","\\coloneqq");j("\\coloncolonequals","\\Coloneqq");j("\\equalscolon","\\eqqcolon");j("\\equalscoloncolon","\\Eqqcolon");j("\\colonminus","\\coloneq");j("\\coloncolonminus","\\Coloneq");j("\\minuscolon","\\eqcolon");j("\\minuscoloncolon","\\Eqcolon");j("\\coloncolonapprox","\\Colonapprox");j("\\coloncolonsim","\\Colonsim");j("\\simcolon","\\mathrel{\\sim\\mathrel{\\mkern-1.2mu}\\vcentcolon}");j("\\simcoloncolon","\\mathrel{\\sim\\mathrel{\\mkern-1.2mu}\\dblcolon}");j("\\approxcolon","\\mathrel{\\approx\\mathrel{\\mkern-1.2mu}\\vcentcolon}");j("\\approxcoloncolon","\\mathrel{\\approx\\mathrel{\\mkern-1.2mu}\\dblcolon}");j("\\notni","\\html@mathml{\\not\\ni}{\\mathrel{\\char`∌}}");j("\\limsup","\\DOTSB\\operatorname*{lim\\,sup}");j("\\liminf","\\DOTSB\\operatorname*{lim\\,inf}");j("\\injlim","\\DOTSB\\operatorname*{inj\\,lim}");j("\\projlim","\\DOTSB\\operatorname*{proj\\,lim}");j("\\varlimsup","\\DOTSB\\operatorname*{\\overline{lim}}");j("\\varliminf","\\DOTSB\\operatorname*{\\underline{lim}}");j("\\varinjlim","\\DOTSB\\operatorname*{\\underrightarrow{lim}}");j("\\varprojlim","\\DOTSB\\operatorname*{\\underleftarrow{lim}}");j("\\gvertneqq","\\html@mathml{\\@gvertneqq}{≩}");j("\\lvertneqq","\\html@mathml{\\@lvertneqq}{≨}");j("\\ngeqq","\\html@mathml{\\@ngeqq}{≱}");j("\\ngeqslant","\\html@mathml{\\@ngeqslant}{≱}");j("\\nleqq","\\html@mathml{\\@nleqq}{≰}");j("\\nleqslant","\\html@mathml{\\@nleqslant}{≰}");j("\\nshortmid","\\html@mathml{\\@nshortmid}{∤}");j("\\nshortparallel","\\html@mathml{\\@nshortparallel}{∦}");j("\\nsubseteqq","\\html@mathml{\\@nsubseteqq}{⊈}");j("\\nsupseteqq","\\html@mathml{\\@nsupseteqq}{⊉}");j("\\varsubsetneq","\\html@mathml{\\@varsubsetneq}{⊊}");j("\\varsubsetneqq","\\html@mathml{\\@varsubsetneqq}{⫋}");j("\\varsupsetneq","\\html@mathml{\\@varsupsetneq}{⊋}");j("\\varsupsetneqq","\\html@mathml{\\@varsupsetneqq}{⫌}");j("\\imath","\\html@mathml{\\@imath}{ı}");j("\\jmath","\\html@mathml{\\@jmath}{ȷ}");j("\\llbracket","\\html@mathml{\\mathopen{[\\mkern-3.2mu[}}{\\mathopen{\\char`⟦}}");j("\\rrbracket","\\html@mathml{\\mathclose{]\\mkern-3.2mu]}}{\\mathclose{\\char`⟧}}");j("⟦","\\llbracket");j("⟧","\\rrbracket");j("\\lBrace","\\html@mathml{\\mathopen{\\{\\mkern-3.2mu[}}{\\mathopen{\\char`⦃}}");j("\\rBrace","\\html@mathml{\\mathclose{]\\mkern-3.2mu\\}}}{\\mathclose{\\char`⦄}}");j("⦃","\\lBrace");j("⦄","\\rBrace");j("\\minuso","\\mathbin{\\html@mathml{{\\mathrlap{\\mathchoice{\\kern{0.145em}}{\\kern{0.145em}}{\\kern{0.1015em}}{\\kern{0.0725em}}\\circ}{-}}}{\\char`⦵}}");j("⦵","\\minuso");j("\\darr","\\downarrow");j("\\dArr","\\Downarrow");j("\\Darr","\\Downarrow");j("\\lang","\\langle");j("\\rang","\\rangle");j("\\uarr","\\uparrow");j("\\uArr","\\Uparrow");j("\\Uarr","\\Uparrow");j("\\N","\\mathbb{N}");j("\\R","\\mathbb{R}");j("\\Z","\\mathbb{Z}");j("\\alef","\\aleph");j("\\alefsym","\\aleph");j("\\Alpha","\\mathrm{A}");j("\\Beta","\\mathrm{B}");j("\\bull","\\bullet");j("\\Chi","\\mathrm{X}");j("\\clubs","\\clubsuit");j("\\cnums","\\mathbb{C}");j("\\Complex","\\mathbb{C}");j("\\Dagger","\\ddagger");j("\\diamonds","\\diamondsuit");j("\\empty","\\emptyset");j("\\Epsilon","\\mathrm{E}");j("\\Eta","\\mathrm{H}");j("\\exist","\\exists");j("\\harr","\\leftrightarrow");j("\\hArr","\\Leftrightarrow");j("\\Harr","\\Leftrightarrow");j("\\hearts","\\heartsuit");j("\\image","\\Im");j("\\infin","\\infty");j("\\Iota","\\mathrm{I}");j("\\isin","\\in");j("\\Kappa","\\mathrm{K}");j("\\larr","\\leftarrow");j("\\lArr","\\Leftarrow");j("\\Larr","\\Leftarrow");j("\\lrarr","\\leftrightarrow");j("\\lrArr","\\Leftrightarrow");j("\\Lrarr","\\Leftrightarrow");j("\\Mu","\\mathrm{M}");j("\\natnums","\\mathbb{N}");j("\\Nu","\\mathrm{N}");j("\\Omicron","\\mathrm{O}");j("\\plusmn","\\pm");j("\\rarr","\\rightarrow");j("\\rArr","\\Rightarrow");j("\\Rarr","\\Rightarrow");j("\\real","\\Re");j("\\reals","\\mathbb{R}");j("\\Reals","\\mathbb{R}");j("\\Rho","\\mathrm{P}");j("\\sdot","\\cdot");j("\\sect","\\S");j("\\spades","\\spadesuit");j("\\sub","\\subset");j("\\sube","\\subseteq");j("\\supe","\\supseteq");j("\\Tau","\\mathrm{T}");j("\\thetasym","\\vartheta");j("\\weierp","\\wp");j("\\Zeta","\\mathrm{Z}");j("\\argmin","\\DOTSB\\operatorname*{arg\\,min}");j("\\argmax","\\DOTSB\\operatorname*{arg\\,max}");j("\\plim","\\DOTSB\\mathop{\\operatorname{plim}}\\limits");j("\\bra","\\mathinner{\\langle{#1}|}");j("\\ket","\\mathinner{|{#1}\\rangle}");j("\\braket","\\mathinner{\\langle{#1}\\rangle}");j("\\Bra","\\left\\langle#1\\right|");j("\\Ket","\\left|#1\\right\\rangle");var oR=t=>e=>{var n=e.consumeArg().tokens,r=e.consumeArg().tokens,s=e.consumeArg().tokens,i=e.consumeArg().tokens,o=e.macros.get("|"),a=e.macros.get("\\|");e.macros.beginGroup();var l=h=>p=>{t&&(p.macros.set("|",o),s.length&&p.macros.set("\\|",a));var f=h;if(!h&&s.length){var v=p.future();v.text==="|"&&(p.popToken(),f=!0)}return{tokens:f?s:r,numArgs:0}};e.macros.set("|",l(!1)),s.length&&e.macros.set("\\|",l(!0));var c=e.consumeArg().tokens,u=e.expandTokens([...i,...c,...n]);return e.macros.endGroup(),{tokens:u.reverse(),numArgs:0}};j("\\bra@ket",oR(!1));j("\\bra@set",oR(!0));j("\\Braket","\\bra@ket{\\left\\langle}{\\,\\middle\\vert\\,}{\\,\\middle\\vert\\,}{\\right\\rangle}");j("\\Set","\\bra@set{\\left\\{\\:}{\\;\\middle\\vert\\;}{\\;\\middle\\Vert\\;}{\\:\\right\\}}");j("\\set","\\bra@set{\\{\\,}{\\mid}{}{\\,\\}}");j("\\angln","{\\angl n}");j("\\blue","\\textcolor{##6495ed}{#1}");j("\\orange","\\textcolor{##ffa500}{#1}");j("\\pink","\\textcolor{##ff00af}{#1}");j("\\red","\\textcolor{##df0030}{#1}");j("\\green","\\textcolor{##28ae7b}{#1}");j("\\gray","\\textcolor{gray}{#1}");j("\\purple","\\textcolor{##9d38bd}{#1}");j("\\blueA","\\textcolor{##ccfaff}{#1}");j("\\blueB","\\textcolor{##80f6ff}{#1}");j("\\blueC","\\textcolor{##63d9ea}{#1}");j("\\blueD","\\textcolor{##11accd}{#1}");j("\\blueE","\\textcolor{##0c7f99}{#1}");j("\\tealA","\\textcolor{##94fff5}{#1}");j("\\tealB","\\textcolor{##26edd5}{#1}");j("\\tealC","\\textcolor{##01d1c1}{#1}");j("\\tealD","\\textcolor{##01a995}{#1}");j("\\tealE","\\textcolor{##208170}{#1}");j("\\greenA","\\textcolor{##b6ffb0}{#1}");j("\\greenB","\\textcolor{##8af281}{#1}");j("\\greenC","\\textcolor{##74cf70}{#1}");j("\\greenD","\\textcolor{##1fab54}{#1}");j("\\greenE","\\textcolor{##0d923f}{#1}");j("\\goldA","\\textcolor{##ffd0a9}{#1}");j("\\goldB","\\textcolor{##ffbb71}{#1}");j("\\goldC","\\textcolor{##ff9c39}{#1}");j("\\goldD","\\textcolor{##e07d10}{#1}");j("\\goldE","\\textcolor{##a75a05}{#1}");j("\\redA","\\textcolor{##fca9a9}{#1}");j("\\redB","\\textcolor{##ff8482}{#1}");j("\\redC","\\textcolor{##f9685d}{#1}");j("\\redD","\\textcolor{##e84d39}{#1}");j("\\redE","\\textcolor{##bc2612}{#1}");j("\\maroonA","\\textcolor{##ffbde0}{#1}");j("\\maroonB","\\textcolor{##ff92c6}{#1}");j("\\maroonC","\\textcolor{##ed5fa6}{#1}");j("\\maroonD","\\textcolor{##ca337c}{#1}");j("\\maroonE","\\textcolor{##9e034e}{#1}");j("\\purpleA","\\textcolor{##ddd7ff}{#1}");j("\\purpleB","\\textcolor{##c6b9fc}{#1}");j("\\purpleC","\\textcolor{##aa87ff}{#1}");j("\\purpleD","\\textcolor{##7854ab}{#1}");j("\\purpleE","\\textcolor{##543b78}{#1}");j("\\mintA","\\textcolor{##f5f9e8}{#1}");j("\\mintB","\\textcolor{##edf2df}{#1}");j("\\mintC","\\textcolor{##e0e5cc}{#1}");j("\\grayA","\\textcolor{##f6f7f7}{#1}");j("\\grayB","\\textcolor{##f0f1f2}{#1}");j("\\grayC","\\textcolor{##e3e5e6}{#1}");j("\\grayD","\\textcolor{##d6d8da}{#1}");j("\\grayE","\\textcolor{##babec2}{#1}");j("\\grayF","\\textcolor{##888d93}{#1}");j("\\grayG","\\textcolor{##626569}{#1}");j("\\grayH","\\textcolor{##3b3e40}{#1}");j("\\grayI","\\textcolor{##21242c}{#1}");j("\\kaBlue","\\textcolor{##314453}{#1}");j("\\kaGreen","\\textcolor{##71B307}{#1}");var aR={"^":!0,_:!0,"\\limits":!0,"\\nolimits":!0};class upe{constructor(e,n,r){this.settings=void 0,this.expansionCount=void 0,this.lexer=void 0,this.macros=void 0,this.stack=void 0,this.mode=void 0,this.settings=n,this.expansionCount=0,this.feed(e),this.macros=new lpe(cpe,n.macros),this.mode=r,this.stack=[]}feed(e){this.lexer=new s9(e,this.settings)}switchMode(e){this.mode=e}beginGroup(){this.macros.beginGroup()}endGroup(){this.macros.endGroup()}endGroups(){this.macros.endGroups()}future(){return this.stack.length===0&&this.pushToken(this.lexer.lex()),this.stack[this.stack.length-1]}popToken(){return this.future(),this.stack.pop()}pushToken(e){this.stack.push(e)}pushTokens(e){this.stack.push(...e)}scanArgument(e){var n,r,s;if(e){if(this.consumeSpaces(),this.future().text!=="[")return null;n=this.popToken(),{tokens:s,end:r}=this.consumeArg(["]"])}else({tokens:s,start:n,end:r}=this.consumeArg());return this.pushToken(new ms("EOF",r.loc)),this.pushTokens(s),n.range(r,"")}consumeSpaces(){for(;;){var e=this.future();if(e.text===" ")this.stack.pop();else break}}consumeArg(e){var n=[],r=e&&e.length>0;r||this.consumeSpaces();var s=this.future(),i,o=0,a=0;do{if(i=this.popToken(),n.push(i),i.text==="{")++o;else if(i.text==="}"){if(--o,o===-1)throw new ie("Extra }",i)}else if(i.text==="EOF")throw new ie("Unexpected end of input in a macro argument, expected '"+(e&&r?e[a]:"}")+"'",i);if(e&&r)if((o===0||o===1&&e[a]==="{")&&i.text===e[a]){if(++a,a===e.length){n.splice(-a,a);break}}else a=0}while(o!==0||r);return s.text==="{"&&n[n.length-1].text==="}"&&(n.pop(),n.shift()),n.reverse(),{tokens:n,start:s,end:i}}consumeArgs(e,n){if(n){if(n.length!==e+1)throw new ie("The length of delimiters doesn't match the number of args!");for(var r=n[0],s=0;s<r.length;s++){var i=this.popToken();if(r[s]!==i.text)throw new ie("Use of the macro doesn't match its definition",i)}}for(var o=[],a=0;a<e;a++)o.push(this.consumeArg(n&&n[a+1]).tokens);return o}countExpansion(e){if(this.expansionCount+=e,this.expansionCount>this.settings.maxExpand)throw new ie("Too many expansions: infinite loop or need to increase maxExpand setting")}expandOnce(e){var n=this.popToken(),r=n.text,s=n.noexpand?null:this._getExpansion(r);if(s==null||e&&s.unexpandable){if(e&&s==null&&r[0]==="\\"&&!this.isDefined(r))throw new ie("Undefined control sequence: "+r);return this.pushToken(n),!1}this.countExpansion(1);var i=s.tokens,o=this.consumeArgs(s.numArgs,s.delimiters);if(s.numArgs){i=i.slice();for(var a=i.length-1;a>=0;--a){var l=i[a];if(l.text==="#"){if(a===0)throw new ie("Incomplete placeholder at end of macro body",l);if(l=i[--a],l.text==="#")i.splice(a+1,1);else if(/^[1-9]$/.test(l.text))i.splice(a,2,...o[+l.text-1]);else throw new ie("Not a valid argument number",l)}}}return this.pushTokens(i),i.length}expandAfterFuture(){return this.expandOnce(),this.future()}expandNextToken(){for(;;)if(this.expandOnce()===!1){var e=this.stack.pop();return e.treatAsRelax&&(e.text="\\relax"),e}throw new Error}expandMacro(e){return this.macros.has(e)?this.expandTokens([new ms(e)]):void 0}expandTokens(e){var n=[],r=this.stack.length;for(this.pushTokens(e);this.stack.length>r;)if(this.expandOnce(!0)===!1){var s=this.stack.pop();s.treatAsRelax&&(s.noexpand=!1,s.treatAsRelax=!1),n.push(s)}return this.countExpansion(n.length),n}expandMacroAsText(e){var n=this.expandMacro(e);return n&&n.map(r=>r.text).join("")}_getExpansion(e){var n=this.macros.get(e);if(n==null)return n;if(e.length===1){var r=this.lexer.catcodes[e];if(r!=null&&r!==13)return}var s=typeof n=="function"?n(this):n;if(typeof s=="string"){var i=0;if(s.indexOf("#")!==-1)for(var o=s.replace(/##/g,"");o.indexOf("#"+(i+1))!==-1;)++i;for(var a=new s9(s,this.settings),l=[],c=a.lex();c.text!=="EOF";)l.push(c),c=a.lex();l.reverse();var u={tokens:l,numArgs:i};return u}return s}isDefined(e){return this.macros.has(e)||Ho.hasOwnProperty(e)||St.math.hasOwnProperty(e)||St.text.hasOwnProperty(e)||aR.hasOwnProperty(e)}isExpandable(e){var n=this.macros.get(e);return n!=null?typeof n=="string"||typeof n=="function"||!n.unexpandable:Ho.hasOwnProperty(e)&&!Ho[e].primitive}}var a9=/^[₊₋₌₍₎₀₁₂₃₄₅₆₇₈₉ₐₑₕᵢⱼₖₗₘₙₒₚᵣₛₜᵤᵥₓᵦᵧᵨᵩᵪ]/,pp=Object.freeze({"₊":"+","₋":"-","₌":"=","₍":"(","₎":")","₀":"0","₁":"1","₂":"2","₃":"3","₄":"4","₅":"5","₆":"6","₇":"7","₈":"8","₉":"9","ₐ":"a","ₑ":"e","ₕ":"h","ᵢ":"i","ⱼ":"j","ₖ":"k","ₗ":"l","ₘ":"m","ₙ":"n","ₒ":"o","ₚ":"p","ᵣ":"r","ₛ":"s","ₜ":"t","ᵤ":"u","ᵥ":"v","ₓ":"x","ᵦ":"β","ᵧ":"γ","ᵨ":"ρ","ᵩ":"ϕ","ᵪ":"χ","⁺":"+","⁻":"-","⁼":"=","⁽":"(","⁾":")","⁰":"0","¹":"1","²":"2","³":"3","⁴":"4","⁵":"5","⁶":"6","⁷":"7","⁸":"8","⁹":"9","ᴬ":"A","ᴮ":"B","ᴰ":"D","ᴱ":"E","ᴳ":"G","ᴴ":"H","ᴵ":"I","ᴶ":"J","ᴷ":"K","ᴸ":"L","ᴹ":"M","ᴺ":"N","ᴼ":"O","ᴾ":"P","ᴿ":"R","ᵀ":"T","ᵁ":"U","ⱽ":"V","ᵂ":"W","ᵃ":"a","ᵇ":"b","ᶜ":"c","ᵈ":"d","ᵉ":"e","ᶠ":"f","ᵍ":"g",ʰ:"h","ⁱ":"i",ʲ:"j","ᵏ":"k",ˡ:"l","ᵐ":"m",ⁿ:"n","ᵒ":"o","ᵖ":"p",ʳ:"r",ˢ:"s","ᵗ":"t","ᵘ":"u","ᵛ":"v",ʷ:"w",ˣ:"x",ʸ:"y","ᶻ":"z","ᵝ":"β","ᵞ":"γ","ᵟ":"δ","ᵠ":"ϕ","ᵡ":"χ","ᶿ":"θ"}),iv={"́":{text:"\\'",math:"\\acute"},"̀":{text:"\\`",math:"\\grave"},"̈":{text:'\\"',math:"\\ddot"},"̃":{text:"\\~",math:"\\tilde"},"̄":{text:"\\=",math:"\\bar"},"̆":{text:"\\u",math:"\\breve"},"̌":{text:"\\v",math:"\\check"},"̂":{text:"\\^",math:"\\hat"},"̇":{text:"\\.",math:"\\dot"},"̊":{text:"\\r",math:"\\mathring"},"̋":{text:"\\H"},"̧":{text:"\\c"}},l9={á:"á",à:"à",ä:"ä",ǟ:"ǟ",ã:"ã",ā:"ā",ă:"ă",ắ:"ắ",ằ:"ằ",ẵ:"ẵ",ǎ:"ǎ",â:"â",ấ:"ấ",ầ:"ầ",ẫ:"ẫ",ȧ:"ȧ",ǡ:"ǡ",å:"å",ǻ:"ǻ",ḃ:"ḃ",ć:"ć",ḉ:"ḉ",č:"č",ĉ:"ĉ",ċ:"ċ",ç:"ç",ď:"ď",ḋ:"ḋ",ḑ:"ḑ",é:"é",è:"è",ë:"ë",ẽ:"ẽ",ē:"ē",ḗ:"ḗ",ḕ:"ḕ",ĕ:"ĕ",ḝ:"ḝ",ě:"ě",ê:"ê",ế:"ế",ề:"ề",ễ:"ễ",ė:"ė",ȩ:"ȩ",ḟ:"ḟ",ǵ:"ǵ",ḡ:"ḡ",ğ:"ğ",ǧ:"ǧ",ĝ:"ĝ",ġ:"ġ",ģ:"ģ",ḧ:"ḧ",ȟ:"ȟ",ĥ:"ĥ",ḣ:"ḣ",ḩ:"ḩ",í:"í",ì:"ì",ï:"ï",ḯ:"ḯ",ĩ:"ĩ",ī:"ī",ĭ:"ĭ",ǐ:"ǐ",î:"î",ǰ:"ǰ",ĵ:"ĵ",ḱ:"ḱ",ǩ:"ǩ",ķ:"ķ",ĺ:"ĺ",ľ:"ľ",ļ:"ļ",ḿ:"ḿ",ṁ:"ṁ",ń:"ń",ǹ:"ǹ",ñ:"ñ",ň:"ň",ṅ:"ṅ",ņ:"ņ",ó:"ó",ò:"ò",ö:"ö",ȫ:"ȫ",õ:"õ",ṍ:"ṍ",ṏ:"ṏ",ȭ:"ȭ",ō:"ō",ṓ:"ṓ",ṑ:"ṑ",ŏ:"ŏ",ǒ:"ǒ",ô:"ô",ố:"ố",ồ:"ồ",ỗ:"ỗ",ȯ:"ȯ",ȱ:"ȱ",ő:"ő",ṕ:"ṕ",ṗ:"ṗ",ŕ:"ŕ",ř:"ř",ṙ:"ṙ",ŗ:"ŗ",ś:"ś",ṥ:"ṥ",š:"š",ṧ:"ṧ",ŝ:"ŝ",ṡ:"ṡ",ş:"ş",ẗ:"ẗ",ť:"ť",ṫ:"ṫ",ţ:"ţ",ú:"ú",ù:"ù",ü:"ü",ǘ:"ǘ",ǜ:"ǜ",ǖ:"ǖ",ǚ:"ǚ",ũ:"ũ",ṹ:"ṹ",ū:"ū",ṻ:"ṻ",ŭ:"ŭ",ǔ:"ǔ",û:"û",ů:"ů",ű:"ű",ṽ:"ṽ",ẃ:"ẃ",ẁ:"ẁ",ẅ:"ẅ",ŵ:"ŵ",ẇ:"ẇ",ẘ:"ẘ",ẍ:"ẍ",ẋ:"ẋ",ý:"ý",ỳ:"ỳ",ÿ:"ÿ",ỹ:"ỹ",ȳ:"ȳ",ŷ:"ŷ",ẏ:"ẏ",ẙ:"ẙ",ź:"ź",ž:"ž",ẑ:"ẑ",ż:"ż",Á:"Á",À:"À",Ä:"Ä",Ǟ:"Ǟ",Ã:"Ã",Ā:"Ā",Ă:"Ă",Ắ:"Ắ",Ằ:"Ằ",Ẵ:"Ẵ",Ǎ:"Ǎ",Â:"Â",Ấ:"Ấ",Ầ:"Ầ",Ẫ:"Ẫ",Ȧ:"Ȧ",Ǡ:"Ǡ",Å:"Å",Ǻ:"Ǻ",Ḃ:"Ḃ",Ć:"Ć",Ḉ:"Ḉ",Č:"Č",Ĉ:"Ĉ",Ċ:"Ċ",Ç:"Ç",Ď:"Ď",Ḋ:"Ḋ",Ḑ:"Ḑ",É:"É",È:"È",Ë:"Ë",Ẽ:"Ẽ",Ē:"Ē",Ḗ:"Ḗ",Ḕ:"Ḕ",Ĕ:"Ĕ",Ḝ:"Ḝ",Ě:"Ě",Ê:"Ê",Ế:"Ế",Ề:"Ề",Ễ:"Ễ",Ė:"Ė",Ȩ:"Ȩ",Ḟ:"Ḟ",Ǵ:"Ǵ",Ḡ:"Ḡ",Ğ:"Ğ",Ǧ:"Ǧ",Ĝ:"Ĝ",Ġ:"Ġ",Ģ:"Ģ",Ḧ:"Ḧ",Ȟ:"Ȟ",Ĥ:"Ĥ",Ḣ:"Ḣ",Ḩ:"Ḩ",Í:"Í",Ì:"Ì",Ï:"Ï",Ḯ:"Ḯ",Ĩ:"Ĩ",Ī:"Ī",Ĭ:"Ĭ",Ǐ:"Ǐ",Î:"Î",İ:"İ",Ĵ:"Ĵ",Ḱ:"Ḱ",Ǩ:"Ǩ",Ķ:"Ķ",Ĺ:"Ĺ",Ľ:"Ľ",Ļ:"Ļ",Ḿ:"Ḿ",Ṁ:"Ṁ",Ń:"Ń",Ǹ:"Ǹ",Ñ:"Ñ",Ň:"Ň",Ṅ:"Ṅ",Ņ:"Ņ",Ó:"Ó",Ò:"Ò",Ö:"Ö",Ȫ:"Ȫ",Õ:"Õ",Ṍ:"Ṍ",Ṏ:"Ṏ",Ȭ:"Ȭ",Ō:"Ō",Ṓ:"Ṓ",Ṑ:"Ṑ",Ŏ:"Ŏ",Ǒ:"Ǒ",Ô:"Ô",Ố:"Ố",Ồ:"Ồ",Ỗ:"Ỗ",Ȯ:"Ȯ",Ȱ:"Ȱ",Ő:"Ő",Ṕ:"Ṕ",Ṗ:"Ṗ",Ŕ:"Ŕ",Ř:"Ř",Ṙ:"Ṙ",Ŗ:"Ŗ",Ś:"Ś",Ṥ:"Ṥ",Š:"Š",Ṧ:"Ṧ",Ŝ:"Ŝ",Ṡ:"Ṡ",Ş:"Ş",Ť:"Ť",Ṫ:"Ṫ",Ţ:"Ţ",Ú:"Ú",Ù:"Ù",Ü:"Ü",Ǘ:"Ǘ",Ǜ:"Ǜ",Ǖ:"Ǖ",Ǚ:"Ǚ",Ũ:"Ũ",Ṹ:"Ṹ",Ū:"Ū",Ṻ:"Ṻ",Ŭ:"Ŭ",Ǔ:"Ǔ",Û:"Û",Ů:"Ů",Ű:"Ű",Ṽ:"Ṽ",Ẃ:"Ẃ",Ẁ:"Ẁ",Ẅ:"Ẅ",Ŵ:"Ŵ",Ẇ:"Ẇ",Ẍ:"Ẍ",Ẋ:"Ẋ",Ý:"Ý",Ỳ:"Ỳ",Ÿ:"Ÿ",Ỹ:"Ỹ",Ȳ:"Ȳ",Ŷ:"Ŷ",Ẏ:"Ẏ",Ź:"Ź",Ž:"Ž",Ẑ:"Ẑ",Ż:"Ż",ά:"ά",ὰ:"ὰ",ᾱ:"ᾱ",ᾰ:"ᾰ",έ:"έ",ὲ:"ὲ",ή:"ή",ὴ:"ὴ",ί:"ί",ὶ:"ὶ",ϊ:"ϊ",ΐ:"ΐ",ῒ:"ῒ",ῑ:"ῑ",ῐ:"ῐ",ό:"ό",ὸ:"ὸ",ύ:"ύ",ὺ:"ὺ",ϋ:"ϋ",ΰ:"ΰ",ῢ:"ῢ",ῡ:"ῡ",ῠ:"ῠ",ώ:"ώ",ὼ:"ὼ",Ύ:"Ύ",Ὺ:"Ὺ",Ϋ:"Ϋ",Ῡ:"Ῡ",Ῠ:"Ῠ",Ώ:"Ώ",Ὼ:"Ὼ"};class Ym{constructor(e,n){this.mode=void 0,this.gullet=void 0,this.settings=void 0,this.leftrightDepth=void 0,this.nextToken=void 0,this.mode="math",this.gullet=new upe(e,n,this.mode),this.settings=n,this.leftrightDepth=0}expect(e,n){if(n===void 0&&(n=!0),this.fetch().text!==e)throw new ie("Expected '"+e+"', got '"+this.fetch().text+"'",this.fetch());n&&this.consume()}consume(){this.nextToken=null}fetch(){return this.nextToken==null&&(this.nextToken=this.gullet.expandNextToken()),this.nextToken}switchMode(e){this.mode=e,this.gullet.switchMode(e)}parse(){this.settings.globalGroup||this.gullet.beginGroup(),this.settings.colorIsTextColor&&this.gullet.macros.set("\\color","\\textcolor");try{var e=this.parseExpression(!1);return this.expect("EOF"),this.settings.globalGroup||this.gullet.endGroup(),e}finally{this.gullet.endGroups()}}subparse(e){var n=this.nextToken;this.consume(),this.gullet.pushToken(new ms("}")),this.gullet.pushTokens(e);var r=this.parseExpression(!1);return this.expect("}"),this.nextToken=n,r}parseExpression(e,n){for(var r=[];;){this.mode==="math"&&this.consumeSpaces();var s=this.fetch();if(Ym.endOfExpression.indexOf(s.text)!==-1||n&&s.text===n||e&&Ho[s.text]&&Ho[s.text].infix)break;var i=this.parseAtom(n);if(i){if(i.type==="internal")continue}else break;r.push(i)}return this.mode==="text"&&this.formLigatures(r),this.handleInfixNodes(r)}handleInfixNodes(e){for(var n=-1,r,s=0;s<e.length;s++)if(e[s].type==="infix"){if(n!==-1)throw new ie("only one infix operator per group",e[s].token);n=s,r=e[s].replaceWith}if(n!==-1&&r){var i,o,a=e.slice(0,n),l=e.slice(n+1);a.length===1&&a[0].type==="ordgroup"?i=a[0]:i={type:"ordgroup",mode:this.mode,body:a},l.length===1&&l[0].type==="ordgroup"?o=l[0]:o={type:"ordgroup",mode:this.mode,body:l};var c;return r==="\\\\abovefrac"?c=this.callFunction(r,[i,e[n],o],[]):c=this.callFunction(r,[i,o],[]),[c]}else return e}handleSupSubscript(e){var n=this.fetch(),r=n.text;this.consume(),this.consumeSpaces();var s=this.parseGroup(e);if(!s)throw new ie("Expected group after '"+r+"'",n);return s}formatUnsupportedCmd(e){for(var n=[],r=0;r<e.length;r++)n.push({type:"textord",mode:"text",text:e[r]});var s={type:"text",mode:this.mode,body:n},i={type:"color",mode:this.mode,color:this.settings.errorColor,body:[s]};return i}parseAtom(e){var n=this.parseGroup("atom",e);if(this.mode==="text")return n;for(var r,s;;){this.consumeSpaces();var i=this.fetch();if(i.text==="\\limits"||i.text==="\\nolimits"){if(n&&n.type==="op"){var o=i.text==="\\limits";n.limits=o,n.alwaysHandleSupSub=!0}else if(n&&n.type==="operatorname")n.alwaysHandleSupSub&&(n.limits=i.text==="\\limits");else throw new ie("Limit controls must follow a math operator",i);this.consume()}else if(i.text==="^"){if(r)throw new ie("Double superscript",i);r=this.handleSupSubscript("superscript")}else if(i.text==="_"){if(s)throw new ie("Double subscript",i);s=this.handleSupSubscript("subscript")}else if(i.text==="'"){if(r)throw new ie("Double superscript",i);var a={type:"textord",mode:this.mode,text:"\\prime"},l=[a];for(this.consume();this.fetch().text==="'";)l.push(a),this.consume();this.fetch().text==="^"&&l.push(this.handleSupSubscript("superscript")),r={type:"ordgroup",mode:this.mode,body:l}}else if(pp[i.text]){var c=a9.test(i.text),u=[];for(u.push(new ms(pp[i.text])),this.consume();;){var h=this.fetch().text;if(!pp[h]||a9.test(h)!==c)break;u.unshift(new ms(pp[h])),this.consume()}var p=this.subparse(u);c?s={type:"ordgroup",mode:"math",body:p}:r={type:"ordgroup",mode:"math",body:p}}else break}return r||s?{type:"supsub",mode:this.mode,base:n,sup:r,sub:s}:n}parseFunction(e,n){var r=this.fetch(),s=r.text,i=Ho[s];if(!i)return null;if(this.consume(),n&&n!=="atom"&&!i.allowedInArgument)throw new ie("Got function '"+s+"' with no arguments"+(n?" as "+n:""),r);if(this.mode==="text"&&!i.allowedInText)throw new ie("Can't use function '"+s+"' in text mode",r);if(this.mode==="math"&&i.allowedInMath===!1)throw new ie("Can't use function '"+s+"' in math mode",r);var{args:o,optArgs:a}=this.parseArguments(s,i);return this.callFunction(s,o,a,r,e)}callFunction(e,n,r,s,i){var o={funcName:e,parser:this,token:s,breakOnTokenText:i},a=Ho[e];if(a&&a.handler)return a.handler(o,n,r);throw new ie("No function handler for "+e)}parseArguments(e,n){var r=n.numArgs+n.numOptionalArgs;if(r===0)return{args:[],optArgs:[]};for(var s=[],i=[],o=0;o<r;o++){var a=n.argTypes&&n.argTypes[o],l=o<n.numOptionalArgs;(n.primitive&&a==null||n.type==="sqrt"&&o===1&&i[0]==null)&&(a="primitive");var c=this.parseGroupOfType("argument to '"+e+"'",a,l);if(l)i.push(c);else if(c!=null)s.push(c);else throw new ie("Null argument, please report this as a bug")}return{args:s,optArgs:i}}parseGroupOfType(e,n,r){switch(n){case"color":return this.parseColorGroup(r);case"size":return this.parseSizeGroup(r);case"url":return this.parseUrlGroup(r);case"math":case"text":return this.parseArgumentGroup(r,n);case"hbox":{var s=this.parseArgumentGroup(r,"text");return s!=null?{type:"styling",mode:s.mode,body:[s],style:"text"}:null}case"raw":{var i=this.parseStringGroup("raw",r);return i!=null?{type:"raw",mode:"text",string:i.text}:null}case"primitive":{if(r)throw new ie("A primitive argument cannot be optional");var o=this.parseGroup(e);if(o==null)throw new ie("Expected group as "+e,this.fetch());return o}case"original":case null:case void 0:return this.parseArgumentGroup(r);default:throw new ie("Unknown group type as "+e,this.fetch())}}consumeSpaces(){for(;this.fetch().text===" ";)this.consume()}parseStringGroup(e,n){var r=this.gullet.scanArgument(n);if(r==null)return null;for(var s="",i;(i=this.fetch()).text!=="EOF";)s+=i.text,this.consume();return this.consume(),r.text=s,r}parseRegexGroup(e,n){for(var r=this.fetch(),s=r,i="",o;(o=this.fetch()).text!=="EOF"&&e.test(i+o.text);)s=o,i+=s.text,this.consume();if(i==="")throw new ie("Invalid "+n+": '"+r.text+"'",r);return r.range(s,i)}parseColorGroup(e){var n=this.parseStringGroup("color",e);if(n==null)return null;var r=/^(#[a-f0-9]{3}|#?[a-f0-9]{6}|[a-z]+)$/i.exec(n.text);if(!r)throw new ie("Invalid color: '"+n.text+"'",n);var s=r[0];return/^[0-9a-f]{6}$/i.test(s)&&(s="#"+s),{type:"color-token",mode:this.mode,color:s}}parseSizeGroup(e){var n,r=!1;if(this.gullet.consumeSpaces(),!e&&this.gullet.future().text!=="{"?n=this.parseRegexGroup(/^[-+]? *(?:$|\d+|\d+\.\d*|\.\d*) *[a-z]{0,2} *$/,"size"):n=this.parseStringGroup("size",e),!n)return null;!e&&n.text.length===0&&(n.text="0pt",r=!0);var s=/([-+]?) *(\d+(?:\.\d*)?|\.\d+) *([a-z]{2})/.exec(n.text);if(!s)throw new ie("Invalid size: '"+n.text+"'",n);var i={number:+(s[1]+s[2]),unit:s[3]};if(!yj(i))throw new ie("Invalid unit: '"+i.unit+"'",n);return{type:"size",mode:this.mode,value:i,isBlank:r}}parseUrlGroup(e){this.gullet.lexer.setCatcode("%",13),this.gullet.lexer.setCatcode("~",12);var n=this.parseStringGroup("url",e);if(this.gullet.lexer.setCatcode("%",14),this.gullet.lexer.setCatcode("~",13),n==null)return null;var r=n.text.replace(/\\([#$%&~_^{}])/g,"$1");return{type:"url",mode:this.mode,url:r}}parseArgumentGroup(e,n){var r=this.gullet.scanArgument(e);if(r==null)return null;var s=this.mode;n&&this.switchMode(n),this.gullet.beginGroup();var i=this.parseExpression(!1,"EOF");this.expect("EOF"),this.gullet.endGroup();var o={type:"ordgroup",mode:this.mode,loc:r.loc,body:i};return n&&this.switchMode(s),o}parseGroup(e,n){var r=this.fetch(),s=r.text,i;if(s==="{"||s==="\\begingroup"){this.consume();var o=s==="{"?"}":"\\endgroup";this.gullet.beginGroup();var a=this.parseExpression(!1,o),l=this.fetch();this.expect(o),this.gullet.endGroup(),i={type:"ordgroup",mode:this.mode,loc:Lr.range(r,l),body:a,semisimple:s==="\\begingroup"||void 0}}else if(i=this.parseFunction(n,e)||this.parseSymbol(),i==null&&s[0]==="\\"&&!aR.hasOwnProperty(s)){if(this.settings.throwOnError)throw new ie("Undefined control sequence: "+s,r);i=this.formatUnsupportedCmd(s),this.consume()}return i}formLigatures(e){for(var n=e.length-1,r=0;r<n;++r){var s=e[r],i=s.text;i==="-"&&e[r+1].text==="-"&&(r+1<n&&e[r+2].text==="-"?(e.splice(r,3,{type:"textord",mode:"text",loc:Lr.range(s,e[r+2]),text:"---"}),n-=2):(e.splice(r,2,{type:"textord",mode:"text",loc:Lr.range(s,e[r+1]),text:"--"}),n-=1)),(i==="'"||i==="`")&&e[r+1].text===i&&(e.splice(r,2,{type:"textord",mode:"text",loc:Lr.range(s,e[r+1]),text:i+i}),n-=1)}}parseSymbol(){var e=this.fetch(),n=e.text;if(/^\\verb[^a-zA-Z]/.test(n)){this.consume();var r=n.slice(5),s=r.charAt(0)==="*";if(s&&(r=r.slice(1)),r.length<2||r.charAt(0)!==r.slice(-1))throw new ie(`\\verb assertion failed --
                    please report what input caused this bug`);return r=r.slice(1,-1),{type:"verb",mode:"text",body:r,star:s}}l9.hasOwnProperty(n[0])&&!St[this.mode][n[0]]&&(this.settings.strict&&this.mode==="math"&&this.settings.reportNonstrict("unicodeTextInMathMode",'Accented Unicode text character "'+n[0]+'" used in math mode',e),n=l9[n[0]]+n.slice(1));var i=ope.exec(n);i&&(n=n.substring(0,i.index),n==="i"?n="ı":n==="j"&&(n="ȷ"));var o;if(St[this.mode][n]){this.settings.strict&&this.mode==="math"&&LS.indexOf(n)>=0&&this.settings.reportNonstrict("unicodeTextInMathMode",'Latin-1/Unicode text character "'+n[0]+'" used in math mode',e);var a=St[this.mode][n].group,l=Lr.range(e),c;if(Qhe.hasOwnProperty(a)){var u=a;c={type:"atom",mode:this.mode,family:u,loc:l,text:n}}else c={type:a,mode:this.mode,loc:l,text:n};o=c}else if(n.charCodeAt(0)>=128)this.settings.strict&&(mj(n.charCodeAt(0))?this.mode==="math"&&this.settings.reportNonstrict("unicodeTextInMathMode",'Unicode text character "'+n[0]+'" used in math mode',e):this.settings.reportNonstrict("unknownSymbol",'Unrecognized Unicode character "'+n[0]+'"'+(" ("+n.charCodeAt(0)+")"),e)),o={type:"textord",mode:"text",loc:Lr.range(e),text:n};else return null;if(this.consume(),i)for(var h=0;h<i[0].length;h++){var p=i[0][h];if(!iv[p])throw new ie("Unknown accent ' "+p+"'",e);var f=iv[p][this.mode]||iv[p].text;if(!f)throw new ie("Accent "+p+" unsupported in "+this.mode+" mode",e);o={type:"accent",mode:this.mode,loc:Lr.range(e),label:f,isStretchy:!1,isShifty:!0,base:o}}return o}}Ym.endOfExpression=["}","\\endgroup","\\end","\\right","&"];var bb=function(e,n){if(!(typeof e=="string"||e instanceof String))throw new TypeError("KaTeX can only parse string typed expression");var r=new Ym(e,n);delete r.gullet.macros.current["\\df@tag"];var s=r.parse();if(delete r.gullet.macros.current["\\current@color"],delete r.gullet.macros.current["\\color"],r.gullet.macros.get("\\df@tag")){if(!n.displayMode)throw new ie("\\tag works only in display equations");s=[{type:"tag",mode:"text",body:s,tag:r.subparse([new ms("\\df@tag")])}]}return s},lR=function(e,n,r){n.textContent="";var s=Cb(e,r).toNode();n.appendChild(s)};typeof document<"u"&&document.compatMode!=="CSS1Compat"&&(typeof console<"u"&&console.warn("Warning: KaTeX doesn't work in quirks mode. Make sure your website has a suitable doctype."),lR=function(){throw new ie("KaTeX doesn't work in quirks mode.")});var dpe=function(e,n){var r=Cb(e,n).toMarkup();return r},hpe=function(e,n){var r=new sb(n);return bb(e,r)},cR=function(e,n,r){if(r.throwOnError||!(e instanceof ie))throw e;var s=Y.makeSpan(["katex-error"],[new xs(n)]);return s.setAttribute("title",e.toString()),s.setAttribute("style","color:"+r.errorColor),s},Cb=function(e,n){var r=new sb(n);try{var s=bb(e,r);return w0e(s,e,r)}catch(i){return cR(i,e,r)}},ppe=function(e,n){var r=new sb(n);try{var s=bb(e,r);return b0e(s,e,r)}catch(i){return cR(i,e,r)}},fpe="0.16.21",gpe={Span:Hh,Anchor:ab,SymbolNode:xs,SvgNode:lo,PathNode:pa,LineNode:OS},mpe={version:fpe,render:lR,renderToString:dpe,ParseError:ie,SETTINGS_SCHEMA:cf,__parse:hpe,__renderToDomTree:Cb,__renderToHTMLTree:ppe,__setFontMetrics:Whe,__defineSymbol:k,__defineFunction:ue,__defineMacro:j,__domTree:gpe};const Mg=class Mg extends fs{constructor(){super(...arguments),this.canEdit=()=>!0,this.canResize=()=>!1,this.isAspectRatioLocked=()=>!0,this.onResize=(e,n)=>fm(e,n)}getDefaultProps(){return{w:200,h:45,text:"\\sin^2\\theta+\\cos^2\\theta=1"}}getGeometry(e){return new xi({width:e.props.w,height:e.props.h,isFilled:!0})}component(e){const n=this.editor.getEditingShapeId()===e.id;let r={__html:mpe.renderToString(e.props.text,{throwOnError:!1,output:"mathml",displayMode:!0})};const s=5;return d.jsxs(aa,{id:e.id,onPointerDown:n?sn:void 0,style:{pointerEvents:n?"all":"none",paddingTop:s+"px"},children:[d.jsx("div",{style:{margin:0,padding:"5px",fontSize:24,textAlign:"center"},dangerouslySetInnerHTML:r}),n&&d.jsx("textarea",{style:{margin:0,padding:"5px",paddingTop:"10px",position:"absolute",backgroundColor:"rgba(82, 78, 183, 0.2)",color:"currentColor",width:"150%",height:"200%",border:"none",fontFamily:"monospace"},onChange:i=>{const o=i.target.value,l=i.target.parentNode.children[0],c=l.scrollHeight+s,u=l.scrollWidth;this.editor.updateShape({id:e.id,type:e.type,props:{...e.props,text:o,h:c,w:u}})},value:e.props.text})]})}indicator(e){return console.log("indicator call"),d.jsx("rect",{width:e.props.w,height:e.props.h})}};Mg.type="card",Mg.props=ghe;let US=Mg;const Pb=location.origin;console.log("host",Pb);const ype={async upload(t,e){const r=`${dt()}-${e.name}`,s=`${Pb}/uploads/${encodeURIComponent(r)}`,i=await fetch(s,{method:"PUT",body:e});if(!i.ok)throw new Error(`Failed to upload asset: ${i.statusText}`);let o=await i.json();return o&&o.publicUrl?(console.log("got a public url from server",o.publicUrl),o.publicUrl):(console.log("no public url",i),s)},resolve(t){return console.log("resolve asset",t.props),t.props.src}};function vpe(t){let e=t.roomId;if(!e||e<1)return null;const n=()=>d.jsxs(ND,{children:[d.jsx(LD,{}),d.jsx("div",{style:{backgroundColor:"thistle"},children:d.jsx(Ae,{id:"example",children:d.jsx(X,{id:"goBack",label:"Go back",icon:"arrow-left",readonlyOk:!0,onSelect:()=>{console.log("go back click"),t.handler(0)}})})})]}),r={icons:{"sigma-icon":"sigma.svg"}},s={MainMenu:n,...fhe},i=[US],o=[DS],a=C.useRef([...rw,...i]),l=dhe({uri:`${Pb}/connect/${e}`,assets:ype,shapeUtils:a.current});return d.jsx("div",{style:{position:"fixed",inset:0},children:d.jsx(Ude,{assetUrls:r,components:s,overrides:phe,shapeUtils:i,store:l,tools:o})})}function Spe(t){const e=`${t.host}/list`,[n,r]=C.useState([]),[s,i]=C.useState(!0),[o,a]=C.useState(null),l=t.handler;return C.useEffect(()=>{(async()=>{try{const u=await fetch(e);if(!u.ok)throw new Error(`HTTP error! status: ${u.status}`);const h=await u.json();r(h.records)}catch(u){a(u)}finally{i(!1)}})()},[]),s?d.jsx("p",{children:"Loading records..."}):o?d.jsxs("p",{children:["Error: ",o.message]}):d.jsx("div",{className:"board-list",children:n.map(c=>d.jsx("div",{className:"list-entry",onClick:()=>l(c.jam_id),children:d.jsx("span",{children:c.title})},c.jam_id))})}const c9=location.origin;class Zpe extends Ne.Component{constructor(e){super(e),this.state={inputValue:""},this.handler=e.handler}reset(){this.state={inputValue:""}}updateValue(e){this.setState({inputValue:e.target.value})}handleClick(){this.handler(Number(this.state.inputValue))}render(){return d.jsxs("div",{children:[d.jsx("div",{children:" Room ID: "}),d.jsx("input",{value:this.state.inputValue,onChange:this.updateValue.bind(this)}),d.jsx("button",{onClick:this.handleClick.bind(this),children:"confirm"})]})}}function xpe(t){const[e,n]=C.useState(""),r=s=>{s.preventDefault(),e&&(alert(`Creating new board: ${e}`),t.handler(e),n(""))};return d.jsxs("form",{onSubmit:r,children:[d.jsx("div",{children:"Enter title for new board:"}),d.jsx("br",{}),d.jsx("input",{type:"text",value:e,onChange:s=>n(s.target.value)}),d.jsx("input",{type:"submit"})]})}class wpe extends Ne.Component{constructor(e){super(e),this.state={currentRoom:0,updateKey:dt()}}async newRoom(e){if(!e)return;const n=`${c9}/new`;try{const r={method:"PUT",body:JSON.stringify({title:e})},s=await fetch(n,r);if(!s.ok)throw new Error(`new room HTTP error! status: ${s.status}`);setTimeout(()=>this.refresh(),100)}catch(r){console.log("new room error",r)}}refresh(){const e={currentRoom:this.state.currentRoom,updateKey:dt()};this.setState(e)}changeRoom(e){this.setState({currentRoom:e})}reset(){this.state={currentRoom:0,updateKey:dt()}}render(){return this.state.currentRoom<1?d.jsxs("div",{className:"homepage",children:[d.jsx("h1",{children:"Sketchboard"}),d.jsx("div",{className:"new-board",children:d.jsx(xpe,{handler:this.newRoom.bind(this)})}),d.jsx(Spe,{handler:this.changeRoom.bind(this),host:c9},this.state.updateKey)]}):d.jsx(vpe,{handler:this.changeRoom.bind(this),roomId:this.state.currentRoom})}}Iv.createRoot(document.getElementById("root")).render(d.jsx(Ne.StrictMode,{children:d.jsx(wpe,{})}));
